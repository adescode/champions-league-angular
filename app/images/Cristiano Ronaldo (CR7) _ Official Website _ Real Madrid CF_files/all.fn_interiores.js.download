function whenAvailable(t,e){var i=10;window.setTimeout(function(){window[t]?e(window[t]):window.setTimeout(arguments.callee,i)},i)}function InfoBox(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infoBox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"https://www.google.com/intl/en_us/mapfiles/close.gif",""===t.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=t.isHidden||!1,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}window.Modernizr=function(t,e,i){function n(t){y.cssText=t}function r(t,e){return typeof t===e}function o(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var n in t){var r=t[n];if(!o(r,"-")&&y[r]!==i)return"pfx"==e?r:!0}return!1}function s(t,e,n){for(var o in t){var a=e[t[o]];if(a!==i)return n===!1?t[o]:r(a,"function")?a.bind(n||e):a}return!1}function l(t,e,i){var n=t.charAt(0).toUpperCase()+t.slice(1),o=(t+" "+x.join(n+" ")+n).split(" ");return r(e,"string")||r(e,"undefined")?a(o,e):(o=(t+" "+b.join(n+" ")+n).split(" "),s(o,e,i))}var c,h,u,d="2.6.2",p={},f=!0,m=e.documentElement,g="modernizr",v=e.createElement(g),y=v.style,_=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),w="Webkit Moz O ms",x=w.split(" "),b=w.toLowerCase().split(" "),M={svg:"https://www.w3.org/TR/SVG/"},T={},E=[],S=E.slice,C=function(t,i,n,r){var o,a,s,l,c=e.createElement("div"),h=e.body,u=h||e.createElement("body");if(parseInt(n,10))for(;n--;)s=e.createElement("div"),s.id=r?r[n]:g+(n+1),c.appendChild(s);return o=["&#173;",'<style id="s',g,'">',t,"</style>"].join(""),c.id=g,(h?c:u).innerHTML+=o,u.appendChild(c),h||(u.style.background="",u.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(u)),a=i(c,t),h?c.parentNode.removeChild(c):(u.parentNode.removeChild(u),m.style.overflow=l),!!a},A={}.hasOwnProperty;u=r(A,"undefined")||r(A.call,"undefined")?function(t,e){return e in t&&r(t.constructor.prototype[e],"undefined")}:function(t,e){return A.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=S.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=e.prototype;var o=new r,a=e.apply(o,i.concat(S.call(arguments)));return Object(a)===a?a:o}return e.apply(t,i.concat(S.call(arguments)))};return n}),T.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),o(y.backgroundColor,"rgba")},T.borderradius=function(){return l("borderRadius")},T.csstransforms=function(){return!!l("transform")},T.svg=function(){return!!e.createElementNS&&!!e.createElementNS(M.svg,"svg").createSVGRect};for(var P in T)u(T,P)&&(h=P.toLowerCase(),p[h]=T[P](),E.push((p[h]?"":"no-")+h));return p.addTest=function(t,e){if("object"==typeof t)for(var n in t)u(t,n)&&p.addTest(n,t[n]);else{if(t=t.toLowerCase(),p[t]!==i)return p;e="function"==typeof e?e():e,"undefined"!=typeof f&&f&&(m.className+=" "+(e?"":"no-")+t),p[t]=e}return p},n(""),v=c=null,p._version=d,p._prefixes=_,p._domPrefixes=b,p._cssomPrefixes=x,p.testProp=function(t){return a([t])},p.testAllProps=l,p.testStyles=C,m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+E.join(" "):""),p}(this,this.document),Modernizr.addTest("adownload","download"in document.createElement("a")),/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */
function(t){var e=navigator.userAgent;t.HTMLPictureElement&&/ecko/.test(e)&&e.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var e,i=document.createElement("source"),n=function(t){var e,n,r=t.parentNode;"PICTURE"===r.nodeName.toUpperCase()?(e=i.cloneNode(),r.insertBefore(e,r.firstElementChild),setTimeout(function(){r.removeChild(e)})):(!t._pfLastSize||t.offsetWidth>t._pfLastSize)&&(t._pfLastSize=t.offsetWidth,n=t.sizes,t.sizes+=",100vw",setTimeout(function(){t.sizes=n}))},r=function(){var t,e=document.querySelectorAll("picture > img, img[srcset][sizes]");for(t=0;t<e.length;t++)n(e[t])},o=function(){clearTimeout(e),e=setTimeout(r,99)},a=t.matchMedia&&matchMedia("(orientation: landscape)"),s=function(){o(),a&&a.addListener&&a.addListener(o)};return i.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?s():document.addEventListener("DOMContentLoaded",s),o}())}(window),/*! Picturefill - v3.0.2
 * http://scottjehl.github.io/picturefill
 * Copyright (c) 2015 https://github.com/scottjehl/picturefill/blob/master/Authors.txt;
 *  License: MIT
 */
function(t,e,i){"use strict";function n(t){return" "===t||"	"===t||"\n"===t||"\f"===t||"\r"===t}function r(e,i){var n=new t.Image;return n.onerror=function(){S[e]=!1,ee()},n.onload=function(){S[e]=1===n.width,ee()},n.src=i,"pending"}function o(){N=!1,H=t.devicePixelRatio,B={},U={},y.DPR=H||1,G.width=Math.max(t.innerWidth||0,E.clientWidth),G.height=Math.max(t.innerHeight||0,E.clientHeight),G.vw=G.width/100,G.vh=G.height/100,v=[G.height,G.width,H].join("-"),G.em=y.getEmValue(),G.rem=G.em}function a(t,e,i,n){var r,o,a,s;return"saveData"===C.algorithm?t>2.7?s=i+1:(o=e-i,r=Math.pow(t-.6,1.5),a=o*r,n&&(a+=.1*r),s=t+a):s=i>1?Math.sqrt(t*e):t,s>i}function s(t){var e,i=y.getSet(t),n=!1;"pending"!==i&&(n=v,i&&(e=y.setRes(i),y.applySetCandidate(e,t))),t[y.ns].evaled=n}function l(t,e){return t.res-e.res}function c(t,e,i){var n;return!i&&e&&(i=t[y.ns].sets,i=i&&i[i.length-1]),n=h(e,i),n&&(e=y.makeUrl(e),t[y.ns].curSrc=e,t[y.ns].curCan=n,n.res||te(n,n.set.sizes)),n}function h(t,e){var i,n,r;if(t&&e)for(r=y.parseSet(e),t=y.makeUrl(t),i=0;i<r.length;i++)if(t===y.makeUrl(r[i].url)){n=r[i];break}return n}function u(t,e){var i,n,r,o,a=t.getElementsByTagName("source");for(i=0,n=a.length;n>i;i++)r=a[i],r[y.ns]=!0,o=r.getAttribute("srcset"),o&&e.push({srcset:o,media:r.getAttribute("media"),type:r.getAttribute("type"),sizes:r.getAttribute("sizes")})}function d(t,e){function i(e){var i,n=e.exec(t.substring(d));return n?(i=n[0],d+=i.length,i):void 0}function r(){var t,i,n,r,o,l,c,h,u,d=!1,f={};for(r=0;r<s.length;r++)o=s[r],l=o[o.length-1],c=o.substring(0,o.length-1),h=parseInt(c,10),u=parseFloat(c),$.test(c)&&"w"===l?((t||i)&&(d=!0),0===h?d=!0:t=h):Z.test(c)&&"x"===l?((t||i||n)&&(d=!0),0>u?d=!0:i=u):$.test(c)&&"h"===l?((n||i)&&(d=!0),0===h?d=!0:n=h):d=!0;d||(f.url=a,t&&(f.w=t),i&&(f.d=i),n&&(f.h=n),n||i||t||(f.d=1),1===f.d&&(e.has1x=!0),f.set=e,p.push(f))}function o(){for(i(Y),l="",c="in descriptor";;){if(h=t.charAt(d),"in descriptor"===c)if(n(h))l&&(s.push(l),l="",c="after descriptor");else{if(","===h)return d+=1,l&&s.push(l),void r();if("("===h)l+=h,c="in parens";else{if(""===h)return l&&s.push(l),void r();l+=h}}else if("in parens"===c)if(")"===h)l+=h,c="in descriptor";else{if(""===h)return s.push(l),void r();l+=h}else if("after descriptor"===c)if(n(h));else{if(""===h)return void r();c="in descriptor",d-=1}d+=1}}for(var a,s,l,c,h,u=t.length,d=0,p=[];;){if(i(V),d>=u)return p;a=i(X),s=[],","===a.slice(-1)?(a=a.replace(q,""),r()):o()}}function p(t){function e(t){function e(){o&&(a.push(o),o="")}function i(){a[0]&&(s.push(a),a=[])}for(var r,o="",a=[],s=[],l=0,c=0,h=!1;;){if(r=t.charAt(c),""===r)return e(),i(),s;if(h){if("*"===r&&"/"===t[c+1]){h=!1,c+=2,e();continue}c+=1}else{if(n(r)){if(t.charAt(c-1)&&n(t.charAt(c-1))||!o){c+=1;continue}if(0===l){e(),c+=1;continue}r=" "}else if("("===r)l+=1;else if(")"===r)l-=1;else{if(","===r){e(),i(),c+=1;continue}if("/"===r&&"*"===t.charAt(c+1)){h=!0,c+=2;continue}}o+=r,c+=1}}}function i(t){return h.test(t)&&parseFloat(t)>=0?!0:u.test(t)?!0:"0"===t||"-0"===t||"+0"===t?!0:!1}var r,o,a,s,l,c,h=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,u=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(o=e(t),a=o.length,r=0;a>r;r++)if(s=o[r],l=s[s.length-1],i(l)){if(c=l,s.pop(),0===s.length)return c;if(s=s.join(" "),y.matchesMedia(s))return c}return"100vw"}e.createElement("picture");var f,m,g,v,y={},_=!1,w=function(){},x=e.createElement("img"),b=x.getAttribute,M=x.setAttribute,T=x.removeAttribute,E=e.documentElement,S={},C={algorithm:""},A="data-pfsrc",P=A+"set",L=navigator.userAgent,k=/rident/.test(L)||/ecko/.test(L)&&L.match(/rv\:(\d+)/)&&RegExp.$1>35,I="currentSrc",R=/\s+\+?\d+(e\d+)?w/,D=/(\([^)]+\))?\s*(.+)/,z=t.picturefillCFG,O="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",F="font-size:100%!important;",N=!0,B={},U={},H=t.devicePixelRatio,G={px:1,"in":96},j=e.createElement("a"),W=!1,Y=/^[ \t\n\r\u000c]+/,V=/^[, \t\n\r\u000c]+/,X=/^[^ \t\n\r\u000c]+/,q=/[,]+$/,$=/^\d+$/,Z=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Q=function(t,e,i,n){t.addEventListener?t.addEventListener(e,i,n||!1):t.attachEvent&&t.attachEvent("on"+e,i)},K=function(t){var e={};return function(i){return i in e||(e[i]=t(i)),e[i]}},J=function(){var t=/^([\d\.]+)(em|vw|px)$/,e=function(){for(var t=arguments,e=0,i=t[0];++e in t;)i=i.replace(t[e],t[++e]);return i},i=K(function(t){return"return "+e((t||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"});return function(e,n){var r;if(!(e in B))if(B[e]=!1,n&&(r=e.match(t)))B[e]=r[1]*G[r[2]];else try{B[e]=new Function("e",i(e))(G)}catch(o){}return B[e]}}(),te=function(t,e){return t.w?(t.cWidth=y.calcListLength(e||"100vw"),t.res=t.w/t.cWidth):t.res=t.d,t},ee=function(t){if(_){var i,n,r,o=t||{};if(o.elements&&1===o.elements.nodeType&&("IMG"===o.elements.nodeName.toUpperCase()?o.elements=[o.elements]:(o.context=o.elements,o.elements=null)),i=o.elements||y.qsa(o.context||e,o.reevaluate||o.reselect?y.sel:y.selShort),r=i.length){for(y.setupRun(o),W=!0,n=0;r>n;n++)y.fillImg(i[n],o);y.teardownRun(o)}}};f=t.console&&console.warn?function(t){console.warn(t)}:w,I in x||(I="src"),S["image/jpeg"]=!0,S["image/gif"]=!0,S["image/png"]=!0,S["image/svg+xml"]=e.implementation.hasFeature("https://www.w3.org/TR/SVG11/feature#Image","1.1"),y.ns=("pf"+(new Date).getTime()).substr(0,9),y.supSrcset="srcset"in x,y.supSizes="sizes"in x,y.supPicture=!!t.HTMLPictureElement,y.supSrcset&&y.supPicture&&!y.supSizes&&!function(t){x.srcset="data:,a",t.src="data:,a",y.supSrcset=x.complete===t.complete,y.supPicture=y.supSrcset&&y.supPicture}(e.createElement("img")),y.supSrcset&&!y.supSizes?!function(){var t="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",i="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",n=e.createElement("img"),r=function(){var t=n.width;2===t&&(y.supSizes=!0),g=y.supSrcset&&!y.supSizes,_=!0,setTimeout(ee)};n.onload=r,n.onerror=r,n.setAttribute("sizes","9px"),n.srcset=i+" 1w,"+t+" 9w",n.src=i}():_=!0,y.selShort="picture>img,img[srcset]",y.sel=y.selShort,y.cfg=C,y.DPR=H||1,y.u=G,y.types=S,y.setSize=w,y.makeUrl=K(function(t){return j.href=t,j.href}),y.qsa=function(t,e){return"querySelector"in t?t.querySelectorAll(e):[]},y.matchesMedia=function(){return y.matchesMedia=t.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?function(t){return!t||matchMedia(t).matches}:y.mMQ,y.matchesMedia.apply(this,arguments)},y.mMQ=function(t){return t?J(t):!0},y.calcLength=function(t){var e=J(t,!0)||!1;return 0>e&&(e=!1),e},y.supportsType=function(t){return t?S[t]:!0},y.parseSize=K(function(t){var e=(t||"").match(D);return{media:e&&e[1],length:e&&e[2]}}),y.parseSet=function(t){return t.cands||(t.cands=d(t.srcset,t)),t.cands},y.getEmValue=function(){var t;if(!m&&(t=e.body)){var i=e.createElement("div"),n=E.style.cssText,r=t.style.cssText;i.style.cssText=O,E.style.cssText=F,t.style.cssText=F,t.appendChild(i),m=i.offsetWidth,t.removeChild(i),m=parseFloat(m,10),E.style.cssText=n,t.style.cssText=r}return m||16},y.calcListLength=function(t){if(!(t in U)||C.uT){var e=y.calcLength(p(t));U[t]=e?e:G.width}return U[t]},y.setRes=function(t){var e;if(t){e=y.parseSet(t);for(var i=0,n=e.length;n>i;i++)te(e[i],t.sizes)}return e},y.setRes.res=te,y.applySetCandidate=function(t,e){if(t.length){var i,n,r,o,s,h,u,d,p,f=e[y.ns],m=y.DPR;if(h=f.curSrc||e[I],u=f.curCan||c(e,h,t[0].set),u&&u.set===t[0].set&&(p=k&&!e.complete&&u.res-.1>m,p||(u.cached=!0,u.res>=m&&(s=u))),!s)for(t.sort(l),o=t.length,s=t[o-1],n=0;o>n;n++)if(i=t[n],i.res>=m){r=n-1,s=t[r]&&(p||h!==y.makeUrl(i.url))&&a(t[r].res,i.res,m,t[r].cached)?t[r]:i;break}s&&(d=y.makeUrl(s.url),f.curSrc=d,f.curCan=s,d!==h&&y.setSrc(e,s),y.setSize(e))}},y.setSrc=function(t,e){var i;t.src=e.url,"image/svg+xml"===e.set.type&&(i=t.style.width,t.style.width=t.offsetWidth+1+"px",t.offsetWidth+1&&(t.style.width=i))},y.getSet=function(t){var e,i,n,r=!1,o=t[y.ns].sets;for(e=0;e<o.length&&!r;e++)if(i=o[e],i.srcset&&y.matchesMedia(i.media)&&(n=y.supportsType(i.type))){"pending"===n&&(i=n),r=i;break}return r},y.parseSets=function(t,e,n){var r,o,a,s,l=e&&"PICTURE"===e.nodeName.toUpperCase(),c=t[y.ns];(c.src===i||n.src)&&(c.src=b.call(t,"src"),c.src?M.call(t,A,c.src):T.call(t,A)),(c.srcset===i||n.srcset||!y.supSrcset||t.srcset)&&(r=b.call(t,"srcset"),c.srcset=r,s=!0),c.sets=[],l&&(c.pic=!0,u(e,c.sets)),c.srcset?(o={srcset:c.srcset,sizes:b.call(t,"sizes")},c.sets.push(o),a=(g||c.src)&&R.test(c.srcset||""),a||!c.src||h(c.src,o)||o.has1x||(o.srcset+=", "+c.src,o.cands.push({url:c.src,d:1,set:o}))):c.src&&c.sets.push({srcset:c.src,sizes:null}),c.curCan=null,c.curSrc=i,c.supported=!(l||o&&!y.supSrcset||a&&!y.supSizes),s&&y.supSrcset&&!c.supported&&(r?(M.call(t,P,r),t.srcset=""):T.call(t,P)),c.supported&&!c.srcset&&(!c.src&&t.src||t.src!==y.makeUrl(c.src))&&(null===c.src?t.removeAttribute("src"):t.src=c.src),c.parsed=!0},y.fillImg=function(t,e){var i,n=e.reselect||e.reevaluate;t[y.ns]||(t[y.ns]={}),i=t[y.ns],(n||i.evaled!==v)&&((!i.parsed||e.reevaluate)&&y.parseSets(t,t.parentNode,e),i.supported?i.evaled=v:s(t))},y.setupRun=function(){(!W||N||H!==t.devicePixelRatio)&&o()},y.supPicture?(ee=w,y.fillImg=w):!function(){var i,n=t.attachEvent?/d$|^c/:/d$|^c|^i/,r=function(){var t=e.readyState||"";o=setTimeout(r,"loading"===t?200:999),e.body&&(y.fillImgs(),i=i||n.test(t),i&&clearTimeout(o))},o=setTimeout(r,e.body?9:99),a=function(t,e){var i,n,r=function(){var o=new Date-n;e>o?i=setTimeout(r,e-o):(i=null,t())};return function(){n=new Date,i||(i=setTimeout(r,e))}},s=E.clientHeight,l=function(){N=Math.max(t.innerWidth||0,E.clientWidth)!==G.width||E.clientHeight!==s,s=E.clientHeight,N&&y.fillImgs()};Q(t,"resize",a(l,99)),Q(e,"readystatechange",r)}(),y.picturefill=ee,y.fillImgs=ee,y.teardownRun=w,ee._=y,t.picturefillCFG={pf:y,push:function(t){var e=t.shift();"function"==typeof y[e]?y[e].apply(y,t):(C[e]=t[0],W&&y.fillImgs({reselect:!0}))}};for(;z&&z.length;)t.picturefillCFG.push(z.shift());t.picturefill=ee,"object"==typeof module&&"object"==typeof module.exports?module.exports=ee:"function"==typeof define&&define.amd&&define("picturefill",function(){return ee}),y.supPicture||(S["image/webp"]=r("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document),function(t,e){var i=e(t,t.document);t.lazySizes=i,"object"==typeof module&&module.exports&&(module.exports=i)}(window,function(t,e){"use strict";if(e.getElementsByClassName){var i,n,r=e.documentElement,o=t.Date,a=t.HTMLPictureElement,s="addEventListener",l="getAttribute",c=t[s],h=t.setTimeout,u=t.requestAnimationFrame||h,d=t.requestIdleCallback,p=/^picture$/i,f=["load","error","lazyincluded","_lazyloaded"],m={},g=Array.prototype.forEach,v=function(t,e){return m[e]||(m[e]=new RegExp("(\\s|^)"+e+"(\\s|$)")),m[e].test(t[l]("class")||"")&&m[e]},y=function(t,e){v(t,e)||t.setAttribute("class",(t[l]("class")||"").trim()+" "+e)},_=function(t,e){var i;(i=v(t,e))&&t.setAttribute("class",(t[l]("class")||"").replace(i," "))},w=function(t,e,i){var n=i?s:"removeEventListener";i&&w(t,e),f.forEach(function(i){t[n](i,e)})},x=function(t,n,r,o,a){var s=e.createEvent("CustomEvent");return r||(r={}),r.instance=i,s.initCustomEvent(n,!o,!a,r),t.dispatchEvent(s),s},b=function(e,i){var r;!a&&(r=t.picturefill||n.pf)?r({reevaluate:!0,elements:[e]}):i&&i.src&&(e.src=i.src)},M=function(t,e){return(getComputedStyle(t,null)||{})[e]},T=function(t,e,i){for(i=i||t.offsetWidth;i<n.minSize&&e&&!t._lazysizesWidth;)i=e.offsetWidth,e=e.parentNode;return i},E=function(){var t,i,n=[],r=[],o=n,a=function(){var e=o;for(o=n.length?r:n,t=!0,i=!1;e.length;)e.shift()();t=!1},s=function(n,r){t&&!r?n.apply(this,arguments):(o.push(n),i||(i=!0,(e.hidden?h:u)(a)))};return s._lsFlush=a,s}(),S=function(t,e){return e?function(){E(t)}:function(){var e=this,i=arguments;E(function(){t.apply(e,i)})}},C=function(t){var e,i=0,n=125,r=666,a=r,s=function(){e=!1,i=o.now(),t()},l=d?function(){d(s,{timeout:a}),a!==r&&(a=r)}:S(function(){h(s)},!0);return function(t){var r;(t=t===!0)&&(a=44),e||(e=!0,r=n-(o.now()-i),0>r&&(r=0),t||9>r&&d?l():h(l,r))}},A=function(t){var e,i,n=99,r=function(){e=null,t()},a=function(){var t=o.now()-i;n>t?h(a,n-t):(d||r)(r)};return function(){i=o.now(),e||(e=h(a,n))}},P=function(){var a,u,d,f,m,T,P,k,I,R,D,z,O,F,N=/^img$/i,B=/^iframe$/i,U="onscroll"in t&&!/glebot/.test(navigator.userAgent),H=0,G=0,j=0,W=-1,Y=function(t){j--,t&&t.target&&w(t.target,Y),(!t||0>j||!t.target)&&(j=0)},V=function(t,i){var n,o=t,a="hidden"==M(e.body,"visibility")||"hidden"!=M(t,"visibility");for(k-=i,D+=i,I-=i,R+=i;a&&(o=o.offsetParent)&&o!=e.body&&o!=r;)a=(M(o,"opacity")||1)>0,a&&"visible"!=M(o,"overflow")&&(n=o.getBoundingClientRect(),a=R>n.left&&I<n.right&&D>n.top-1&&k<n.bottom+1);return a},X=function(){var t,o,s,c,h,d,p,m,g,v=i.elements;if((f=n.loadMode)&&8>j&&(t=v.length)){o=0,W++,null==O&&("expand"in n||(n.expand=r.clientHeight>500&&r.clientWidth>500?500:370),z=n.expand,O=z*n.expFactor),O>G&&1>j&&W>2&&f>2&&!e.hidden?(G=O,W=0):G=f>1&&W>1&&6>j?z:H;for(;t>o;o++)if(v[o]&&!v[o]._lazyRace)if(U)if((m=v[o][l]("data-expand"))&&(d=1*m)||(d=G),g!==d&&(T=innerWidth+d*F,P=innerHeight+d,p=-1*d,g=d),s=v[o].getBoundingClientRect(),(D=s.bottom)>=p&&(k=s.top)<=P&&(R=s.right)>=p*F&&(I=s.left)<=T&&(D||R||I||k)&&(n.loadHidden||"hidden"!=M(v[o],"visibility"))&&(u&&3>j&&!m&&(3>f||4>W)||V(v[o],d))){if(ee(v[o]),h=!0,j>9)break}else!h&&u&&!c&&4>j&&4>W&&f>2&&(a[0]||n.preloadAfterLoad)&&(a[0]||!m&&(D||R||I||k||"auto"!=v[o][l](n.sizesAttr)))&&(c=a[0]||v[o]);else ee(v[o]);c&&!h&&ee(c)}},q=C(X),$=function(t){y(t.target,n.loadedClass),_(t.target,n.loadingClass),w(t.target,Q),x(t.target,"lazyloaded")},Z=S($),Q=function(t){Z({target:t.target})},K=function(t,e){try{t.contentWindow.location.replace(e)}catch(i){t.src=e}},J=function(t){var e,i=t[l](n.srcsetAttr);(e=n.customMedia[t[l]("data-media")||t[l]("media")])&&t.setAttribute("media",e),i&&t.setAttribute("srcset",i)},te=S(function(t,e,i,r,o){var a,s,c,u,f,m;(f=x(t,"lazybeforeunveil",e)).defaultPrevented||(r&&(i?y(t,n.autosizesClass):t.setAttribute("sizes",r)),s=t[l](n.srcsetAttr),a=t[l](n.srcAttr),o&&(c=t.parentNode,u=c&&p.test(c.nodeName||"")),m=e.firesLoad||"src"in t&&(s||a||u),f={target:t},m&&(w(t,Y,!0),clearTimeout(d),d=h(Y,2500),y(t,n.loadingClass),w(t,Q,!0)),u&&g.call(c.getElementsByTagName("source"),J),s?t.setAttribute("srcset",s):a&&!u&&(B.test(t.nodeName)?K(t,a):t.src=a),o&&(s||u)&&b(t,{src:a})),t._lazyRace&&delete t._lazyRace,_(t,n.lazyClass),E(function(){(!m||t.complete&&t.naturalWidth>1)&&(m?Y(f):j--,$(f))},!0)}),ee=function(t){var e,i=N.test(t.nodeName),r=i&&(t[l](n.sizesAttr)||t[l]("sizes")),o="auto"==r;(!o&&u||!i||!t[l]("src")&&!t.srcset||t.complete||v(t,n.errorClass))&&(e=x(t,"lazyunveilread").detail,o&&L.updateElem(t,!0,t.offsetWidth),t._lazyRace=!0,j++,te(t,e,o,r,i))},ie=function(){if(!u){if(o.now()-m<999)return void h(ie,999);var t=A(function(){n.loadMode=3,q()});u=!0,n.loadMode=3,q(),c("scroll",function(){3==n.loadMode&&(n.loadMode=2),t()},!0)}};return{_:function(){m=o.now(),i.elements=e.getElementsByClassName(n.lazyClass),a=e.getElementsByClassName(n.lazyClass+" "+n.preloadClass),F=n.hFac,c("scroll",q,!0),c("resize",q,!0),t.MutationObserver?new MutationObserver(q).observe(r,{childList:!0,subtree:!0,attributes:!0}):(r[s]("DOMNodeInserted",q,!0),r[s]("DOMAttrModified",q,!0),setInterval(q,999)),c("hashchange",q,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(t){e[s](t,q,!0)}),/d$|^c/.test(e.readyState)?ie():(c("load",ie),e[s]("DOMContentLoaded",q),h(ie,2e4)),i.elements.length?(X(),E._lsFlush()):q()},checkElems:q,unveil:ee}}(),L=function(){var t,i=S(function(t,e,i,n){var r,o,a;if(t._lazysizesWidth=n,n+="px",t.setAttribute("sizes",n),p.test(e.nodeName||""))for(r=e.getElementsByTagName("source"),o=0,a=r.length;a>o;o++)r[o].setAttribute("sizes",n);i.detail.dataAttr||b(t,i.detail)}),r=function(t,e,n){var r,o=t.parentNode;o&&(n=T(t,o,n),r=x(t,"lazybeforesizes",{width:n,dataAttr:!!e}),r.defaultPrevented||(n=r.detail.width,n&&n!==t._lazysizesWidth&&i(t,o,r,n)))},o=function(){var e,i=t.length;if(i)for(e=0;i>e;e++)r(t[e])},a=A(o);return{_:function(){t=e.getElementsByClassName(n.autosizesClass),c("resize",a)},checkElems:a,updateElem:r}}(),k=function(){k.i||(k.i=!0,L._(),P._())};return function(){var e,i={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0};n=t.lazySizesConfig||t.lazysizesConfig||{};for(e in i)e in n||(n[e]=i[e]);t.lazySizesConfig=n,h(function(){n.init&&k()})}(),i={cfg:n,autoSizer:L,loader:P,init:k,uP:b,aC:y,rC:_,hC:v,fire:x,gW:T,rAF:E}}}),jQuery.fn.allLazyLoaded=function(t){if(this.length){var e="."+lazySizes.cfg.loadingClass,i="."+lazySizes.cfg.lazyClass,n=function(){return!("complete"in this)||this.complete};this.each(function(){var r=this,o=function(){$(i,r).length||$(e,r).not(n).length||(r.removeEventListener("load",a,!0),t&&t.call(r,r),$(r).trigger("containerlazyloaded"))},a=function(){requestAnimationFrame(o)};r.addEventListener("load",a,!0),a()})}return this},function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,o=Function.prototype,a=n.push,s=n.slice,l=n.concat,c=r.toString,h=r.hasOwnProperty,u=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,y=n.indexOf,_=n.lastIndexOf,w=Array.isArray,x=Object.keys,b=o.bind,M=function(t){return t instanceof M?t:this instanceof M?void(this._wrapped=t):new M(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=M),exports._=M):t._=M,M.VERSION="1.4.4";var T=M.each=M.forEach=function(t,e,n){if(null!=t)if(u&&t.forEach===u)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var a in t)if(M.has(t,a)&&e.call(n,t[a],a,t)===i)return};M.map=M.collect=function(t,e,i){var n=[];return null==t?n:d&&t.map===d?t.map(e,i):(T(t,function(t,r,o){n[n.length]=e.call(i,t,r,o)}),n)};var E="Reduce of empty array with no initial value";M.reduce=M.foldl=M.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return n&&(e=M.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(T(t,function(t,o,a){r?i=e.call(n,i,t,o,a):(i=t,r=!0)}),!r)throw new TypeError(E);return i},M.reduceRight=M.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=M.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var o=t.length;if(o!==+o){var a=M.keys(t);o=a.length}if(T(t,function(s,l,c){l=a?a[--o]:--o,r?i=e.call(n,i,t[l],l,c):(i=t[l],r=!0)}),!r)throw new TypeError(E);return i},M.find=M.detect=function(t,e,i){var n;return S(t,function(t,r,o){return e.call(i,t,r,o)?(n=t,!0):void 0}),n},M.filter=M.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(T(t,function(t,r,o){e.call(i,t,r,o)&&(n[n.length]=t)}),n)},M.reject=function(t,e,i){return M.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},M.every=M.all=function(t,e,n){e||(e=M.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(e,n):(T(t,function(t,o,a){return(r=r&&e.call(n,t,o,a))?void 0:i}),!!r)};var S=M.some=M.any=function(t,e,n){e||(e=M.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,n):(T(t,function(t,o,a){return r||(r=e.call(n,t,o,a))?i:void 0}),!!r)};M.contains=M.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):S(t,function(t){return t===e})},M.invoke=function(t,e){var i=s.call(arguments,2),n=M.isFunction(e);return M.map(t,function(t){return(n?e:t[e]).apply(t,i)})},M.pluck=function(t,e){return M.map(t,function(t){return t[e]})},M.where=function(t,e,i){return M.isEmpty(e)?i?null:[]:M[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},M.findWhere=function(t,e){return M.where(t,e,!0)},M.max=function(t,e,i){if(!e&&M.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&M.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return T(t,function(t,r,o){var a=e?e.call(i,t,r,o):t;a>=n.computed&&(n={value:t,computed:a})}),n.value},M.min=function(t,e,i){if(!e&&M.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&M.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return T(t,function(t,r,o){var a=e?e.call(i,t,r,o):t;a<n.computed&&(n={value:t,computed:a})}),n.value},M.shuffle=function(t){var e,i=0,n=[];return T(t,function(t){e=M.random(i++),n[i-1]=n[e],n[e]=t}),n};var C=function(t){return M.isFunction(t)?t:function(e){return e[t]}};M.sortBy=function(t,e,i){var n=C(e);return M.pluck(M.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index<e.index?-1:1}),"value")};var A=function(t,e,i,n){var r={},o=C(e||M.identity);return T(t,function(e,a){var s=o.call(i,e,a,t);n(r,s,e)}),r};M.groupBy=function(t,e,i){return A(t,e,i,function(t,e,i){(M.has(t,e)?t[e]:t[e]=[]).push(i)})},M.countBy=function(t,e,i){return A(t,e,i,function(t,e){M.has(t,e)||(t[e]=0),t[e]++})},M.sortedIndex=function(t,e,i,n){i=null==i?M.identity:C(i);for(var r=i.call(n,e),o=0,a=t.length;a>o;){var s=o+a>>>1;i.call(n,t[s])<r?o=s+1:a=s}return o},M.toArray=function(t){return t?M.isArray(t)?s.call(t):t.length===+t.length?M.map(t,M.identity):M.values(t):[]},M.size=function(t){return null==t?0:t.length===+t.length?t.length:M.keys(t).length},M.first=M.head=M.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:s.call(t,0,e)},M.initial=function(t,e,i){return s.call(t,0,t.length-(null==e||i?1:e))},M.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},M.rest=M.tail=M.drop=function(t,e,i){return s.call(t,null==e||i?1:e)},M.compact=function(t){return M.filter(t,M.identity)};var P=function(t,e,i){return T(t,function(t){M.isArray(t)?e?a.apply(i,t):P(t,e,i):i.push(t)}),i};M.flatten=function(t,e){return P(t,e,[])},M.without=function(t){return M.difference(t,s.call(arguments,1))},M.uniq=M.unique=function(t,e,i,n){M.isFunction(e)&&(n=i,i=e,e=!1);var r=i?M.map(t,i,n):t,o=[],a=[];return T(r,function(i,n){(e?n&&a[a.length-1]===i:M.contains(a,i))||(a.push(i),o.push(t[n]))}),o},M.union=function(){return M.uniq(l.apply(n,arguments))},M.intersection=function(t){var e=s.call(arguments,1);return M.filter(M.uniq(t),function(t){return M.every(e,function(e){return M.indexOf(e,t)>=0})})},M.difference=function(t){var e=l.apply(n,s.call(arguments,1));return M.filter(t,function(t){return!M.contains(e,t)})},M.zip=function(){for(var t=s.call(arguments),e=M.max(M.pluck(t,"length")),i=new Array(e),n=0;e>n;n++)i[n]=M.pluck(t,""+n);return i},M.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},M.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=M.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},M.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(_&&t.lastIndexOf===_)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},M.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,o=new Array(n);n>r;)o[r++]=t,t+=i;return o},M.bind=function(t,e){if(t.bind===b&&b)return b.apply(t,s.call(arguments,1));var i=s.call(arguments,2);return function(){return t.apply(e,i.concat(s.call(arguments)))}},M.partial=function(t){var e=s.call(arguments,1);return function(){return t.apply(this,e.concat(s.call(arguments)))}},M.bindAll=function(t){var e=s.call(arguments,1);return 0===e.length&&(e=M.functions(t)),T(e,function(e){t[e]=M.bind(t[e],t)}),t},M.memoize=function(t,e){var i={};return e||(e=M.identity),function(){var n=e.apply(this,arguments);return M.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},M.delay=function(t,e){var i=s.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},M.defer=function(t){return M.delay.apply(M,[t,1].concat(s.call(arguments,1)))},M.throttle=function(t,e){var i,n,r,o,a=0,s=function(){a=new Date,r=null,o=t.apply(i,n)};return function(){var l=new Date,c=e-(l-a);return i=this,n=arguments,0>=c?(clearTimeout(r),r=null,a=l,o=t.apply(i,n)):r||(r=setTimeout(s,c)),o}},M.debounce=function(t,e,i){var n,r;return function(){var o=this,a=arguments,s=function(){n=null,i||(r=t.apply(o,a))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,e),l&&(r=t.apply(o,a)),r}},M.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},M.wrap=function(t,e){return function(){var i=[t];return a.apply(i,arguments),e.apply(this,i)}},M.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},M.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},M.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)M.has(t,i)&&(e[e.length]=i);return e},M.values=function(t){var e=[];for(var i in t)M.has(t,i)&&e.push(t[i]);return e},M.pairs=function(t){var e=[];for(var i in t)M.has(t,i)&&e.push([i,t[i]]);return e},M.invert=function(t){var e={};for(var i in t)M.has(t,i)&&(e[t[i]]=i);return e},M.functions=M.methods=function(t){var e=[];for(var i in t)M.isFunction(t[i])&&e.push(i);return e.sort()},M.extend=function(t){return T(s.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},M.pick=function(t){var e={},i=l.apply(n,s.call(arguments,1));return T(i,function(i){i in t&&(e[i]=t[i])}),e},M.omit=function(t){var e={},i=l.apply(n,s.call(arguments,1));for(var r in t)M.contains(i,r)||(e[r]=t[r]);return e},M.defaults=function(t){return T(s.call(arguments,1),function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])}),t},M.clone=function(t){return M.isObject(t)?M.isArray(t)?t.slice():M.extend({},t):t},M.tap=function(t,e){return e(t),t};var L=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof M&&(t=t._wrapped),e instanceof M&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=i.length;o--;)if(i[o]==t)return n[o]==e;i.push(t),n.push(e);var a=0,s=!0;if("[object Array]"==r){if(a=t.length,s=a==e.length)for(;a--&&(s=L(t[a],e[a],i,n)););}else{var l=t.constructor,h=e.constructor;if(l!==h&&!(M.isFunction(l)&&l instanceof l&&M.isFunction(h)&&h instanceof h))return!1;for(var u in t)if(M.has(t,u)&&(a++,!(s=M.has(e,u)&&L(t[u],e[u],i,n))))break;if(s){for(u in e)if(M.has(e,u)&&!a--)break;s=!a}}return i.pop(),n.pop(),s};M.isEqual=function(t,e){return L(t,e,[],[])},M.isEmpty=function(t){if(null==t)return!0;if(M.isArray(t)||M.isString(t))return 0===t.length;for(var e in t)if(M.has(t,e))return!1;return!0},M.isElement=function(t){return!(!t||1!==t.nodeType)},M.isArray=w||function(t){return"[object Array]"==c.call(t)},M.isObject=function(t){return t===Object(t)},T(["Arguments","Function","String","Number","Date","RegExp"],function(t){M["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),M.isArguments(arguments)||(M.isArguments=function(t){return!(!t||!M.has(t,"callee"))}),"function"!=typeof/./&&(M.isFunction=function(t){return"function"==typeof t}),M.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},M.isNaN=function(t){return M.isNumber(t)&&t!=+t},M.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},M.isNull=function(t){return null===t},M.isUndefined=function(t){return void 0===t},M.has=function(t,e){return h.call(t,e)},M.noConflict=function(){return t._=e,this},M.identity=function(t){return t},M.times=function(t,e,i){for(var n=Array(t),r=0;t>r;r++)n[r]=e.call(i,r);return n},M.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var k={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};k.unescape=M.invert(k.escape);var I={escape:new RegExp("["+M.keys(k.escape).join("")+"]","g"),unescape:new RegExp("("+M.keys(k.unescape).join("|")+")","g")};M.each(["escape","unescape"],function(t){M[t]=function(e){return null==e?"":(""+e).replace(I[t],function(e){return k[t][e]})}}),M.result=function(t,e){if(null==t)return null;var i=t[e];return M.isFunction(i)?i.call(t):i},M.mixin=function(t){T(M.functions(t),function(e){var i=M[e]=t[e];M.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),F.call(this,i.apply(M,t))}})};var R=0;M.uniqueId=function(t){var e=++R+"";return t?t+e:e},M.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\t|\u2028|\u2029/g;M.template=function(t,e,i){var n;i=M.defaults({},i,M.templateSettings);var r=new RegExp([(i.escape||D).source,(i.interpolate||D).source,(i.evaluate||D).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,function(e,i,n,r,s){return a+=t.slice(o,s).replace(O,function(t){return"\\"+z[t]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),o=s+e.length,e}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(e)return n(e,M);var l=function(t){return n.call(this,t,M)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},M.chain=function(t){return M(t).chain()};var F=function(t){return this._chain?M(t).chain():t};M.mixin(M),T(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];M.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],F.call(this,i)}}),T(["concat","join","slice"],function(t){var e=n[t];M.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),M.extend(M.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(t,e,i){_.mixin({trim:function(t){return t.replace(/^\s+|\s+$/g,"")},curry:function(t){var e=Array.prototype.slice,i=e.call(arguments,1);return function(){var n=e.call(arguments);return t.apply(this,i.concat(n))}}}),t.Prototype={extend:function(t,e){function i(){}var n=e.prototype;i.prototype=n,t.prototype=new i,t.prototype.constructor=t,t.prototype._super=e;var r=function(){var t=n.constructor;this.sup=n.sup,t.apply(this,[].slice.call(arguments)),this.sup||(this["super"]=r)};t.prototype.sup=r;var o=function(t){if(this.__last_super_method__&&this.__last_super_method__==t){var e;return this.super_method=n.super_method,this.super_method||(this.super_method=o),e=n[t].apply(this,[].slice.call(arguments,1))}return this.__last_super_method__=t,this.super_method=o,this.super_method.apply(this,[].slice.apply(arguments))};return t.prototype.super_method=o,t},mixin:function(t){for(var e,i=[].slice.call(arguments,1);e=i.shift();)_.extend(t.prototype,e.prototype||e)}},t.Plugin={},Plugin.define=function(t,e,n){n||(n=t),i.fn[t]=function(t){return this.each(function(){var r=i(this);r.data(n)||r.data(n,new e(r,t))})}},t.EventDispatcher=function(t){t&&(this.dispatcher=t instanceof jQuery?t:i(t))},i.extend(EventDispatcher.prototype,{_dispatcher:function(){return this.dispatcher?this.dispatcher:this.dispatcher=this.element||i(this)},on:function(){var t=this._dispatcher();return t.on.apply(t,[].slice.apply(arguments)),this},off:function(){var t=this._dispatcher();return t.off.apply(t,[].slice.apply(arguments)),this},trigger:function(){var t=this._dispatcher();return t.trigger.apply(t,[].slice.apply(arguments)),this}}),t.App=function(){_.bindAll(this,"_ready_callback"),this.fn={},this.dom={},this.utils={},this.data={},this._dom={},this._callbacks={preinitialize:i.noop,ready:i.noop,load:i.noop},this._plugins=[],this._events=[]
},_.extend(App.prototype,{_compose_callbacks:function(t,e){this._callbacks[t]=_.compose(e,this._callbacks[t])},_execute_callbacks:function(t){this._callbacks[t].apply(this)},_fetch_dom_elements:function(){_(this._dom).each(_.bind(function(t,e){var n=i(t);this.dom[e]=n.length?n:null},this))},_init_plugins:function(){_(this._plugins).each(function(t){_(t).each(function(t,e){var n,r,o,a;_(t).isString()?(n=t,r=e):(o=t,e=e.split("|"),n=_(e[1]).trim(),r=_(e[0]).trim()),a=i(r),"function"==typeof o?a.each(function(){var t=i(this);t[n](o.call(t,t,n,r))}):0!=a.length&&a[n](o)})})},_init_events:function(){_(this._events).each(function(n){_(n).each(function(n,r){var r=r.split("|"),o=_(r[0]).trim(),a=_(r[1]).trim();"window"==o?o=t:"document"==o&&(o=e),i(o).on(a,n)})})},_ready_callback:function(){this._fetch_dom_elements(),this._init_plugins(),this._execute_callbacks("ready"),this._init_events()},fetch:function(t){this._dom=_.extend(this._dom,t)},preinitialize:function(t){return this._compose_callbacks("preinitialize",t),this},ready:function(t){return this._compose_callbacks("ready",t),this},load:function(t){return this._compose_callbacks("load",t),this},plugins:function(t){return this._plugins.push(t),this},events:function(t){return this._events.push(t),this},init:function(){return this._execute_callbacks("preinitialize"),t.isLoaded?this._ready_callback():i(this._ready_callback)},ns:function(t,e){var i=this;"function"==typeof t?(e=t,t=""):_.each(t.split("."),_.bind(function(t){var e=i[t];i=e?e:i[t]={}},this)),e.call(this,i)}});var n=t.CollectionIterator=function(t,e){this.collection=t,this.index="undefined"==typeof e?0:e};_.extend(n.prototype,{set_collection:function(t){this.collection=t,this.index="undefined"==typeof index?0:index},each:function(t){_(this.collection).each(t)}})}(window,document,jQuery),window.AutoComplete=function(){var t=function(){};return $.extend(t,{me:function(e){return e.data("autocomplete-me")||(instance=new t(e),e.data("autocomplete-me")),e.data("autocomplete-me")}}),t}();var Browser=function(t,e){return e._browser=$.browser||function(){var t,e,i;return i=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},t=i(navigator.userAgent),e={},t.browser&&(e[t.browser]=!0,e.version=t.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),e}(),e.not_msie=function(){return!e._browser.msie},e.is_msie=function(t){var e="return !!Browser._browser.msie";return t&&(e+=" && parseFloat(Browser._browser.version) "+t),new Function("obj",e)()},e.supports_animation=function(){var t=e.not_msie()||e.is_msie(">= 9");return e.supports_animation=function(){return t},t},e}(window,{});window.TCE||(window.TCE={}),TCE.ClickTrap=function(){var t=function(){},e=function(i){if(!(i instanceof t))throw"Trying to instance ClickTrap without a ClickTrapSingletonEnforcer, please instance ClickTrap with ClickTrap.instance()";if(e._instance)throw"There's already a ClickTrap instance, please access it with ClickTrap.instance()"},i=function(t,e){_.bindAll(this,"on_catch"),t instanceof jQuery||(t=$(t)),this.click_zone=t,this.one_use_trap=e,this.allowed=[],this.denied=[],this.id=_.uniqueId("click_trap"),this.armed=!1};return Prototype.extend(i,EventDispatcher),e.instance=function(){return e._instance||(e._instance=new e(new t)),e._instance},e.Trap=i,_.extend(e.prototype,{trap_type:i,trap:function(t,e){return t||(t="html"),new this.trap_type(t,!!e)}}),_.extend(i.prototype,{allow:function(){var t=[].slice.apply(arguments);return this.allowed=_.uniq(this.allowed.concat(t)),this},deny:function(){var t=[].slice.apply(arguments);return this.denied=_.uniq(this.denied.concat(t)),this},arm:function(){if(!this.armed){var t="."+this.id+"_down";this.click_zone.off(t).on("click."+t+" tap."+t,this.on_catch),this.armed=!0,this.trigger($.Event("armed"))}},disarm:function(){if(this.armed){var t="."+this.id+"_down";this.click_zone.off(t),this.armed=!1,this.trigger($.Event("disarmed"))}},on_catch:function(t){var e=!0,i=$(t.target),n=this.allowed.join(",");i.closest(n).length||i.is(n)||(e=!1),e&&(n=this.denied.join(","),n.match(/\S/)&&(i.closest(n).length||i.is(n))&&(e=!1)),e||(t.preventDefault(),t.stopImmediatePropagation(),this.trigger($.Event("click_caught",{target:t.target})),this.one_use_trap&&this.disarm())}}),e}(),function(t,e,i,n){function r(e,i){this.element=e,this.options=t.extend(!0,{},s,i),this.options.events.length&&(this.options.events=this.addMomentObjectToEvents(this.options.events)),this.month=this.options.startWithMonth?moment(this.options.startWithMonth):moment(),this._defaults=s,this._name=a,this.init()}var o="<div class='clndr-controls'><div class='clndr-control-button'><span class='clndr-previous-button'>previous</span></div><div class='month'><%= month %> <%= year %></div><div class='clndr-control-button rightalign'><span class='clndr-next-button'>next</span></div></div><table class='clndr-table' border='0' cellspacing='0' cellpadding='0'><thead><tr class='header-days'><% for(var i = 0; i < daysOfTheWeek.length; i++) { %><td class='header-day'><%= daysOfTheWeek[i] %></td><% } %></tr></thead><tbody><% for(var i = 0; i < numberOfRows; i++){ %><tr><% for(var j = 0; j < 7; j++){ %><% var d = j + i * 7; %><td class='<%= days[d].classes %>'><div class='day-contents'><%= days[d].day %></div></td><% } %></tr><% } %></tbody></table>",a="clndr",s={template:o,weekOffset:0,startWithMonth:null,clickEvents:{click:null,nextMonth:null,previousMonth:null,nextYear:null,previousYear:null,today:null,onMonthChange:null,onYearChange:null},targets:{nextButton:"clndr-next-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button",todayButton:"clndr-today-button",day:"day",empty:"empty"},events:[],extras:null,dateParameter:"date",doneRendering:null,render:null,daysOfTheWeek:null,showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:null};r.prototype.init=function(){if(this.daysOfTheWeek=this.options.daysOfTheWeek||[],!this.options.daysOfTheWeek){this.daysOfTheWeek=[];for(var e=0;7>e;e++)this.daysOfTheWeek.push(moment().weekday(e).format("dd").charAt(0))}if(this.options.weekOffset&&(this.daysOfTheWeek=this.shiftWeekdayLabels(this.options.weekOffset)),!t.isFunction(this.options.render)){if(this.options.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this.compiledClndrTemplate=_.template(this.options.template)}t(this.element).html("<div class='clndr'></div>"),this.calendarContainer=t(".clndr",this.element),this.bindEvents(),this.render(),this.options.ready&&this.options.ready.apply(this,[])},r.prototype.shiftWeekdayLabels=function(t){for(var e=this.daysOfTheWeek,i=0;t>i;i++)e.push(e.shift());return e},r.prototype.createDaysObject=function(e){daysArray=[];var i=e.startOf("month");if(this.eventsLastMonth=[],this.eventsThisMonth=[],this.eventsNextMonth=[],this.options.events.length&&(this.eventsThisMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==e.format("YYYY-MM")}),this.options.showAdjacentMonths)){var n=e.clone().subtract("months",1),r=e.clone().add("months",1);this.eventsLastMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==n.format("YYYY-MM")}),this.eventsNextMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==r.format("YYYY-MM")})}var o=i.weekday()-this.options.weekOffset;if(0>o&&(o+=7),this.options.showAdjacentMonths)for(var a=0;o>a;a++){var s=moment([e.year(),e.month(),a-o+1]);daysArray.push(this.createDayObject(s,this.eventsLastMonth))}else for(var a=0;o>a;a++)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" last-month"}));for(var l=i.daysInMonth(),a=1;l>=a;a++){var s=moment([e.year(),e.month(),a]);daysArray.push(this.createDayObject(s,this.eventsThisMonth))}if(this.options.showAdjacentMonths)for(a=1;daysArray.length%7!==0;){var s=moment([e.year(),e.month(),l+a]);daysArray.push(this.createDayObject(s,this.eventsNextMonth)),a++}else for(a=1;daysArray.length%7!==0;)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"})),a++;return daysArray},r.prototype.createDayObject=function(t,e){var i=[],r=moment(),o=0,a=e.length;for(o;a>o;o++)e[o]._clndrDateObject.date()==t.date()&&i.push(e[o]);var s="";return r.format("YYYY-MM-DD")==t.format("YYYY-MM-DD")&&(s+=" today"),t.isBefore(r,"day")&&(s+=" past"),i.length&&(s+=" event"),this.month.month()>t.month()?(s+=" adjacent-month",s+=this.month.year()===t.year()?" last-month":" next-month"):this.month.month()<t.month()&&(s+=" adjacent-month",s+=this.month.year()===t.year()?" next-month":" last-month"),!t.isValid()&&t.hasOwnProperty("_d")&&t._d!=n&&(t=moment(t._d)),s+=" calendar-day-"+t.format("YYYY-MM-DD"),this.calendarDay({day:t.date(),classes:this.options.targets.day+s,id:"calendar-day-"+t.format("YYYY-MM-DD"),events:i,date:t})},r.prototype.render=function(){this.calendarContainer.children().remove();var t=this.createDaysObject(this.month),e=(this.month,{daysOfTheWeek:this.daysOfTheWeek,numberOfRows:Math.ceil(t.length/7),days:t,month:this.month.format("MMMM"),year:this.month.year(),eventsThisMonth:this.eventsThisMonth,extras:this.options.extras});this.calendarContainer.html(this.options.render?this.options.render.apply(this,[e]):this.compiledClndrTemplate(e)),this.options.doneRendering&&this.options.doneRendering.apply(this,[])},r.prototype.bindEvents=function(){var e=t(this.element),i=this;e.on("click","."+this.options.targets.day,function(e){if(i.options.clickEvents.click){var n=i.buildTargetObject(e.currentTarget,!0);i.options.clickEvents.click.apply(i,[n])}i.options.adjacentDaysChangeMonth&&(t(e.currentTarget).is(".last-month")?i.backActionWithContext(i):t(e.currentTarget).is(".next-month")&&i.forwardActionWithContext(i))}),e.on("click","."+this.options.targets.empty,function(e){if(i.options.clickEvents.click){var n=i.buildTargetObject(e.currentTarget,!1);i.options.clickEvents.click.apply(i,[n])}i.options.adjacentDaysChangeMonth&&(t(e.currentTarget).is(".last-month")?i.backActionWithContext(i):t(e.currentTarget).is(".next-month")&&i.forwardActionWithContext(i))}),e.on("click","."+this.options.targets.previousButton,{context:this},this.backAction).on("click","."+this.options.targets.nextButton,{context:this},this.forwardAction).on("click","."+this.options.targets.todayButton,{context:this},this.todayAction).on("click","."+this.options.targets.nextYearButton,{context:this},this.nextYearAction).on("click","."+this.options.targets.previousYearButton,{context:this},this.previousYearAction)},r.prototype.buildTargetObject=function(e,i){var n={element:e,events:[],date:null};if(i){var r,o=e.className.indexOf("calendar-day-");r=0!==o?e.className.substring(o+13,o+23):e.id.replace("calendar-day-",""),n.date=moment(r),this.options.events&&(n.events=t.makeArray(t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM-DD")==r})))}return n},r.prototype.forwardAction=function(t){var e=t.data.context;e.forwardActionWithContext(e)},r.prototype.backAction=function(t){var e=t.data.context;e.backActionWithContext(e)},r.prototype.backActionWithContext=function(t){var e=!t.month.isSame(moment(),"year");t.month.subtract("months",1),t.options.clickEvents.previousMonth&&t.options.clickEvents.previousMonth.apply(t,[moment(t.month)]),t.options.clickEvents.onMonthChange&&t.options.clickEvents.onMonthChange.apply(t,[moment(t.month)]),e&&t.options.clickEvents.onYearChange&&t.options.clickEvents.onYearChange.apply(t,[moment(t.month)]),t.render()},r.prototype.forwardActionWithContext=function(t){var e=!t.month.isSame(moment(),"year");t.month.add("months",1),t.options.clickEvents.nextMonth&&t.options.clickEvents.nextMonth.apply(t,[t.month]),t.options.clickEvents.onMonthChange&&t.options.clickEvents.onMonthChange.apply(t,[t.month]),e&&t.options.clickEvents.onYearChange&&t.options.clickEvents.onYearChange.apply(t,[moment(t.month)]),t.render()},r.prototype.todayAction=function(t){var e=t.data.context,i=!e.month.isSame(moment(),"month"),n=!e.month.isSame(moment(),"year");e.options.clickEvents.today&&e.options.clickEvents.today.apply(e,[moment(e.month)]),i&&(e.month=moment(),e.options.clickEvents.onMonthChange&&e.options.clickEvents.onMonthChange.apply(e,[moment(e.month)]),n&&e.options.clickEvents.onYearChange&&e.options.clickEvents.onYearChange.apply(e,[moment(e.month)]),e.render())},r.prototype.nextYearAction=function(t){var e=t.data.context;e.month.add("years",1),e.options.clickEvents.nextYear&&e.options.clickEvents.nextYear.apply(e,[moment(e.month)]),e.options.clickEvents.onMonthChange&&e.options.clickEvents.onMonthChange.apply(e,[moment(e.month)]),e.options.clickEvents.onYearChange&&e.options.clickEvents.onYearChange.apply(e,[moment(e.month)]),e.render()},r.prototype.previousYearAction=function(t){var e=t.data.context;e.month.subtract("years",1),e.options.clickEvents.previousYear&&e.options.clickEvents.previousYear.apply(e,[moment(e.month)]),e.options.clickEvents.onMonthChange&&e.options.clickEvents.onMonthChange.apply(e,[moment(e.month)]),e.options.clickEvents.onYearChange&&e.options.clickEvents.onYearChange.apply(e,[moment(e.month)]),e.render()},r.prototype.forward=function(){return this.month.add("months",1),this.render(),this},r.prototype.back=function(){return this.month.subtract("months",1),this.render(),this},r.prototype.next=function(){return this.forward(),this},r.prototype.previous=function(){return this.back(),this},r.prototype.setMonth=function(t){return this.month.month(t),this.render(),this},r.prototype.setYear=function(t){return this.month.year(t),this.render(),this},r.prototype.nextYear=function(){return this.month.add("year",1),this.render(),this},r.prototype.previousYear=function(){return this.month.subtract("year",1),this.render(),this},r.prototype.setYear=function(t){return this.month.year(t),this.render(),this},r.prototype.setEvents=function(t){return this.options.events=this.addMomentObjectToEvents(t),this.render(),this},r.prototype.addEvents=function(e){return this.options.events=t.merge(this.options.events,this.addMomentObjectToEvents(e)),this.render(),this},r.prototype.addMomentObjectToEvents=function(t){var e=this,i=0,n=t.length;for(i;n>i;i++)t[i]._clndrDateObject=moment(t[i][e.options.dateParameter]);return t},r.prototype.calendarDay=function(e){var i={day:"",classes:this.options.targets.empty,events:[],id:"",date:null};return t.extend({},i,e)},t.fn.clndr=function(e){if(!t.data(this,"plugin_clndr")){var i=new r(this,e);return t.data(this,"plugin_clndr",i),i}}}(jQuery,window,document),function(t){function e(t,e){return e=parseFloat(t.css(e)),isNaN(e)?0:e}function i(t){this.identifier=t}function n(t){this.constructor.call(this,t)}function r(t){this.constructor.call(this,t)}function o(t){this.constructor.call(this,t)}function a(t){this.constructor.call(this,t)}function s(){this.init=function(e,i){var n=this,i=t.extend({file_button:"Choose file",file_label:"No file chosen",responsive_select:!1,responsive_file:!1},i||{});return e=e.each(function(){return"SELECT"==this.nodeName&&this.size>0||this.$$custom_form_identifier?!0:void(this.$$custom_form_identifier=n.new_element(this).init(i).identifier)})},this.execute=function(t,e){var i=e[0],n=Array.prototype.slice.call(e,1);return i in c?c[i].apply(t,n):t.each(function(){if(this.$$custom_form_identifier){var t=l[this.$$custom_form_identifier].instance;t[i].apply(t,n)}})},this.new_element=function(e,n){var r=t(e),o=i.build(r,n),a=o.get_id();return this.register_instance(a,o,r),o},this.register_instance=function(t,e,i){l[t]={element:i,instance:e,children:{}}},this.unregister_instance=function(t){var e=t.get_id();t=t.kill(),delete l[e]}}var l={fn:{}},c={disabled:function(t){if(void 0!=t||(t="all"),1==this.length)return l[this[0].$$custom_form_identifier].instance.disabled(t);var e="any"==t?!1:!0;return this.each(function(){var i=l[this.$$custom_form_identifier].instance.disabled(t);switch(t){case"all":if(e&&!i)return e=!1,!1;break;case"any":if(i)return e=!0,!1;break;case"none":if(!i)return e=!1,!1}}),e}};l._browser=t.browser||function(){var t,e,i;return i=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},t=i(navigator.userAgent),e={},t.browser&&(e[t.browser]=!0,e.version=t.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),e}(),i.total_instances=0,i.browser_string=function(){var t,e,i,n=l._browser;for(t in n)"version"==t?e=parseInt(n.version):i=t;return i+" "+i+e+(n.msie?"":" not_msie")}(),i.build=function(t){var e,n;if(e=t.is("select")?"select":"input_"+t.attr("type"),!(n=this.available_classes[e]))throw"No class available to build element of type "+e;return new n(e+"_"+i.total_instances++)},i.available_classes={},i.register_class=function(t,e){this.available_classes[t]=e};var h=i.prototype;t.extend(h,{is_disabled:!1,get_element:function(){return l[this.identifier].element},get:function(t){return l[this.identifier].children[t]},set:function(t,e){return l[this.identifier].children[e]=t,t},get_id:function(){return this.identifier},kill:function(){return this.identifier},active_replacement_class:function(t){this.replacement[t?"addClass":"removeClass"]("checked_"+this.element_type)},init:function(t){var e,n=this.get_element(),r=n.attr("id");return this.set_parameters(n,t),e=this.set_replacement(n),e.addClass(i.browser_string),r.match(/\S/)&&e.addClass("custom-form_"+r),this.replace_elements(n,e),this.init_replacement(n,e),this.disable_if_disabled(n),this.init_mouse_events(n,e),this},set_replacement:function(t){return this.set(this.get_replacement(t),"replacement")},init_mouse_events:function(t,e){var i,n=this.mouse_trigger();n.bind("mouseenter",this,this.hover_handler).bind("mouseleave",this,this.out_handler).bind("mouseup",this,this.mouse_up_handler).bind("mousedown",this,this.mouse_down_handler),i=e.parent("label"),0==i.length&&n.bind("click",this,this.click_handler),t.bind("focusin",this,this.focus_in).bind("focusout",this,this.focus_out).bind("change",this,this.change)},focus_in:function(t){t.data.focus(!0)},focus_out:function(t){t.data.focus(!1)},focus:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("focus_"+this.element_type)},change:function(){},label_handler:function(t){t.target==this&&(t.preventDefault(),t.data.get_element().triggerHandler("change"))},hover_handler:function(t){t.data.hover(!0)},out_handler:function(t){t.data.hover(!1)},mouse_up_handler:function(t){t.data.mouse_in(!1)},mouse_down_handler:function(t){t.data.mouse_in(!0)},hover:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("hover_"+this.element_type)},mouse_in:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("active_"+this.element_type)},disabled:function(t,e,i){var i,e=e||this.get_element();switch(t){case!0:case!1:return i=i||this.get("replacement"),e.attr("disabled",t),i[t?"addClass":"removeClass"]("disabled_"+this.element_type),this.is_disabled=t,t;case"none":return!e.is(":disabled");default:return e.is(":disabled")}},disable_if_disabled:function(t){this.is_disabled!=t.is(":disabled")&&this.disabled(!this.is_disabled,t)}}),n.IDENTIFIER="input_checkbox";var u=n.prototype=new i;u.constructor=i.prototype.constructor,t.extend(u,{element_type:"checkbox",uncheckeable:!1,set_parameters:function(t){this.element_id=t.attr("id"),this.element_name=t.attr("name")},get_replacement:function(){return t("<span class='"+this.element_type+"'></span>")},replace_elements:function(t,e){t.after(e),e.append(t)},init_replacement:function(t,e){var i,n;(i=t.is(":checked"))&&this.checked(!0,t,e),(n=t.is(":disabled"))&&this.disabled(!0,t,e),(i||n)&&this.update(t,e)},checked:function(t,e,i){e=e||this.get_element(),i=i||this.get("replacement"),t=void 0==t?!e.is(":checked"):t,(!this.uncheckeable||this.uncheckeable&&t)&&(e.prop("checked",t),e.trigger("change"))},mouse_trigger:function(){return this.get("replacement")},click_handler:function(t){if(!t.data.is_disabled){var e=t.data;e.get_element().focus().triggerHandler("click"),t.target==this&&e.checked()}},change:function(e){e.data.update(t(this))},update:function(t,e){var t=t||this.get_element(),i="checked_"+this.element_type,n=t.is(":checked"),e=e||this.get("replacement");this.disable_if_disabled(t),n&&!e.hasClass(i)?e.addClass(i):!n&&e.hasClass(i)&&e.removeClass(i)}}),i.register_class(n.IDENTIFIER,n),r.IDENTIFIER="input_radio";var d=r.prototype=new n;d.constructor=i.prototype.constructor,t.extend(d,{uncheckeable:!0,element_type:"radio",update:function(e,i){var e=e||this.get_element(),n="checked_"+this.element_type,r=e.is(":checked"),i=i||this.get("replacement");if(this.disable_if_disabled(e),r){var o=t("."+n).has("[name='"+this.element_name+"']").not(this.element_id);0!=o.length&&o.removeClass(n),i.addClass(n)}}}),i.register_class(r.IDENTIFIER,r),i.element_border_width=function(t){return parseInt(t.css("border-left-width"))-parseInt(t.css("border-right-width"))},o.IDENTIFIER="select";var p=o.prototype=new i;p.constructor=i.prototype.constructor,t.extend(p,{button_width:0,click_handler:t.noop,element_type:"select",redraw:function(){var i=this.get_element();i.removeAttr("style"),this.element_width=i.outerWidth();var n=this.get("replacement"),r=n.find(".select_content"),o=this.set(t(".select_label",n),"select_label"),a={width:this.element_width-e(n,"border-left-width")-e(n,"border-right-width")};i.css(a),n.css(a);var s=t(".select_button",n);o.css({width:a.width-s.outerWidth()-e(r,"border-left-width")-e(r,"border-right-width")-e(o,"border-right-width")-e(o,"border-left-width")})},set_parameters:function(t,e){this.responsive=e.responsive_select},get_replacement:function(e){var i=t("option:selected",e);return 0!=i.length||(i=t("option:first-child",e)),t("<span class='select'><span class='select_content' ><span class='select_button'><span class='select_button_icon'></span></span><span class='select_label'><span>"+i.text()+"</span></span></span></span>")},replace_elements:function(t,e){this.element_width=t.outerWidth(),t.after(e),e.append(t)},init_replacement:function(e,i){this.set(t(".select_label",i),"select_label");this.responsive?i.addClass("responsive_select"):this.redraw(),e.bind("change",this,this.select_change)},init_mouse_events:function(t,e){i.prototype.init_mouse_events.call(this,t,e),(l._browser.mozilla||l._browser.msie)&&t.bind("keyup",this,this.key_up)},key_up:function(t){(38==t.which||40==t.which)&&t.data.update()},select_change:function(t){t.data.update_label()},update_label:function(){this.get("select_label").html("<span>"+t("option:selected",this.get_element()).text()+"</span>")},mouse_trigger:function(){return this.get_element()},update:function(){var t=this.get_element();this.disable_if_disabled(t),this.update_label()},select:function(e){var i=typeof e,n=this.get_element();switch(i){case"number":n.val(t(":nth-child("+e+")",n).val());break;case"function":e.apply(n);break;default:"string"==i||(e=e.to_s),n.find("option:contains('"+e+"')").prop("selected",!0)}this.update()}}),i.register_class(o.IDENTIFIER,o),a.IDENTIFIER="input_file";var f=a.prototype=new i;f.constructor=i.prototype.constructor,t.extend(f,{click_handler:t.noop,element_type:"file",set_parameters:function(t,e){this.label=e.file_label,this.button_label=e.file_button,this.responsive=e.responsive_file},get_replacement:function(){return t("<span class='file'><span class='file_content'><span class='file_button'><span></span>"+this.button_label+"</span><span class='file_label'><span>"+this.label+"</span></span></span></span>")},replace_elements:function(e,i){this.responsive||(this.element_width=e.outerWidth(),this.element_margin=e.css("margin-left"),this.element_padding=e.css("padding-left")),e.after(i);var n=t("<span class='file_wrap'></span>");i.append(n),n.append(e)},init_replacement:function(e,i){var n=n=this.set(t(".file_label",i),"file_label");if(e.bind("change",this,this.file_change),this.responsive)i.addClass("responsive_file");else{var r={width:this.element_width-parseInt(i.css("border-left-width"))-parseInt(i.css("border-right-width"))};e.css(r),i.css(r)}},mouse_trigger:function(){return this.get_element()},file_change:function(t){t.data.update_label()},update_label:function(){var t=this.get_element().val();t.match(/\S/)||(t=this.label),this.get("file_label").html("<span>"+t+"</span>")},update:function(){var t=this.get_element();this.disable_if_disabled(t),t.trigger("change")}}),i.register_class(a.IDENTIFIER,a),l.fn.ie6=function(){return l._browser.msie&&parseInt(l._browser.version)<=6},l.fn.ie6_instance=function(){return new function(){this.init=this.execute=function(t){return t}}},s.get_custom_form_instance=function(){return this.instance||(this.instance=l.fn.ie6()?l.fn.ie6_instance():new s),this.instance},t.fn.custom_form=function(t){var e=s.get_custom_form_instance();return"string"==typeof t&&t?e.execute(this,arguments):e.init(this,t)}}(jQuery),$.fn.depends_on=function(){this.each(function(){var t=$(this),e=$(t.data("depends-on"));e.find("[data-depends-on-show]:checked").length?t.show():t.hide(),e.change(function(e){var i=$(e.target);i.is("[data-depends-on-hide]")?t.hide():i.is("[data-depends-on-show]")&&t.show()})})};var Device=function(t,e,i){var n;if(e.ranges=i,Browser.is_msie("< 9")){for(n in i)e["is_"+n]="desktop"==n?!0:!1;return e.device_type=function(){return"desktop"},e.is=function(t){return"desktop"==t},e.debug=e.log=e.refresh=$.noop,e.current_device="desktop",e}var r="innerWidth"in t?"innerWidth":"clientWidth",o="innerWidth"==r?t:document.documentElement||document.body,a=function(){return o[r]};return e.log=$.noop,e.debug=function(){var t=$("<div style='position:fixed; left:0; top:0; background-color:#FFD000; border:3px solid #DE5050; color:#B83509; z-index:99999; padding:10px; font-size:1.5em; border-radius:5px;'/>");$("body").append(t),e.log=function(){t.html("<p>Width: "+a()+"</p><p>Device: "+e.current_device+"</p><p>Range: "+i[e.current_device]+"</p>")},e.log()},e.device_type=function(){var t,e,n,r,o=a();for(r in i)if(t=i[r],e=t[0],n=t[1],o>=e&&(!n||n>=o))return r;return null},e.es_movil={android:function(){return navigator.userAgent.search(/android/i)>-1},blackberry:function(){return navigator.userAgent.search(/blackberry/i)>-1},ios:function(){return navigator.userAgent.search(/iphone|ipad|ipod/i)>-1},opera:function(){return navigator.userAgent.search(/opera mini/i)>-1},windows:function(){return navigator.userAgent.search(/iemobile/i)>-1},any:function(){return e.es_movil.android()||e.es_movil.blackberry()||e.es_movil.ios()||e.es_movil.opera()||e.es_movil.windows()}},e.is=function(t){var e=a(),n=i[t],r=n[0],o=n[1];return e>=r&&(!o||o>=e)},e.refresh=function(n){n||(n=!1);var r,o,a,s,l=!1;for(s in i)r=e["is_"+s],o=e.is(s),r!=o&&(e["is_"+s]=o,o&&(a=e.current_device,e.current_device=s),l||(l=!0));(l||n)&&$(t).trigger($.Event("device_change",{device:e.current_device,prev_device:a}))},$(t).on("resize",_.debounce(function(){e.refresh(),e.log()},100)),e.refresh(),e}(window,{},{desktop:[991],tablet:[768,990],mobile:[0,767]}),DYN_WEB=DYN_WEB||{};DYN_WEB.Event=function(t){return t.add=document.addEventListener?function(t,e,i,n){n=n||!1,t.addEventListener(e,i,n)}:function(t,e,i){t.attachEvent("on"+e,i)},t.remove=document.removeEventListener?function(t,e,i,n){n=n||!1,t.removeEventListener(e,i,n)}:function(t,e,i){t.detachEvent("on"+e,i)},t.DOMit=function(t){return t=t?t:window.event,t.target||(t.target=t.srcElement),t.preventDefault||(t.preventDefault=function(){return t.returnValue=!1,!1}),t.stopPropagation||(t.stopPropagation=function(){t.cancelBubble=!0}),t},t.getTarget=function(e){e=t.DOMit(e);var i=e.target;return 1!==i.nodeType&&(i=i.parentNode),i},t.domReady=function(){function t(t){if(!i&&("readystatechange"!==t.type||"complete"===document.readyState)){for(var n=0,r=e.length;r>n;n++)e[n].call(document);i=!0,e=[]}}var e=[],i=!1;return document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),document.addEventListener("readystatechange",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",t),window.attachEvent("onload",t)),function(t){i?t.call(document):e.push(t)}}(),t}(DYN_WEB.Event||{}),DYN_WEB.Viewport={_docEl:null,getDocEl:function(){var t="",e=document;return this._docEl||(t=e.compatMode,this._docEl="CSS1Compat"===t?e.documentElement:e.body),this._docEl},getWidth:function(){var t=this.getDocEl().clientWidth;return window.innerWidth&&t>window.innerWidth&&(t=window.innerWidth),t},getHeight:function(){var t=this.getDocEl().clientHeight;return window.innerHeight&&t>window.innerHeight&&(t=window.innerHeight),t},getScrollX:function(){var t="number"==typeof window.pageXOffset?window.pageXOffset:this.getDocEl().scrollLeft;return t},getScrollY:function(){var t="number"==typeof window.pageYOffset?window.pageYOffset:this.getDocEl().scrollTop;return t},getAll:function(){return{width:this.getWidth(),height:this.getHeight(),scrollX:this.getScrollX(),scrollY:this.getScrollY()}}},DYN_WEB.Util=function(t){return t.$=function(t){return document.getElementById(t)},t.getCurrentStyle=function(t,e){var i,n,r="";return window.getComputedStyle?r=window.getComputedStyle(t,null)[e]:t.currentStyle&&(r=t.currentStyle[e],!/^\d+(px)?$/i.test(r)&&/^\d/.test(r)&&(i=t.style.left,n=t.runtimeStyle.left,t.runtimeStyle.left=t.currentStyle.left,t.style.left=r||0,r=t.style.pixelLeft+"px",t.style.left=i,t.runtimeStyle.left=n)),r},t.contained=function(t,e){if(!t)return!1;for(;t=t.parentNode;)if(t===e)return!0;return!1},t}(DYN_WEB.Util||{}),DYN_WEB.Draggable=function(){function t(n,r,o){var a=e.$(n);if(!a)throw new Error("new DYN_WEB.Draggable: No element with the specified id found.");this.id=n,t.col[n]=this;var s,l=parseInt(e.getCurrentStyle(a,"left"),10),c=parseInt(e.getCurrentStyle(a,"top"),10);if(l=isNaN(l)?0:l,c=isNaN(c)?0:c,o&&(this.minX="number"==typeof o.minX?o.minX:void 0,this.maxX="number"==typeof o.maxX?o.maxX:void 0,this.minY="number"==typeof o.minY?o.minY:void 0,this.maxY="number"==typeof o.maxY?o.maxY:void 0,this.on_drag_start="function"==typeof o.on_drag_start?o.on_drag_start:this.on_drag_start,this.on_drag="function"==typeof o.on_drag?o.on_drag:this.on_drag,this.on_drag_end="function"==typeof o.on_drag_end?o.on_drag_end:this.on_drag_end),t.shiftTo(a,l,c),r){if(s=e.$(r),!s)throw new Error("new DYN_WEB.Draggable: No element with the specified handleId found.");if(!e.contained(s,a))throw new Error("new DYN_WEB.Draggable: No element with id "+r+" found inside "+n+".")}else s=a;i.add(s,"mousedown",t.start)}var e=DYN_WEB.Util,i=DYN_WEB.Event,n=DYN_WEB.Viewport;return t.prototype={on_drag_start:function(){},on_drag:function(){},on_drag_end:function(){}},t.col={},t.current="",t.zOrder=1e3,t.start=function(r){var o,a,s,l,c,h,u=0,d=10;r=i.DOMit(r);var p=i.getTarget(r);do{if(p.id&&(a=t.col[p.id])){o=e.$(p.id),t.current=p.id;break}u++}while(d>u&&(p=p.parentNode));if(!o)throw new Error("Unable to find Draggable element onmousedown.");o.style.zIndex=t.zOrder++,s=r.clientX+n.getScrollX(),l=r.clientY+n.getScrollY(),c=parseInt(o.style.left,10)||0,h=parseInt(o.style.top,10)||0,a.dx=s-c,a.dy=l-h,a.on_drag_start(c,h),i.add(document,"mousemove",t.drag),i.add(document,"mouseup",t.end),r.preventDefault(),r.stopPropagation()},t.drag=function(r){r=i.DOMit(r);var o=t.col[t.current],a=e.$(t.current),s=r.clientX+n.getScrollX()-o.dx,l=r.clientY+n.getScrollY()-o.dy;s="undefined"!=typeof o.minX?Math.max(o.minX,s):s,s="undefined"!=typeof o.maxX?Math.min(o.maxX,s):s,l="undefined"!=typeof o.minY?Math.max(o.minY,l):l,l="undefined"!=typeof o.maxY?Math.min(o.maxY,l):l,t.shiftTo(a,s,l),o.on_drag(s,l),r.preventDefault()},t.end=function(){var n,r,o=t.col[t.current],a=e.$(t.current);i.remove(document,"mousemove",t.drag),i.remove(document,"mouseup",t.end),a&&(n=parseInt(a.style.left,10),r=parseInt(a.style.top,10),o.on_drag_end(n,r)),t.current=""},t.setup=function(){for(var e,i=0,n=arguments.length;n>i;i++)e=arguments[i],"string"==typeof e?new t(e):new t(e.id,e.handleId,e)},t.shiftTo=function(t,e,i){t.style.left=parseInt(e,10)+"px",t.style.top=parseInt(i,10)+"px"},t}(),DYN_WEB.Slider=function(){function t(e,i,n){this.id=e,this.trackId=i,this.axis=n,t.col[this.id]=this,this.init()}var e=DYN_WEB.Util,i=DYN_WEB.Event,n=DYN_WEB.Draggable;return t.col={},t.prototype={slideDur:500,init:function(){var t,r,o,a=e.$(this.id),s=e.$(this.trackId),l=parseInt(e.getCurrentStyle(a,"left"),10),c=parseInt(e.getCurrentStyle(a,"top"),10),h=this;
l=isNaN(l)?0:l,c=isNaN(c)?0:c,"v"===this.axis?(r=s.offsetHeight-a.offsetHeight-2*s.clientTop,o={minX:l,maxX:l,minY:0,maxY:r}):(t=s.offsetWidth-a.offsetWidth-2*s.clientLeft,o={minX:0,maxX:t,minY:c,maxY:c}),this.barWd=a.offsetWidth,this.barHt=a.offsetHeight,this.Dragbar=new n(this.id,"",o),this.minX=this.Dragbar.minX,this.maxX=this.Dragbar.maxX,this.minY=this.Dragbar.minY,this.maxY=this.Dragbar.maxY,this.Dragbar.on_drag_start=function(t,e){h.on_move_start(t,e)},this.Dragbar.on_drag=function(t,e){h.on_move(t,e)},this.Dragbar.on_drag_end=function(t,e){h.on_move_end(t,e)},i.add(s,"mousedown",function(t){h.prepSlide(t,h.id)})},prepSlide:function(n,r){n=i.DOMit(n);var o=t.col[r],a=o.bar=e.$(r);o.clearTimer(),n.offX="number"==typeof n.offsetX?n.offsetX:n.layerX,n.offY="number"==typeof n.offsetY?n.offsetY:n.layerY,o.startX=parseInt(a.style.left,10),o.startY=parseInt(a.style.top,10),"v"===o.axis?(o.destX=o.startX,o.destY=n.offY<o.startY?n.offY:n.offY-o.barHt,o.destY=Math.min(Math.max(o.destY,o.minY),o.maxY)):(o.destX=n.offX<o.startX?n.offX:n.offX-o.barWd,o.destX=Math.min(Math.max(o.destX,o.minX),o.maxX),o.destY=o.startY),o.distX=o.destX-o.startX,o.distY=o.destY-o.startY,o.per=Math.PI/(2*o.slideDur),o.slideStartTime=(new Date).getTime(),o.on_move_start(o.startX,o.startY),o.timerId=setInterval(function(){o.doSlide()},10)},doSlide:function(){var t=(new Date).getTime()-this.slideStartTime;if(t<this.slideDur){var e=this.startX+this.distX*Math.sin(this.per*t),i=this.startY+this.distY*Math.sin(this.per*t);this.shiftTo(e,i),this.on_move(e,i)}else this.clearTimer(),this.shiftTo(this.destX,this.destY),this.on_move(this.destX,this.destY),this.on_move_end(this.destX,this.destY)},shiftTo:function(t,e){!this.bar||isNaN(t)||isNaN(e)||(this.bar.style.left=Math.round(t)+"px",this.bar.style.top=Math.round(e)+"px")},clearTimer:function(){clearInterval(this.timerId),this.timerId=0},on_move_start:function(){},on_move:function(){},on_move_end:function(){}},t}(),function(){$(".m_map, .m_neonews_mapa, .m_search_club_content_map").length&&whenAvailable("google",function(){function t(t){var e=Array.prototype.slice,i=e.call(arguments,1);return function(){var n=e.call(arguments);return t.apply(this,n.concat(i))}}function e(t,e){this.options=$.extend(!0,{},$.fn.gmaps.defaults,e),this.element=t,this.on_search=$.proxy(this.on_search,this),this.on_draw_route=$.proxy(this.on_draw_route,this),this.marker_image=new google.maps.MarkerImage(this.option_or_data("marker")),this.markers_description=this.option_or_data("markers"),this.markers_windows={};this.gapi={geocoder:new google.maps.Geocoder,directions_service:new google.maps.DirectionsService,directions_display:new google.maps.DirectionsRenderer({suppressMarkers:!0})},this.position=this.new_position(this.option_or_data("lat"),this.option_or_data("lng")),this.map=this.build_map(),this.markers=[],this.init()}$.extend(e.prototype,{option_or_data:function(t){return"undefined"!=typeof this.options[t]?this.options[t]:this.element.attr("data-"+t)},new_position:function(t,e){return new google.maps.LatLng(parseFloat(t),parseFloat(e))},build_map:function(){var t=this.options.map;return(t=this.options.map).center||(t.center=this.position),new google.maps.Map(this.element.get(0),t)},init:function(){this.gapi.directions_display.setMap(this.map),this.set_zoom(this.options.zoom).set_center(this.position);var t,e;this.markers_description&&(this.markers_description=this.markers_description instanceof jQuery?this.markers_description:$(this.markers_description),this.markers_description.each($.proxy(function(i,n){n=$(n);var r,o;t=n.data("marker-content")||((o=n.find(".template")).length?o.html():null),t&&(e=new InfoBox({content:t,pixelOffset:new google.maps.Size(-24,-24),alignBottom:!0,closeBoxMargin:"0px 0px 0px 0px",closeBoxURL:""})),r=this.create_marker(this.new_position(n.data("lat"),n.data("lng")),n.data("marker-image"),e,n.data("marker-id"))},this)),this.markers_description=null,this.fit_to_markers()),this.option_or_data("marker-center")&&(t=this.element.data("marker-content"),t&&(e=new InfoBox({content:t,pixelOffset:new google.maps.Size(-24,-69),closeBoxMargin:"0px 0px 0px 0px",closeBoxURL:""})),this.create_marker(this.position,null,e))},set_position:function(t,e){var i=this.new_position(t,e);this.set_center(i)},fit_to_markers:function(){for(var t=new google.maps.LatLngBounds,e=this.markers.length,i=0;e>i;i++){var n=this.markers[i].position;t.extend(new google.maps.LatLng(n.lat(),n.lng())),this.map.fitBounds(t)}},create_marker:function(t,e,i,n){var r=new google.maps.Marker({position:t,map:this.map,draggable:!1,raiseOnDrag:!1,icon:e||this.marker_image,infoWindow:i});return i&&this.register_info_window(i,r,n),this.markers.push(r),r},register_info_window:function(t,e,i){this.markers_windows[i]={window:t,marker:e},google.maps.event.addListener(e,"mouseover",$.proxy(function(){t.open(this.map,e)},this)),google.maps.event.addListener(e,"mouseout",$.proxy(function(){t.close(this.map,e)},this))},open_window:function(t){var e=this.markers_windows[t];e&&e.window.open(this.map,e.marker)},set_zoom:function(t){return this.map.setZoom(t),this},set_center:function(t){return this.map.setCenter(t||this.position),this},search:function(e,i){this.gapi.geocoder.geocode({address:e},i||t(this.on_search,!1,!1))},search_route:function(e){this.clear_route(),this.search(e,t(this.on_search,!0,!0))},clear_route:function(){this.current_route_marker&&this.clear_marker(this.current_route_marker),this.gapi.directions_display.setDirections({routes:[]})},clear_marker:function(t){t.setMap(null)},clear_markers:function(){for(var t;t=this.markers.pop();)this.clear_marker(t)},draw_route:function(t,e){this.gapi.directions_service.route({origin:t,destination:e,travelMode:google.maps.TravelMode.WALKING},this.on_draw_route)},on_draw_route:function(t,e){e==google.maps.DirectionsStatus.OK&&this.gapi.directions_display.setDirections(t)},on_search:function(t,e,i,n){if(e==google.maps.GeocoderStatus.OK){{var r,o,a;t.length}(i||n)&&(o=t[0]),r=o.geometry.location,n&&(a=this.create_marker(r)),i&&(this.draw_route(r,this.position),this.current_route_marker=a)}this.element.trigger($.Event("search_complete",{results:t,status:e}))}}),$.fn.gmaps=function(t){return this.each(function(){var i=$(this);i.data("gmaps")||i.data("gmaps",new e(i,t))})};var i="";try{i=google.maps.NavigationControlStyle.SMALL}catch(n){}$.fn.gmaps.defaults={zoom:15,map:{mapTypeControl:!0,navigationControlOptions:{style:i},mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1}}})}(),// @copyright Copyright 2010 Gary Little [gary at luxcentral.com]
window.google&&(InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var t,e,i,n=this,r=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},o=function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault(),n.enableEventPropagation_||r(t)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(i=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-i.left-i.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<e.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,e[t],r));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",o),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var t="";return""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},InfoBox.prototype.addClickHandler_=function(){var t;""!==this.closeBoxURL_?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var t=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t,"closeclick"),t.close()}},InfoBox.prototype.panBox_=function(t){var e,i,n=0,r=0;if(!t&&(e=this.getMap(),e instanceof google.maps.Map)){e.getBounds().contains(this.position_)||e.setCenter(this.position_),i=e.getBounds();var o=e.getDiv(),a=o.offsetWidth,s=o.offsetHeight,l=this.pixelOffset_.width,c=this.pixelOffset_.height,h=this.div_.offsetWidth,u=this.div_.offsetHeight,d=this.infoBoxClearance_.width,p=this.infoBoxClearance_.height,f=this.getProjection().fromLatLngToContainerPixel(this.position_);if(f.x<-l+d?n=f.x+l-d:f.x+h+l+d>a&&(n=f.x+h+l+d-a),this.alignBottom_?f.y<-c+p+u?r=f.y+c-p-u:f.y+c+p>s&&(r=f.y+c+p-s):f.y<-c+p?r=f.y+c-p:f.y+u+c+p>s&&(r=f.y+u+c+p-s),0!==n||0!==r){{e.getCenter()}e.panBy(n,r)}}},InfoBox.prototype.setBoxStyle_=function(){var t,e;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_;for(t in e)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);"undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},i=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=i.ownerDocument.defaultView.getComputedStyle(i,""),t&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0)):document.documentElement.currentStyle&&i.currentStyle&&(e.top=parseInt(i.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(i.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(i.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(i.currentStyle.borderRightWidth,10)||0),e},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},InfoBox.prototype.setOptions=function(t){"undefined"!=typeof t.boxClass&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),"undefined"!=typeof t.boxStyle&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),"undefined"!=typeof t.content&&this.setContent(t.content),"undefined"!=typeof t.disableAutoPan&&(this.disableAutoPan_=t.disableAutoPan),"undefined"!=typeof t.maxWidth&&(this.maxWidth_=t.maxWidth),"undefined"!=typeof t.pixelOffset&&(this.pixelOffset_=t.pixelOffset),"undefined"!=typeof t.alignBottom&&(this.alignBottom_=t.alignBottom),"undefined"!=typeof t.position&&this.setPosition(t.position),"undefined"!=typeof t.zIndex&&this.setZIndex(t.zIndex),"undefined"!=typeof t.closeBoxMargin&&(this.closeBoxMargin_=t.closeBoxMargin),"undefined"!=typeof t.closeBoxURL&&(this.closeBoxURL_=t.closeBoxURL),"undefined"!=typeof t.infoBoxClearance&&(this.infoBoxClearance_=t.infoBoxClearance),"undefined"!=typeof t.isHidden&&(this.isHidden_=t.isHidden),"undefined"!=typeof t.enableEventPropagation&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(t,e){var i=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){i.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)}),function(t,e,i){function n(i,n){this.wrapper="string"==typeof i?e.querySelector(i):i,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,disablePointer:!s.hasPointer,disableTouch:s.hasPointer||!s.hasTouch,disableMouse:s.hasPointer||s.hasTouch,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,bindToWrapper:"undefined"==typeof t.onmousedown};for(var r in n)this.options[r]=n[r];this.translateZ=this.options.HWCompositing&&s.hasPerspective?" translateZ(0)":"",this.options.useTransition=s.hasTransition&&this.options.useTransition,this.options.useTransform=s.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?s.ease[this.options.bounceEasing]||s.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.options.useTransition||this.options.useTransform||/relative|absolute/i.test(this.scrollerStyle.position)||(this.scrollerStyle.position="relative"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function r(t,i,n){var r=e.createElement("div"),o=e.createElement("div");return n===!0&&(r.style.cssText="position:absolute;z-index:9999",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),o.className="iScrollIndicator","h"==t?(n===!0&&(r.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",o.style.height="100%"),r.className="iScrollHorizontalScrollbar"):(n===!0&&(r.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",o.style.width="100%"),r.className="iScrollVerticalScrollbar"),r.style.cssText+=";overflow:hidden",i||(r.style.pointerEvents="none"),r.appendChild(o),r}function o(i,n){this.wrapper="string"==typeof n.el?e.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var r in n)this.options[r]=n[r];if(this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(s.addEvent(this.indicator,"touchstart",this),s.addEvent(t,"touchend",this)),this.options.disablePointer||(s.addEvent(this.indicator,s.prefixPointerEvent("pointerdown"),this),s.addEvent(t,s.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(s.addEvent(this.indicator,"mousedown",this),s.addEvent(t,"mouseup",this))),this.options.fade){this.wrapperStyle[s.style.transform]=this.scroller.translateZ;var o=s.style.transitionDuration;if(!o)return;this.wrapperStyle[o]=s.isBadAndroid?"0.0001ms":"0ms";var l=this;s.isBadAndroid&&a(function(){"0.0001ms"===l.wrapperStyle[o]&&(l.wrapperStyle[o]="0s")}),this.wrapperStyle.opacity="0"}}var a=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},s=function(){function n(t){return a===!1?!1:""===a?t:a+t.charAt(0).toUpperCase()+t.substr(1)}var r={},o=e.createElement("div").style,a=function(){for(var t,e=["t","webkitT","MozT","msT","OT"],i=0,n=e.length;n>i;i++)if(t=e[i]+"ransform",t in o)return e[i].substr(0,e[i].length-1);return!1}();r.getTime=Date.now||function(){return(new Date).getTime()},r.extend=function(t,e){for(var i in e)t[i]=e[i]},r.addEvent=function(t,e,i,n){t.addEventListener(e,i,!!n)},r.removeEvent=function(t,e,i,n){t.removeEventListener(e,i,!!n)},r.prefixPointerEvent=function(e){return t.MSPointerEvent?"MSPointer"+e.charAt(7).toUpperCase()+e.substr(8):e},r.momentum=function(t,e,n,r,o,a){var s,l,c=t-e,h=i.abs(c)/n;return a=void 0===a?6e-4:a,s=t+h*h/(2*a)*(0>c?-1:1),l=h/a,r>s?(s=o?r-o/2.5*(h/8):r,c=i.abs(s-t),l=c/h):s>0&&(s=o?o/2.5*(h/8):0,c=i.abs(t)+s,l=c/h),{destination:i.round(s),duration:l}};var s=n("transform");return r.extend(r,{hasTransform:s!==!1,hasPerspective:n("perspective")in o,hasTouch:"ontouchstart"in t,hasPointer:!(!t.PointerEvent&&!t.MSPointerEvent),hasTransition:n("transition")in o}),r.isBadAndroid=function(){var e=t.navigator.appVersion;if(/Android/.test(e)&&!/Chrome\/\d/.test(e)){var i=e.match(/Safari\/(\d+.\d)/);return i&&"object"==typeof i&&i.length>=2?parseFloat(i[1])<535.19:!0}return!1}(),r.extend(r.style={},{transform:s,transitionTimingFunction:n("transitionTimingFunction"),transitionDuration:n("transitionDuration"),transitionDelay:n("transitionDelay"),transformOrigin:n("transformOrigin")}),r.hasClass=function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)");return i.test(t.className)},r.addClass=function(t,e){if(!r.hasClass(t,e)){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}},r.removeClass=function(t,e){if(r.hasClass(t,e)){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i," ")}},r.offset=function(t){for(var e=-t.offsetLeft,i=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,i-=t.offsetTop;return{left:e,top:i}},r.preventDefaultException=function(t,e){for(var i in e)if(e[i].test(t[i]))return!0;return!1},r.extend(r.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),r.extend(r.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return i.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var e=4;return(t-=1)*t*((e+1)*t+e)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var e=.22,n=.4;return 0===t?0:1==t?1:n*i.pow(2,-10*t)*i.sin(2*(t-e/4)*i.PI/e)+1}}}),r.tap=function(t,i){var n=e.createEvent("Event");n.initEvent(i,!0,!0),n.pageX=t.pageX,n.pageY=t.pageY,t.target.dispatchEvent(n)},r.click=function(i){var n,r=i.target;/(SELECT|INPUT|TEXTAREA)/i.test(r.tagName)||(n=e.createEvent(t.MouseEvent?"MouseEvents":"Event"),n.initEvent("click",!0,!0),n.view=i.view||t,n.detail=1,n.screenX=r.screenX||0,n.screenY=r.screenY||0,n.clientX=r.clientX||0,n.clientY=r.clientY||0,n.ctrlKey=!!i.ctrlKey,n.altKey=!!i.altKey,n.shiftKey=!!i.shiftKey,n.metaKey=!!i.metaKey,n.button=0,n.relatedTarget=null,n._constructed=!0,r.dispatchEvent(n))},r}();n.prototype={version:"5.2.0",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),clearTimeout(this.resizeTimeout),this.resizeTimeout=null,this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(1!=s.eventType[t.type]){var e;if(e=t.which?t.button:t.button<2?0:4==t.button?1:2,0!==e)return}if(this.enabled&&(!this.initiated||s.eventType[t.type]===this.initiated)){!this.options.preventDefault||s.isBadAndroid||s.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var n,r=t.touches?t.touches[0]:t;this.initiated=s.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this.startTime=s.getTime(),this.options.useTransition&&this.isInTransition?(this._transitionTime(),this.isInTransition=!1,n=this.getComputedPosition(),this._translate(i.round(n.x),i.round(n.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=r.pageX,this.pointY=r.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&s.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var e,n,r,o,a=t.touches?t.touches[0]:t,l=a.pageX-this.pointX,c=a.pageY-this.pointY,h=s.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=l,this.distY+=c,r=i.abs(this.distX),o=i.abs(this.distY),!(h-this.endTime>300&&10>r&&10>o)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=r>o+this.options.directionLockThreshold?"h":o>=r+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}l=this.hasHorizontalScroll?l:0,c=this.hasVerticalScroll?c:0,e=this.x+l,n=this.y+c,(e>0||e<this.maxScrollX)&&(e=this.options.bounce?this.x+l/3:e>0?0:this.maxScrollX),(n>0||n<this.maxScrollY)&&(n=this.options.bounce?this.y+c/3:n>0?0:this.maxScrollY),this.directionX=l>0?-1:0>l?1:0,this.directionY=c>0?-1:0>c?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(e,n),h-this.startTime>300&&(this.startTime=h,this.startX=this.x,this.startY=this.y)}}},_end:function(t){if(this.enabled&&s.eventType[t.type]===this.initiated){this.options.preventDefault&&!s.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,n,r=(t.changedTouches?t.changedTouches[0]:t,s.getTime()-this.startTime),o=i.round(this.x),a=i.round(this.y),l=i.abs(o-this.startX),c=i.abs(a-this.startY),h=0,u="";if(this.isInTransition=0,this.initiated=0,this.endTime=s.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(o,a),!this.moved)return this.options.tap&&s.tap(t,this.options.tap),this.options.click&&s.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&200>r&&100>l&&100>c)return void this._execEvent("flick");if(this.options.momentum&&300>r&&(e=this.hasHorizontalScroll?s.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},n=this.hasVerticalScroll?s.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:a,duration:0},o=e.destination,a=n.destination,h=i.max(e.duration,n.duration),this.isInTransition=1),this.options.snap){var d=this._nearestSnap(o,a);this.currentPage=d,h=this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-d.x),1e3),i.min(i.abs(a-d.y),1e3)),300),o=d.x,a=d.y,this.directionX=0,this.directionY=0,u=this.options.bounceEasing}return o!=this.x||a!=this.y?((o>0||o<this.maxScrollX||a>0||a<this.maxScrollY)&&(u=s.ease.quadratic),void this.scrollTo(o,a,h,u)):void this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),e==this.x&&i==this.y?!1:(this.scrollTo(e,i,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=s.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var i=this._events[t].indexOf(e);i>-1&&this._events[t].splice(i,1)}},_execEvent:function(t){if(this._events[t]){var e=0,i=this._events[t].length;if(i)for(;i>e;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,n){t=this.x+t,e=this.y+e,i=i||0,this.scrollTo(t,e,i,n)},scrollTo:function(t,e,i,n){n=n||s.ease.circular,this.isInTransition=this.options.useTransition&&i>0;var r=this.options.useTransition&&n.style;!i||r?(r&&(this._transitionTimingFunction(n.style),this._transitionTime(i)),this._translate(t,e)):this._animate(t,e,i,n.fn)},scrollToElement:function(t,e,n,r,o){if(t=t.nodeType?t:this.scroller.querySelector(t)){var a=s.offset(t);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,n===!0&&(n=i.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),r===!0&&(r=i.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=n||0,a.top-=r||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,e=void 0===e||null===e||"auto"===e?i.max(i.abs(this.x-a.left),i.abs(this.y-a.top)):e,this.scrollTo(a.left,a.top,e,o)}},_transitionTime:function(t){if(this.options.useTransition){t=t||0;var e=s.style.transitionDuration;if(e){if(this.scrollerStyle[e]=t+"ms",!t&&s.isBadAndroid){this.scrollerStyle[e]="0.0001ms";var i=this;a(function(){"0.0001ms"===i.scrollerStyle[e]&&(i.scrollerStyle[e]="0s")})}if(this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].transitionTime(t)}}},_transitionTimingFunction:function(t){if(this.scrollerStyle[s.style.transitionTimingFunction]=t,this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTimingFunction(t)},_translate:function(t,e){if(this.options.useTransform?this.scrollerStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ:(t=i.round(t),e=i.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e,this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].updatePosition()},_initEvents:function(e){var i=e?s.removeEvent:s.addEvent,n=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this),i(t,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),s.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,s.prefixPointerEvent("pointerdown"),this),i(n,s.prefixPointerEvent("pointermove"),this),i(n,s.prefixPointerEvent("pointercancel"),this),i(n,s.prefixPointerEvent("pointerup"),this)),s.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,i,n=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[s.style.transform].split(")")[0].split(", "),e=+(n[12]||n[4]),i=+(n[13]||n[5])):(e=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:e,y:i}},_initIndicators:function(){function t(t){if(s.indicators)for(var e=s.indicators.length;e--;)t.call(s.indicators[e])}var e,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,a=[],s=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:r("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),a.push(e)),this.options.scrollX&&(e={el:r("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),a.push(e))),this.options.indicators&&(a=a.concat(this.options.indicators));for(var l=a.length;l--;)this.indicators.push(new o(this,a[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){s.addEvent(this.wrapper,"wheel",this),s.addEvent(this.wrapper,"mousewheel",this),s.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){clearTimeout(this.wheelTimeout),this.wheelTimeout=null,s.removeEvent(this.wrapper,"wheel",this),s.removeEvent(this.wrapper,"mousewheel",this),s.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault();var e,n,r,o,a=this;if(void 0===this.wheelTimeout&&a._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){a.options.snap||a._execEvent("scrollEnd"),a.wheelTimeout=void 0},400),"deltaX"in t)1===t.deltaMode?(e=-t.deltaX*this.options.mouseWheelSpeed,n=-t.deltaY*this.options.mouseWheelSpeed):(e=-t.deltaX,n=-t.deltaY);else if("wheelDeltaX"in t)e=t.wheelDeltaX/120*this.options.mouseWheelSpeed,n=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)e=n=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;e=n=-t.detail/3*this.options.mouseWheelSpeed}if(e*=this.options.invertWheelDirection,n*=this.options.invertWheelDirection,this.hasVerticalScroll||(e=n,n=0),this.options.snap)return r=this.currentPage.pageX,o=this.currentPage.pageY,e>0?r--:0>e&&r++,n>0?o--:0>n&&o++,void this.goToPage(r,o);r=this.x+i.round(this.hasHorizontalScroll?e:0),o=this.y+i.round(this.hasVerticalScroll?n:0),this.directionX=e>0?-1:0>e?1:0,this.directionY=n>0?-1:0>n?1:0,r>0?r=0:r<this.maxScrollX&&(r=this.maxScrollX),o>0?o=0:o<this.maxScrollY&&(o=this.maxScrollY),this.scrollTo(r,o,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,n,r,o,a,s=0,l=0,c=0,h=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(n=i.round(h/2),r=i.round(u/2);c>-this.scrollerWidth;){for(this.pages[s]=[],t=0,o=0;o>-this.scrollerHeight;)this.pages[s][t]={x:i.max(c,this.maxScrollX),y:i.max(o,this.maxScrollY),width:h,height:u,cx:c-n,cy:o-r},o-=u,t++;c-=h,s++}else for(a=this.options.snap,t=a.length,e=-1;t>s;s++)(0===s||a[s].offsetLeft<=a[s-1].offsetLeft)&&(l=0,e++),this.pages[l]||(this.pages[l]=[]),c=i.max(-a[s].offsetLeft,this.maxScrollX),o=i.max(-a[s].offsetTop,this.maxScrollY),n=c-i.round(a[s].offsetWidth/2),r=o-i.round(a[s].offsetHeight/2),this.pages[l][e]={x:c,y:o,width:a[s].offsetWidth,height:a[s].offsetHeight,cx:n,cy:r},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,r=this.pages.length,o=0;if(i.abs(t-this.absStartX)<this.snapThresholdX&&i.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),e>0?e=0:e<this.maxScrollY&&(e=this.maxScrollY);r>n;n++)if(t>=this.pages[n][0].cx){t=this.pages[n][0].x;break}for(r=this.pages[n].length;r>o;o++)if(e>=this.pages[0][o].cy){e=this.pages[0][o].y;break}return n==this.currentPage.pageX&&(n+=this.directionX,0>n?n=0:n>=this.pages.length&&(n=this.pages.length-1),t=this.pages[n][0].x),o==this.currentPage.pageY&&(o+=this.directionY,0>o?o=0:o>=this.pages[0].length&&(o=this.pages[0].length-1),e=this.pages[0][o].y),{x:t,y:e,pageX:n,pageY:o}},goToPage:function(t,e,n,r){r=r||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:0>t&&(t=0),e>=this.pages[t].length?e=this.pages[t].length-1:0>e&&(e=0);var o=this.pages[t][e].x,a=this.pages[t][e].y;n=void 0===n?this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-this.x),1e3),i.min(i.abs(a-this.y),1e3)),300):n,this.currentPage={x:o,y:a,pageX:t,pageY:e},this.scrollTo(o,a,n,r)},next:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,t,e)},prev:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,0>i&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,t,e)},_initKeys:function(){var e,i={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(e in this.options.keyBindings)"string"==typeof this.options.keyBindings[e]&&(this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(e in i)this.options.keyBindings[e]=this.options.keyBindings[e]||i[e];s.addEvent(t,"keydown",this),this.on("destroy",function(){s.removeEvent(t,"keydown",this)})},_key:function(t){if(this.enabled){var e,n=this.options.snap,r=n?this.currentPage.pageX:this.x,o=n?this.currentPage.pageY:this.y,a=s.getTime(),l=this.keyTime||0,c=.25;switch(this.options.useTransition&&this.isInTransition&&(e=this.getComputedPosition(),this._translate(i.round(e.x),i.round(e.y)),this.isInTransition=!1),this.keyAcceleration=200>a-l?i.min(this.keyAcceleration+c,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?r+=n?1:this.wrapperWidth:o+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?r-=n?1:this.wrapperWidth:o-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:r=n?this.pages.length-1:this.maxScrollX,o=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:r=0,o=0;break;case this.options.keyBindings.left:r+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:o+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:r-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:o-=n?1:5+this.keyAcceleration>>0;break;default:return}if(n)return void this.goToPage(r,o);r>0?(r=0,this.keyAcceleration=0):r<this.maxScrollX&&(r=this.maxScrollX,this.keyAcceleration=0),o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollY&&(o=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(r,o,0),this.keyTime=a}},_animate:function(t,e,i,n){function r(){var d,p,f,m=s.getTime();return m>=u?(o.isAnimating=!1,o._translate(t,e),void(o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd"))):(m=(m-h)/i,f=n(m),d=(t-l)*f+l,p=(e-c)*f+c,o._translate(d,p),void(o.isAnimating&&a(r)))}var o=this,l=this.x,c=this.y,h=s.getTime(),u=h+i;
this.isAnimating=!0,r()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":this.enabled&&!t._constructed&&(t.preventDefault(),t.stopPropagation())}}},o.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.fadeScrollbars&&(clearTimeout(this.fadeTimeout),this.fadeTimeout=null),this.options.interactive&&(s.removeEvent(this.indicator,"touchstart",this),s.removeEvent(this.indicator,s.prefixPointerEvent("pointerdown"),this),s.removeEvent(this.indicator,"mousedown",this),s.removeEvent(t,"touchmove",this),s.removeEvent(t,s.prefixPointerEvent("pointermove"),this),s.removeEvent(t,"mousemove",this),s.removeEvent(t,"touchend",this),s.removeEvent(t,s.prefixPointerEvent("pointerup"),this),s.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var i=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=s.getTime(),this.options.disableTouch||s.addEvent(t,"touchmove",this),this.options.disablePointer||s.addEvent(t,s.prefixPointerEvent("pointermove"),this),this.options.disableMouse||s.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){{var e,i,n,r,o=t.touches?t.touches[0]:t;s.getTime()}this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,e=o.pageX-this.lastPointX,this.lastPointX=o.pageX,i=o.pageY-this.lastPointY,this.lastPointY=o.pageY,n=this.x+e,r=this.y+i,this._pos(n,r),t.preventDefault(),t.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),s.removeEvent(t,"touchmove",this),s.removeEvent(t,s.prefixPointerEvent("pointermove"),this),s.removeEvent(t,"mousemove",this),this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),r=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-n.x),1e3),i.min(i.abs(this.scroller.y-n.y),1e3)),300);(this.scroller.x!=n.x||this.scroller.y!=n.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,r,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0;var e=s.style.transitionDuration;if(e&&(this.indicatorStyle[e]=t+"ms",!t&&s.isBadAndroid)){this.indicatorStyle[e]="0.0001ms";var i=this;a(function(){"0.0001ms"===i.indicatorStyle[e]&&(i.indicatorStyle[e]="0s")})}},transitionTimingFunction:function(t){this.indicatorStyle[s.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(s.addClass(this.wrapper,"iScrollBothScrollbars"),s.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(s.removeClass(this.wrapper,"iScrollBothScrollbars"),s.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(t<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=i.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=i.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),e<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=i.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=i.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=e+"px")},_pos:function(t,e){0>t?t=0:t>this.maxPosX&&(t=this.maxPosX),0>e?e=0:e>this.maxPosY&&(e=this.maxPosY),t=this.options.listenX?i.round(t/this.sizeRatioX):this.scroller.x,e=this.options.listenY?i.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,e)},fade:function(t,e){if(!e||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=t?250:500,n=t?0:300;t=t?"1":"0",this.wrapperStyle[s.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),n)}}},n.utils=s,"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):t.IScroll=n}(window,document,Math),function(t){t.fn.aToolTip=function(e){var i={closeTipBtn:"aToolTipCloseBtn",toolTipId:"aToolTip",fixed:!1,clickIt:!1,inSpeed:200,outSpeed:100,tipContent:"",toolTipClass:"defaultTheme",xOffset:5,yOffset:5,onShow:null,onHide:null,width:250},n=t.extend({},i,e);return n.anchuraMedia=parseInt(n.width/2),this.each(function(){var e=t(this);if(e.attr("title"))var i=e.attr("title");else var i=n.tipContent;var r=function(){t("body").append("<div id='"+n.toolTipId+"' class='"+n.toolTipClass+"'><p class='aToolTipContent'>"+i+"</p></div>"),t("#"+n.toolTipId+" p.aToolTipContent").css({width:n.width+"px","max-width":n.width+"px"}),i&&n.clickIt&&t("#"+n.toolTipId+" p.aToolTipContent").append("<a id='"+n.closeTipBtn+"' href='#' alt='close'>close</a>")},o=function(){t("#"+n.toolTipId).css({top:e.offset().top-t("#"+n.toolTipId).outerHeight()-n.yOffset-7+"px",left:e.offset().left+parseInt(e.outerWidth()/2)-n.anchuraMedia+n.xOffset+"px"}).stop().fadeIn(n.inSpeed,function(){t.isFunction(n.onShow)&&n.onShow(e)})},a=function(){t("#"+n.toolTipId).stop().fadeOut(n.outSpeed,function(){t(this).remove(),t.isFunction(n.onHide)&&n.onHide(e)})};i&&!n.clickIt&&e.hover(function(){t("#"+n.toolTipId).remove(),e.attr({title:""}),r(),o()},function(){a()}),i&&n.clickIt&&e.click(function(){return t("#"+n.toolTipId).remove(),e.attr({title:""}),r(),o(),t("#"+n.closeTipBtn).click(function(){return a(),!1}),!1}),n.fixed||n.clickIt||e.mousemove(function(e){t("#"+n.toolTipId).css({top:e.pageY-t("#"+n.toolTipId).outerHeight()-n.yOffset,left:e.pageX+n.xOffset})})})}}(jQuery),// Copyright 2013 Klaus Hartl
function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(t){return s.raw?t:encodeURIComponent(t)}function i(t){return s.raw?t:decodeURIComponent(t)}function n(t){return e(s.json?JSON.stringify(t):String(t))}function r(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{t=decodeURIComponent(t.replace(a," "))}catch(e){return}try{return s.json?JSON.parse(t):t}catch(e){}}function o(e,i){var n=s.raw?e:r(e);return t.isFunction(i)?i(n):n}var a=/\+/g,s=t.cookie=function(r,a,l){if(void 0!==a&&!t.isFunction(a)){if(l=t.extend({},s.defaults,l),"number"==typeof l.expires){var c=l.expires,h=l.expires=new Date;h.setDate(h.getDate()+c)}return document.cookie=[e(r),"=",n(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var u=r?void 0:{},d=document.cookie?document.cookie.split("; "):[],p=0,f=d.length;f>p;p++){var m=d[p].split("="),g=i(m.shift()),v=m.join("=");if(r&&r===g){u=o(v,a);break}r||void 0===(v=o(v))||(u[g]=v)}return u};s.defaults={},t.removeCookie=function(e,i){return void 0!==t.cookie(e)?(t.cookie(e,"",t.extend({},i,{expires:-1})),!0):!1}}),// Copyright © 2008 George McGinley Smith
// Redistributions of source code must retain the above copyright notice, this list of 
// Redistributions in binary form must reproduce the above copyright notice, this list 
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
//  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(t,e,i,n,r){return jQuery.easing[jQuery.easing.def](t,e,i,n,r)},easeInQuad:function(t,e,i,n,r){return n*(e/=r)*e+i},easeOutQuad:function(t,e,i,n,r){return-n*(e/=r)*(e-2)+i},easeInOutQuad:function(t,e,i,n,r){return(e/=r/2)<1?n/2*e*e+i:-n/2*(--e*(e-2)-1)+i},easeInCubic:function(t,e,i,n,r){return n*(e/=r)*e*e+i},easeOutCubic:function(t,e,i,n,r){return n*((e=e/r-1)*e*e+1)+i},easeInOutCubic:function(t,e,i,n,r){return(e/=r/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},easeInQuart:function(t,e,i,n,r){return n*(e/=r)*e*e*e+i},easeOutQuart:function(t,e,i,n,r){return-n*((e=e/r-1)*e*e*e-1)+i},easeInOutQuart:function(t,e,i,n,r){return(e/=r/2)<1?n/2*e*e*e*e+i:-n/2*((e-=2)*e*e*e-2)+i},easeInQuint:function(t,e,i,n,r){return n*(e/=r)*e*e*e*e+i},easeOutQuint:function(t,e,i,n,r){return n*((e=e/r-1)*e*e*e*e+1)+i},easeInOutQuint:function(t,e,i,n,r){return(e/=r/2)<1?n/2*e*e*e*e*e+i:n/2*((e-=2)*e*e*e*e+2)+i},easeInSine:function(t,e,i,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+i},easeOutSine:function(t,e,i,n,r){return n*Math.sin(e/r*(Math.PI/2))+i},easeInOutSine:function(t,e,i,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+i},easeInExpo:function(t,e,i,n,r){return 0==e?i:n*Math.pow(2,10*(e/r-1))+i},easeOutExpo:function(t,e,i,n,r){return e==r?i+n:n*(-Math.pow(2,-10*e/r)+1)+i},easeInOutExpo:function(t,e,i,n,r){return 0==e?i:e==r?i+n:(e/=r/2)<1?n/2*Math.pow(2,10*(e-1))+i:n/2*(-Math.pow(2,-10*--e)+2)+i},easeInCirc:function(t,e,i,n,r){return-n*(Math.sqrt(1-(e/=r)*e)-1)+i},easeOutCirc:function(t,e,i,n,r){return n*Math.sqrt(1-(e=e/r-1)*e)+i},easeInOutCirc:function(t,e,i,n,r){return(e/=r/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+i:n/2*(Math.sqrt(1-(e-=2)*e)+1)+i},easeInElastic:function(t,e,i,n,r){var o=1.70158,a=0,s=n;if(0==e)return i;if(1==(e/=r))return i+n;if(a||(a=.3*r),s<Math.abs(n)){s=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/s);return-(s*Math.pow(2,10*(e-=1))*Math.sin(2*(e*r-o)*Math.PI/a))+i},easeOutElastic:function(t,e,i,n,r){var o=1.70158,a=0,s=n;if(0==e)return i;if(1==(e/=r))return i+n;if(a||(a=.3*r),s<Math.abs(n)){s=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/s);return s*Math.pow(2,-10*e)*Math.sin(2*(e*r-o)*Math.PI/a)+n+i},easeInOutElastic:function(t,e,i,n,r){var o=1.70158,a=0,s=n;if(0==e)return i;if(2==(e/=r/2))return i+n;if(a||(a=.3*r*1.5),s<Math.abs(n)){s=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/s);return 1>e?-.5*s*Math.pow(2,10*(e-=1))*Math.sin(2*(e*r-o)*Math.PI/a)+i:s*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*r-o)*Math.PI/a)*.5+n+i},easeInBack:function(t,e,i,n,r,o){return void 0==o&&(o=1.70158),n*(e/=r)*e*((o+1)*e-o)+i},easeOutBack:function(t,e,i,n,r,o){return void 0==o&&(o=1.70158),n*((e=e/r-1)*e*((o+1)*e+o)+1)+i},easeInOutBack:function(t,e,i,n,r,o){return void 0==o&&(o=1.70158),(e/=r/2)<1?n/2*e*e*(((o*=1.525)+1)*e-o)+i:n/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+i},easeInBounce:function(t,e,i,n,r){return n-jQuery.easing.easeOutBounce(t,r-e,0,n,r)+i},easeOutBounce:function(t,e,i,n,r){return(e/=r)<1/2.75?7.5625*n*e*e+i:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+i:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+i:n*(7.5625*(e-=2.625/2.75)*e+.984375)+i},easeInOutBounce:function(t,e,i,n,r){return r/2>e?.5*jQuery.easing.easeInBounce(t,2*e,0,n,r)+i:.5*jQuery.easing.easeOutBounce(t,2*e-r,0,n,r)+.5*n+i}}),// Copyright 2012 WooThemes
function(t){t.flexslider=function(e,i){var n=t(e);n.vars=t.extend({},t.flexslider.defaults,i);var r,o=n.vars.namespace,a=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture,s=("ontouchstart"in window||a||window.DocumentTouch&&document instanceof DocumentTouch)&&n.vars.touch,l="click touchend MSPointerUp",c="",h="vertical"===n.vars.direction,u=n.vars.reverse,d=n.vars.itemWidth>0,p="fade"===n.vars.animation,f=""!==n.vars.asNavFor,m={},g=!0;t.data(e,"flexslider",n),m={init:function(){n.animating=!1,n.currentSlide=parseInt(n.vars.startAt?n.vars.startAt:0),isNaN(n.currentSlide)&&(n.currentSlide=0),n.animatingTo=n.currentSlide,n.atEnd=0===n.currentSlide||n.currentSlide===n.last,n.containerSelector=n.vars.selector.substr(0,n.vars.selector.search(" ")),n.slides=t(n.vars.selector,n),n.container=t(n.containerSelector,n),n.count=n.slides.length,n.syncExists=t(n.vars.sync).length>0,"slide"===n.vars.animation&&(n.vars.animation="swing"),n.prop=h?"top":"marginLeft",n.args={},n.manualPause=!1,n.stopped=!1,n.started=!1,n.startTimeout=null,n.transitions=!n.vars.video&&!p&&n.vars.useCSS&&function(){var t=document.createElement("div"),e=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in e)if(void 0!==t.style[e[i]])return n.pfx=e[i].replace("Perspective","").toLowerCase(),n.prop="-"+n.pfx+"-transform",!0;return!1}(),""!==n.vars.controlsContainer&&(n.controlsContainer=t(n.vars.controlsContainer).length>0&&t(n.vars.controlsContainer)),""!==n.vars.manualControls&&(n.manualControls=t(n.vars.manualControls).length>0&&t(n.vars.manualControls)),n.vars.randomize&&(n.slides.sort(function(){return Math.round(Math.random())-.5}),n.container.empty().append(n.slides)),n.doMath(),n.setup("init"),n.vars.controlNav&&m.controlNav.setup(),n.vars.directionNav&&m.directionNav.setup(),n.vars.keyboard&&(1===t(n.containerSelector).length||n.vars.multipleKeyboard)&&t(document).bind("keyup",function(t){var e=t.keyCode;if(!n.animating&&(39===e||37===e)){var i=39===e?n.getTarget("next"):37===e?n.getTarget("prev"):!1;n.flexAnimate(i,n.vars.pauseOnAction)}}),n.vars.mousewheel&&n.bind("mousewheel",function(t,e){t.preventDefault();var i=n.getTarget(0>e?"next":"prev");n.flexAnimate(i,n.vars.pauseOnAction)}),n.vars.pausePlay&&m.pausePlay.setup(),n.vars.slideshow&&n.vars.pauseInvisible&&m.pauseInvisible.init(),n.vars.slideshow&&(n.vars.pauseOnHover&&n.hover(function(){!n.manualPlay&&!n.manualPause&&n.pause()},function(){!n.manualPause&&!n.manualPlay&&!n.stopped&&n.play()}),n.vars.pauseInvisible&&m.pauseInvisible.isHidden()||(n.vars.initDelay>0?n.startTimeout=setTimeout(n.play,n.vars.initDelay):n.play())),f&&m.asNav.setup(),s&&n.vars.touch&&m.touch(),(!p||p&&n.vars.smoothHeight)&&t(window).bind("resize orientationchange focus",m.resize),n.find("img").attr("draggable","false"),setTimeout(function(){n.vars.start(n)},200)},asNav:{setup:function(){n.asNav=!0,n.animatingTo=Math.floor(n.currentSlide/n.move),n.currentItem=n.currentSlide,n.slides.removeClass(o+"active-slide").eq(n.currentItem).addClass(o+"active-slide"),a?(e._slider=n,n.slides.each(function(){var e=this;e._gesture=new MSGesture,e._gesture.target=e,e.addEventListener("MSPointerDown",function(t){t.preventDefault(),t.currentTarget._gesture&&t.currentTarget._gesture.addPointer(t.pointerId)},!1),e.addEventListener("MSGestureTap",function(e){e.preventDefault();var i=t(this),r=i.index();t(n.vars.asNavFor).data("flexslider").animating||i.hasClass("active")||(n.direction=n.currentItem<r?"next":"prev",n.flexAnimate(r,n.vars.pauseOnAction,!1,!0,!0))})})):n.slides.click(function(e){e.preventDefault();var i=t(this),r=i.index(),a=i.offset().left-t(n).scrollLeft();0>=a&&i.hasClass(o+"active-slide")?n.flexAnimate(n.getTarget("prev"),!0):t(n.vars.asNavFor).data("flexslider").animating||i.hasClass(o+"active-slide")||(n.direction=n.currentItem<r?"next":"prev",n.flexAnimate(r,n.vars.pauseOnAction,!1,!0,!0))})}},controlNav:{setup:function(){n.manualControls?m.controlNav.setupManual():m.controlNav.setupPaging()},setupPaging:function(){var e,i,r="thumbnails"===n.vars.controlNav?"control-thumbs":"control-paging",a=1;if(n.controlNavScaffold=t('<ol class="'+o+"control-nav "+o+r+'"></ol>'),n.pagingCount>1)for(var s=0;s<n.pagingCount;s++){if(i=n.slides.eq(s),e="thumbnails"===n.vars.controlNav?'<img src="'+i.attr("data-thumb")+'"/>':"<a>"+a+"</a>","thumbnails"===n.vars.controlNav&&!0===n.vars.thumbCaptions){var h=i.attr("data-thumbcaption");""!=h&&void 0!=h&&(e+='<span class="'+o+'caption">'+h+"</span>")}n.controlNavScaffold.append("<li>"+e+"</li>"),a++}n.controlsContainer?t(n.controlsContainer).append(n.controlNavScaffold):n.append(n.controlNavScaffold),m.controlNav.set(),m.controlNav.active(),n.controlNavScaffold.delegate("a, img",l,function(e){if(e.preventDefault(),""===c||c===e.type){var i=t(this),r=n.controlNav.index(i);i.hasClass(o+"active")||(n.direction=r>n.currentSlide?"next":"prev",n.flexAnimate(r,n.vars.pauseOnAction))}""===c&&(c=e.type),m.setToClearWatchedEvent()})},setupManual:function(){n.controlNav=n.manualControls,m.controlNav.active(),n.controlNav.bind(l,function(e){if(e.preventDefault(),""===c||c===e.type){var i=t(this),r=n.controlNav.index(i);i.hasClass(o+"active")||(n.direction=r>n.currentSlide?"next":"prev",n.flexAnimate(r,n.vars.pauseOnAction))}""===c&&(c=e.type),m.setToClearWatchedEvent()})},set:function(){var e="thumbnails"===n.vars.controlNav?"img":"a";n.controlNav=t("."+o+"control-nav li "+e,n.controlsContainer?n.controlsContainer:n)},active:function(){n.controlNav.removeClass(o+"active").eq(n.animatingTo).addClass(o+"active")},update:function(e,i){n.pagingCount>1&&"add"===e?n.controlNavScaffold.append(t("<li><a>"+n.count+"</a></li>")):1===n.pagingCount?n.controlNavScaffold.find("li").remove():n.controlNav.eq(i).closest("li").remove(),m.controlNav.set(),n.pagingCount>1&&n.pagingCount!==n.controlNav.length?n.update(i,e):m.controlNav.active()}},directionNav:{setup:function(){var e=t('<ul class="'+o+'direction-nav"><li><a class="'+o+'prev" href="#">'+n.vars.prevText+'</a></li><li><a class="'+o+'next" href="#">'+n.vars.nextText+"</a></li></ul>");n.controlsContainer?(t(n.controlsContainer).append(e),n.directionNav=t("."+o+"direction-nav li a",n.controlsContainer)):(n.append(e),n.directionNav=t("."+o+"direction-nav li a",n)),m.directionNav.update(),n.directionNav.bind(l,function(e){e.preventDefault();var i;(""===c||c===e.type)&&(i=n.getTarget(t(this).hasClass(o+"next")?"next":"prev"),n.flexAnimate(i,n.vars.pauseOnAction)),""===c&&(c=e.type),m.setToClearWatchedEvent()})},update:function(){var t=o+"disabled";1===n.pagingCount?n.directionNav.addClass(t).attr("tabindex","-1"):n.vars.animationLoop?n.directionNav.removeClass(t).removeAttr("tabindex"):0===n.animatingTo?n.directionNav.removeClass(t).filter("."+o+"prev").addClass(t).attr("tabindex","-1"):n.animatingTo===n.last?n.directionNav.removeClass(t).filter("."+o+"next").addClass(t).attr("tabindex","-1"):n.directionNav.removeClass(t).removeAttr("tabindex")}},pausePlay:{setup:function(){var e=t('<div class="'+o+'pauseplay"><a></a></div>');n.controlsContainer?(n.controlsContainer.append(e),n.pausePlay=t("."+o+"pauseplay a",n.controlsContainer)):(n.append(e),n.pausePlay=t("."+o+"pauseplay a",n)),m.pausePlay.update(n.vars.slideshow?o+"pause":o+"play"),n.pausePlay.bind(l,function(e){e.preventDefault(),(""===c||c===e.type)&&(t(this).hasClass(o+"pause")?(n.manualPause=!0,n.manualPlay=!1,n.pause()):(n.manualPause=!1,n.manualPlay=!0,n.play())),""===c&&(c=e.type),m.setToClearWatchedEvent()})},update:function(t){"play"===t?n.pausePlay.removeClass(o+"pause").addClass(o+"play").html(n.vars.playText):n.pausePlay.removeClass(o+"play").addClass(o+"pause").html(n.vars.pauseText)}},touch:function(){function t(t){n.animating?t.preventDefault():(window.navigator.msPointerEnabled||1===t.touches.length)&&(n.pause(),g=h?n.h:n.w,y=Number(new Date),w=t.touches[0].pageX,x=t.touches[0].pageY,m=d&&u&&n.animatingTo===n.last?0:d&&u?n.limit-(n.itemW+n.vars.itemMargin)*n.move*n.animatingTo:d&&n.currentSlide===n.last?n.limit:d?(n.itemW+n.vars.itemMargin)*n.move*n.currentSlide:u?(n.last-n.currentSlide+n.cloneOffset)*g:(n.currentSlide+n.cloneOffset)*g,c=h?x:w,f=h?w:x,e.addEventListener("touchmove",i,!1),e.addEventListener("touchend",r,!1))}function i(t){w=t.touches[0].pageX,x=t.touches[0].pageY,v=h?c-x:c-w,_=h?Math.abs(v)<Math.abs(w-f):Math.abs(v)<Math.abs(x-f);var e=500;(!_||Number(new Date)-y>e)&&(t.preventDefault(),!p&&n.transitions&&(n.vars.animationLoop||(v/=0===n.currentSlide&&0>v||n.currentSlide===n.last&&v>0?Math.abs(v)/g+2:1),n.setProps(m+v,"setTouch")))}function r(){if(e.removeEventListener("touchmove",i,!1),n.animatingTo===n.currentSlide&&!_&&null!==v){var t=u?-v:v,o=n.getTarget(t>0?"next":"prev");n.canAdvance(o)&&(Number(new Date)-y<550&&Math.abs(t)>50||Math.abs(t)>g/2)?n.flexAnimate(o,n.vars.pauseOnAction):p||n.flexAnimate(n.currentSlide,n.vars.pauseOnAction,!0)}e.removeEventListener("touchend",r,!1),c=null,f=null,v=null,m=null}function o(t){t.stopPropagation(),n.animating?t.preventDefault():(n.pause(),e._gesture.addPointer(t.pointerId),b=0,g=h?n.h:n.w,y=Number(new Date),m=d&&u&&n.animatingTo===n.last?0:d&&u?n.limit-(n.itemW+n.vars.itemMargin)*n.move*n.animatingTo:d&&n.currentSlide===n.last?n.limit:d?(n.itemW+n.vars.itemMargin)*n.move*n.currentSlide:u?(n.last-n.currentSlide+n.cloneOffset)*g:(n.currentSlide+n.cloneOffset)*g)}function s(t){t.stopPropagation();var i=t.target._slider;if(i){var n=-t.translationX,r=-t.translationY;return b+=h?r:n,v=b,_=h?Math.abs(b)<Math.abs(-n):Math.abs(b)<Math.abs(-r),t.detail===t.MSGESTURE_FLAG_INERTIA?void setImmediate(function(){e._gesture.stop()}):void((!_||Number(new Date)-y>500)&&(t.preventDefault(),!p&&i.transitions&&(i.vars.animationLoop||(v=b/(0===i.currentSlide&&0>b||i.currentSlide===i.last&&b>0?Math.abs(b)/g+2:1)),i.setProps(m+v,"setTouch"))))}}function l(t){t.stopPropagation();var e=t.target._slider;if(e){if(e.animatingTo===e.currentSlide&&!_&&null!==v){var i=u?-v:v,n=e.getTarget(i>0?"next":"prev");e.canAdvance(n)&&(Number(new Date)-y<550&&Math.abs(i)>50||Math.abs(i)>g/2)?e.flexAnimate(n,e.vars.pauseOnAction):p||e.flexAnimate(e.currentSlide,e.vars.pauseOnAction,!0)}c=null,f=null,v=null,m=null,b=0}}var c,f,m,g,v,y,_=!1,w=0,x=0,b=0;a?(e.style.msTouchAction="none",e._gesture=new MSGesture,e._gesture.target=e,e.addEventListener("MSPointerDown",o,!1),e._slider=n,e.addEventListener("MSGestureChange",s,!1),e.addEventListener("MSGestureEnd",l,!1)):e.addEventListener("touchstart",t,!1)},resize:function(){!n.animating&&n.is(":visible")&&(d||n.doMath(),p?m.smoothHeight():d?(n.slides.width(n.computedW),n.update(n.pagingCount),n.setProps()):h?(n.viewport.height(n.h),n.setProps(n.h,"setTotal")):(n.vars.smoothHeight&&m.smoothHeight(),n.newSlides.width(n.computedW),n.setProps(n.computedW,"setTotal")))},smoothHeight:function(t){if(!h||p){var e=p?n:n.viewport;t?e.animate({height:n.slides.eq(n.animatingTo).height()},t):e.height(n.slides.eq(n.animatingTo).height())}},sync:function(e){var i=t(n.vars.sync).data("flexslider"),r=n.animatingTo;switch(e){case"animate":i.flexAnimate(r,n.vars.pauseOnAction,!1,!0);break;case"play":!i.playing&&!i.asNav&&i.play();break;case"pause":i.pause()}},pauseInvisible:{visProp:null,init:function(){var t=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var e=0;e<t.length;e++)t[e]+"Hidden"in document&&(m.pauseInvisible.visProp=t[e]+"Hidden");if(m.pauseInvisible.visProp){var i=m.pauseInvisible.visProp.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(i,function(){m.pauseInvisible.isHidden()?n.startTimeout?clearTimeout(n.startTimeout):n.pause():n.started?n.play():n.vars.initDelay>0?setTimeout(n.play,n.vars.initDelay):n.play()})}},isHidden:function(){return document[m.pauseInvisible.visProp]||!1}},setToClearWatchedEvent:function(){clearTimeout(r),r=setTimeout(function(){c=""},3e3)}},n.flexAnimate=function(e,i,r,a,l){if(!n.vars.animationLoop&&e!==n.currentSlide&&(n.direction=e>n.currentSlide?"next":"prev"),f&&1===n.pagingCount&&(n.direction=n.currentItem<e?"next":"prev"),!n.animating&&(n.canAdvance(e,l)||r)&&n.is(":visible")){if(f&&a){var c=t(n.vars.asNavFor).data("flexslider");if(n.atEnd=0===e||e===n.count-1,c.flexAnimate(e,!0,!1,!0,l),n.direction=n.currentItem<e?"next":"prev",c.direction=n.direction,Math.ceil((e+1)/n.visible)-1===n.currentSlide||0===e)return n.currentItem=e,n.slides.removeClass(o+"active-slide").eq(e).addClass(o+"active-slide"),!1;n.currentItem=e,n.slides.removeClass(o+"active-slide").eq(e).addClass(o+"active-slide"),e=Math.floor(e/n.visible)}if(n.animating=!0,n.animatingTo=e,i&&n.pause(),n.vars.before(n),n.syncExists&&!l&&m.sync("animate"),n.vars.controlNav&&m.controlNav.active(),d||n.slides.removeClass(o+"active-slide").eq(e).addClass(o+"active-slide"),n.atEnd=0===e||e===n.last,n.vars.directionNav&&m.directionNav.update(),e===n.last&&(n.vars.end(n),n.vars.animationLoop||n.pause()),p)s?(n.slides.eq(n.currentSlide).css({opacity:0,zIndex:1}),n.slides.eq(e).css({opacity:1,zIndex:2}),n.wrapup(_)):(n.slides.eq(n.currentSlide).css({zIndex:1}).animate({opacity:0},n.vars.animationSpeed,n.vars.easing),n.slides.eq(e).css({zIndex:2}).animate({opacity:1},n.vars.animationSpeed,n.vars.easing,n.wrapup));else{var g,v,y,_=h?n.slides.filter(":first").height():n.computedW;d?(g=n.vars.itemMargin,y=(n.itemW+g)*n.move*n.animatingTo,v=y>n.limit&&1!==n.visible?n.limit:y):v=0===n.currentSlide&&e===n.count-1&&n.vars.animationLoop&&"next"!==n.direction?u?(n.count+n.cloneOffset)*_:0:n.currentSlide===n.last&&0===e&&n.vars.animationLoop&&"prev"!==n.direction?u?0:(n.count+1)*_:u?(n.count-1-e+n.cloneOffset)*_:(e+n.cloneOffset)*_,n.setProps(v,"",n.vars.animationSpeed),n.transitions?(n.vars.animationLoop&&n.atEnd||(n.animating=!1,n.currentSlide=n.animatingTo),n.container.unbind("webkitTransitionEnd transitionend"),n.container.bind("webkitTransitionEnd transitionend",function(){n.wrapup(_)})):n.container.animate(n.args,n.vars.animationSpeed,n.vars.easing,function(){n.wrapup(_)})}n.vars.smoothHeight&&m.smoothHeight(n.vars.animationSpeed)}},n.wrapup=function(t){!p&&!d&&(0===n.currentSlide&&n.animatingTo===n.last&&n.vars.animationLoop?n.setProps(t,"jumpEnd"):n.currentSlide===n.last&&0===n.animatingTo&&n.vars.animationLoop&&n.setProps(t,"jumpStart")),n.animating=!1,n.currentSlide=n.animatingTo,n.vars.after(n)},n.animateSlides=function(){!n.animating&&g&&n.flexAnimate(n.getTarget("next"))},n.pause=function(){clearInterval(n.animatedSlides),n.animatedSlides=null,n.playing=!1,n.vars.pausePlay&&m.pausePlay.update("play"),n.syncExists&&m.sync("pause")},n.play=function(){n.playing&&clearInterval(n.animatedSlides),n.animatedSlides=n.animatedSlides||setInterval(n.animateSlides,n.vars.slideshowSpeed),n.started=n.playing=!0,n.vars.pausePlay&&m.pausePlay.update("pause"),n.syncExists&&m.sync("play")},n.stop=function(){n.pause(),n.stopped=!0},n.canAdvance=function(t,e){var i=f?n.pagingCount-1:n.last;return e?!0:f&&n.currentItem===n.count-1&&0===t&&"prev"===n.direction?!0:f&&0===n.currentItem&&t===n.pagingCount-1&&"next"!==n.direction?!1:t!==n.currentSlide||f?n.vars.animationLoop?!0:n.atEnd&&0===n.currentSlide&&t===i&&"next"!==n.direction?!1:n.atEnd&&n.currentSlide===i&&0===t&&"next"===n.direction?!1:!0:!1},n.getTarget=function(t){return n.direction=t,"next"===t?n.currentSlide===n.last?0:n.currentSlide+1:0===n.currentSlide?n.last:n.currentSlide-1},n.setProps=function(t,e,i){var r=function(){var i=t?t:(n.itemW+n.vars.itemMargin)*n.move*n.animatingTo,r=function(){if(d)return"setTouch"===e?t:u&&n.animatingTo===n.last?0:u?n.limit-(n.itemW+n.vars.itemMargin)*n.move*n.animatingTo:n.animatingTo===n.last?n.limit:i;switch(e){case"setTotal":return u?(n.count-1-n.currentSlide+n.cloneOffset)*t:(n.currentSlide+n.cloneOffset)*t;case"setTouch":return u?t:t;case"jumpEnd":return u?t:n.count*t;case"jumpStart":return u?n.count*t:t;default:return t}}();return-1*r+"px"}();n.transitions&&(r=h?"translate3d(0,"+r+",0)":"translate3d("+r+",0,0)",i=void 0!==i?i/1e3+"s":"0s",n.container.css("-"+n.pfx+"-transition-duration",i)),n.args[n.prop]=r,(n.transitions||void 0===i)&&n.container.css(n.args)},n.setup=function(e){if(p)n.slides.css({width:"100%","float":"left",marginRight:"-100%",position:"relative"}),"init"===e&&(s?n.slides.css({opacity:0,display:"block",webkitTransition:"opacity "+n.vars.animationSpeed/1e3+"s ease",zIndex:1}).eq(n.currentSlide).css({opacity:1,zIndex:2}):n.slides.css({opacity:0,display:"block",zIndex:1}).eq(n.currentSlide).css({zIndex:2}).animate({opacity:1},n.vars.animationSpeed,n.vars.easing)),n.vars.smoothHeight&&m.smoothHeight();else{var i,r;"init"===e&&(n.viewport=t('<div class="'+o+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(n).append(n.container),n.cloneCount=0,n.cloneOffset=0,u&&(r=t.makeArray(n.slides).reverse(),n.slides=t(r),n.container.empty().append(n.slides))),n.vars.animationLoop&&!d&&(n.cloneCount=2,n.cloneOffset=1,"init"!==e&&n.container.find(".clone").remove(),n.container.append(n.slides.first().clone().addClass("clone").attr("aria-hidden","true")).prepend(n.slides.last().clone().addClass("clone").attr("aria-hidden","true"))),n.newSlides=t(n.vars.selector,n),i=u?n.count-1-n.currentSlide+n.cloneOffset:n.currentSlide+n.cloneOffset,h&&!d?(n.container.height(200*(n.count+n.cloneCount)+"%").css("position","absolute").width("100%"),setTimeout(function(){n.newSlides.css({display:"block"}),n.doMath(),n.viewport.height(n.h),n.setProps(i*n.h,"init")},"init"===e?100:0)):(n.container.width(200*(n.count+n.cloneCount)+"%"),n.setProps(i*n.computedW,"init"),setTimeout(function(){n.doMath(),n.newSlides.css({width:n.computedW,"float":"left",display:"block"}),n.vars.smoothHeight&&m.smoothHeight()},"init"===e?100:0))}d||n.slides.removeClass(o+"active-slide").eq(n.currentSlide).addClass(o+"active-slide")},n.doMath=function(){var t=n.slides.first(),e=n.vars.itemMargin,i=n.vars.minItems,r=n.vars.maxItems;n.w=void 0===n.viewport?n.width():n.viewport.width(),n.h=t.height(),n.boxPadding=t.outerWidth()-t.width(),d?(n.itemT=n.vars.itemWidth+e,n.minW=i?i*n.itemT:n.w,n.maxW=r?r*n.itemT-e:n.w,n.itemW=n.minW>n.w?(n.w-e*(i-1))/i:n.maxW<n.w?(n.w-e*(r-1))/r:n.vars.itemWidth>n.w?n.w:n.vars.itemWidth,n.visible=Math.floor(n.w/n.itemW),n.move=n.vars.move>0&&n.vars.move<n.visible?n.vars.move:n.visible,n.pagingCount=Math.ceil((n.count-n.visible)/n.move+1),n.last=n.pagingCount-1,n.limit=1===n.pagingCount?0:n.vars.itemWidth>n.w?n.itemW*(n.count-1)+e*(n.count-1):(n.itemW+e)*n.count-n.w-e):(n.itemW=n.w,n.pagingCount=n.count,n.last=n.count-1),n.computedW=n.itemW-n.boxPadding},n.update=function(t,e){n.doMath(),d||(t<n.currentSlide?n.currentSlide+=1:t<=n.currentSlide&&0!==t&&(n.currentSlide-=1),n.animatingTo=n.currentSlide),n.vars.controlNav&&!n.manualControls&&("add"===e&&!d||n.pagingCount>n.controlNav.length?m.controlNav.update("add"):("remove"===e&&!d||n.pagingCount<n.controlNav.length)&&(d&&n.currentSlide>n.last&&(n.currentSlide-=1,n.animatingTo-=1),m.controlNav.update("remove",n.last))),n.vars.directionNav&&m.directionNav.update()},n.addSlide=function(e,i){var r=t(e);n.count+=1,n.last=n.count-1,h&&u?void 0!==i?n.slides.eq(n.count-i).after(r):n.container.prepend(r):void 0!==i?n.slides.eq(i).before(r):n.container.append(r),n.update(i,"add"),n.slides=t(n.vars.selector+":not(.clone)",n),n.setup(),n.vars.added(n)},n.removeSlide=function(e){var i=isNaN(e)?n.slides.index(t(e)):e;n.count-=1,n.last=n.count-1,isNaN(e)?t(e,n.slides).remove():h&&u?n.slides.eq(n.last).remove():n.slides.eq(e).remove(),n.doMath(),n.update(i,"remove"),n.slides=t(n.vars.selector+":not(.clone)",n),n.setup(),n.vars.removed(n)},m.init()},t(window).blur(function(){focused=!1}).focus(function(){focused=!0}),t.flexslider.defaults={namespace:"flex-",selector:".slides > li",animation:"fade",easing:"swing",direction:"horizontal",reverse:!1,animationLoop:!0,smoothHeight:!1,startAt:0,slideshow:!0,slideshowSpeed:7e3,animationSpeed:600,initDelay:0,randomize:!1,thumbCaptions:!1,pauseOnAction:!0,pauseOnHover:!1,pauseInvisible:!0,useCSS:!0,touch:!0,video:!1,controlNav:!0,directionNav:!0,prevText:"Previous",nextText:"Next",keyboard:!0,multipleKeyboard:!1,mousewheel:!1,pausePlay:!1,pauseText:"Pause",playText:"Play",controlsContainer:"",manualControls:"",sync:"",asNavFor:"",itemWidth:0,itemMargin:0,minItems:1,maxItems:0,move:0,allowOneSlide:!0,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){}},t.fn.flexslider=function(e){if(void 0===e&&(e={}),"object"==typeof e)return this.each(function(){var i=t(this),n=e.selector?e.selector:".slides > li",r=i.find(n);1===r.length&&e.allowOneSlide===!0||0===r.length?(r.fadeIn(400),e.start&&e.start(i)):void 0===i.data("flexslider")&&new t.flexslider(this,e)});var i=t(this).data("flexslider");switch(e){case"play":i.play();break;case"pause":i.pause();break;case"stop":i.stop();break;case"next":i.flexAnimate(i.getTarget("next"),!0);break;case"prev":case"previous":i.flexAnimate(i.getTarget("prev"),!0);break;default:"number"==typeof e&&i.flexAnimate(e,!0)}}}(jQuery),// Copyright (c) 2011-2012, Fred LeBlanc
//   - Redistributions of source code must retain the above copyright
//     copyright notice, this list of conditions and the following
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
function(t){"use strict";var e,i,n;t.extend({roundaboutShapes:{def:"lazySusan",lazySusan:function(t,e,i){return{x:Math.sin(t+e),y:Math.sin(t+3*Math.PI/2+e)/8*i,z:(Math.cos(t+e)+1)/2,scale:Math.sin(t+Math.PI/2+e)/2+.5}}}}),e={bearing:0,tilt:0,minZ:100,maxZ:280,minOpacity:.4,maxOpacity:1,minScale:.4,maxScale:1,duration:600,btnNext:null,btnNextCallback:function(){},btnPrev:null,btnPrevCallback:function(){},btnToggleAutoplay:null,btnStartAutoplay:null,btnStopAutoplay:null,easing:"swing",clickToFocus:!0,clickToFocusCallback:function(){},focusBearing:0,shape:"lazySusan",debug:!1,childSelector:"li",startingChild:null,reflect:!1,floatComparisonThreshold:.001,autoplay:!1,autoplayDuration:1e3,autoplayPauseOnHover:!1,autoplayCallback:function(){},autoplayInitialDelay:0,enableDrag:!1,dropDuration:600,dropEasing:"swing",dropAnimateTo:"nearest",dropCallback:function(){},dragAxis:"x",dragFactor:4,triggerFocusEvents:!0,triggerBlurEvents:!0,responsive:!1},i={autoplayInterval:null,autoplayIsRunning:!1,autoplayStartTimeout:null,animating:!1,childInFocus:-1,touchMoveStartPosition:null,stopAnimation:!1,lastAnimationStep:!1},n={init:function(r,o,a){{var s;(new Date).getTime()}return r="object"==typeof r?r:{},o=t.isFunction(o)?o:function(){},o=t.isFunction(r)?r:o,s=t.extend({},e,r,i),this.each(function(){var e=t(this),i=e.children(s.childSelector).length,r=360/i,l=s.startingChild&&s.startingChild>i-1?i-1:s.startingChild,c=null===s.startingChild?s.bearing:360-l*r,h="static"!==e.css("position")?e.css("position"):"relative";e.css({padding:0,position:h}).addClass("roundabout-holder").data("roundabout",t.extend({},s,{startingChild:l,bearing:c,oppositeOfFocusBearing:n.normalize.apply(null,[s.focusBearing-180]),dragBearing:c,period:r})),a?e.unbind(".roundabout").children(s.childSelector).unbind(".roundabout"):s.responsive&&t(window).bind("resize",function(){n.stopAutoplay.apply(e),n.relayoutChildren.apply(e)}),s.clickToFocus&&e.children(s.childSelector).each(function(i){t(this).bind("click.roundabout",function(){var r=n.getPlacement.apply(e,[i]);return n.isInFocus.apply(e,[r])?void 0:(n.stopAnimation.apply(t(this)),e.data("roundabout").animating||n.animateBearingToFocus.apply(e,[r,e.data("roundabout").clickToFocusCallback]),!1)})}),s.btnNext&&t(s.btnNext).bind("click.roundabout",function(){return e.data("roundabout").animating||n.animateToNextChild.apply(e,[e.data("roundabout").btnNextCallback]),!1}),s.btnPrev&&t(s.btnPrev).bind("click.roundabout",function(){return n.animateToPreviousChild.apply(e,[e.data("roundabout").btnPrevCallback]),!1}),s.btnToggleAutoplay&&t(s.btnToggleAutoplay).bind("click.roundabout",function(){return n.toggleAutoplay.apply(e),!1}),s.btnStartAutoplay&&t(s.btnStartAutoplay).bind("click.roundabout",function(){return n.startAutoplay.apply(e),!1}),s.btnStopAutoplay&&t(s.btnStopAutoplay).bind("click.roundabout",function(){return n.stopAutoplay.apply(e),!1}),s.autoplayPauseOnHover&&e.bind("mouseenter.roundabout.autoplay",function(){n.stopAutoplay.apply(e,[!0])}).bind("mouseleave.roundabout.autoplay",function(){n.startAutoplay.apply(e)}),s.enableDrag&&(t.isFunction(e.drag)?t.isFunction(e.drop)?e.drag(function(t,i){var r=e.data("roundabout"),o="x"===r.dragAxis.toLowerCase()?"deltaX":"deltaY";n.stopAnimation.apply(e),n.setBearing.apply(e,[r.dragBearing+i[o]/r.dragFactor])}).drop(function(){var t=e.data("roundabout"),i=n.getAnimateToMethod(t.dropAnimateTo);n.allowAnimation.apply(e),n[i].apply(e,[t.dropDuration,t.dropEasing,t.dropCallback]),t.dragBearing=t.period*n.getNearestChild.apply(e)}):s.debug&&alert("You do not have the drop plugin loaded."):s.debug&&alert("You do not have the drag plugin loaded."),e.each(function(){var e=t(this).get(0),i=t(this).data("roundabout"),r="x"===i.dragAxis.toLowerCase()?"pageX":"pageY",o=n.getAnimateToMethod(i.dropAnimateTo);e.addEventListener&&(e.addEventListener("touchstart",function(t){i.touchMoveStartPosition=t.touches[0][r]},!1),e.addEventListener("touchmove",function(e){var o=(e.touches[0][r]-i.touchMoveStartPosition)/i.dragFactor;e.preventDefault(),n.stopAnimation.apply(t(this)),n.setBearing.apply(t(this),[i.dragBearing+o])},!1),e.addEventListener("touchend",function(e){e.preventDefault(),n.allowAnimation.apply(t(this)),o=n.getAnimateToMethod(i.dropAnimateTo),n[o].apply(t(this),[i.dropDuration,i.dropEasing,i.dropCallback]),i.dragBearing=i.period*n.getNearestChild.apply(t(this))},!1))})),n.initChildren.apply(e,[o,a])})},initChildren:function(e,i){var r=t(this),o=r.data("roundabout");return e=e||function(){},r.children(o.childSelector).each(function(e){var o,a,s,l=n.getPlacement.apply(r,[e]);i&&t(this).data("roundabout")&&(o=t(this).data("roundabout").startWidth,a=t(this).data("roundabout").startHeight,s=t(this).data("roundabout").startFontSize),t(this).addClass("roundabout-moveable-item").css("position","absolute"),t(this).data("roundabout",{startWidth:o||t(this).width(),startHeight:a||t(this).height(),startFontSize:s||parseInt(t(this).css("font-size"),10),degrees:l,backDegrees:n.normalize.apply(null,[l-180]),childNumber:e,currentScale:1,parent:r})}),n.updateChildren.apply(r),o.autoplay&&(o.autoplayStartTimeout=setTimeout(function(){n.startAutoplay.apply(r)},o.autoplayInitialDelay)),r.trigger("ready"),e.apply(r),r},updateChildren:function(){return this.each(function(){var e=t(this),i=e.data("roundabout"),r=-1,o={bearing:i.bearing,tilt:i.tilt,stage:{width:Math.floor(.9*t(this).width()),height:Math.floor(.9*t(this).height())},animating:i.animating,inFocus:i.childInFocus,focusBearingRadian:n.degToRad.apply(null,[i.focusBearing]),shape:t.roundaboutShapes[i.shape]||t.roundaboutShapes[t.roundaboutShapes.def]};o.midStage={width:o.stage.width/2,height:o.stage.height/2},o.nudge={width:o.midStage.width+.05*o.stage.width,height:o.midStage.height+.05*o.stage.height},o.zValues={min:i.minZ,max:i.maxZ,diff:i.maxZ-i.minZ},o.opacity={min:i.minOpacity,max:i.maxOpacity,diff:i.maxOpacity-i.minOpacity},o.scale={min:i.minScale,max:i.maxScale,diff:i.maxScale-i.minScale},e.children(i.childSelector).each(function(a){!n.updateChild.apply(e,[t(this),o,a,function(){t(this).trigger("ready")}])||o.animating&&!i.lastAnimationStep?t(this).removeClass("roundabout-in-focus"):(r=a,t(this).addClass("roundabout-in-focus"))}),r!==o.inFocus&&(i.triggerBlurEvents&&e.children(i.childSelector).eq(o.inFocus).trigger("ra-blur"),i.childInFocus=r,i.triggerFocusEvents&&-1!==r&&e.children(i.childSelector).eq(r).trigger("ra-focus")),e.trigger("childrenUpdated")})},updateChild:function(e,i,r,o){var a,s=this,l=t(e),c=l.data("roundabout"),h=[],u=n.degToRad.apply(null,[360-c.degrees+i.bearing]);return o=o||function(){},u=n.normalizeRad.apply(null,[u]),a=i.shape(u,i.focusBearingRadian,i.tilt),a.scale=a.scale>1?1:a.scale,a.adjustedScale=(i.scale.min+i.scale.diff*a.scale).toFixed(4),a.width=(a.adjustedScale*c.startWidth).toFixed(4),a.height=(a.adjustedScale*c.startHeight).toFixed(4),l.css({left:(a.x*i.midStage.width+i.nudge.width-a.width/2).toFixed(0)+"px",top:(a.y*i.midStage.height+i.nudge.height-a.height/2).toFixed(0)+"px",width:a.width+"px",height:a.height+"px",opacity:(i.opacity.min+i.opacity.diff*a.scale).toFixed(2),zIndex:Math.round(i.zValues.min+i.zValues.diff*a.z),fontSize:(a.adjustedScale*c.startFontSize).toFixed(1)+"px"}),c.currentScale=a.adjustedScale,s.data("roundabout").debug&&(h.push('<div style="font-weight: normal; font-size: 10px; padding: 2px; width: '+l.css("width")+'; background-color: #ffc;">'),h.push('<strong style="font-size: 12px; white-space: nowrap;">Child '+r+"</strong><br />"),h.push("<strong>left:</strong> "+l.css("left")+"<br />"),h.push("<strong>top:</strong> "+l.css("top")+"<br />"),h.push("<strong>width:</strong> "+l.css("width")+"<br />"),h.push("<strong>opacity:</strong> "+l.css("opacity")+"<br />"),h.push("<strong>height:</strong> "+l.css("height")+"<br />"),h.push("<strong>z-index:</strong> "+l.css("z-index")+"<br />"),h.push("<strong>font-size:</strong> "+l.css("font-size")+"<br />"),h.push("<strong>scale:</strong> "+l.data("roundabout").currentScale),h.push("</div>"),l.html(h.join(""))),l.trigger("reposition"),o.apply(s),n.isInFocus.apply(s,[c.degrees])},setBearing:function(e,i){return i=i||function(){},e=n.normalize.apply(null,[e]),this.each(function(){var i,r=t(this),o=r.data("roundabout"),a=o.bearing;o.bearing=e,r.trigger("bearingSet"),n.updateChildren.apply(r),i=Math.abs(a-e),!o.animating||i>180||(i=Math.abs(a-e),r.children(o.childSelector).each(function(){var i;n.isChildBackDegreesBetween.apply(t(this),[e,a])&&(i=a>e?"Clockwise":"Counterclockwise",t(this).trigger("move"+i+"ThroughBack"))}))}),i.apply(this),this},adjustBearing:function(e,i){return i=i||function(){},0===e?this:(this.each(function(){n.setBearing.apply(t(this),[t(this).data("roundabout").bearing+e])}),i.apply(this),this)},setTilt:function(e,i){return i=i||function(){},this.each(function(){t(this).data("roundabout").tilt=e,n.updateChildren.apply(t(this))}),i.apply(this),this},adjustTilt:function(e,i){return i=i||function(){},this.each(function(){n.setTilt.apply(t(this),[t(this).data("roundabout").tilt+e])}),i.apply(this),this},animateToBearing:function(e,i,r,o,a){var s=(new Date).getTime();return a=a||function(){},t.isFunction(o)?(a=o,o=null):t.isFunction(r)?(a=r,r=null):t.isFunction(i)&&(a=i,i=null),this.each(function(){var l,c,h,u=t(this),d=u.data("roundabout"),p=i?i:d.duration,f=r?r:d.easing||"swing";return o||(o={timerStart:s,start:d.bearing,totalTime:p}),l=s-o.timerStart,d.stopAnimation?(n.allowAnimation.apply(u),void(d.animating=!1)):void(p>l?(d.animating||u.trigger("animationStart"),d.animating=!0,"string"==typeof t.easing.def?(c=t.easing[f]||t.easing[t.easing.def],h=c(null,l,o.start,e-o.start,o.totalTime)):h=t.easing[f](l/o.totalTime,l,o.start,e-o.start,o.totalTime),n.compareVersions.apply(null,[t().jquery,"1.7.2"])>=0&&!t.easing.easeOutBack&&(h=o.start+(e-o.start)*h),h=n.normalize.apply(null,[h]),d.dragBearing=h,n.setBearing.apply(u,[h,function(){setTimeout(function(){n.animateToBearing.apply(u,[e,p,f,o,a])},0)}])):(d.lastAnimationStep=!0,e=n.normalize.apply(null,[e]),n.setBearing.apply(u,[e,function(){u.trigger("animationEnd")}]),d.animating=!1,d.lastAnimationStep=!1,d.dragBearing=e,a.apply(u)))}),this},animateToNearbyChild:function(e,i){var r=e[0],o=e[1],a=e[2]||function(){};return t.isFunction(o)?(a=o,o=null):t.isFunction(r)&&(a=r,r=null),this.each(function(){var e,s,l=t(this),c=l.data("roundabout"),h=c.reflect?c.bearing:c.bearing%360,u=l.children(c.childSelector).length;if(!c.animating)if(c.reflect&&"previous"===i||!c.reflect&&"next"===i){for(h=Math.abs(h)<c.floatComparisonThreshold?360:h,e=0;u>e;e+=1)if(s={lower:c.period*e,upper:c.period*(e+1)},s.upper=e===u-1?360:s.upper,h<=Math.ceil(s.upper)&&h>=Math.floor(s.lower)){2===u&&360===h?n.animateToDelta.apply(l,[-180,r,o,a]):n.animateBearingToFocus.apply(l,[s.lower,r,o,a]);break}}else for(h=Math.abs(h)<c.floatComparisonThreshold||360-Math.abs(h)<c.floatComparisonThreshold?0:h,e=u-1;e>=0;e-=1)if(s={lower:c.period*e,upper:c.period*(e+1)},s.upper=e===u-1?360:s.upper,h>=Math.floor(s.lower)&&h<Math.ceil(s.upper)){2===u&&360===h?n.animateToDelta.apply(l,[180,r,o,a]):n.animateBearingToFocus.apply(l,[s.upper,r,o,a]);break}})},animateToNearestChild:function(e,i,r){return r=r||function(){},t.isFunction(i)?(r=i,i=null):t.isFunction(e)&&(r=e,e=null),this.each(function(){var o=n.getNearestChild.apply(t(this));n.animateToChild.apply(t(this),[o,e,i,r])})},animateToChild:function(e,i,r,o){return o=o||function(){},t.isFunction(r)?(o=r,r=null):t.isFunction(i)&&(o=i,i=null),this.each(function(){var a,s=t(this),l=s.data("roundabout");l.childInFocus===e||l.animating||(a=s.children(l.childSelector).eq(e),n.animateBearingToFocus.apply(s,[a.data("roundabout").degrees,i,r,o]))})},animateToNextChild:function(){return n.animateToNearbyChild.apply(this,[arguments,"next"])},animateToPreviousChild:function(){return n.animateToNearbyChild.apply(this,[arguments,"previous"])},animateToDelta:function(e,i,r,o){return o=o||function(){},t.isFunction(r)?(o=r,r=null):t.isFunction(i)&&(o=i,i=null),this.each(function(){var a=t(this).data("roundabout").bearing+e;n.animateToBearing.apply(t(this),[a,i,r,o])})},animateBearingToFocus:function(e,i,r,o){return o=o||function(){},t.isFunction(r)?(o=r,r=null):t.isFunction(i)&&(o=i,i=null),this.each(function(){var a=t(this).data("roundabout").bearing-e;a=Math.abs(360-a)<Math.abs(a)?360-a:-a,a=a>180?-(360-a):a,0!==a&&n.animateToDelta.apply(t(this),[a,i,r,o])})},stopAnimation:function(){return this.each(function(){t(this).data("roundabout").stopAnimation=!0})},allowAnimation:function(){return this.each(function(){t(this).data("roundabout").stopAnimation=!1})},startAutoplay:function(e){return this.each(function(){var i=t(this),r=i.data("roundabout");e=e||r.autoplayCallback||function(){},clearInterval(r.autoplayInterval),r.autoplayInterval=setInterval(function(){n.animateToNextChild.apply(i,[e])},r.autoplayDuration),r.autoplayIsRunning=!0,i.trigger("autoplayStart")})},stopAutoplay:function(e){return this.each(function(){clearInterval(t(this).data("roundabout").autoplayInterval),t(this).data("roundabout").autoplayInterval=null,t(this).data("roundabout").autoplayIsRunning=!1,e||t(this).unbind(".autoplay"),t(this).trigger("autoplayStop")})},toggleAutoplay:function(e){return this.each(function(){var i=t(this),r=i.data("roundabout");e=e||r.autoplayCallback||function(){},n.isAutoplaying.apply(t(this))?n.stopAutoplay.apply(t(this),[e]):n.startAutoplay.apply(t(this),[e])})},isAutoplaying:function(){return this.data("roundabout").autoplayIsRunning},changeAutoplayDuration:function(e){return this.each(function(){var i=t(this),r=i.data("roundabout");r.autoplayDuration=e,n.isAutoplaying.apply(i)&&(n.stopAutoplay.apply(i),setTimeout(function(){n.startAutoplay.apply(i)},10))})},normalize:function(t){var e=t%360;return 0>e?360+e:e},normalizeRad:function(t){for(;0>t;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t},isChildBackDegreesBetween:function(e,i){var n=t(this).data("roundabout").backDegrees;return e>i?n>=i&&e>n:i>n&&n>=e},getAnimateToMethod:function(t){return t=t.toLowerCase(),"next"===t?"animateToNextChild":"previous"===t?"animateToPreviousChild":"animateToNearestChild"},relayoutChildren:function(){return this.each(function(){var e=t(this),i=t.extend({},e.data("roundabout"));i.startingChild=e.data("roundabout").childInFocus,n.init.apply(e,[i,null,!0])})},getNearestChild:function(){var e=t(this),i=e.data("roundabout"),n=e.children(i.childSelector).length;return i.reflect?Math.round(i.bearing/i.period)%n:(n-Math.round(i.bearing/i.period)%n)%n},degToRad:function(t){return n.normalize.apply(null,[t])*Math.PI/180},getPlacement:function(t){var e=this.data("roundabout");return e.reflect?e.period*t:360-e.period*t},isInFocus:function(t){var e,i=this,r=i.data("roundabout"),o=n.normalize.apply(null,[r.bearing]);return t=n.normalize.apply(null,[t]),e=Math.abs(o-t),e<=r.floatComparisonThreshold||e>=360-r.floatComparisonThreshold},getChildInFocus:function(){var e=t(this).data("roundabout");return e.childInFocus>-1?e.childInFocus:!1},compareVersions:function(t,e){var i,n=t.split(/\./i),r=e.split(/\./i),o=n.length>r.length?n.length:r.length;for(i=0;o>=i;i++){if(n[i]&&!r[i]&&0!==parseInt(n[i],10))return 1;if(r[i]&&!n[i]&&0!==parseInt(r[i],10))return-1;if(n[i]!==r[i]&&n[i]&&r[i])return parseInt(n[i],10)>parseInt(r[i],10)?1:-1}return 0}},t.fn.roundabout=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof e||t.isFunction(e)||!e?n.init.apply(this,arguments):void t.error("Method "+e+" does not exist for jQuery.roundabout.")}}(jQuery),// Copyright 2013 JÃ¶rn Zaefferer
function(t){t.extend(t.fn,{validate:function(e){if(!this.length)return void(e&&e.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var i=t.data(this[0],"validator");return i?i:(this.attr("novalidate","novalidate"),i=new t.validator(e,this[0]),t.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(e){i.settings.submitHandler&&(i.submitButton=e.target),t(e.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==t(e.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(e){function n(){var n;return i.settings.submitHandler?(i.submitButton&&(n=t("<input type='hidden'/>").attr("name",i.submitButton.name).val(t(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,e),i.submitButton&&n.remove(),!1):!0}return i.settings.debug&&e.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)},valid:function(){if(t(this[0]).is("form"))return this.validate().form();var e=!0,i=t(this[0].form).validate();return this.each(function(){e=e&&i.element(this)}),e},removeAttrs:function(e){var i={},n=this;return t.each(e.split(/\s/),function(t,e){i[e]=n.attr(e),n.removeAttr(e)}),i},rules:function(e,i){var n=this[0];if(e){var r=t.data(n.form,"validator").settings,o=r.rules,a=t.validator.staticRules(n);switch(e){case"add":t.extend(a,t.validator.normalizeRule(i)),delete a.messages,o[n.name]=a,i.messages&&(r.messages[n.name]=t.extend(r.messages[n.name],i.messages));break;case"remove":if(!i)return delete o[n.name],a;var s={};return t.each(i.split(/\s/),function(t,e){s[e]=a[e],delete a[e]}),s}}var l=t.validator.normalizeRules(t.extend({},t.validator.classRules(n),t.validator.attributeRules(n),t.validator.dataRules(n),t.validator.staticRules(n)),n);if(l.required){var c=l.required;delete l.required,l=t.extend({required:c},l)}return l}}),t.extend(t.expr[":"],{blank:function(e){return!t.trim(""+t(e).val())},filled:function(e){return!!t.trim(""+t(e).val())},unchecked:function(e){return!t(e).prop("checked")}}),t.validator=function(e,i){this.settings=t.extend(!0,{},t.validator.defaults,e),this.currentForm=i,this.init()},t.validator.format=function(e,i){return 1===arguments.length?function(){var i=t.makeArray(arguments);return i.unshift(e),t.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!==Array&&(i=t.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),t.each(i,function(t,i){e=e.replace(new RegExp("\\{"+t+"\\}","g"),function(){return i})}),e)},t.extend(t.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:t([]),errorLabelContainer:t([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t){this.lastActive=t,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(t)).hide())},onfocusout:function(t){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){(9!==e.which||""!==this.elementValue(t))&&(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(e,i,n){"radio"===e.type?this.findByName(e.name).addClass(i).removeClass(n):t(e).addClass(i).removeClass(n)},unhighlight:function(e,i,n){"radio"===e.type?this.findByName(e.name).removeClass(i).addClass(n):t(e).removeClass(i).addClass(n)}},setDefaults:function(e){t.extend(t.validator.defaults,e)},messages:{required:"Este campo es obligatorio",remote:"Por favor, corrige este campo",email:"Por favor, comprueba el e-mail",url:"Por favor, introduce una URL v\xe1lida",date:"Por favor, introduce una fecha v\xe1lida",dateISO:"Please enter a valid date (ISO)",number:"Por favor, introduce un n\xfamero v\xe1lido",digits:"S\xf3lo d\xedgitos",creditcard:"Introduce un n\xfamero de tarjeta v\xe1lido",equalTo:"Los campos deben de ser iguales",maxlength:t.validator.format("Como m\xe1ximo {0} caracteres"),minlength:t.validator.format("Como m\xednimo {0} caracteres"),rangelength:t.validator.format("Introduce un valor de entre {0} y {1} caracteres"),range:t.validator.format("Introduce un valor entre {0} y {1}"),max:t.validator.format("Introduce un valor igual o menor a {0}"),min:t.validator.format("Introduce un valor mayor o igual a {0}")},autoCreateRanges:!1,prototype:{init:function(){function e(e){var i=t.data(this[0].form,"validator"),n="on"+e.type.replace(/^validate/,"");i.settings[n]&&i.settings[n].call(i,this[0],e)}this.labelContainer=t(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||t(this.currentForm),this.containers=t(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i=this.groups={};t.each(this.settings.groups,function(e,n){"string"==typeof n&&(n=n.split(/\s/)),t.each(n,function(t,n){i[n]=e})});var n=this.settings.rules;t.each(n,function(e,i){n[e]=t.validator.normalizeRule(i)}),t(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",e).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",e),this.settings.invalidHandler&&t(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),t.extend(this.submitted,this.errorMap),this.invalid=t.extend({},this.errorMap),this.valid()||t(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(e){e=this.validationTargetFor(this.clean(e)),this.lastElement=e,this.prepareElement(e),this.currentElements=t(e);var i=this.check(e)!==!1;return i?delete this.invalid[e.name]:this.invalid[e.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(e){if(e){t.extend(this.errorMap,e),this.errorList=[];for(var i in e)this.errorList.push({message:e[i],element:this.findByName(i)[0]});this.successList=t.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){t.fn.resetForm&&t(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e=0;for(var i in t)e++;return e},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{t(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var e=this.lastActive;return e&&1===t.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var e=this,i={};return t(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!e.objectLength(t(this).rules())?!1:(i[this.name]=!0,!0)})},clean:function(e){return t(e)[0]},errors:function(){var e=this.settings.errorClass.replace(" ",".");return t(this.settings.errorElement+"."+e,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=t([]),this.toHide=t([]),this.currentElements=t([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(e){var i=t(e).attr("type"),n=t(e).val();return"radio"===i||"checkbox"===i?t("input[name='"+t(e).attr("name")+"']:checked").val():"string"==typeof n?n.replace(/\r/g,""):n},check:function(e){e=this.validationTargetFor(this.clean(e));var i,n=t(e).rules(),r=!1,o=this.elementValue(e);for(var a in n){var s={method:a,parameters:n[a]};try{if(i=t.validator.methods[a].call(this,o,e,s.parameters),"dependency-mismatch"===i){r=!0;continue}if(r=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!i)return this.formatAndAdd(e,s),!1}catch(l){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+s.method+"' method.",l),l}}return r?void 0:(this.objectLength(n)&&this.successList.push(e),!0)},customDataMessage:function(e,i){return t(e).data("msg-"+i.toLowerCase())||e.attributes&&t(e).attr("data-msg-"+i.toLowerCase())},customMessage:function(t,e){var i=this.settings.messages[t];return i&&(i.constructor===String?i:i[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t];return void 0},defaultMessage:function(e,i){return this.findDefined(this.customMessage(e.name,i),this.customDataMessage(e,i),!this.settings.ignoreTitle&&e.title||void 0,t.validator.messages[i],"<strong>Warning: No message defined for "+e.name+"</strong>")},formatAndAdd:function(e,i){var n=this.defaultMessage(e,i.method),r=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,i.parameters,e):r.test(n)&&(n=t.validator.format(n.replace(r,"{$1}"),i.parameters)),this.errorList.push({message:n,element:e}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e;for(t=0;this.errorList[t];t++){var i=this.errorList[t];this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return t(this.errorList).map(function(){return this.element})},showLabel:function(e,i){var n=this.errorsFor(e);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.html(i)):(n=t("<"+this.settings.errorElement+">").attr("for",this.idOrName(e)).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,t(e)):n.insertAfter(e))),!i&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n,e)),this.toShow=this.toShow.add(n)},errorsFor:function(e){var i=this.idOrName(e);return this.errors().filter(function(){return t(this).attr("for")===i})},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]),t},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(e){return t(this.currentForm).find("[name='"+e+"']")},getLength:function(e,i){switch(i.nodeName.toLowerCase()){case"select":return t("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return e.length},depend:function(t,e){return this.dependTypes[typeof t]?this.dependTypes[typeof t](t,e):!0},dependTypes:{"boolean":function(t){return t},string:function(e,i){return!!t(e,i.form).length},"function":function(t,e){return t(e)}},optional:function(e){var i=this.elementValue(e);return!t.validator.methods.required.call(this,i,e)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(e,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(t(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(t(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e){return t.data(e,"previousValue")||t.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,i){e.constructor===String?this.classRuleSettings[e]=i:t.extend(this.classRuleSettings,e)},classRules:function(e){var i={},n=t(e).attr("class");return n&&t.each(n.split(" "),function(){this in t.validator.classRuleSettings&&t.extend(i,t.validator.classRuleSettings[this])}),i},attributeRules:function(e){var i={},n=t(e),r=n[0].getAttribute("type");for(var o in t.validator.methods){var a;"required"===o?(a=n.get(0).getAttribute(o),""===a&&(a=!0),a=!!a):a=n.attr(o),/min|max/.test(o)&&(null===r||/number|range|text/.test(r))&&(a=Number(a)),a?i[o]=a:r===o&&"range"!==r&&(i[o]=!0)}return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},dataRules:function(e){var i,n,r={},o=t(e);for(i in t.validator.methods)n=o.data("rule-"+i.toLowerCase()),void 0!==n&&(r[i]=n);return r},staticRules:function(e){var i={},n=t.data(e.form,"validator");return n.settings.rules&&(i=t.validator.normalizeRule(n.settings.rules[e.name])||{}),i},normalizeRules:function(e,i){return t.each(e,function(n,r){if(r===!1)return void delete e[n];if(r.param||r.depends){var o=!0;switch(typeof r.depends){case"string":o=!!t(r.depends,i.form).length;break;case"function":o=r.depends.call(i,i)}o?e[n]=void 0!==r.param?r.param:!0:delete e[n]}}),t.each(e,function(n,r){e[n]=t.isFunction(r)?r(i):r}),t.each(["minlength","maxlength"],function(){e[this]&&(e[this]=Number(e[this]))}),t.each(["rangelength","range"],function(){var i;e[this]&&(t.isArray(e[this])?e[this]=[Number(e[this][0]),Number(e[this][1])]:"string"==typeof e[this]&&(i=e[this].split(/[\s,]+/),e[this]=[Number(i[0]),Number(i[1])]))}),t.validator.autoCreateRanges&&(e.min&&e.max&&(e.range=[e.min,e.max],delete e.min,delete e.max),e.minlength&&e.maxlength&&(e.rangelength=[e.minlength,e.maxlength],delete e.minlength,delete e.maxlength)),e},normalizeRule:function(e){if("string"==typeof e){var i={};t.each(e.split(/\s/),function(){i[this]=!0}),e=i}return e},addMethod:function(e,i,n){t.validator.methods[e]=i,t.validator.messages[e]=void 0!==n?n:t.validator.messages[e],i.length<3&&t.validator.addClassRules(e,t.validator.normalizeRule(e))},methods:{required:function(e,i,n){if(!this.depend(n,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var r=t(i).val();return r&&r.length>0}return this.checkable(i)?this.getLength(e,i)>0:t.trim(e).length>0},email:function(t,e){return this.optional(e)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;var i=0,n=0,r=!1;t=t.replace(/\D/g,"");for(var o=t.length-1;o>=0;o--){var a=t.charAt(o);n=parseInt(a,10),r&&(n*=2)>9&&(n-=9),i+=n,r=!r}return i%10===0},minlength:function(e,i,n){var r=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||r>=n},maxlength:function(e,i,n){var r=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||n>=r},rangelength:function(e,i,n){var r=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||r>=n[0]&&r<=n[1]},min:function(t,e,i){return this.optional(e)||t>=i},max:function(t,e,i){return this.optional(e)||i>=t},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},equalTo:function(e,i,n){var r=t(n);return this.settings.onfocusout&&r.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){t(i).valid()}),e===r.val()},remote:function(e,i,n){if(this.optional(i))return"dependency-mismatch";var r=this.previousValue(i);if(this.settings.messages[i.name]||(this.settings.messages[i.name]={}),r.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=r.message,n="string"==typeof n&&{url:n}||n,r.old===e)return r.valid;r.old=e;var o=this;this.startRequest(i);var a={};return a[i.name]=e,t.ajax(t.extend(!0,{url:n,mode:"abort",port:"validate"+i.name,dataType:"json",data:a,success:function(n){o.settings.messages[i.name].remote=r.originalMessage;var a=n===!0||"true"===n;if(a){var s=o.formSubmitted;o.prepareElement(i),o.formSubmitted=s,o.successList.push(i),delete o.invalid[i.name],o.showErrors()}else{var l={},c=n||o.defaultMessage(i,"remote");l[i.name]=r.message=t.isFunction(c)?c(e):c,o.invalid[i.name]=!0,o.showErrors(l)}r.valid=a,o.stopRequest(i,a)}},n)),"pending"}}}),t.format=t.validator.format}(jQuery),function(t){var e={};if(t.ajaxPrefilter)t.ajaxPrefilter(function(t,i,n){var r=t.port;"abort"===t.mode&&(e[r]&&e[r].abort(),e[r]=n)});else{var i=t.ajax;t.ajax=function(n){var r=("mode"in n?n:t.ajaxSettings).mode,o=("port"in n?n:t.ajaxSettings).port;return"abort"===r?(e[o]&&e[o].abort(),e[o]=i.apply(this,arguments),e[o]):i.apply(this,arguments)}}}(jQuery),function(t){t.extend(t.fn,{validateDelegate:function(e,i,n){return this.bind(i,function(i){var r=t(i.target);return r.is(e)?n.apply(r,arguments):void 0})}})}(jQuery),function(t){var e,i,n,r,o,a,s,l="Close",c="BeforeClose",h="AfterClose",u="BeforeAppend",d="MarkupParse",p="Open",f="Change",m="mfp",g="."+m,v="mfp-ready",y="mfp-removing",_="mfp-prevent-close",w=function(){},x=!!window.jQuery,b=t(window),M=function(t,i){e.ev.on(m+t+g,i)},T=function(e,i,n,r){var o=document.createElement("div");return o.className="mfp-"+e,n&&(o.innerHTML=n),r?i&&i.appendChild(o):(o=t(o),i&&o.appendTo(i)),o},E=function(i,n){e.ev.triggerHandler(m+i,n),e.st.callbacks&&(i=i.charAt(0).toLowerCase()+i.slice(1),e.st.callbacks[i]&&e.st.callbacks[i].apply(e,t.isArray(n)?n:[n]))},S=function(){(e.st.focus?e.content.find(e.st.focus).eq(0):e.wrap).focus()},C=function(i){return i===s&&e.currTemplate.closeBtn||(e.currTemplate.closeBtn=t(e.st.closeMarkup.replace("%title%",e.st.tClose)),s=i),e.currTemplate.closeBtn},A=function(){t.magnificPopup.instance||(e=new w,e.init(),t.magnificPopup.instance=e)},P=function(i){if(!t(i).hasClass(_)){var n=e.st.closeOnContentClick,r=e.st.closeOnBgClick;if(n&&r)return!0;if(!e.content||t(i).hasClass("mfp-close")||e.preloader&&i===e.preloader[0])return!0;if(i===e.content[0]||t.contains(e.content[0],i)){if(n)return!0}else if(r&&t.contains(document,i))return!0;return!1}},L=function(){var t=document.createElement("p").style,e=["ms","O","Moz","Webkit"];if(void 0!==t.transition)return!0;for(;e.length;)if(e.pop()+"Transition"in t)return!0;return!1};w.prototype={constructor:w,init:function(){var i=navigator.appVersion;e.isIE7=-1!==i.indexOf("MSIE 7."),e.isIE8=-1!==i.indexOf("MSIE 8."),e.isLowIE=e.isIE7||e.isIE8,e.isAndroid=/android/gi.test(i),e.isIOS=/iphone|ipad|ipod/gi.test(i),e.supportsTransition=L(),e.probablyMobile=e.isAndroid||e.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),n=t(document.body),r=t(document),e.popupsCache={}},open:function(i){var n;if(i.isObj===!1){e.items=i.items.toArray(),e.index=0;var o,s=i.items;for(n=0;n<s.length;n++)if(o=s[n],o.parsed&&(o=o.el[0]),o===i.el[0]){e.index=n;break}}else e.items=t.isArray(i.items)?i.items:[i.items],e.index=i.index||0;if(e.isOpen)return void e.updateItemHTML();e.types=[],a="",e.ev=i.mainEl&&i.mainEl.length?i.mainEl.eq(0):r,i.key?(e.popupsCache[i.key]||(e.popupsCache[i.key]={}),e.currTemplate=e.popupsCache[i.key]):e.currTemplate={},e.st=t.extend(!0,{},t.magnificPopup.defaults,i),e.fixedContentPos="auto"===e.st.fixedContentPos?!e.probablyMobile:e.st.fixedContentPos,e.st.modal&&(e.st.closeOnContentClick=!1,e.st.closeOnBgClick=!1,e.st.showCloseBtn=!1,e.st.enableEscapeKey=!1),e.bgOverlay||(e.bgOverlay=T("bg").on("click"+g,function(){e.close()}),e.wrap=T("wrap").attr("tabindex",-1).on("click"+g,function(t){P(t.target)&&e.close()}),e.container=T("container",e.wrap)),e.contentContainer=T("content"),e.st.preloader&&(e.preloader=T("preloader",e.container,e.st.tLoading));var l=t.magnificPopup.modules;for(n=0;n<l.length;n++){var c=l[n];c=c.charAt(0).toUpperCase()+c.slice(1),e["init"+c].call(e)}E("BeforeOpen"),e.st.showCloseBtn&&(e.st.closeBtnInside?(M(d,function(t,e,i,n){i.close_replaceWith=C(n.type)}),a+=" mfp-close-btn-in"):e.wrap.append(C())),e.st.alignTop&&(a+=" mfp-align-top"),e.wrap.css(e.fixedContentPos?{overflow:e.st.overflowY,overflowX:"hidden",overflowY:e.st.overflowY}:{top:b.scrollTop(),position:"absolute"}),(e.st.fixedBgPos===!1||"auto"===e.st.fixedBgPos&&!e.fixedContentPos)&&e.bgOverlay.css({height:r.height(),position:"absolute"}),e.st.enableEscapeKey&&r.on("keyup"+g,function(t){27===t.keyCode&&e.close()}),b.on("resize"+g,function(){e.updateSize()}),e.st.closeOnContentClick||(a+=" mfp-auto-cursor"),a&&e.wrap.addClass(a);var h=e.wH=b.height(),u={};if(e.fixedContentPos&&e._hasScrollBar(h)){var f=e._getScrollbarSize();f&&(u.paddingRight=f)}e.fixedContentPos&&(e.isIE7?t("body, html").css("overflow","hidden"):u.overflow="hidden");var m=e.st.mainClass;return e.isIE7&&(m+=" mfp-ie7"),m&&e._addClassToMFP(m),e.updateItemHTML(),E("BuildControls"),t("html").css(u),e.bgOverlay.add(e.wrap).prependTo(document.body),e._lastFocusedEl=document.activeElement,setTimeout(function(){e.content?(e._addClassToMFP(v),S()):e.bgOverlay.addClass(v),r.on("focusin"+g,function(i){return i.target===e.wrap[0]||t.contains(e.wrap[0],i.target)?void 0:(S(),!1)})},16),e.isOpen=!0,e.updateSize(h),E(p),i},close:function(){e.isOpen&&(E(c),e.isOpen=!1,e.st.removalDelay&&!e.isLowIE&&e.supportsTransition?(e._addClassToMFP(y),setTimeout(function(){e._close()},e.st.removalDelay)):e._close())},_close:function(){E(l);var i=y+" "+v+" ";if(e.bgOverlay.detach(),e.wrap.detach(),e.container.empty(),e.st.mainClass&&(i+=e.st.mainClass+" "),e._removeClassFromMFP(i),e.fixedContentPos){var n={paddingRight:""};e.isIE7?t("body, html").css("overflow",""):n.overflow="",t("html").css(n)}r.off("keyup"+g+" focusin"+g),e.ev.off(g),e.wrap.attr("class","mfp-wrap").removeAttr("style"),e.bgOverlay.attr("class","mfp-bg"),e.container.attr("class","mfp-container"),!e.st.showCloseBtn||e.st.closeBtnInside&&e.currTemplate[e.currItem.type]!==!0||e.currTemplate.closeBtn&&e.currTemplate.closeBtn.detach(),e._lastFocusedEl&&t(e._lastFocusedEl).focus(),e.currItem=null,e.content=null,e.currTemplate=null,e.prevHeight=0,E(h)},updateSize:function(t){if(e.isIOS){var i=document.documentElement.clientWidth/window.innerWidth,n=window.innerHeight*i;e.wrap.css("height",n),e.wH=n}else e.wH=t||b.height();e.fixedContentPos||e.wrap.css("height",e.wH),E("Resize")},updateItemHTML:function(){var i=e.items[e.index];e.contentContainer.detach(),e.content&&e.content.detach(),i.parsed||(i=e.parseEl(e.index));var n=i.type;if(E("BeforeChange",[e.currItem?e.currItem.type:"",n]),e.currItem=i,!e.currTemplate[n]){var r=e.st[n]?e.st[n].markup:!1;E("FirstMarkupParse",r),e.currTemplate[n]=r?t(r):!0}o&&o!==i.type&&e.container.removeClass("mfp-"+o+"-holder");var a=e["get"+n.charAt(0).toUpperCase()+n.slice(1)](i,e.currTemplate[n]);e.appendContent(a,n),i.preloaded=!0,E(f,i),o=i.type,e.container.prepend(e.contentContainer),E("AfterChange")},appendContent:function(t,i){e.content=t,t?e.st.showCloseBtn&&e.st.closeBtnInside&&e.currTemplate[i]===!0?e.content.find(".mfp-close").length||e.content.append(C()):e.content=t:e.content="",E(u),e.container.addClass("mfp-"+i+"-holder"),e.contentContainer.append(e.content)},parseEl:function(i){var n=e.items[i],r=n.type;if(n=n.tagName?{el:t(n)}:{data:n,src:n.src},n.el){for(var o=e.types,a=0;a<o.length;a++)if(n.el.hasClass("mfp-"+o[a])){r=o[a];break}n.src=n.el.attr("data-mfp-src"),n.src||(n.src=n.el.attr("href"))}return n.type=r||e.st.type||"inline",n.index=i,n.parsed=!0,e.items[i]=n,E("ElementParse",n),e.items[i]},addGroup:function(t,i){var n=function(n){n.mfpEl=this,e._openClick(n,t,i)};i||(i={});var r="click.magnificPopup";i.mainEl=t,i.items?(i.isObj=!0,t.off(r).on(r,n)):(i.isObj=!1,i.delegate?t.off(r).on(r,i.delegate,n):(i.items=t,t.off(r).on(r,n)))},_openClick:function(i,n,r){var o=void 0!==r.midClick?r.midClick:t.magnificPopup.defaults.midClick;if(o||2!==i.which&&!i.ctrlKey&&!i.metaKey){var a=void 0!==r.disableOn?r.disableOn:t.magnificPopup.defaults.disableOn;if(a)if(t.isFunction(a)){if(!a.call(e))return!0}else if(b.width()<a)return!0;i.type&&(i.preventDefault(),e.isOpen&&i.stopPropagation()),r.el=t(i.mfpEl),r.delegate&&(r.items=n.find(r.delegate)),e.open(r)}},updateStatus:function(t,n){if(e.preloader){i!==t&&e.container.removeClass("mfp-s-"+i),n||"loading"!==t||(n=e.st.tLoading);var r={status:t,text:n};E("UpdateStatus",r),t=r.status,n=r.text,e.preloader.html(n),e.preloader.find("a").on("click",function(t){t.stopImmediatePropagation()}),e.container.addClass("mfp-s-"+t),i=t}},_addClassToMFP:function(t){e.bgOverlay.addClass(t),e.wrap.addClass(t)},_removeClassFromMFP:function(t){this.bgOverlay.removeClass(t),e.wrap.removeClass(t)},_hasScrollBar:function(t){return(e.isIE7?r.height():document.body.scrollHeight)>(t||b.height())},_parseMarkup:function(e,i,n){var r;n.data&&(i=t.extend(n.data,i)),E(d,[e,i,n]),t.each(i,function(t,i){if(void 0===i||i===!1)return!0;if(r=t.split("_"),r.length>1){var n=e.find(g+"-"+r[0]);if(n.length>0){var o=r[1];"replaceWith"===o?n[0]!==i[0]&&n.replaceWith(i):"img"===o?n.is("img")?n.attr("src",i):n.replaceWith('<img src="'+i+'" class="'+n.attr("class")+'" />'):n.attr(r[1],i)}}else e.find(g+"-"+t).html(i)})},_getScrollbarSize:function(){if(void 0===e.scrollbarSize){var t=document.createElement("div");t.id="mfp-sbm",t.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(t),e.scrollbarSize=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return e.scrollbarSize}},t.magnificPopup={instance:null,proto:w.prototype,modules:[],open:function(e,i){return A(),e=e?t.extend(!0,{},e):{},e.isObj=!0,e.index=i||0,this.instance.open(e)},close:function(){return t.magnificPopup.instance&&t.magnificPopup.instance.close()},registerModule:function(e,i){i.options&&(t.magnificPopup.defaults[e]=i.options),t.extend(this.proto,i.proto),this.modules.push(e)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},t.fn.magnificPopup=function(i){A();var n=t(this);if("string"==typeof i)if("open"===i){var r,o=x?n.data("magnificPopup"):n[0].magnificPopup,a=parseInt(arguments[1],10)||0;o.items?r=o.items[a]:(r=n,o.delegate&&(r=r.find(o.delegate)),r=r.eq(a)),e._openClick({mfpEl:r},n,o)}else e.isOpen&&e[i].apply(e,Array.prototype.slice.call(arguments,1));else i=t.extend(!0,{},i),x?n.data("magnificPopup",i):n[0].magnificPopup=i,e.addGroup(n,i);return n};var k,I,R,D="inline",z=function(){R&&(I.after(R.addClass(k)).detach(),R=null)};t.magnificPopup.registerModule(D,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){e.types.push(D),M(l+"."+D,function(){z()})},getInline:function(i,n){if(z(),i.src){var r=e.st.inline,o=t(i.src);if(o.length){var a=o[0].parentNode;a&&a.tagName&&(I||(k=r.hiddenClass,I=T(k),k="mfp-"+k),R=o.after(I).detach().removeClass(k)),e.updateStatus("ready")}else e.updateStatus("error",r.tNotFound),o=t("<div>");return i.inlineElement=o,o}return e.updateStatus("ready"),e._parseMarkup(n,{},i),n}}});var O,F=function(i){if(i.data&&void 0!==i.data.title)return i.data.title;var n=e.st.image.titleSrc;if(n){if(t.isFunction(n))return n.call(e,i);if(i.el)return i.el.attr(n)||""}return""};t.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><div class="mfp-img"></div><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var t=e.st.image,i=".image";e.types.push("image"),M(p+i,function(){"image"===e.currItem.type&&t.cursor&&n.addClass(t.cursor)}),M(l+i,function(){t.cursor&&n.removeClass(t.cursor),b.off("resize"+g)}),M("Resize"+i,e.resizeImage),e.isLowIE&&M("AfterChange",e.resizeImage)},resizeImage:function(){var t=e.currItem;if(t&&t.img&&e.st.image.verticalFit){var i=0;e.isLowIE&&(i=parseInt(t.img.css("padding-top"),10)+parseInt(t.img.css("padding-bottom"),10)),t.img.css("max-height",e.wH-i)}},_onImageHasSize:function(t){t.img&&(t.hasSize=!0,O&&clearInterval(O),t.isCheckingImgSize=!1,E("ImageHasSize",t),t.imgHidden&&(e.content&&e.content.removeClass("mfp-loading"),t.imgHidden=!1))},findImageSize:function(t){var i=0,n=t.img[0],r=function(o){O&&clearInterval(O),O=setInterval(function(){return n.naturalWidth>0?void e._onImageHasSize(t):(i>200&&clearInterval(O),i++,void(3===i?r(10):40===i?r(50):100===i&&r(500)))
},o)};r(1)},getImage:function(i,n){var r=0,o=function(){i&&(i.img[0].complete?(i.img.off(".mfploader"),i===e.currItem&&(e._onImageHasSize(i),e.updateStatus("ready")),i.hasSize=!0,i.loaded=!0,E("ImageLoadComplete")):(r++,200>r?setTimeout(o,100):a()))},a=function(){i&&(i.img.off(".mfploader"),i===e.currItem&&(e._onImageHasSize(i),e.updateStatus("error",s.tError.replace("%url%",i.src))),i.hasSize=!0,i.loaded=!0,i.loadError=!0)},s=e.st.image,l=n.find(".mfp-img");if(l.length){var c=document.createElement("img");c.className="mfp-img",i.img=t(c).on("load.mfploader",o).on("error.mfploader",a),c.src=i.src,l.is("img")&&(i.img=i.img.clone()),i.img[0].naturalWidth>0&&(i.hasSize=!0)}return e._parseMarkup(n,{title:F(i),img_replaceWith:i.img},i),e.resizeImage(),i.hasSize?(O&&clearInterval(O),i.loadError?(n.addClass("mfp-loading"),e.updateStatus("error",s.tError.replace("%url%",i.src))):(n.removeClass("mfp-loading"),e.updateStatus("ready")),n):(e.updateStatus("loading"),i.loading=!0,i.hasSize||(i.imgHidden=!0,n.addClass("mfp-loading"),e.findImageSize(i)),n)}}});var N,B=function(){return void 0===N&&(N=void 0!==document.createElement("p").style.MozTransform),N};t.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(t){return t.is("img")?t:t.find("img")}},proto:{initZoom:function(){var t,i=e.st.zoom,n=".zoom";if(i.enabled&&e.supportsTransition){var r,o,a=i.duration,s=function(t){var e=t.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),n="all "+i.duration/1e3+"s "+i.easing,r={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},o="transition";return r["-webkit-"+o]=r["-moz-"+o]=r["-o-"+o]=r[o]=n,e.css(r),e},h=function(){e.content.css("visibility","visible")};M("BuildControls"+n,function(){if(e._allowZoom()){if(clearTimeout(r),e.content.css("visibility","hidden"),t=e._getItemToZoom(),!t)return void h();o=s(t),o.css(e._getOffset()),e.wrap.append(o),r=setTimeout(function(){o.css(e._getOffset(!0)),r=setTimeout(function(){h(),setTimeout(function(){o.remove(),t=o=null,E("ZoomAnimationEnded")},16)},a)},16)}}),M(c+n,function(){if(e._allowZoom()){if(clearTimeout(r),e.st.removalDelay=a,!t){if(t=e._getItemToZoom(),!t)return;o=s(t)}o.css(e._getOffset(!0)),e.wrap.append(o),e.content.css("visibility","hidden"),setTimeout(function(){o.css(e._getOffset())},16)}}),M(l+n,function(){e._allowZoom()&&(h(),o&&o.remove(),t=null)})}},_allowZoom:function(){return"image"===e.currItem.type},_getItemToZoom:function(){return e.currItem.hasSize?e.currItem.img:!1},_getOffset:function(i){var n;n=i?e.currItem.img:e.st.zoom.opener(e.currItem.el||e.currItem);var r=n.offset(),o=parseInt(n.css("padding-top"),10),a=parseInt(n.css("padding-bottom"),10);r.top-=t(window).scrollTop()-o;var s={width:n.width(),height:(x?n.innerHeight():n[0].offsetHeight)-a-o};return B()?s["-moz-transform"]=s.transform="translate("+r.left+"px,"+r.top+"px)":(s.left=r.left,s.top=r.top),s}}});var U="iframe",H="//about:blank",G=function(t){if(e.currTemplate[U]){var i=e.currTemplate[U].find("iframe");i.length&&(t||(i[0].src=H),e.isIE8&&i.css("display",t?"block":"none"))}};t.magnificPopup.registerModule(U,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){e.types.push(U),M("BeforeChange",function(t,e,i){e!==i&&(e===U?G():i===U&&G(!0))}),M(l+"."+U,function(){G()})},getIframe:function(i,n){var r=i.src,o=e.st.iframe;t.each(o.patterns,function(){return r.indexOf(this.index)>-1?(this.id&&(r="string"==typeof this.id?r.substr(r.lastIndexOf(this.id)+this.id.length,r.length):this.id.call(this,r)),r=this.src.replace("%id%",r),!1):void 0});var a={};return o.srcAction&&(a[o.srcAction]=r),e._parseMarkup(n,a,i),e.updateStatus("ready"),n}}})}(window.jQuery||window.Zepto),function(t){function e(t,e){return function(i){return l(t.call(this,i),e)}}function i(t,e){return function(i){return this.lang().ordinal(t.call(this,i),e)}}function n(){}function r(t){w(t),a(this,t)}function o(t){var e=f(t),i=e.year||0,n=e.month||0,r=e.week||0,o=e.day||0,a=e.hour||0,s=e.minute||0,l=e.second||0,c=e.millisecond||0;this._input=t,this._milliseconds=+c+1e3*l+6e4*s+36e5*a,this._days=+o+7*r,this._months=+n+12*i,this._data={},this._bubble()}function a(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return e.hasOwnProperty("toString")&&(t.toString=e.toString),e.hasOwnProperty("valueOf")&&(t.valueOf=e.valueOf),t}function s(t){return 0>t?Math.ceil(t):Math.floor(t)}function l(t,e){for(var i=t+"";i.length<e;)i="0"+i;return i}function c(t,e,i,n){var r,o,a=e._milliseconds,s=e._days,l=e._months;a&&t._d.setTime(+t._d+a*i),(s||l)&&(r=t.minute(),o=t.hour()),s&&t.date(t.date()+s*i),l&&t.month(t.month()+l*i),a&&!n&&ee.updateOffset(t),(s||l)&&(t.minute(r),t.hour(o))}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function u(t){return"[object Date]"===Object.prototype.toString.call(t)}function d(t,e,i){var n,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),a=0;for(n=0;r>n;n++)(i&&t[n]!==e[n]||!i&&g(t[n])!==g(e[n]))&&a++;return a+o}function p(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=ze[t]||Oe[e]||e}return t}function f(t){var e,i,n={};for(i in t)t.hasOwnProperty(i)&&(e=p(i),e&&(n[e]=t[i]));return n}function m(e){var i,n;if(0===e.indexOf("week"))i=7,n="day";else{if(0!==e.indexOf("month"))return;i=12,n="month"}ee[e]=function(r,o){var a,s,l=ee.fn._lang[e],c=[];if("number"==typeof r&&(o=r,r=t),s=function(t){var e=ee().utc().set(n,t);return l.call(ee.fn._lang,e,r||"")},null!=o)return s(o);for(a=0;i>a;a++)c.push(s(a));return c}}function g(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=e>=0?Math.floor(e):Math.ceil(e)),i}function v(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function y(t){return _(t)?366:365}function _(t){return 0===t%4&&0!==t%100||0===t%400}function w(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[ae]<0||t._a[ae]>11?ae:t._a[se]<1||t._a[se]>v(t._a[oe],t._a[ae])?se:t._a[le]<0||t._a[le]>23?le:t._a[ce]<0||t._a[ce]>59?ce:t._a[he]<0||t._a[he]>59?he:t._a[ue]<0||t._a[ue]>999?ue:-1,t._pf._overflowDayOfYear&&(oe>e||e>se)&&(e=se),t._pf.overflow=e)}function x(t){t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1}}function b(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length)),t._isValid}function M(t){return t?t.toLowerCase().replace("_","-"):t}function T(t,e){return e.abbr=t,de[t]||(de[t]=new n),de[t].set(e),de[t]}function E(t){delete de[t]}function S(t){var e,i,n,r,o=0,a=function(t){if(!de[t]&&pe)try{require("./lang/"+t)}catch(e){}return de[t]};if(!t)return ee.fn._lang;if(!h(t)){if(i=a(t))return i;t=[t]}for(;o<t.length;){for(r=M(t[o]).split("-"),e=r.length,n=M(t[o+1]),n=n?n.split("-"):null;e>0;){if(i=a(r.slice(0,e).join("-")))return i;if(n&&n.length>=e&&d(r,n,!0)>=e-1)break;e--}o++}return ee.fn._lang}function C(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function A(t){var e,i,n=t.match(ve);for(e=0,i=n.length;i>e;e++)n[e]=Ue[n[e]]?Ue[n[e]]:C(n[e]);return function(r){var o="";for(e=0;i>e;e++)o+=n[e]instanceof Function?n[e].call(r,t):n[e];return o}}function P(t,e){return t.isValid()?(e=L(e,t.lang()),Fe[e]||(Fe[e]=A(e)),Fe[e](t)):t.lang().invalidDate()}function L(t,e){function i(t){return e.longDateFormat(t)||t}var n=5;for(ye.lastIndex=0;n>=0&&ye.test(t);)t=t.replace(ye,i),ye.lastIndex=0,n-=1;return t}function k(t,e){var i;switch(t){case"DDDD":return xe;case"YYYY":case"GGGG":case"gggg":return be;case"YYYYY":case"GGGGG":case"ggggg":return Me;case"S":case"SS":case"SSS":case"DDD":return we;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Te;case"a":case"A":return S(e._l)._meridiemParse;case"X":return Ce;case"Z":case"ZZ":return Ee;case"T":return Se;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return _e;default:return i=new RegExp(B(N(t.replace("\\","")),"i"))}}function I(t){var e=(Ee.exec(t)||[])[0],i=(e+"").match(Ie)||["-",0,0],n=+(60*i[1])+g(i[2]);return"+"===i[0]?-n:n}function R(t,e,i){var n,r=i._a;switch(t){case"M":case"MM":null!=e&&(r[ae]=g(e)-1);break;case"MMM":case"MMMM":n=S(i._l).monthsParse(e),null!=n?r[ae]=n:i._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(r[se]=g(e));break;case"DDD":case"DDDD":null!=e&&(i._dayOfYear=g(e));break;case"YY":r[oe]=g(e)+(g(e)>68?1900:2e3);break;case"YYYY":case"YYYYY":r[oe]=g(e);break;case"a":case"A":i._isPm=S(i._l).isPM(e);break;case"H":case"HH":case"h":case"hh":r[le]=g(e);break;case"m":case"mm":r[ce]=g(e);break;case"s":case"ss":r[he]=g(e);break;case"S":case"SS":case"SSS":r[ue]=g(1e3*("0."+e));break;case"X":i._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=I(e);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":t=t.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(i._w=i._w||{},i._w[t]=e)}}function D(t){var e,i,n,r,o,a,s,l,c,h,u=[];if(!t._d){for(n=O(t),t._w&&null==t._a[se]&&null==t._a[ae]&&(o=function(e){return e?e.length<3?parseInt(e,10)>68?"19"+e:"20"+e:e:null==t._a[oe]?ee().weekYear():t._a[oe]},a=t._w,null!=a.GG||null!=a.W||null!=a.E?s=$(o(a.GG),a.W||1,a.E,4,1):(l=S(t._l),c=null!=a.d?Y(a.d,l):null!=a.e?parseInt(a.e,10)+l._week.dow:0,h=parseInt(a.w,10)||1,null!=a.d&&c<l._week.dow&&h++,s=$(o(a.gg),h,c,l._week.doy,l._week.dow)),t._a[oe]=s.year,t._dayOfYear=s.dayOfYear),t._dayOfYear&&(r=null==t._a[oe]?n[oe]:t._a[oe],t._dayOfYear>y(r)&&(t._pf._overflowDayOfYear=!0),i=W(r,0,t._dayOfYear),t._a[ae]=i.getUTCMonth(),t._a[se]=i.getUTCDate()),e=0;3>e&&null==t._a[e];++e)t._a[e]=u[e]=n[e];for(;7>e;e++)t._a[e]=u[e]=null==t._a[e]?2===e?1:0:t._a[e];u[le]+=g((t._tzm||0)/60),u[ce]+=g((t._tzm||0)%60),t._d=(t._useUTC?W:j).apply(null,u)}}function z(t){var e;t._d||(e=f(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],D(t))}function O(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function F(t){t._a=[],t._pf.empty=!0;var e,i,n,r,o,a=S(t._l),s=""+t._i,l=s.length,c=0;for(n=L(t._f,a).match(ve)||[],e=0;e<n.length;e++)r=n[e],i=(k(r,t).exec(s)||[])[0],i&&(o=s.substr(0,s.indexOf(i)),o.length>0&&t._pf.unusedInput.push(o),s=s.slice(s.indexOf(i)+i.length),c+=i.length),Ue[r]?(i?t._pf.empty=!1:t._pf.unusedTokens.push(r),R(r,i,t)):t._strict&&!i&&t._pf.unusedTokens.push(r);t._pf.charsLeftOver=l-c,s.length>0&&t._pf.unusedInput.push(s),t._isPm&&t._a[le]<12&&(t._a[le]+=12),t._isPm===!1&&12===t._a[le]&&(t._a[le]=0),D(t),w(t)}function N(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,r){return e||i||n||r})}function B(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function U(t){var e,i,n,r,o;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(0/0));for(r=0;r<t._f.length;r++)o=0,e=a({},t),x(e),e._f=t._f[r],F(e),b(e)&&(o+=e._pf.charsLeftOver,o+=10*e._pf.unusedTokens.length,e._pf.score=o,(null==n||n>o)&&(n=o,i=e));a(t,i||e)}function H(t){var e,i=t._i,n=Ae.exec(i);if(n){for(e=4;e>0;e--)if(n[e]){t._f=Le[e-1]+(n[6]||" ");break}for(e=0;4>e;e++)if(ke[e][1].exec(i)){t._f+=ke[e][0];break}Ee.exec(i)&&(t._f+=" Z"),F(t)}else t._d=new Date(i)}function G(e){var i=e._i,n=fe.exec(i);i===t?e._d=new Date:n?e._d=new Date(+n[1]):"string"==typeof i?H(e):h(i)?(e._a=i.slice(0),D(e)):u(i)?e._d=new Date(+i):"object"==typeof i?z(e):e._d=new Date(i)}function j(t,e,i,n,r,o,a){var s=new Date(t,e,i,n,r,o,a);return 1970>t&&s.setFullYear(t),s}function W(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function Y(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function V(t,e,i,n,r){return r.relativeTime(e||1,!!i,t,n)}function X(t,e,i){var n=re(Math.abs(t)/1e3),r=re(n/60),o=re(r/60),a=re(o/24),s=re(a/365),l=45>n&&["s",n]||1===r&&["m"]||45>r&&["mm",r]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",re(a/30)]||1===s&&["y"]||["yy",s];return l[2]=e,l[3]=t>0,l[4]=i,V.apply({},l)}function q(t,e,i){var n,r=i-e,o=i-t.day();return o>r&&(o-=7),r-7>o&&(o+=7),n=ee(t).add("d",o),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function $(t,e,i,n,r){var o,a,s=new Date(Date.UTC(t,0)).getUTCDay();return i=null!=i?i:r,o=r-s+(s>n?7:0),a=7*(e-1)+(i-r)+o+1,{year:a>0?t:t-1,dayOfYear:a>0?a:y(t-1)+a}}function Z(t){var e=t._i,i=t._f;return"undefined"==typeof t._pf&&x(t),null===e?ee.invalid({nullInput:!0}):("string"==typeof e&&(t._i=e=S().preparse(e)),ee.isMoment(e)?(t=a({},e),t._d=new Date(+e._d)):i?h(i)?U(t):F(t):G(t),new r(t))}function Q(t,e){ee.fn[t]=ee.fn[t+"s"]=function(t){var i=this._isUTC?"UTC":"";return null!=t?(this._d["set"+i+e](t),ee.updateOffset(this),this):this._d["get"+i+e]()}}function K(t){ee.duration.fn[t]=function(){return this._data[t]}}function J(t,e){ee.duration.fn["as"+t]=function(){return+this/e}}function te(){"undefined"==typeof ender&&(this.moment=ee)}for(var ee,ie,ne="2.3.1",re=Math.round,oe=0,ae=1,se=2,le=3,ce=4,he=5,ue=6,de={},pe="undefined"!=typeof module&&module.exports,fe=/^\/?Date\((\-?\d+)/i,me=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,ge=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ve=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,ye=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,_e=/\d\d?/,we=/\d{1,3}/,xe=/\d{3}/,be=/\d{1,4}/,Me=/[+\-]?\d{1,6}/,Te=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ee=/Z|[\+\-]\d\d:?\d\d/i,Se=/T/i,Ce=/[\+\-]?\d+(\.\d{1,3})?/,Ae=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?$/,Pe="YYYY-MM-DDTHH:mm:ssZ",Le=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],ke=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ie=/([\+\-]|\d\d)/gi,Re="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),De={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ze={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Oe={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Fe={},Ne="DDD w W M D d".split(" "),Be="M D H h m s w W".split(" "),Ue={M:function(){return this.month()+1},MMM:function(t){return this.lang().monthsShort(this,t)},MMMM:function(t){return this.lang().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.lang().weekdaysMin(this,t)},ddd:function(t){return this.lang().weekdaysShort(this,t)},dddd:function(t){return this.lang().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return g(this.milliseconds()/100)},SS:function(){return l(g(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+l(g(t/60),2)+":"+l(g(t)%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+l(g(10*t/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},He=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Ne.length;)ie=Ne.pop(),Ue[ie+"o"]=i(Ue[ie],ie);for(;Be.length;)ie=Be.pop(),Ue[ie+ie]=e(Ue[ie],2);for(Ue.DDDD=e(Ue.DDD,3),a(n.prototype,{set:function(t){var e,i;for(i in t)e=t[i],"function"==typeof e?this[i]=e:this["_"+i]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,i,n;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(i=ee.utc([2e3,e]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[e]=new RegExp(n.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(i=ee([2e3,1]).day(e),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[e]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var i=this._calendar[t];return"function"==typeof i?i.apply(e):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,i,n){var r=this._relativeTime[i];return"function"==typeof r?r(t,e,i,n):r.replace(/%d/i,t)},pastFuture:function(t,e){var i=this._relativeTime[t>0?"future":"past"];return"function"==typeof i?i(e):i.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return q(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),ee=function(e,i,n,r){return"boolean"==typeof n&&(r=n,n=t),Z({_i:e,_f:i,_l:n,_strict:r,_isUTC:!1})},ee.utc=function(e,i,n,r){var o;return"boolean"==typeof n&&(r=n,n=t),o=Z({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:i,_strict:r}).utc()},ee.unix=function(t){return ee(1e3*t)},ee.duration=function(t,e){var i,n,r,a=ee.isDuration(t),s="number"==typeof t,l=a?t._input:s?{}:t,c=null;return s?e?l[e]=t:l.milliseconds=t:(c=me.exec(t))?(i="-"===c[1]?-1:1,l={y:0,d:g(c[se])*i,h:g(c[le])*i,m:g(c[ce])*i,s:g(c[he])*i,ms:g(c[ue])*i}):(c=ge.exec(t))&&(i="-"===c[1]?-1:1,r=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*i},l={y:r(c[2]),M:r(c[3]),d:r(c[4]),h:r(c[5]),m:r(c[6]),s:r(c[7]),w:r(c[8])}),n=new o(l),a&&t.hasOwnProperty("_lang")&&(n._lang=t._lang),n},ee.version=ne,ee.defaultFormat=Pe,ee.updateOffset=function(){},ee.lang=function(t,e){var i;return t?(e?T(M(t),e):null===e?(E(t),t="en"):de[t]||S(t),i=ee.duration.fn._lang=ee.fn._lang=S(t),i._abbr):ee.fn._lang._abbr},ee.langData=function(t){return t&&t._lang&&t._lang._abbr&&(t=t._lang._abbr),S(t)},ee.isMoment=function(t){return t instanceof r},ee.isDuration=function(t){return t instanceof o},ie=He.length-1;ie>=0;--ie)m(He[ie]);for(ee.normalizeUnits=function(t){return p(t)},ee.invalid=function(t){var e=ee.utc(0/0);return null!=t?a(e._pf,t):e._pf.userInvalidated=!0,e},ee.parseZone=function(t){return ee(t).parseZone()},a(ee.fn=r.prototype,{clone:function(){return ee(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return P(ee(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return b(this)},isDSTShifted:function(){return this._a?this.isValid()&&d(this._a,(this._isUTC?ee.utc(this._a):ee(this._a)).toArray())>0:!1},parsingFlags:function(){return a({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(t){var e=P(this,t||ee.defaultFormat);return this.lang().postformat(e)},add:function(t,e){var i;return i="string"==typeof t?ee.duration(+e,t):ee.duration(t,e),c(this,i,1),this},subtract:function(t,e){var i;return i="string"==typeof t?ee.duration(+e,t):ee.duration(t,e),c(this,i,-1),this},diff:function(t,e,i){var n,r,o=this._isUTC?ee(t).zone(this._offset||0):ee(t).local(),a=6e4*(this.zone()-o.zone());return e=p(e),"year"===e||"month"===e?(n=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-ee(this).startOf("month")-(o-ee(o).startOf("month")))/n,r-=6e4*(this.zone()-ee(this).startOf("month").zone()-(o.zone()-ee(o).startOf("month").zone()))/n,"year"===e&&(r/=12)):(n=this-o,r="second"===e?n/1e3:"minute"===e?n/6e4:"hour"===e?n/36e5:"day"===e?(n-a)/864e5:"week"===e?(n-a)/6048e5:n),i?r:s(r)},from:function(t,e){return ee.duration(this.diff(t)).lang(this.lang()._abbr).humanize(!e)},fromNow:function(t){return this.from(ee(),t)},calendar:function(){var t=this.diff(ee().zone(this.zone()).startOf("day"),"days",!0),e=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){return _(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=Y(t,this.lang()),this.add({d:t-e})):e},month:function(t){var e,i=this._isUTC?"UTC":"";return null!=t?"string"==typeof t&&(t=this.lang().monthsParse(t),"number"!=typeof t)?this:(e=this.date(),this.date(1),this._d["set"+i+"Month"](t),this.date(Math.min(e,this.daysInMonth())),ee.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(t){switch(t=p(t)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),this},endOf:function(t){return t=p(t),this.startOf(t).add("isoWeek"===t?"week":t,1).subtract("ms",1)},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+ee(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+ee(t).startOf(e)},isSame:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)===+ee(t).startOf(e)},min:function(t){return t=ee.apply(null,arguments),this>t?this:t},max:function(t){return t=ee.apply(null,arguments),t>this?this:t},zone:function(t){var e=this._offset||0;return null==t?this._isUTC?e:this._d.getTimezoneOffset():("string"==typeof t&&(t=I(t)),Math.abs(t)<16&&(t=60*t),this._offset=t,this._isUTC=!0,e!==t&&c(this,ee.duration(e-t,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(t){return t=t?ee(t).zone():0,0===(this.zone()-t)%60},daysInMonth:function(){return v(this.year(),this.month())},dayOfYear:function(t){var e=re((ee(this).startOf("day")-ee(this).startOf("year"))/864e5)+1;return null==t?e:this.add("d",t-e)},weekYear:function(t){var e=q(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==t?e:this.add("y",t-e)},isoWeekYear:function(t){var e=q(this,1,4).year;return null==t?e:this.add("y",t-e)},week:function(t){var e=this.lang().week(this);return null==t?e:this.add("d",7*(t-e))},isoWeek:function(t){var e=q(this,1,4).week;return null==t?e:this.add("d",7*(t-e))},weekday:function(t){var e=(this.day()+7-this.lang()._week.dow)%7;return null==t?e:this.add("d",t-e)},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},get:function(t){return t=p(t),this[t]()},set:function(t,e){return t=p(t),"function"==typeof this[t]&&this[t](e),this},lang:function(e){return e===t?this._lang:(this._lang=S(e),this)}}),ie=0;ie<Re.length;ie++)Q(Re[ie].toLowerCase().replace(/s$/,""),Re[ie]);Q("year","FullYear"),ee.fn.days=ee.fn.day,ee.fn.months=ee.fn.month,ee.fn.weeks=ee.fn.week,ee.fn.isoWeeks=ee.fn.isoWeek,ee.fn.toJSON=ee.fn.toISOString,a(ee.duration.fn=o.prototype,{_bubble:function(){var t,e,i,n,r=this._milliseconds,o=this._days,a=this._months,l=this._data;l.milliseconds=r%1e3,t=s(r/1e3),l.seconds=t%60,e=s(t/60),l.minutes=e%60,i=s(e/60),l.hours=i%24,o+=s(i/24),l.days=o%30,a+=s(o/30),l.months=a%12,n=s(a/12),l.years=n},weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*g(this._months/12)},humanize:function(t){var e=+this,i=X(e,!t,this.lang());return t&&(i=this.lang().pastFuture(e,i)),this.lang().postformat(i)},add:function(t,e){var i=ee.duration(t,e);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(t,e){var i=ee.duration(t,e);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(t){return t=p(t),this[t.toLowerCase()+"s"]()},as:function(t){return t=p(t),this["as"+t.charAt(0).toUpperCase()+t.slice(1)+"s"]()},lang:ee.fn.lang,toIsoString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(i?i+"D":"")+(n||r||o?"T":"")+(n?n+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"}});for(ie in De)De.hasOwnProperty(ie)&&(J(ie,De[ie]),K(ie.toLowerCase()));J("Weeks",6048e5),ee.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},ee.lang("en",{ordinal:function(t){var e=t%10,i=1===g(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),pe?(module.exports=ee,te()):"function"==typeof define&&define.amd?define("moment",function(t,e,i){return i.config().noGlobal!==!0&&te(),ee}):te()}.call(this),function(t){"function"==typeof module?module.exports=t(this.jQuery||require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):this.NProgress=t(this.jQuery)}(function(t){function e(t,e,i){return e>t?e:t>i?i:t}function i(t){return 100*(-1+t)}function n(t,e,n){var r;return r="translate3d"===o.positionUsing?{transform:"translate3d("+i(t)+"%,0,0)"}:"translate"===o.positionUsing?{transform:"translate("+i(t)+"%,0)"}:{"margin-left":i(t)+"%"},r.transition="all "+e+"ms "+n,r}var r={};r.version="0.1.2";var o=r.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};return r.configure=function(e){return t.extend(o,e),this},r.status=null,r.set=function(t){var i=r.isStarted();t=e(t,o.minimum,1),r.status=1===t?null:t;var a=r.render(!i),s=a.find('[role="bar"]'),l=o.speed,c=o.easing;return a[0].offsetWidth,a.queue(function(e){""===o.positionUsing&&(o.positionUsing=r.getPositioningCSS()),s.css(n(t,l,c)),1===t?(a.css({transition:"none",opacity:1}),a[0].offsetWidth,setTimeout(function(){a.css({transition:"all "+l+"ms linear",opacity:0}),setTimeout(function(){r.remove(),e()},l)},l)):setTimeout(e,l)}),this},r.isStarted=function(){return"number"==typeof r.status},r.start=function(){r.status||r.set(0);var t=function(){setTimeout(function(){r.status&&(r.trickle(),t())},o.trickleSpeed)};return o.trickle&&t(),this},r.done=function(t){return t||r.status?r.inc(.3+.5*Math.random()).set(1):this},r.inc=function(t){var i=r.status;return i?("number"!=typeof t&&(t=(1-i)*e(Math.random()*i,.1,.95)),i=e(i+t,0,.994),r.set(i)):r.start()},r.trickle=function(){return r.inc(Math.random()*o.trickleRate)},function(){var t=0,e=0;r.promise=function(i){return i&&"resolved"!=i.state()?(0==e&&r.start(),t++,e++,i.always(function(){e--,0==e?(t=0,r.done()):r.set((t-e)/t)}),this):this}}(),r.render=function(e){if(r.isRendered())return t("#nprogress");t("html").addClass("nprogress-busy");var n=t("<div id='nprogress'>").html(o.template),a=e?"-100":i(r.status||0);return n.find('[role="bar"]').css({transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),o.showSpinner||n.find('[role="spinner"]').remove(),n.appendTo(document.body),n},r.remove=function(){t("html").removeClass("nprogress-busy"),t("#nprogress").remove()},r.isRendered=function(){return t("#nprogress").length>0},r.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"},r}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.O=t()}}(function(){var define,module,exports;return function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e){var i=t("./lib/odyssey/story");i.Actions=t("./lib/odyssey/actions"),i.Triggers=t("./lib/odyssey/triggers"),i.Core=t("./lib/odyssey/core"),i.Template=t("./lib/odyssey/template"),i.UI=t("./lib/odyssey/ui"),t("./lib/odyssey/util");for(var n in i.Actions)i[n]=i.Actions[n];for(var n in i.Triggers)i[n]=i.Triggers[n];e.exports=i},{"./lib/odyssey/actions":5,"./lib/odyssey/core":13,"./lib/odyssey/story":14,"./lib/odyssey/template":15,"./lib/odyssey/triggers":17,"./lib/odyssey/ui":23,"./lib/odyssey/util":26}],2:[function(t,e){function i(t){function e(){}return e.toggleClass=function(e){return n(function(){t.toggleClass(e)})},e.addClass=function(e){return n(function(){t.addClass(e)})},e.removeClass=function(e){return n(function(){t.removeClass(e)
})},e}var n=t("../story").Action;e.exports=i},{"../story":14}],3:[function(t,e){function i(){function t(){}return t.log=function(t){return n({enter:function(){console.log("STATE =>",t,arguments)},update:function(){console.log("STATE (.)",t,arguments)},exit:function(){console.log("STATE <=",t,arguments)}})},t}var n=t("../story").Action;e.exports=i},{"../story":14}],4:[function(t,e){var i=t("../story").Action,n=function(t){return{play:function(){return i(function(){t.play()})},pause:function(){return i(function(){t.pause()})},setCurrentTime:function(e){return i(function(){t.currentTime=e})}}};e.exports=n},{"../story":14}],5:[function(t,e){e.exports={Sleep:t("./sleep"),Debug:t("./debug"),Location:t("./location"),Audio:t("./html5audio"),Leaflet:{Marker:t("./leaflet/marker"),Map:t("./leaflet/map"),Popup:t("./leaflet/popup")},CSS:t("./css"),Slides:t("./slides"),MiniProgressBar:t("./mini_progressbar")}},{"./css":2,"./debug":3,"./html5audio":4,"./leaflet/map":6,"./leaflet/marker":7,"./leaflet/popup":8,"./location":9,"./mini_progressbar":10,"./sleep":11,"./slides":12}],6:[function(t,e){function i(t){function e(){}function i(i,r){e[i]=function(){var e=arguments;return n({enter:function(){return this.moveEnd=function(){t.off(r,this.moveEnd,this),this.finish()},t.on(r,this.moveEnd,this),t[i].apply(t,e),!0},clear:function(){t.off(r,this.moveEnd,this)}})}}return e.moveLinearTo=function(e,i,r){var o,a,s=r||{k:2},l=20;return n({enter:function(){a=t.project(t.getCenter()),o=setInterval(function(){var e=t.project(t.getCenter()),i=e.x+(a.x-e.x)*l*.001*s.k,n=e.y+(a.y-e.y)*l*.001*s.k;t.panTo(t.unproject(L.point(i,n)),{animate:!1})},l)},update:function(n){var r=t.project(e),o=t.project(i);a=r.add(o.subtract(r).multiplyBy(n))},exit:function(){clearInterval(o)},clean:function(){this.exit()}})},i("panTo","moveend"),i("setView","moveend"),i("setZoom","zoomend"),e}var n=t("../../story").Action;"undefined"!=typeof window.L&&L.Map.addInitHook(function(){this.actions=i(this)}),e.exports=i},{"../../story":14}],7:[function(t,e){function i(t){function e(){}return e.addTo=function(e){return r(function(){t.addTo(e)})},e.addRemove=function(e){return r({enter:function(){t.addTo(e)},exit:function(){e.removeLayer(t)},clear:function(){e.removeLayer(t)}})},e.icon=function(e,i){return e=L.icon({iconUrl:e}),i=L.icon({iconUrl:i}),r({enter:function(){t.setIcon(e)},exit:function(){t.setIcon(i)},clear:function(){}})},e}function n(t){function e(){}return e.toggleStyle=function(e,i){return r({enter:function(){t.setStyle(i)},exit:function(){t.setStyle(e)},clear:function(){}})},e}var r=t("../../story").Action;"undefined"!=typeof window.L&&(L.Marker.addInitHook(function(){this.actions=i(this)}),L.Path.addInitHook(function(){this.actions=n(this)})),e.exports=i},{"../../story":14}],8:[function(t){function e(t){function e(){}function n(n){e[n]=function(){var e=arguments;return i(function(){t[n].apply(t,e)})}}return n("openOn"),e.openClose=function(e){if(!e)throw new Error("openClose gets map as first param");return i({enter:function(){t.openOn(e)},exit:function(){e.closePopup(t)}})},e}var i=t("../../story").Action;if("undefined"!=typeof window.L){var n=L.Popup.extend({_updatePosition:function(){L.Popup.prototype._updatePosition.call(this);var t=L.point(this.options.offset),e=this._animated;switch(this.options.position){case"left":this._container.style.bottom="auto",this._container.style.left="auto",this._container.style.right=t.x+(e?0:pos.x)+"px";break;case"right":this._container.style.bottom="auto",this._container.style.left=t.x+"px"}}});L.DirectionalPopup=n,L.directionalPopup=function(t,e){return new L.DirectionalPopup(t,e)},L.Popup.addInitHook(function(){this.actions=e(this)})}},{"../../story":14}],9:[function(t,e){var i=t("../story").Action,n=window.location,r={changeHash:function(t){if(void 0===t)throw new Error("hash should be a string");return i(function(){n.hash=t})}};e.exports=r},{"../story":14}],10:[function(t,e){var i=t("../story").Action,n=function(t){var e={position:"fixed",left:0,top:0,height:"3px",display:"inline-block",background:"#ff7373","z-index":2},n={},r=document.createElement("div");r.setAttribute("class","oddysey-miniprogressbar");for(var o in e)r.style[o]=e[o];return(t||document.body).appendChild(r),n.percent=function(t){return i(function(){r.style.width=t+"%"})},n};e.exports=n},{"../story":14}],11:[function(t,e){function i(t){return n({enter:function(){return setTimeout(this.finish,t),!0}})}var n=t("../story").Action;e.exports=i},{"../story":14}],12:[function(t,e){function i(t){function e(){}function i(e){for(var i=r.getElement(t).children,n=0;n<i.length;++n)n===e?i[n].classList.add("selected","selected_slide"):i[n].classList.remove("selected","selected_slide")}return e.activate=function(t){return n(function(){i(t)})},i(-1),e}{var n=t("../story").Action,r=t("../core");t("../util/classList")}e.exports=i},{"../core":13,"../story":14,"../util/classList":24}],13:[function(t,e){function i(t){if("undefined"!=typeof jQuery){if(t instanceof jQuery)return t[0];if("string"==typeof t&&("#"===t[0]||"."===t[0]))return i($(t))}return t instanceof NodeList||t instanceof HTMLCollection?t[0]:t instanceof Element?t:document.getElementById(t)}e.exports={getElement:i}},{}],14:[function(t,e){function i(){function t(){}var e=[],i=[],n=null,r=null;return t.addEvent=function(e,n){return e._story(t,function(){n.enter()}),i.push({a:e,b:n}),t},t.clear=function(){for(var t=e.concat(i),o=0;o<t.length;++o){var a=t[o];a.a.story=null,a.a.trigger=null,a.a.clear&&a.a.clear(),a.b.clear&&a.b.clear()}e=[],i=[],n=null,r=null},t.go=function(i,n){if(n=n||{},0>i&&i>e.length)throw new Error("index should be less than states length");if(t.state()!==i){if(n.reverse){var o=e[i].a;o.reverse&&o.reverse()}if(t.state(i),null!==r){var a=e[r].b;a.exit&&a.exit()}var s=e[i].b;s.enter()}},t.addState=function(i,n,r){var o=e.length;if(!i||!n)throw new Error("action and trigger must be defined");return e.push({a:i,b:n,opts:r}),i._story(t,function(){t.go(o)}),t},t.addLinearState=function(i,n,r){var o=e.length;return e.push({a:i,b:n,opts:r}),i._story(t,function(e){t.state()!==o?t.go(o):n.update&&n.update(e)}),t},t.state=function(t){return void 0===t?n:(r=n,void(n=t))},t}function n(t){var e=d3.dispatch("finish"),i=t;return void 0!==t.enter||"function"==typeof t&&void 0!==t.prototype.enter||(i={enter:t}),d3.rebind(i,e,"on","finish")}function r(t){return t=t||{},t._story=function(t,e){this.trigger=e,this.story=t},t.then=function(t,e){this.trigger=function(){if(t.trigger)t.trigger(),t.reverse&&t.reverse();else{if(!t.call)throw new Error("then first param should be either function or trigger");t.call(e||self)}}},t}function o(){function t(){}function e(){o=a.length}function i(){0===--o&&t.finish()}function r(t){t.on("finish.parallel",function(){t.on("finish.parallel",null),i()})}var o,a=Array.prototype.slice.call(arguments);return t.enter=function(){e();for(var t=0,n=a.length;n>t;++t){var o=a[t];o.enter&&(o.enter()?r(o):i())}},t.exit=function(){e();for(var t=a.length-1;t>=0;--t){var n=a[t];n.exit&&(n.exit()?r(n):i())}},t.clear=function(){for(var t=0,e=a.length;e>t;++t){var i=a[t];i.clear&&i.clear()}},t=n(t)}function a(){function t(){}function e(n){if(0===i.length)return void t.finish();var r=i.pop();r.on&&r.on("finish.chain",function(){r.on("finish.chain",null),e(n)}),r[n]&&r[n]()||(e(n),r.on&&r.on("finish.chain",null))}var i,r=Array.prototype.slice.call(arguments);return t.enter=function(){return i=r.slice().reverse(),e("enter"),!0},t.exit=function(){return i=r.slice(),e("exit"),!0},t.clear=function(){for(var t=0,e=r.length;e>t;++t){var i=r[t];i.clear&&i.clear()}},t=n(t)}function s(t,e){function i(){}var n=0;return t._story(null,function(){0!==n&&i.trigger(),n=0}),e._story(null,function(){1!==n&&i.trigger(),n=1}),r(i)}t("../../vendor/d3.custom"),e.exports={Story:i,Action:n,Trigger:r,Step:a,Parallel:o,Edge:s}},{"../../vendor/d3.custom":32}],15:[function(_dereq_,module,exports){function Slide(t,e,i){function n(t){r(),e.sort(function(t,e){return t.order-e.order}),"map"in Array.prototype||(Array.prototype.map=function(t,e){for(var i=new Array(this.length),n=0,r=this.length;r>n;n++)n in this&&(i[n]=t.call(e,this[n],n,this));return i}),s=O.Step.apply(window,e.map(function(e){var i=e.cmd;try{var n=Function("S","return "+i+";")}catch(r){throw new Error("error while compiling "+i+": "+r.message)}return n(t)}))}function r(){for(var t in c){var i=c[t];switch(t){case"center":var n=i.value;e.push(void 0===c.zoom?{order:i.order,cmd:"S.map.actions.panTo(["+n[0]+","+n[1]+"])"}:{order:i.order,cmd:"S.map.actions.setView(["+n[0]+","+n[1]+"], "+c.zoom.value+")"});case"zoom":c.center||e.push({order:i.order,cmd:"S.map.actions.setZoom("+c.zoom.value+")"})}}}function o(t){return s||n(t),s}var a,s,l=t,c=i;return o.html=function(){return a||(a=markdown.toHTML(["markdown"].concat(l))),a},o.props=function(){return c||{}},o.get=function(t){return(c||{})[t]},o}function trim(t){return t.replace(/^\s+|\s+$/gm,"")}function parseProperties(t){for(var e={},i=t.split("\n"),n=0;n<i.length;++n){var r=prop_re.exec(i[n]);if(r)try{e[trim(r[1])]=JSON.parse(trim(r[2]))}catch(r){}}return e}function md2json(t){for(var e=null,i=[],n={},r=t.slice(1),o=0;o<r.length;++o){var a=r[o],s=!0;if("header"===a[0]&&1===a[1].level)e&&i.push(Slide(e.md_tree,e.actions,e.properties)),e={md_tree:[],html:"",actions:[],properties:{}};else if("para"===a[0])for(var l=1;l<a.length;++l){var c=a[l];if("inlinecode"===c[0]){for(var h=c[1].split("\n"),u=0;u<h.length;++u){var d=h[u];if(""!==trim(d))if(prop_re.exec(d)){var p=parseProperties(c[1]),f=e?e.properties:n;for(var m in p)f[m]={order:u,value:p[m]}}else e&&e.actions.push({cmd:d,order:u})}a.splice(l,1),--l}}s&&e&&e.md_tree.push(a)}e&&i.push(Slide(e.md_tree,e.actions,e.properties)),i.global={};for(var m in n)i.global[m]=n[m].value;return i}function actionsFromMarkdown(t){var e=markdown.parse(t);return md2json(e)}_dereq_("../../vendor/markdown");var mapActions={"move map to current position":function(){var t=this.map.getCenter();return"- center: ["+t.lat.toFixed(4)+", "+t.lng.toFixed(4)+"]\n- zoom: "+this.map.getZoom()},"show marker at current position":function(){var t=this.map.getCenter();return"L.marker(["+t.lat.toFixed(4)+", "+t.lng.toFixed(4)+"]).actions.addRemove(S.map)"},sleep:function(){return"O.Actions.Sleep(1000)"}},Template=function(template){function readMessage(event){function sendMsg(t){event.source.postMessage(JSON.stringify({id:msg.id,data:t}),event.currentTarget?event.currentTarget.location:event.source.location)}var msg=JSON.parse(event.data);if(template.editor=!0,initialized||(configureEditor(),initialized=!0),"md"===msg.type){var actions=actionsFromMarkdown(msg.code);try{template.update(actions),sendMsg(null)}catch(e){sendMsg(e.message)}}else if("actions"===msg.type){var actions=[];if(template.map&&template.map instanceof L.Map)for(var k in mapActions)actions.push(k);if(template.actions)for(var k in template.actions)actions.push(k);sendMsg(actions)}else"get_action"===msg.type?sendMsg(msg.code in mapActions?mapActions[msg.code].call(template):template.actions[msg.code].call(template)):"code"===msg.type?sendMsg(eval(msg.code)):"change_slide"===msg.type&&template.changeSlide&&template.changeSlide(msg.slide)}function configureEditor(){template.map&&template.map instanceof L.Map&&new L.CrossHair("//cartodb.github.io/odyssey.js/img/crosshair.png").addTo(template.map)}var initialized=!1;window.addEventListener?window.addEventListener("message",function(t){readMessage(t)}):window.attachEvent("message",function(t){readMessage(t)}),template.init(function(){}),window.onload=function(){location.pathname.split("/")[1];Template.Storage.load(function(t){template.update(actionsFromMarkdown(t))})}};Template.Storage={save:function(t,e){location.hash="md/"+e+"/"+btoa(t)},load:function(t){if(document.getElementById("md_template"))return void t(document.getElementById("md_template").text);var e=location.hash;if(t&&e){var i=e.split("/");"#md"===i[0]&&t(atob(i.slice(2).join("/")),i[1])}}};var prop_re=/^-([^:]+):(.*)/;Template.parseProperties=parseProperties,module.exports=Template},{"../../vendor/markdown":33}],16:[function(t,e){function i(t){function e(e,o){i[o]=function(){var i=n({});return r(t).on(e,function(){i.trigger()}),i}}var i={};return t=t||document,e("swipeup","swipeUp"),e("swipedown","swipeDown"),e("swipeleft","swipeLeft"),e("swiperight","swipeRight"),i}var n=t("../story").Trigger,r=(t("../core"),t("hammerjs"));e.exports=i},{"../core":13,"../story":14,hammerjs:31}],17:[function(t,e){e.exports={Scroll:t("./scroll"),Sequential:t("./sequential"),Keys:t("./keys"),Video:t("./video"),Gestures:t("./gestures")}},{"./gestures":16,"./keys":18,"./scroll":19,"./sequential":20,"./video":21}],18:[function(t,e){function i(){function t(t,e,i){function n(t){t=t||window.event;var n=t.keyCode;n===e&&(i(),t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}window.addEventListener?t.addEventListener("keydown",function(t){n(t)}):t.attachEvent("onkeydown",function(t){n(t)})}KEY_LEFT=37,KEY_UP=38,KEY_RIGHT=39,KEY_DOWN=40;var e=document,i={};return i.left=function(){var i=n({});return t(e,KEY_LEFT,function(){i.trigger()}),i},i.right=function(){var i=n({});return t(e,KEY_RIGHT,function(){i.trigger()}),i},i.on=function(t){return e=r.getElement(t),i},i}var n=t("../story").Trigger,r=t("../core");e.exports=i},{"../core":13,"../story":14}],19:[function(t,e){function i(t){return function(){return t}}function n(){function t(){}function e(t){l.push(t),a()}function n(t){var e=l.indexOf(t);e>=0&&l.splice(e,1)}function a(){function t(){l.forEach(function(t){t.scroll(window.scrollY)})}c||(c=!0,Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var i,n;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(i=e),n=0;o>n;){var a;n in r&&(a=r[n],t.call(i,a,n,r)),n++}}),window.addEventListener?window.addEventListener("scroll",function(){t()}):s.attachEvent("onscroll",function(){t()}))}var s=window,l=[],c=!1,h=i(0),u=null;return t.reach=function(t){function a(){}return r(a),a.scroll=function(e){var i=o.getElement(t),n=i.getBoundingClientRect(),r=a.offset(),s=u(n,r,e);return null!==s&&void 0!==s&&a.trigger(s),a},a.condition=function(t){return arguments.length?void(u=t):u},a.offset=function(t){return arguments.length?(h="number"==typeof t?i(t):function(){var e=+t.replace("%","");return s.innerHeight*e*.01},a):h()},a.reverse=function(){var e=document.getElementById(t),i=e.getBoundingClientRect(),n=a.offset();s.scrollTo(0,i.top-n)},a.clear=function(){n(a)},e(a),a},t.within=function(e){var i=t.reach(e);return i.condition(function(t,e){if(t.top<=e&&t.bottom>=e){var i=(e-t.top)/(t.bottom-t.top);return i}}),i},t.less=function(e,i){i=i||{};var n,r=t.reach(e);if(i.fixed){var a=o.getElement(e);n=s.scrollY+a.getBoundingClientRect().top}return r.condition(function(t,e,r){var o=i.fixed?n:t.top,a=i.fixed?r:e;return o>=a?0:void 0}),r},t.greater=function(e,i){i=i||{};var n,r=t.reach(e);if(i.fixed){var a=o.getElement(e);n=s.scrollY+a.getBoundingClientRect().top}return r.condition(function(t,e,r){var o=i.fixed?n:t.top,a=i.fixed?r:e;return a>=o?0:void 0}),r},t}var r=t("../story").Trigger,o=t("../core");n._scrolls=[],e.exports=n},{"../core":13,"../story":14}],20:[function(t,e){function i(){function t(){}function e(){for(var t=0;t<r.length;++t)r[t].check()}var i=0,r=[],o=0,a={};return t.state=t.step=function(t){if(t in a)return a[t];var e=n({check:function(){t===i&&this.trigger&&this.trigger()},reverse:function(){i=t}});return o=Math.max(o,t),r.push(e),a[t]=e},t.next=function(){i+=1,i>o&&(i=0),e()},t.clear=function(){return r=[],o=0,i=0,t},t.current=function(t){if(void 0!==t){var n=Math.max(Math.min(o,t),0);return n!==i&&(i=n,e()),this}return i},t.prev=function(){i-=1,0>i&&(i=o),e()},t}var n=t("../story").Trigger;e.exports=i},{"../story":14}],21:[function(t,e){function i(t){if("undefined"==typeof YT||!(t instanceof YT.Player))throw new Error("player should be a YT.Player instance, see youtube API");var e=[],i=setInterval(function(){for(var i=t.getCurrentTime(),n=0;n<e.length;++n){var r=e[n];r.start<=i&&r.end>i&&r.trigger((i-r.start)/(r.end-r.start))}},100),n=function(){0===e.length&&clearInterval(i)};return{between:function(t,i){var r=O.Trigger();return r.start=t,r.end=i,e.push(r),r.clear=function(){e.splice(e.indexOf(r),1),n()},r}}}e.exports=i},{}],22:[function(t,e){function i(t){function e(){return e}function i(){for(var t="<ul>",e=0;r>e;++e)t+='<li><a slide-index="'+e+'" href="#'+e+'"></a></li>';t+="</ul>",o.innerHTML=t}var r=0,o=n.getElement(t),a={};return e.count=function(t){return r=t,i(),e},e.activate=function(t){return O.Action(function(){for(var e=o.children[0].children,i=0;i<e.length;++i)e[i].children[0].setAttribute("class","");e[t].children[0].setAttribute("class","active")})},o.onclick=function(t){t=t||window.event;var e=(t.target||t.srcElement).getAttribute("slide-index"),i=a[e];i&&i.trigger()},e.step=function(t){var e=O.Trigger();return a[t]=e,e},e}var n=t("../core");e.exports=i},{"../core":13}],23:[function(t,e){e.exports={DotProgress:t("./dotprogress")}},{"./dotprogress":22}],24:[function(){"document"in self&&!("classList"in document.createElement("_"))&&!function(t){"use strict";if("Element"in t){var e="classList",i="prototype",n=t.Element[i],r=Object,o=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[i].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},s=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},l=function(t,e){if(""===e)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(t,e)},c=function(t){for(var e=o.call(t.getAttribute("class")||""),i=e?e.split(/\s+/):[],n=0,r=i.length;r>n;n++)this.push(i[n]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},h=c[i]=[],u=function(){return new c(this)};if(s[i]=Error[i],h.item=function(t){return this[t]||null},h.contains=function(t){return t+="",-1!==l(this,t)},h.add=function(){var t,e=arguments,i=0,n=e.length,r=!1;do t=e[i]+"",-1===l(this,t)&&(this.push(t),r=!0);while(++i<n);r&&this._updateClassName()},h.remove=function(){var t,e=arguments,i=0,n=e.length,r=!1;do{t=e[i]+"";var o=l(this,t);-1!==o&&(this.splice(o,1),r=!0)}while(++i<n);r&&this._updateClassName()},h.toggle=function(t,e){t+="";var i=this.contains(t),n=i?e!==!0&&"remove":e!==!1&&"add";return n&&this[n](t),!i},h.toString=function(){return this.join(" ")},r.defineProperty){var d={get:u,enumerable:!0,configurable:!0};try{r.defineProperty(n,e,d)}catch(p){-2146823252===p.number&&(d.enumerable=!1,r.defineProperty(n,e,d))}}else r[i].__defineGetter__&&n.__defineGetter__(e,u)}}(self)},{}],25:[function(){"undefined"!=typeof window.L&&(L.CrossHair=L.Control.extend({initialize:function(t,e){this.image=new Image,this.image.onload=L.bind(this._updatePos,this),this.image.src=t,e&&(this.image.width=e.x,this.image.height=e.y)},_updatePos:function(){if(this._map){var t=this.image.width>>1,e=this.image.height>>1;t=this._map.getSize().x/2-t,e=this._map.getSize().y/2-e,L.DomUtil.setPosition(this.image,{x:t,y:e})}},addTo:function(t){var e=L.Control.prototype.addTo.call(this,t);return this.image.parentNode.setAttribute("class",""),t.on("resize",L.bind(this._updatePos,this)),e},onRemove:function(t){t.off("resize",null,this)},onAdd:function(){return this._updatePos(),this.image}}))},{}],26:[function(t,e){e.exports={CrossHair:t("./crosshair")}},{"./crosshair":25}],27:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],28:[function(t,e){function i(){}var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var i=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),i.length>0)){var n=i.shift();n()}},!0),function(t){i.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],29:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],30:[function(t,e,i){(function(e,n){function r(t,e){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&i._extend(n,e),x(n.showHidden)&&(n.showHidden=!1),x(n.depth)&&(n.depth=2),x(n.colors)&&(n.colors=!1),x(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),l(n,t,n.depth)}function o(t,e){var i=r.styles[e];return i?"["+r.colors[i][0]+"m"+t+"["+r.colors[i][1]+"m":t}function a(t){return t}function s(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function l(t,e,n){if(t.customInspect&&e&&S(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return _(r)||(r=l(t,r,n)),r}var o=c(t,e);if(o)return o;var a=Object.keys(e),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),E(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(e);if(0===a.length){if(S(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(b(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(T(e))return t.stylize(Date.prototype.toString.call(e),"date");if(E(e))return h(e)}var v="",y=!1,w=["{","}"];if(f(e)&&(y=!0,w=["[","]"]),S(e)){var x=e.name?": "+e.name:"";v=" [Function"+x+"]"}if(b(e)&&(v=" "+RegExp.prototype.toString.call(e)),T(e)&&(v=" "+Date.prototype.toUTCString.call(e)),E(e)&&(v=" "+h(e)),0===a.length&&(!y||0==e.length))return w[0]+v+w[1];if(0>n)return b(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var M;return M=y?u(t,e,n,m,a):a.map(function(i){return d(t,e,n,m,i,y)}),t.seen.pop(),p(M,v,w)}function c(t,e){if(x(e))return t.stylize("undefined","undefined");if(_(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,i,n,r){for(var o=[],a=0,s=e.length;s>a;++a)o.push(k(e,String(a))?d(t,e,i,n,String(a),!0):"");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(t,e,i,n,r,!0))}),o}function d(t,e,i,n,r,o){var a,s,c;if(c=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},c.get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),k(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(c.value)<0?(s=g(i)?l(t,c.value,null):l(t,c.value,i-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),x(a)){if(o&&r.match(/^\d+$/))return s;a=JSON.stringify(""+r),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t,e,i){var n=0,r=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function f(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function v(t){return null==t}function y(t){return"number"==typeof t}function _(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function x(t){return void 0===t}function b(t){return M(t)&&"[object RegExp]"===A(t)}function M(t){return"object"==typeof t&&null!==t}function T(t){return M(t)&&"[object Date]"===A(t)}function E(t){return M(t)&&("[object Error]"===A(t)||t instanceof Error)}function S(t){return"function"==typeof t}function C(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function L(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),z[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
var I=/%[sdj%]/g;i.format=function(t){if(!_(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(r(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,o=n.length,a=String(t).replace(I,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return t}}),s=n[i];o>i;s=n[++i])a+=g(s)||!M(s)?" "+s:" "+r(s);return a},i.deprecate=function(t,r){function o(){if(!a){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),a=!0}return t.apply(this,arguments)}if(x(n.process))return function(){return i.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var a=!1;return o};var R,D={};i.debuglog=function(t){if(x(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var n=e.pid;D[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,n,e)}}else D[t]=function(){};return D[t]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=f,i.isBoolean=m,i.isNull=g,i.isNullOrUndefined=v,i.isNumber=y,i.isString=_,i.isSymbol=w,i.isUndefined=x,i.isRegExp=b,i.isObject=M,i.isDate=T,i.isError=E,i.isFunction=S,i.isPrimitive=C,i.isBuffer=t("./support/isBuffer");var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",L(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(t,e){if(!e||!M(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,t("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":29,FWaASH:28,inherits:27}],31:[function(t,e){/*! Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.io/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(t,i){"use strict";function n(){r.READY||(_.determineEventTypes(),y.each(r.gestures,function(t){x.register(t)}),_.onTouch(r.DOCUMENT,f,x.detect),_.onTouch(r.DOCUMENT,m,x.detect),r.READY=!0)}var r=function b(t,e){return new b.Instance(t,e||{})};r.VERSION="1.1.3",r.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},r.DOCUMENT=document,r.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,r.HAS_TOUCHEVENTS="ontouchstart"in t,r.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),r.NO_MOUSEEVENTS=r.HAS_TOUCHEVENTS&&r.IS_MOBILE||r.HAS_POINTEREVENTS,r.CALCULATE_INTERVAL=25;var o={},a=r.DIRECTION_DOWN="down",s=r.DIRECTION_LEFT="left",l=r.DIRECTION_UP="up",c=r.DIRECTION_RIGHT="right",h=r.POINTER_MOUSE="mouse",u=r.POINTER_TOUCH="touch",d=r.POINTER_PEN="pen",p=r.EVENT_START="start",f=r.EVENT_MOVE="move",m=r.EVENT_END="end",g=r.EVENT_RELEASE="release",v=r.EVENT_TOUCH="touch";r.READY=!1,r.plugins=r.plugins||{},r.gestures=r.gestures||{};var y=r.utils={extend:function(t,e,n){for(var r in e)!e.hasOwnProperty(r)||t[r]!==i&&n||(t[r]=e[r]);return t},on:function(t,e,i){t.addEventListener(e,i,!1)},off:function(t,e,i){t.removeEventListener(e,i,!1)},each:function(t,e,n){var r,o;if("forEach"in t)t.forEach(e,n);else if(t.length!==i){for(r=0,o=t.length;o>r;r++)if(e.call(n,t[r],r,t)===!1)return}else for(r in t)if(t.hasOwnProperty(r)&&e.call(n,t[r],r,t)===!1)return},inStr:function(t,e){return t.indexOf(e)>-1},inArray:function(t,e){if(t.indexOf){var i=t.indexOf(e);return-1===i?!1:i}for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return!1},toArray:function(t){return Array.prototype.slice.call(t,0)},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[],n=[],r=[],o=Math.min,a=Math.max;return 1===t.length?{pageX:t[0].pageX,pageY:t[0].pageY,clientX:t[0].clientX,clientY:t[0].clientY}:(y.each(t,function(t){e.push(t.pageX),i.push(t.pageY),n.push(t.clientX),r.push(t.clientY)}),{pageX:(o.apply(Math,e)+a.apply(Math,e))/2,pageY:(o.apply(Math,i)+a.apply(Math,i))/2,clientX:(o.apply(Math,n)+a.apply(Math,n))/2,clientY:(o.apply(Math,r)+a.apply(Math,r))/2})},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY);return i>=n?t.clientX-e.clientX>0?s:c:t.clientY-e.clientY>0?l:a},getDistance:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==l||t==a},setPrefixedCss:function(t,e,i,n){var r=["","Webkit","Moz","O","ms"];e=y.toCamelCase(e);for(var o=0;o<r.length;o++){var a=e;if(r[o]&&(a=r[o]+a.slice(0,1).toUpperCase()+a.slice(1)),a in t.style){t.style[a]=(null==n||n)&&i||"";break}}},toggleBehavior:function(t,e,i){if(e&&t&&t.style){y.each(e,function(e,n){y.setPrefixedCss(t,n,e,i)});var n=i&&function(){return!1};"none"==e.userSelect&&(t.onselectstart=n),"none"==e.userDrag&&(t.ondragstart=n)}},toCamelCase:function(t){return t.replace(/[_-]([a-z])/g,function(t){return t[1].toUpperCase()})}},_=r.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(t,e,i,n){var r=e.split(" ");y.each(r,function(e){y.on(t,e,i),n&&n(e)})},off:function(t,e,i,n){var r=e.split(" ");y.each(r,function(e){y.off(t,e,i),n&&n(e)})},onTouch:function(t,e,i){var n=this,a=function(o){var a,s=o.type.toLowerCase(),l=r.HAS_POINTEREVENTS,c=y.inStr(s,"mouse");c&&n.preventMouseEvents||(c&&e==p&&0===o.button?(n.preventMouseEvents=!1,n.shouldDetect=!0):l&&e==p?n.shouldDetect=1===o.buttons||w.matchType(u,o):c||e!=p||(n.preventMouseEvents=!0,n.shouldDetect=!0),l&&e!=m&&w.updatePointer(e,o),n.shouldDetect&&(a=n.doDetect.call(n,o,e,t,i)),a==m&&(n.preventMouseEvents=!1,n.shouldDetect=!1,w.reset()),l&&e==m&&w.updatePointer(e,o))};return this.on(t,o[e],a),a},doDetect:function(t,e,i,n){var r=this.getTouchList(t,e),o=r.length,a=e,s=r.trigger,l=o;e==p?s=v:e==m&&(s=g,l=r.length-(t.changedTouches?t.changedTouches.length:1)),l>0&&this.started&&(a=f),this.started=!0;var c=this.collectEventData(i,a,r,t);return e!=m&&n.call(x,c),s&&(c.changedLength=l,c.eventType=s,n.call(x,c),c.eventType=a,delete c.changedLength),a==m&&(n.call(x,c),this.started=!1),a},determineEventTypes:function(){var e;return e=r.HAS_POINTEREVENTS?t.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:r.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],o[p]=e[0],o[f]=e[1],o[m]=e[2],o},getTouchList:function(t,e){if(r.HAS_POINTEREVENTS)return w.getTouchList();if(t.touches){if(e==f)return t.touches;var i=[],n=[].concat(y.toArray(t.touches),y.toArray(t.changedTouches)),o=[];return y.each(n,function(t){y.inArray(i,t.identifier)===!1&&o.push(t),i.push(t.identifier)}),o}return t.identifier=1,[t]},collectEventData:function(t,e,i,n){var r=u;return y.inStr(n.type,"mouse")||w.matchType(h,n)?r=h:w.matchType(d,n)&&(r=d),{center:y.getCenter(i),timeStamp:Date.now(),target:n.target,touches:i,eventType:e,pointerType:r,srcEvent:n,preventDefault:function(){var t=this.srcEvent;t.preventManipulation&&t.preventManipulation(),t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return x.stopDetect()}}}},w=r.PointerEvent={pointers:{},getTouchList:function(){var t=[];return y.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){t==m||t!=m&&1!==e.buttons?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e)},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,n={};return n[h]=i===(e.MSPOINTER_TYPE_MOUSE||h),n[u]=i===(e.MSPOINTER_TYPE_TOUCH||u),n[d]=i===(e.MSPOINTER_TYPE_PEN||d),n[t]},reset:function(){this.pointers={}}},x=r.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:y.extend({},e),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst,i=e.options;return y.each(this.gestures,function(n){!this.stopped&&e.enabled&&i[n.name]&&n.handler.call(n,t,e)},this),this.current&&(this.current.lastEvent=t),t.eventType==m&&this.stopDetect(),t}},stopDetect:function(){this.previous=y.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(t,e,i,n,o){var a=this.current,s=!1,l=a.lastCalcEvent,c=a.lastCalcData;l&&t.timeStamp-l.timeStamp>r.CALCULATE_INTERVAL&&(e=l.center,i=t.timeStamp-l.timeStamp,n=t.center.clientX-l.center.clientX,o=t.center.clientY-l.center.clientY,s=!0),(t.eventType==v||t.eventType==g)&&(a.futureCalcEvent=t),(!a.lastCalcEvent||s)&&(c.velocity=y.getVelocity(i,n,o),c.angle=y.getAngle(e,t.center),c.direction=y.getDirection(e,t.center),a.lastCalcEvent=a.futureCalcEvent||t,a.futureCalcEvent=t),t.velocityX=c.velocity.x,t.velocityY=c.velocity.y,t.interimAngle=c.angle,t.interimDirection=c.direction},extendEventData:function(t){var e=this.current,i=e.startEvent,n=e.lastEvent||i;(t.eventType==v||t.eventType==g)&&(i.touches=[],y.each(t.touches,function(t){i.touches.push({clientX:t.clientX,clientY:t.clientY})}));var r=t.timeStamp-i.timeStamp,o=t.center.clientX-i.center.clientX,a=t.center.clientY-i.center.clientY;return this.getCalculatedData(t,n.center,r,o,a),y.extend(t,{startEvent:i,deltaTime:r,deltaX:o,deltaY:a,distance:y.getDistance(i.center,t.center),angle:y.getAngle(i.center,t.center),direction:y.getDirection(i.center,t.center),scale:y.getScale(i.touches,t.touches),rotation:y.getRotation(i.touches,t.touches)}),t},register:function(t){var e=t.defaults||{};return e[t.name]===i&&(e[t.name]=!0),y.extend(r.defaults,e,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}};r.Instance=function(t,e){var i=this;n(),this.element=t,this.enabled=!0,y.each(e,function(t,i){delete e[i],e[y.toCamelCase(i)]=t}),this.options=y.extend(y.extend({},r.defaults),e||{}),this.options.behavior&&y.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=_.onTouch(t,p,function(t){i.enabled&&t.eventType==p?x.startDetect(i,t):t.eventType==v&&x.detect(t)}),this.eventHandlers=[]},r.Instance.prototype={on:function(t,e){var i=this;return _.on(i.element,t,e,function(t){i.eventHandlers.push({gesture:t,handler:e})}),i},off:function(t,e){var i=this;return _.off(i.element,t,e,function(t){var n=y.inArray({gesture:t,handler:e});n!==!1&&i.eventHandlers.splice(n,1)}),i},trigger:function(t,e){e||(e={});var i=r.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var n=this.element;return y.hasParent(e.target,n)&&(n=e.target),n.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this},dispose:function(){var t,e;for(y.toggleBehavior(this.element,this.options.behavior,!1),t=-1;e=this.eventHandlers[++t];)y.off(this.element,e.gesture,e.handler);return this.eventHandlers=[],_.off(this.element,o[p],this.eventStartHandler),null}},function(t){function e(e,n){var r=x.current;if(!(n.options.dragMaxTouches>0&&e.touches.length>n.options.dragMaxTouches))switch(e.eventType){case p:i=!1;break;case f:if(e.distance<n.options.dragMinDistance&&r.name!=t)return;var o=r.startEvent.center;if(r.name!=t&&(r.name=t,n.options.dragDistanceCorrection&&e.distance>0)){var h=Math.abs(n.options.dragMinDistance/e.distance);o.pageX+=e.deltaX*h,o.pageY+=e.deltaY*h,o.clientX+=e.deltaX*h,o.clientY+=e.deltaY*h,e=x.extendEventData(e)}(r.lastEvent.dragLockToAxis||n.options.dragLockToAxis&&n.options.dragLockMinDistance<=e.distance)&&(e.dragLockToAxis=!0);var u=r.lastEvent.direction;e.dragLockToAxis&&u!==e.direction&&(e.direction=y.isVertical(u)?e.deltaY<0?l:a:e.deltaX<0?s:c),i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),n.trigger(t+e.direction,e);var d=y.isVertical(e.direction);(n.options.dragBlockVertical&&d||n.options.dragBlockHorizontal&&!d)&&e.preventDefault();break;case g:i&&e.changedLength<=n.options.dragMaxTouches&&(n.trigger(t+"end",e),i=!1);break;case m:i=!1}}var i=!1;r.gestures.Drag={name:t,index:50,handler:e,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),r.gestures.Gesture={name:"gesture",index:1337,handler:function(t,e){e.trigger(this.name,t)}},function(t){function e(e,n){var r=n.options,o=x.current;switch(e.eventType){case p:clearTimeout(i),o.name=t,i=setTimeout(function(){o&&o.name==t&&n.trigger(t,e)},r.holdTimeout);break;case f:e.distance>r.holdThreshold&&clearTimeout(i);break;case g:clearTimeout(i)}}var i;r.gestures.Hold={name:t,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:e}}("hold"),r.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==g&&e.trigger(this.name,t)}},r.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(t,e){if(t.eventType==g){var i=t.touches.length,n=e.options;if(i<n.swipeMinTouches||i>n.swipeMaxTouches)return;(t.velocityX>n.swipeVelocityX||t.velocityY>n.swipeVelocityY)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},function(t){function e(e,n){var r,o,a=n.options,s=x.current,l=x.previous;switch(e.eventType){case p:i=!1;break;case f:i=i||e.distance>a.tapMaxDistance;break;case m:!y.inStr(e.srcEvent.type,"cancel")&&e.deltaTime<a.tapMaxTime&&!i&&(r=l&&l.lastEvent&&e.timeStamp-l.lastEvent.timeStamp,o=!1,l&&l.name==t&&r&&r<a.doubleTapInterval&&e.distance<a.doubleTapDistance&&(n.trigger("doubletap",e),o=!0),(!o||a.tapAlways)&&(s.name=t,n.trigger(s.name,e)))}}var i=!1;r.gestures.Tap={name:t,index:100,handler:e,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),r.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(t,e){return e.options.preventMouse&&t.pointerType==h?void t.stopDetect():(e.options.preventDefault&&t.preventDefault(),void(t.eventType==v&&e.trigger("touch",t)))}},function(t){function e(e,n){switch(e.eventType){case p:i=!1;break;case f:if(e.touches.length<2)return;var r=Math.abs(1-e.scale),o=Math.abs(e.rotation);if(r<n.options.transformMinScale&&o<n.options.transformMinRotation)return;x.current.name=t,i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),o>n.options.transformMinRotation&&n.trigger("rotate",e),r>n.options.transformMinScale&&(n.trigger("pinch",e),n.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case g:i&&e.changedLength<2&&(n.trigger(t+"end",e),i=!1)}}var i=!1;r.gestures.Transform={name:t,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:e}}("transform"),"function"==typeof define&&define.amd?define(function(){return r}):"undefined"!=typeof e&&e.exports?e.exports=r:t.Hammer=r}(window)},{}],32:[function(){"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0);for(var i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1}),d3=function(){function t(t,e){try{for(var i in e)Object.defineProperty(t.prototype,i,{value:e[i],enumerable:!1})}catch(n){t.prototype=e}}function e(){}function i(){}function n(t){function i(){for(var e,i=n,r=-1,o=i.length;++r<o;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],r=new e;return i.on=function(e,i){var o,a=r.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},i}function r(t,e,i){return function(){var n=i.apply(e,arguments);return n===e?t:n}}var o={version:"3.3.10"};o.map=function(t){var i=new e;if(t instanceof e)t.forEach(function(t,e){i.set(t,e)});else for(var n in t)i.set(n,t[n]);return i},t(e,{has:function(t){return a+t in this},get:function(t){return this[a+t]},set:function(t,e){return this[a+t]=e},remove:function(t){return t=a+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,i){t.push(i)}),t},entries:function(){var t=[];return this.forEach(function(e,i){t.push({key:e,value:i})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===s&&t.call(this,e.substring(1),this[e])}});var a="\x00",s=a.charCodeAt(0);return o.dispatch=function(){for(var t=new i,e=-1,r=arguments.length;++e<r;)t[arguments[e]]=n(t);return t},i.prototype.on=function(t,e){var i=t.indexOf("."),n="";if(i>=0&&(n=t.substring(i+1),t=t.substring(0,i)),t)return arguments.length<2?this[t].on(n):this[t].on(n,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(n,null);return this}},o.rebind=function(t,e){for(var i,n=1,o=arguments.length;++n<o;)t[i=arguments[n]]=r(t,e,e[i]);return t},o}()},{}],33:[function(t){// Copyright (c) 2009-2010 Dominic Baggott
// Copyright (c) 2009-2010 Ash Berlin
// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)
!function(e){function i(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function n(){var e=t("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function r(t){for(var e=0,i=-1;-1!==(i=t.indexOf("\n",i+1));)e++;return e}function o(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(t){if("string"==typeof t)return o(t);var e=t.shift(),i={},n=[];for(!t.length||"object"!=typeof t[0]||t[0]instanceof Array||(i=t.shift());t.length;)n.push(a(t.shift()));var r="";for(var s in i)r+=" "+s+'="'+o(i[s])+'"';return"img"===e||"br"===e||"hr"===e?"<"+e+r+"/>":"<"+e+r+">"+n.join("")+"</"+e+">"}function s(t,e,i){var n;i=i||{};var r=t.slice(0);"function"==typeof i.preprocessTreeNode&&(r=i.preprocessTreeNode(r,e));var o=m(r);if(o){r[1]={};for(n in o)r[1][n]=o[n];o=r[1]}if("string"==typeof r)return r;switch(r[0]){case"header":r[0]="h"+r[1].level,delete r[1].level;break;case"bulletlist":r[0]="ul";break;case"numberlist":r[0]="ol";break;case"listitem":r[0]="li";break;case"para":r[0]="p";break;case"markdown":r[0]="html",o&&delete o.references;break;case"code_block":r[0]="pre",n=o?2:1;var a=["code"];a.push.apply(a,r.splice(n,r.length-n)),r[n]=a;break;case"inlinecode":r[0]="code";break;case"img":r[1].src=r[1].href,delete r[1].href;break;case"linebreak":r[0]="br";break;case"link":r[0]="a";break;case"link_ref":r[0]="a";var l=e[o.ref];if(!l)return o.original;delete o.ref,o.href=l.href,l.title&&(o.title=l.title),delete o.original;break;case"img_ref":r[0]="img";var l=e[o.ref];if(!l)return o.original;delete o.ref,o.src=l.href,l.title&&(o.title=l.title),delete o.original}if(n=1,o){for(var c in r[1]){n=2;break}1===n&&r.splice(n,1)}for(;n<r.length;++n)r[n]=s(r[n],e,i);return r}function l(t){for(var e=m(t)?2:1;e<t.length;)"string"==typeof t[e]?e+1<t.length&&"string"==typeof t[e+1]?t[e]+=t.splice(e+1,1)[0]:++e:(l(t[e]),++e)}function c(t,e){function i(t){this.len_after=t,this.name="close_"+e}var n=t+"_state",r="strong"===t?"em_state":"strong_state";return function(o){if(this[n][0]===e)return this[n].shift(),[o.length,new i(o.length-e.length)];var a=this[r].slice(),s=this[n].slice();this[n].unshift(e);{var l=this.processInline(o.substr(e.length)),c=l[l.length-1];this[n].shift()}if(c instanceof i){l.pop();var h=o.length-c.len_after;return[h,[t].concat(l)]}return this[r]=a,this[n]=s,[e.length,e]}}function h(t){for(var e=t.split(""),i=[""],n=!1;e.length;){var r=e.shift();switch(r){case" ":n?i[i.length-1]+=r:i.push("");break;case"'":case'"':n=!n;break;case"\\":r=e.shift();default:i[i.length-1]+=r}}return i}var u={};u.mk_block=function(t,e,r){1===arguments.length&&(e="\n\n");var o=new String(t);return o.trailing=e,o.inspect=n,o.toSource=i,void 0!==r&&(o.lineNumber=r),o};var d=u.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};u.forEach=Array.prototype.forEach?function(t,e,i){return t.forEach(e,i)}:function(t,e,i){for(var n=0;n<t.length;n++)e.call(i||t,t[n],n,t)},u.isEmpty=function(t){for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0},u.extract_attr=function(t){return d(t)&&t.length>1&&"object"==typeof t[1]&&!d(t[1])?t[1]:void 0};var p=function(t){switch(typeof t){case"undefined":this.dialect=p.dialects.Gruber;break;case"object":this.dialect=t;break;default:if(!(t in p.dialects))throw new Error("Unknown Markdown dialect '"+String(t)+"'");this.dialect=p.dialects[t]}this.em_state=[],this.strong_state=[],this.debug_indent=""};p.dialects={};var f=p.mk_block=u.mk_block,d=u.isArray;p.parse=function(t,e){var i=new p(e);return i.toTree(t)},p.prototype.split_blocks=function(t){t=t.replace(/(\r\n|\n|\r)/g,"\n");var e,i=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,n=[],o=1;for(null!==(e=/^(\s*\n)/.exec(t))&&(o+=r(e[0]),i.lastIndex=e[0].length);null!==(e=i.exec(t));)"\n#"===e[2]&&(e[2]="\n",i.lastIndex--),n.push(f(e[1],e[2],o)),o+=r(e[0]);return n},p.prototype.processBlock=function(t,e){var i=this.dialect.block,n=i.__order__;if("__call__"in i)return i.__call__.call(this,t,e);for(var r=0;r<n.length;r++){var o=i[n[r]].call(this,t,e);if(o)return(!d(o)||o.length>0&&!d(o[0]))&&this.debug(n[r],"didn't return a proper array"),o}return[]},p.prototype.processInline=function(t){return this.dialect.inline.__call__.call(this,String(t))},p.prototype.toTree=function(t,e){var i=t instanceof Array?t:this.split_blocks(t),n=this.tree;try{for(this.tree=e||this.tree||["markdown"];i.length;){var r=this.processBlock(i.shift(),i);r.length&&this.tree.push.apply(this.tree,r)}return this.tree}finally{e&&(this.tree=n)}},p.prototype.debug=function(){var t=Array.prototype.slice.call(arguments);t.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,t),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,t)},p.prototype.loop_re_over_block=function(t,e,i){for(var n,r=e.valueOf();r.length&&null!==(n=t.exec(r));)r=r.substr(n[0].length),i.call(this,n);return r},p.buildBlockOrder=function(t){var e=[];for(var i in t)"__order__"!==i&&"__call__"!==i&&e.push(i);t.__order__=e},p.buildInlinePatterns=function(t){var e=[];for(var i in t)if(!i.match(/^__.*__$/)){var n=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");e.push(1===i.length?n:"(?:"+n+")")}e=e.join("|"),t.__patterns__=e;var r=t.__call__;t.__call__=function(t,i){return void 0!==i?r.call(this,t,i):r.call(this,t,e)}};var m=u.extract_attr;p.renderJsonML=function(t,e){e=e||{},e.root=e.root||!1;var i=[];if(e.root)i.push(a(t));else for(t.shift(),!t.length||"object"!=typeof t[0]||t[0]instanceof Array||t.shift();t.length;)i.push(a(t.shift()));return i.join("\n\n")},p.toHTMLTree=function(t,e,i){"string"==typeof t&&(t=this.parse(t,e));var n=m(t),r={};n&&n.references&&(r=n.references);var o=s(t,r,i);return l(o),o},p.toHTML=function(t,e,i){var n=this.toHTMLTree(t,e,i);return this.renderJsonML(n)};var g={};g.inline_until_char=function(t,e){for(var i=0,n=[];;){if(t.charAt(i)===e)return i++,[i,n];if(i>=t.length)return null;var r=this.dialect.inline.__oneElement__.call(this,t.substr(i));i+=r[0],n.push.apply(n,r.slice(1))}},g.subclassDialect=function(t){function e(){}function i(){}return e.prototype=t.block,i.prototype=t.inline,{block:new e,inline:new i}};var v=u.forEach,m=u.extract_attr,f=u.mk_block,y=u.isEmpty,_=g.inline_until_char,w={block:{atxHeader:function(t,e){var i=t.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!i)return void 0;var n=["header",{level:i[1].length}];return Array.prototype.push.apply(n,this.processInline(i[2])),i[0].length<t.length&&e.unshift(f(t.substr(i[0].length),t.trailing,t.lineNumber+2)),[n]},setextHeader:function(t,e){var i=t.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!i)return void 0;var n="="===i[2]?1:2,r=["header",{level:n},i[1]];return i[0].length<t.length&&e.unshift(f(t.substr(i[0].length),t.trailing,t.lineNumber+2)),[r]},code:function(t,e){var i=[],n=/^(?: {0,3}\t| {4})(.*)\n?/;if(!t.match(n))return void 0;t:for(;;){var r=this.loop_re_over_block(n,t.valueOf(),function(t){i.push(t[1])});if(r.length){e.unshift(f(r,t.trailing));break t}if(!e.length)break t;if(!e[0].match(n))break t;i.push(t.trailing.replace(/[^\n]/g,"").substring(2)),t=e.shift()}return[["code_block",i.join("\n")]]},horizRule:function(t,e){var i=t.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!i)return void 0;var n=[["hr"]];if(i[1]){var r=f(i[1],"",t.lineNumber);n.unshift.apply(n,this.toTree(r,[]))}return i[3]&&e.unshift(f(i[3],t.trailing,t.lineNumber+1)),n},lists:function(){function t(t){return new RegExp("(?:^("+l+"{0,"+t+"} {0,3})("+o+")\\s+)|(^"+l+"{0,"+(t-1)+"}[ ]{0,4})")}function e(t){return t.replace(/ {0,3}\t/g,"    ")}function i(t,e,i,n){if(e)return void t.push(["para"].concat(i));var r=t[t.length-1]instanceof Array&&"para"===t[t.length-1][0]?t[t.length-1]:t;n&&t.length>1&&i.unshift(n);for(var o=0;o<i.length;o++){var a=i[o],s="string"==typeof a;s&&r.length>1&&"string"==typeof r[r.length-1]?r[r.length-1]+=a:r.push(a)}}function n(t,e){for(var i=new RegExp("^("+l+"{"+t+"}.*?\\n?)*$"),n=new RegExp("^"+l+"{"+t+"}","gm"),r=[];e.length>0&&i.exec(e[0]);){var o=e.shift(),a=o.replace(n,"");r.push(f(a,o.trailing,o.lineNumber))}return r}function r(t,e,i){var n=t.list,r=n[n.length-1];if(!(r[1]instanceof Array&&"para"===r[1][0]))if(e+1===i.length)r.push(["para"].concat(r.splice(1,r.length-1)));else{var o=r.pop();r.push(["para"].concat(r.splice(1,r.length-1)),o)}}var o="[*+-]|\\d+\\.",a=/[*+-]/,s=new RegExp("^( {0,3})("+o+")[ 	]+"),l="(?: {0,3}\\t| {4})";return function(o,l){function c(t){var e=a.exec(t[2])?["bulletlist"]:["numberlist"];return p.push({list:e,indent:t[1]}),e}var h=o.match(s);if(!h)return void 0;for(var u,d,p=[],f=c(h),m=!1,g=[p[0].list];;){for(var y=o.split(/(?=\n)/),_="",w="",x=0;x<y.length;x++){w="";var b=y[x].replace(/^\n/,function(t){return w=t,""}),M=t(p.length);if(h=b.match(M),void 0!==h[1]){_.length&&(i(u,m,this.processInline(_),w),m=!1,_=""),h[1]=e(h[1]);var T=Math.floor(h[1].length/4)+1;if(T>p.length)f=c(h),u.push(f),u=f[1]=["listitem"];else{var E=!1;for(d=0;d<p.length;d++)if(p[d].indent===h[1]){f=p[d].list,p.splice(d+1,p.length-(d+1)),E=!0;break}E||(T++,T<=p.length?(p.splice(T,p.length-T),f=p[T-1].list):(f=c(h),u.push(f))),u=["listitem"],f.push(u)}w=""}b.length>h[0].length&&(_+=w+b.substr(h[0].length))}_.length&&(i(u,m,this.processInline(_),w),m=!1,_="");var S=n(p.length,l);S.length>0&&(v(p,r,this),u.push.apply(u,this.toTree(S,[])));var C=l[0]&&l[0].valueOf()||"";if(!C.match(s)&&!C.match(/^ /))break;o=l.shift();var A=this.dialect.block.horizRule(o,l);if(A){g.push.apply(g,A);break}v(p,r,this),m=!0}return g}}(),blockquote:function(t,e){if(!t.match(/^>/m))return void 0;var i=[];if(">"!==t[0]){for(var n=t.split(/\n/),r=[],o=t.lineNumber;n.length&&">"!==n[0][0];)r.push(n.shift()),o++;var a=f(r.join("\n"),"\n",t.lineNumber);i.push.apply(i,this.processBlock(a,[])),t=f(n.join("\n"),t.trailing,o)}for(;e.length&&">"===e[0][0];){var s=e.shift();t=f(t+t.trailing+s,s.trailing,t.lineNumber)}var l=t.replace(/^> ?/gm,""),c=(this.tree,this.toTree(l,["blockquote"])),h=m(c);return h&&h.references&&(delete h.references,y(h)&&c.splice(1,1)),i.push(c),i},referenceDefn:function(t,e){var i=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!t.match(i))return void 0;m(this.tree)||this.tree.splice(1,0,{});var n=m(this.tree);void 0===n.references&&(n.references={});var r=this.loop_re_over_block(i,t,function(t){t[2]&&"<"===t[2][0]&&">"===t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1));var e=n.references[t[1].toLowerCase()]={href:t[2]};void 0!==t[4]?e.title=t[4]:void 0!==t[5]&&(e.title=t[5])});return r.length&&e.unshift(f(r,t.trailing)),[]},para:function(t){return[["para"].concat(this.processInline(t))]}},inline:{__oneElement__:function(t,e,i){var n,r;e=e||this.dialect.inline.__patterns__;var o=new RegExp("([\\s\\S]*?)("+(e.source||e)+")");if(n=o.exec(t),!n)return[t.length,t];if(n[1])return[n[1].length,n[1]];var r;return n[2]in this.dialect.inline&&(r=this.dialect.inline[n[2]].call(this,t.substr(n.index),n,i||[])),r=r||[n[2].length,n[2]]},__call__:function(t,e){function i(t){"string"==typeof t&&"string"==typeof r[r.length-1]?r[r.length-1]+=t:r.push(t)}for(var n,r=[];t.length>0;)n=this.dialect.inline.__oneElement__.call(this,t,e,r),t=t.substr(n.shift()),v(n,i);return r},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(t){return this.dialect.inline.__escape__.exec(t)?[2,t.charAt(1)]:[1,"\\"]},"![":function(t){var e=t.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(e){e[2]&&"<"===e[2][0]&&">"===e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1)),e[2]=this.dialect.inline.__call__.call(this,e[2],/\\/)[0];var i={alt:e[1],href:e[2]||""};return void 0!==e[4]&&(i.title=e[4]),[e[0].length,["img",i]]}return e=t.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),e?[e[0].length,["img_ref",{alt:e[1],ref:e[2].toLowerCase(),original:e[0]}]]:[2,"!["]},"[":function b(t){var e=String(t),i=_.call(this,t.substr(1),"]");if(!i)return[1,"["];var b,n,r=1+i[0],o=i[1];t=t.substr(r);var a=t.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var s=a[1];if(r+=a[0].length,s&&"<"===s[0]&&">"===s[s.length-1]&&(s=s.substring(1,s.length-1)),!a[3])for(var l=1,c=0;c<s.length;c++)switch(s[c]){case"(":l++;break;case")":0===--l&&(r-=s.length-c,s=s.substring(0,c))}return s=this.dialect.inline.__call__.call(this,s,/\\/)[0],n={href:s||""},void 0!==a[3]&&(n.title=a[3]),b=["link",n].concat(o),[r,b]}return a=t.match(/^\s*\[(.*?)\]/),a?(r+=a[0].length,n={ref:(a[1]||String(o)).toLowerCase(),original:e.substr(0,r)},b=["link_ref",n].concat(o),[r,b]):1===o.length&&"string"==typeof o[0]?(n={ref:o[0].toLowerCase(),original:e.substr(0,r)},b=["link_ref",n,o[0]],[r,b]):[1,"["]},"<":function(t){var e;return null!==(e=t.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?e[3]?[e[0].length,["link",{href:"mailto:"+e[3]},e[3]]]:"mailto"===e[2]?[e[0].length,["link",{href:e[1]},e[1].substr("mailto:".length)]]:[e[0].length,["link",{href:e[1]},e[1]]]:[1,"<"]},"`":function(t){var e=t.match(/(`+)(([\s\S]*?)\1)/);return e&&e[2]?[e[1].length+e[2].length,["inlinecode",e[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}}};w.inline["**"]=c("strong","**"),w.inline.__=c("strong","__"),w.inline["*"]=c("em","*"),w.inline._=c("em","_"),p.dialects.Gruber=w,p.buildBlockOrder(p.dialects.Gruber.block),p.buildInlinePatterns(p.dialects.Gruber.inline);var x=g.subclassDialect(w),m=u.extract_attr,v=u.forEach;x.processMetaHash=function(t){for(var e=h(t),i={},n=0;n<e.length;++n)if(/^#/.test(e[n]))i.id=e[n].substring(1);else if(/^\./.test(e[n]))i["class"]=i["class"]?i["class"]+e[n].replace(/./," "):e[n].substring(1);else if(/\=/.test(e[n])){var r=e[n].split(/\=/);i[r[0]]=r[1]}return i},x.block.document_meta=function(t){if(t.lineNumber>1)return void 0;if(!t.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;m(this.tree)||this.tree.splice(1,0,{});var e=t.split(/\n/);for(var i in e){var n=e[i].match(/(\w+):\s*(.*)$/),r=n[1].toLowerCase(),o=n[2];this.tree[1][r]=o}return[]},x.block.block_meta=function(t){var e=t.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!e)return void 0;var i,n=this.dialect.processMetaHash(e[2]);if(""===e[1]){var r=this.tree[this.tree.length-1];if(i=m(r),"string"==typeof r)return void 0;i||(i={},r.splice(1,0,i));for(var o in n)i[o]=n[o];return[]}var a=t.replace(/\n.*$/,""),s=this.processBlock(a,[]);i=m(s[0]),i||(i={},s[0].splice(1,0,i));for(var o in n)i[o]=n[o];return s},x.block.definition_list=function(t,e){var i,n,r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,o=["dl"];if(!(n=t.match(r)))return void 0;for(var a=[t];e.length&&r.exec(e[0]);)a.push(e.shift());for(var s=0;s<a.length;++s){var n=a[s].match(r),l=n[1].replace(/\n$/,"").split(/\n/),c=n[2].split(/\n:\s+/);for(i=0;i<l.length;++i)o.push(["dt",l[i]]);for(i=0;i<c.length;++i)o.push(["dd"].concat(this.processInline(c[i].replace(/(\n)\s+/,"$1"))))}return[o]},x.block.table=function M(t){var e,i,n=function(t,e){e=e||"\\s",e.match(/^[\\|\[\]{}?*.+^$]$/)&&(e="\\"+e);for(var i,n=[],r=new RegExp("^((?:\\\\.|[^\\\\"+e+"])*)"+e+"(.*)");i=t.match(r);)n.push(i[1]),t=i[2];return n.push(t),n},r=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,o=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(i=t.match(r))i[3]=i[3].replace(/^\s*\|/gm,"");else if(!(i=t.match(o)))return void 0;var M=["table",["thead",["tr"]],["tbody"]];i[2]=i[2].replace(/\|\s*$/,"").split("|");var a=[];for(v(i[2],function(t){a.push(t.match(/^\s*-+:\s*$/)?{align:"right"}:t.match(/^\s*:-+\s*$/)?{align:"left"}:t.match(/^\s*:-+:\s*$/)?{align:"center"}:{})}),i[1]=n(i[1].replace(/\|\s*$/,""),"|"),e=0;e<i[1].length;e++)M[1][1].push(["th",a[e]||{}].concat(this.processInline(i[1][e].trim())));return v(i[3].replace(/\|\s*$/gm,"").split("\n"),function(t){var i=["tr"];for(t=n(t,"|"),e=0;e<t.length;e++)i.push(["td",a[e]||{}].concat(this.processInline(t[e].trim())));M[2].push(i)},this),[M]},x.inline["{:"]=function(t,e,i){if(!i.length)return[2,"{:"];var n=i[i.length-1];if("string"==typeof n)return[2,"{:"];var r=t.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!r)return[2,"{:"];var o=this.dialect.processMetaHash(r[1]),a=m(n);a||(a={},n.splice(1,0,a));for(var s in o)a[s]=o[s];return[r[0].length,""]},p.dialects.Maruku=x,p.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,p.buildBlockOrder(p.dialects.Maruku.block),p.buildInlinePatterns(p.dialects.Maruku.inline),e.Markdown=p,e.parse=p.parse,e.toHTML=p.toHTML,e.toHTMLTree=p.toHTMLTree,e.renderJsonML=p.renderJsonML}(function(){return window.markdown={},window.markdown}())},{util:30}]},{},[1])(1)}),window.TCE||(window.TCE={});var Sticky=function(){var t=function(t,e){t instanceof jQuery||(t=$(t)),this.element=t,this.options=$.extend({},this.defaults,e),this.top="function"==typeof this.options.top?$.proxy(function(t){return this.options.top.call(this,t)},this):$.proxy(function(){return this.options.top}),this.sticked=!1};$.extend(t.prototype,{defaults:{top:0,sticky_class:"sticky"},evaluate:function(t){t>=this.top(t)?this.stick():this.unstick()},stick:function(){this.sticked||(this.element.addClass(this.options.sticky_class),this.sticked=!0,this.element.trigger("sticked"))},unstick:function(){this.sticked&&(this.element.removeClass(this.options.sticky_class),this.sticked=!1,this.element.trigger("unsticked"))}});var e=function(){},i=function(t){if(!(t instanceof e)||i._instance&&i._instance!=this)throw"Initialize Sticky via Sticky.instance()";this.on_scroll=$.proxy(this.on_scroll,this),this.on_resize=$.proxy(this.on_resize,this),this.running=!1,this.elements=[]};return i.StickyElement=t,i.instance=function(){return i._instance||(i._instance=new i(new e)),i._instance},$.extend(i.prototype,{register:function(e,i){return this.elements.push(new t(e,i)),this},refresh:function(){var t,e,i=$(window).scrollTop();for(e=this.elements.length;e--;)t=this.elements[e],t.evaluate(i)},stop:function(){return this.running?($(window).off(".sticky_scroll"),void(this.running=!1)):this},start:function(){return this.running?this:($(window).on("scroll.sticky_scroll",this.on_scroll).on("resize.sticky_scroll",this.on_resize),this.refresh(),this.running=!0,this)},on_scroll:function(){this.refresh()},on_resize:function(){this.refresh()}}),i}();/**
 * Swiper 3.4.1
 * Most modern mobile touch slider and framework with hardware accelerated transitions
 * 
 * http://www.idangero.us/swiper/
 * 
 * Copyright 2016, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 * 
 * Licensed under MIT
 * 
 * Released on: December 13, 2016
 */
!function(){"use strict";function t(t){t.fn.swiper=function(e){var n;return t(this).each(function(){var t=new i(this,e);n||(n=t)}),n}}var e,i=function(t,n){function r(t){return Math.floor(t)}function o(){var t=x.params.autoplay,e=x.slides.eq(x.activeIndex);e.attr("data-swiper-autoplay")&&(t=e.attr("data-swiper-autoplay")||x.params.autoplay),x.autoplayTimeoutId=setTimeout(function(){x.params.loop?(x.fixLoop(),x._slideNext(),x.emit("onAutoplay",x)):x.isEnd?n.autoplayStopOnLast?x.stopAutoplay():(x._slideTo(0),x.emit("onAutoplay",x)):(x._slideNext(),x.emit("onAutoplay",x))},t)}function a(t,i){var n=e(t.target);if(!n.is(i))if("string"==typeof i)n=n.parents(i);else if(i.nodeType){var r;return n.parents().each(function(t,e){e===i&&(r=i)}),r?i:void 0}return 0!==n.length?n[0]:void 0}function s(t,e){e=e||{};var i=window.MutationObserver||window.WebkitMutationObserver,n=new i(function(t){t.forEach(function(t){x.onResize(!0),x.emit("onObserverUpdate",x,t)})});n.observe(t,{attributes:"undefined"==typeof e.attributes||e.attributes,childList:"undefined"==typeof e.childList||e.childList,characterData:"undefined"==typeof e.characterData||e.characterData}),x.observers.push(n)}function l(t){t.originalEvent&&(t=t.originalEvent);var e=t.keyCode||t.charCode;if(!x.params.allowSwipeToNext&&(x.isHorizontal()&&39===e||!x.isHorizontal()&&40===e))return!1;if(!x.params.allowSwipeToPrev&&(x.isHorizontal()&&37===e||!x.isHorizontal()&&38===e))return!1;if(!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey||document.activeElement&&document.activeElement.nodeName&&("input"===document.activeElement.nodeName.toLowerCase()||"textarea"===document.activeElement.nodeName.toLowerCase()))){if(37===e||39===e||38===e||40===e){var i=!1;if(x.container.parents("."+x.params.slideClass).length>0&&0===x.container.parents("."+x.params.slideActiveClass).length)return;var n={left:window.pageXOffset,top:window.pageYOffset},r=window.innerWidth,o=window.innerHeight,a=x.container.offset();x.rtl&&(a.left=a.left-x.container[0].scrollLeft);for(var s=[[a.left,a.top],[a.left+x.width,a.top],[a.left,a.top+x.height],[a.left+x.width,a.top+x.height]],l=0;l<s.length;l++){var c=s[l];c[0]>=n.left&&c[0]<=n.left+r&&c[1]>=n.top&&c[1]<=n.top+o&&(i=!0)}if(!i)return}x.isHorizontal()?(37!==e&&39!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),(39===e&&!x.rtl||37===e&&x.rtl)&&x.slideNext(),(37===e&&!x.rtl||39===e&&x.rtl)&&x.slidePrev()):(38!==e&&40!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),40===e&&x.slideNext(),38===e&&x.slidePrev())}}function c(){var t="onwheel",e=t in document;if(!e){var i=document.createElement("div");i.setAttribute(t,"return;"),e="function"==typeof i[t]}return!e&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&(e=document.implementation.hasFeature("Events.wheel","3.0")),e}function h(t){t.originalEvent&&(t=t.originalEvent);var e=0,i=x.rtl?-1:1,n=u(t);if(x.params.mousewheelForceToAxis)if(x.isHorizontal()){if(!(Math.abs(n.pixelX)>Math.abs(n.pixelY)))return;e=n.pixelX*i}else{if(!(Math.abs(n.pixelY)>Math.abs(n.pixelX)))return;e=n.pixelY}else e=Math.abs(n.pixelX)>Math.abs(n.pixelY)?-n.pixelX*i:-n.pixelY;if(0!==e){if(x.params.mousewheelInvert&&(e=-e),x.params.freeMode){var r=x.getWrapperTranslate()+e*x.params.mousewheelSensitivity,o=x.isBeginning,a=x.isEnd;if(r>=x.minTranslate()&&(r=x.minTranslate()),r<=x.maxTranslate()&&(r=x.maxTranslate()),x.setWrapperTransition(0),x.setWrapperTranslate(r),x.updateProgress(),x.updateActiveIndex(),(!o&&x.isBeginning||!a&&x.isEnd)&&x.updateClasses(),x.params.freeModeSticky?(clearTimeout(x.mousewheel.timeout),x.mousewheel.timeout=setTimeout(function(){x.slideReset()},300)):x.params.lazyLoading&&x.lazy&&x.lazy.load(),x.emit("onScroll",x,t),x.params.autoplay&&x.params.autoplayDisableOnInteraction&&x.stopAutoplay(),0===r||r===x.maxTranslate())return}else{if((new window.Date).getTime()-x.mousewheel.lastScrollTime>60)if(0>e)if(x.isEnd&&!x.params.loop||x.animating){if(x.params.mousewheelReleaseOnEdges)return!0}else x.slideNext(),x.emit("onScroll",x,t);else if(x.isBeginning&&!x.params.loop||x.animating){if(x.params.mousewheelReleaseOnEdges)return!0}else x.slidePrev(),x.emit("onScroll",x,t);x.mousewheel.lastScrollTime=(new window.Date).getTime()}return t.preventDefault?t.preventDefault():t.returnValue=!1,!1}}function u(t){var e=10,i=40,n=800,r=0,o=0,a=0,s=0;return"detail"in t&&(o=t.detail),"wheelDelta"in t&&(o=-t.wheelDelta/120),"wheelDeltaY"in t&&(o=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=o,o=0),a=r*e,s=o*e,"deltaY"in t&&(s=t.deltaY),"deltaX"in t&&(a=t.deltaX),(a||s)&&t.deltaMode&&(1===t.deltaMode?(a*=i,s*=i):(a*=n,s*=n)),a&&!r&&(r=1>a?-1:1),s&&!o&&(o=1>s?-1:1),{spinX:r,spinY:o,pixelX:a,pixelY:s}}function d(t,i){t=e(t);var n,r,o,a=x.rtl?-1:1;n=t.attr("data-swiper-parallax")||"0",r=t.attr("data-swiper-parallax-x"),o=t.attr("data-swiper-parallax-y"),r||o?(r=r||"0",o=o||"0"):x.isHorizontal()?(r=n,o="0"):(o=n,r="0"),r=r.indexOf("%")>=0?parseInt(r,10)*i*a+"%":r*i*a+"px",o=o.indexOf("%")>=0?parseInt(o,10)*i+"%":o*i+"px",t.transform("translate3d("+r+", "+o+",0px)")}function p(t){return 0!==t.indexOf("on")&&(t=t[0]!==t[0].toUpperCase()?"on"+t[0].toUpperCase()+t.substring(1):"on"+t),t}if(!(this instanceof i))return new i(t,n);var f={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,iOSEdgeSwipeDetection:!1,iOSEdgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},flip:{slideShadows:!0,limitRotation:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,zoom:!1,zoomMax:3,zoomMin:1,zoomToggle:!0,scrollbar:null,scrollbarHide:!0,scrollbarDraggable:!1,scrollbarSnapOnRelease:!1,keyboardControl:!1,mousewheelControl:!1,mousewheelReleaseOnEdges:!1,mousewheelInvert:!1,mousewheelForceToAxis:!1,mousewheelSensitivity:1,mousewheelEventsTarged:"container",hashnav:!1,hashnavWatchState:!1,history:!1,replaceState:!1,breakpoints:void 0,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,touchReleaseOnEdges:!1,uniqueNavElements:!0,pagination:null,paginationElement:"span",paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,paginationProgressRender:null,paginationFractionRender:null,paginationCustomRender:null,paginationType:"bullets",resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingInPrevNextAmount:1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:void 0,controlInverse:!1,controlBy:"slide",normalizeSlideIndex:!0,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationCurrentClass:"swiper-pagination-current",paginationTotalClass:"swiper-pagination-total",paginationHiddenClass:"swiper-pagination-hidden",paginationProgressbarClass:"swiper-pagination-progressbar",paginationClickableClass:"swiper-pagination-clickable",paginationModifierClass:"swiper-pagination-",lazyLoadingClass:"swiper-lazy",lazyStatusLoadingClass:"swiper-lazy-loading",lazyStatusLoadedClass:"swiper-lazy-loaded",lazyPreloaderClass:"swiper-lazy-preloader",notificationClass:"swiper-notification",preloaderClass:"preloader",zoomContainerClass:"swiper-zoom-container",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",runCallbacksOnInit:!0},m=n&&n.virtualTranslate;n=n||{};var g={};for(var v in n)if("object"!=typeof n[v]||null===n[v]||n[v].nodeType||n[v]===window||n[v]===document||"undefined"!=typeof Dom7&&n[v]instanceof Dom7||"undefined"!=typeof jQuery&&n[v]instanceof jQuery)g[v]=n[v];else{g[v]={};for(var y in n[v])g[v][y]=n[v][y]}for(var _ in f)if("undefined"==typeof n[_])n[_]=f[_];else if("object"==typeof n[_])for(var w in f[_])"undefined"==typeof n[_][w]&&(n[_][w]=f[_][w]);var x=this;if(x.params=n,x.originalParams=g,x.classNames=[],"undefined"!=typeof e&&"undefined"!=typeof Dom7&&(e=Dom7),("undefined"!=typeof e||(e="undefined"==typeof Dom7?window.Dom7||window.Zepto||window.jQuery:Dom7))&&(x.$=e,x.currentBreakpoint=void 0,x.getActiveBreakpoint=function(){if(!x.params.breakpoints)return!1;var t,e=!1,i=[];for(t in x.params.breakpoints)x.params.breakpoints.hasOwnProperty(t)&&i.push(t);i.sort(function(t,e){return parseInt(t,10)>parseInt(e,10)});for(var n=0;n<i.length;n++)t=i[n],t>=window.innerWidth&&!e&&(e=t);return e||"max"},x.setBreakpoint=function(){var t=x.getActiveBreakpoint();if(t&&x.currentBreakpoint!==t){var e=t in x.params.breakpoints?x.params.breakpoints[t]:x.originalParams,i=x.params.loop&&e.slidesPerView!==x.params.slidesPerView;for(var n in e)x.params[n]=e[n];x.currentBreakpoint=t,i&&x.destroyLoop&&x.reLoop(!0)}},x.params.breakpoints&&x.setBreakpoint(),x.container=e(t),0!==x.container.length)){if(x.container.length>1){var b=[];return x.container.each(function(){b.push(new i(this,n))}),b}x.container[0].swiper=x,x.container.data("swiper",x),x.classNames.push(x.params.containerModifierClass+x.params.direction),x.params.freeMode&&x.classNames.push(x.params.containerModifierClass+"free-mode"),x.support.flexbox||(x.classNames.push(x.params.containerModifierClass+"no-flexbox"),x.params.slidesPerColumn=1),x.params.autoHeight&&x.classNames.push(x.params.containerModifierClass+"autoheight"),(x.params.parallax||x.params.watchSlidesVisibility)&&(x.params.watchSlidesProgress=!0),x.params.touchReleaseOnEdges&&(x.params.resistanceRatio=0),["cube","coverflow","flip"].indexOf(x.params.effect)>=0&&(x.support.transforms3d?(x.params.watchSlidesProgress=!0,x.classNames.push(x.params.containerModifierClass+"3d")):x.params.effect="slide"),"slide"!==x.params.effect&&x.classNames.push(x.params.containerModifierClass+x.params.effect),"cube"===x.params.effect&&(x.params.resistanceRatio=0,x.params.slidesPerView=1,x.params.slidesPerColumn=1,x.params.slidesPerGroup=1,x.params.centeredSlides=!1,x.params.spaceBetween=0,x.params.virtualTranslate=!0,x.params.setWrapperSize=!1),"fade"!==x.params.effect&&"flip"!==x.params.effect||(x.params.slidesPerView=1,x.params.slidesPerColumn=1,x.params.slidesPerGroup=1,x.params.watchSlidesProgress=!0,x.params.spaceBetween=0,x.params.setWrapperSize=!1,"undefined"==typeof m&&(x.params.virtualTranslate=!0)),x.params.grabCursor&&x.support.touch&&(x.params.grabCursor=!1),x.wrapper=x.container.children("."+x.params.wrapperClass),x.params.pagination&&(x.paginationContainer=e(x.params.pagination),x.params.uniqueNavElements&&"string"==typeof x.params.pagination&&x.paginationContainer.length>1&&1===x.container.find(x.params.pagination).length&&(x.paginationContainer=x.container.find(x.params.pagination)),"bullets"===x.params.paginationType&&x.params.paginationClickable?x.paginationContainer.addClass(x.params.paginationModifierClass+"clickable"):x.params.paginationClickable=!1,x.paginationContainer.addClass(x.params.paginationModifierClass+x.params.paginationType)),(x.params.nextButton||x.params.prevButton)&&(x.params.nextButton&&(x.nextButton=e(x.params.nextButton),x.params.uniqueNavElements&&"string"==typeof x.params.nextButton&&x.nextButton.length>1&&1===x.container.find(x.params.nextButton).length&&(x.nextButton=x.container.find(x.params.nextButton))),x.params.prevButton&&(x.prevButton=e(x.params.prevButton),x.params.uniqueNavElements&&"string"==typeof x.params.prevButton&&x.prevButton.length>1&&1===x.container.find(x.params.prevButton).length&&(x.prevButton=x.container.find(x.params.prevButton)))),x.isHorizontal=function(){return"horizontal"===x.params.direction},x.rtl=x.isHorizontal()&&("rtl"===x.container[0].dir.toLowerCase()||"rtl"===x.container.css("direction")),x.rtl&&x.classNames.push(x.params.containerModifierClass+"rtl"),x.rtl&&(x.wrongRTL="-webkit-box"===x.wrapper.css("display")),x.params.slidesPerColumn>1&&x.classNames.push(x.params.containerModifierClass+"multirow"),x.device.android&&x.classNames.push(x.params.containerModifierClass+"android"),x.container.addClass(x.classNames.join(" ")),x.translate=0,x.progress=0,x.velocity=0,x.lockSwipeToNext=function(){x.params.allowSwipeToNext=!1,x.params.allowSwipeToPrev===!1&&x.params.grabCursor&&x.unsetGrabCursor()},x.lockSwipeToPrev=function(){x.params.allowSwipeToPrev=!1,x.params.allowSwipeToNext===!1&&x.params.grabCursor&&x.unsetGrabCursor()},x.lockSwipes=function(){x.params.allowSwipeToNext=x.params.allowSwipeToPrev=!1,x.params.grabCursor&&x.unsetGrabCursor()},x.unlockSwipeToNext=function(){x.params.allowSwipeToNext=!0,x.params.allowSwipeToPrev===!0&&x.params.grabCursor&&x.setGrabCursor()},x.unlockSwipeToPrev=function(){x.params.allowSwipeToPrev=!0,x.params.allowSwipeToNext===!0&&x.params.grabCursor&&x.setGrabCursor()},x.unlockSwipes=function(){x.params.allowSwipeToNext=x.params.allowSwipeToPrev=!0,x.params.grabCursor&&x.setGrabCursor()},x.setGrabCursor=function(t){x.container[0].style.cursor="move",x.container[0].style.cursor=t?"-webkit-grabbing":"-webkit-grab",x.container[0].style.cursor=t?"-moz-grabbin":"-moz-grab",x.container[0].style.cursor=t?"grabbing":"grab"},x.unsetGrabCursor=function(){x.container[0].style.cursor=""},x.params.grabCursor&&x.setGrabCursor(),x.imagesToLoad=[],x.imagesLoaded=0,x.loadImage=function(t,e,i,n,r,o){function a(){o&&o()}var s;t.complete&&r?a():e?(s=new window.Image,s.onload=a,s.onerror=a,n&&(s.sizes=n),i&&(s.srcset=i),e&&(s.src=e)):a()},x.preloadImages=function(){function t(){"undefined"!=typeof x&&null!==x&&x&&(void 0!==x.imagesLoaded&&x.imagesLoaded++,x.imagesLoaded===x.imagesToLoad.length&&(x.params.updateOnImagesReady&&x.update(),x.emit("onImagesReady",x)))}x.imagesToLoad=x.container.find("img");for(var e=0;e<x.imagesToLoad.length;e++)x.loadImage(x.imagesToLoad[e],x.imagesToLoad[e].currentSrc||x.imagesToLoad[e].getAttribute("src"),x.imagesToLoad[e].srcset||x.imagesToLoad[e].getAttribute("srcset"),x.imagesToLoad[e].sizes||x.imagesToLoad[e].getAttribute("sizes"),!0,t)},x.autoplayTimeoutId=void 0,x.autoplaying=!1,x.autoplayPaused=!1,x.startAutoplay=function(){return"undefined"==typeof x.autoplayTimeoutId&&!!x.params.autoplay&&!x.autoplaying&&(x.autoplaying=!0,x.emit("onAutoplayStart",x),void o())},x.stopAutoplay=function(){x.autoplayTimeoutId&&(x.autoplayTimeoutId&&clearTimeout(x.autoplayTimeoutId),x.autoplaying=!1,x.autoplayTimeoutId=void 0,x.emit("onAutoplayStop",x))},x.pauseAutoplay=function(t){x.autoplayPaused||(x.autoplayTimeoutId&&clearTimeout(x.autoplayTimeoutId),x.autoplayPaused=!0,0===t?(x.autoplayPaused=!1,o()):x.wrapper.transitionEnd(function(){x&&(x.autoplayPaused=!1,x.autoplaying?o():x.stopAutoplay())}))},x.minTranslate=function(){return-x.snapGrid[0]},x.maxTranslate=function(){return-x.snapGrid[x.snapGrid.length-1]},x.updateAutoHeight=function(){var t,e=[],i=0;if("auto"!==x.params.slidesPerView&&x.params.slidesPerView>1)for(t=0;t<Math.ceil(x.params.slidesPerView);t++){var n=x.activeIndex+t;if(n>x.slides.length)break;e.push(x.slides.eq(n)[0])}else e.push(x.slides.eq(x.activeIndex)[0]);for(t=0;t<e.length;t++)if("undefined"!=typeof e[t]){var r=e[t].offsetHeight;i=r>i?r:i}i&&x.wrapper.css("height",i+"px")},x.updateContainerSize=function(){var t,e;t="undefined"!=typeof x.params.width?x.params.width:x.container[0].clientWidth,e="undefined"!=typeof x.params.height?x.params.height:x.container[0].clientHeight,0===t&&x.isHorizontal()||0===e&&!x.isHorizontal()||(t=t-parseInt(x.container.css("padding-left"),10)-parseInt(x.container.css("padding-right"),10),e=e-parseInt(x.container.css("padding-top"),10)-parseInt(x.container.css("padding-bottom"),10),x.width=t,x.height=e,x.size=x.isHorizontal()?x.width:x.height)},x.updateSlidesSize=function(){x.slides=x.wrapper.children("."+x.params.slideClass),x.snapGrid=[],x.slidesGrid=[],x.slidesSizesGrid=[];var t,e=x.params.spaceBetween,i=-x.params.slidesOffsetBefore,n=0,o=0;if("undefined"!=typeof x.size){"string"==typeof e&&e.indexOf("%")>=0&&(e=parseFloat(e.replace("%",""))/100*x.size),x.virtualSize=-e,x.slides.css(x.rtl?{marginLeft:"",marginTop:""}:{marginRight:"",marginBottom:""});var a;x.params.slidesPerColumn>1&&(a=Math.floor(x.slides.length/x.params.slidesPerColumn)===x.slides.length/x.params.slidesPerColumn?x.slides.length:Math.ceil(x.slides.length/x.params.slidesPerColumn)*x.params.slidesPerColumn,"auto"!==x.params.slidesPerView&&"row"===x.params.slidesPerColumnFill&&(a=Math.max(a,x.params.slidesPerView*x.params.slidesPerColumn)));var s,l=x.params.slidesPerColumn,c=a/l,h=c-(x.params.slidesPerColumn*c-x.slides.length);for(t=0;t<x.slides.length;t++){s=0;var u=x.slides.eq(t);if(x.params.slidesPerColumn>1){var d,p,f;"column"===x.params.slidesPerColumnFill?(p=Math.floor(t/l),f=t-p*l,(p>h||p===h&&f===l-1)&&++f>=l&&(f=0,p++),d=p+f*a/l,u.css({"-webkit-box-ordinal-group":d,"-moz-box-ordinal-group":d,"-ms-flex-order":d,"-webkit-order":d,order:d})):(f=Math.floor(t/c),p=t-f*c),u.css("margin-"+(x.isHorizontal()?"top":"left"),0!==f&&x.params.spaceBetween&&x.params.spaceBetween+"px").attr("data-swiper-column",p).attr("data-swiper-row",f)}"none"!==u.css("display")&&("auto"===x.params.slidesPerView?(s=x.isHorizontal()?u.outerWidth(!0):u.outerHeight(!0),x.params.roundLengths&&(s=r(s))):(s=(x.size-(x.params.slidesPerView-1)*e)/x.params.slidesPerView,x.params.roundLengths&&(s=r(s)),x.isHorizontal()?x.slides[t].style.width=s+"px":x.slides[t].style.height=s+"px"),x.slides[t].swiperSlideSize=s,x.slidesSizesGrid.push(s),x.params.centeredSlides?(i=i+s/2+n/2+e,0===t&&(i=i-x.size/2-e),Math.abs(i)<.001&&(i=0),o%x.params.slidesPerGroup===0&&x.snapGrid.push(i),x.slidesGrid.push(i)):(o%x.params.slidesPerGroup===0&&x.snapGrid.push(i),x.slidesGrid.push(i),i=i+s+e),x.virtualSize+=s+e,n=s,o++)}x.virtualSize=Math.max(x.virtualSize,x.size)+x.params.slidesOffsetAfter;var m;if(x.rtl&&x.wrongRTL&&("slide"===x.params.effect||"coverflow"===x.params.effect)&&x.wrapper.css({width:x.virtualSize+x.params.spaceBetween+"px"}),x.support.flexbox&&!x.params.setWrapperSize||x.wrapper.css(x.isHorizontal()?{width:x.virtualSize+x.params.spaceBetween+"px"}:{height:x.virtualSize+x.params.spaceBetween+"px"}),x.params.slidesPerColumn>1&&(x.virtualSize=(s+x.params.spaceBetween)*a,x.virtualSize=Math.ceil(x.virtualSize/x.params.slidesPerColumn)-x.params.spaceBetween,x.wrapper.css(x.isHorizontal()?{width:x.virtualSize+x.params.spaceBetween+"px"}:{height:x.virtualSize+x.params.spaceBetween+"px"}),x.params.centeredSlides)){for(m=[],t=0;t<x.snapGrid.length;t++)x.snapGrid[t]<x.virtualSize+x.snapGrid[0]&&m.push(x.snapGrid[t]);x.snapGrid=m}if(!x.params.centeredSlides){for(m=[],t=0;t<x.snapGrid.length;t++)x.snapGrid[t]<=x.virtualSize-x.size&&m.push(x.snapGrid[t]);x.snapGrid=m,Math.floor(x.virtualSize-x.size)-Math.floor(x.snapGrid[x.snapGrid.length-1])>1&&x.snapGrid.push(x.virtualSize-x.size)}0===x.snapGrid.length&&(x.snapGrid=[0]),0!==x.params.spaceBetween&&x.slides.css(x.isHorizontal()?x.rtl?{marginLeft:e+"px"}:{marginRight:e+"px"}:{marginBottom:e+"px"}),x.params.watchSlidesProgress&&x.updateSlidesOffset()}},x.updateSlidesOffset=function(){for(var t=0;t<x.slides.length;t++)x.slides[t].swiperSlideOffset=x.isHorizontal()?x.slides[t].offsetLeft:x.slides[t].offsetTop},x.currentSlidesPerView=function(){var t,e,i=1;if(x.params.centeredSlides){var n,r=x.slides[x.activeIndex].swiperSlideSize;for(t=x.activeIndex+1;t<x.slides.length;t++)x.slides[t]&&!n&&(r+=x.slides[t].swiperSlideSize,i++,r>x.size&&(n=!0));for(e=x.activeIndex-1;e>=0;e--)x.slides[e]&&!n&&(r+=x.slides[e].swiperSlideSize,i++,r>x.size&&(n=!0))}else for(t=x.activeIndex+1;t<x.slides.length;t++)x.slidesGrid[t]-x.slidesGrid[x.activeIndex]<x.size&&i++;return i},x.updateSlidesProgress=function(t){if("undefined"==typeof t&&(t=x.translate||0),0!==x.slides.length){"undefined"==typeof x.slides[0].swiperSlideOffset&&x.updateSlidesOffset();var e=-t;x.rtl&&(e=t),x.slides.removeClass(x.params.slideVisibleClass);for(var i=0;i<x.slides.length;i++){var n=x.slides[i],r=(e+(x.params.centeredSlides?x.minTranslate():0)-n.swiperSlideOffset)/(n.swiperSlideSize+x.params.spaceBetween);if(x.params.watchSlidesVisibility){var o=-(e-n.swiperSlideOffset),a=o+x.slidesSizesGrid[i],s=o>=0&&o<x.size||a>0&&a<=x.size||0>=o&&a>=x.size;s&&x.slides.eq(i).addClass(x.params.slideVisibleClass)}n.progress=x.rtl?-r:r}}},x.updateProgress=function(t){"undefined"==typeof t&&(t=x.translate||0);var e=x.maxTranslate()-x.minTranslate(),i=x.isBeginning,n=x.isEnd;0===e?(x.progress=0,x.isBeginning=x.isEnd=!0):(x.progress=(t-x.minTranslate())/e,x.isBeginning=x.progress<=0,x.isEnd=x.progress>=1),x.isBeginning&&!i&&x.emit("onReachBeginning",x),x.isEnd&&!n&&x.emit("onReachEnd",x),x.params.watchSlidesProgress&&x.updateSlidesProgress(t),x.emit("onProgress",x,x.progress)},x.updateActiveIndex=function(){var t,e,i,n=x.rtl?x.translate:-x.translate;for(e=0;e<x.slidesGrid.length;e++)"undefined"!=typeof x.slidesGrid[e+1]?n>=x.slidesGrid[e]&&n<x.slidesGrid[e+1]-(x.slidesGrid[e+1]-x.slidesGrid[e])/2?t=e:n>=x.slidesGrid[e]&&n<x.slidesGrid[e+1]&&(t=e+1):n>=x.slidesGrid[e]&&(t=e);x.params.normalizeSlideIndex&&(0>t||"undefined"==typeof t)&&(t=0),i=Math.floor(t/x.params.slidesPerGroup),i>=x.snapGrid.length&&(i=x.snapGrid.length-1),t!==x.activeIndex&&(x.snapIndex=i,x.previousIndex=x.activeIndex,x.activeIndex=t,x.updateClasses(),x.updateRealIndex())},x.updateRealIndex=function(){x.realIndex=parseInt(x.slides.eq(x.activeIndex).attr("data-swiper-slide-index")||x.activeIndex,10)},x.updateClasses=function(){x.slides.removeClass(x.params.slideActiveClass+" "+x.params.slideNextClass+" "+x.params.slidePrevClass+" "+x.params.slideDuplicateActiveClass+" "+x.params.slideDuplicateNextClass+" "+x.params.slideDuplicatePrevClass);var t=x.slides.eq(x.activeIndex);t.addClass(x.params.slideActiveClass),n.loop&&(t.hasClass(x.params.slideDuplicateClass)?x.wrapper.children("."+x.params.slideClass+":not(."+x.params.slideDuplicateClass+')[data-swiper-slide-index="'+x.realIndex+'"]').addClass(x.params.slideDuplicateActiveClass):x.wrapper.children("."+x.params.slideClass+"."+x.params.slideDuplicateClass+'[data-swiper-slide-index="'+x.realIndex+'"]').addClass(x.params.slideDuplicateActiveClass));var i=t.next("."+x.params.slideClass).addClass(x.params.slideNextClass);x.params.loop&&0===i.length&&(i=x.slides.eq(0),i.addClass(x.params.slideNextClass));var r=t.prev("."+x.params.slideClass).addClass(x.params.slidePrevClass);if(x.params.loop&&0===r.length&&(r=x.slides.eq(-1),r.addClass(x.params.slidePrevClass)),n.loop&&(i.hasClass(x.params.slideDuplicateClass)?x.wrapper.children("."+x.params.slideClass+":not(."+x.params.slideDuplicateClass+')[data-swiper-slide-index="'+i.attr("data-swiper-slide-index")+'"]').addClass(x.params.slideDuplicateNextClass):x.wrapper.children("."+x.params.slideClass+"."+x.params.slideDuplicateClass+'[data-swiper-slide-index="'+i.attr("data-swiper-slide-index")+'"]').addClass(x.params.slideDuplicateNextClass),r.hasClass(x.params.slideDuplicateClass)?x.wrapper.children("."+x.params.slideClass+":not(."+x.params.slideDuplicateClass+')[data-swiper-slide-index="'+r.attr("data-swiper-slide-index")+'"]').addClass(x.params.slideDuplicatePrevClass):x.wrapper.children("."+x.params.slideClass+"."+x.params.slideDuplicateClass+'[data-swiper-slide-index="'+r.attr("data-swiper-slide-index")+'"]').addClass(x.params.slideDuplicatePrevClass)),x.paginationContainer&&x.paginationContainer.length>0){var o,a=x.params.loop?Math.ceil((x.slides.length-2*x.loopedSlides)/x.params.slidesPerGroup):x.snapGrid.length;if(x.params.loop?(o=Math.ceil((x.activeIndex-x.loopedSlides)/x.params.slidesPerGroup),o>x.slides.length-1-2*x.loopedSlides&&(o-=x.slides.length-2*x.loopedSlides),o>a-1&&(o-=a),0>o&&"bullets"!==x.params.paginationType&&(o=a+o)):o="undefined"!=typeof x.snapIndex?x.snapIndex:x.activeIndex||0,"bullets"===x.params.paginationType&&x.bullets&&x.bullets.length>0&&(x.bullets.removeClass(x.params.bulletActiveClass),x.paginationContainer.length>1?x.bullets.each(function(){e(this).index()===o&&e(this).addClass(x.params.bulletActiveClass)}):x.bullets.eq(o).addClass(x.params.bulletActiveClass)),"fraction"===x.params.paginationType&&(x.paginationContainer.find("."+x.params.paginationCurrentClass).text(o+1),x.paginationContainer.find("."+x.params.paginationTotalClass).text(a)),"progress"===x.params.paginationType){var s=(o+1)/a,l=s,c=1;x.isHorizontal()||(c=s,l=1),x.paginationContainer.find("."+x.params.paginationProgressbarClass).transform("translate3d(0,0,0) scaleX("+l+") scaleY("+c+")").transition(x.params.speed)}"custom"===x.params.paginationType&&x.params.paginationCustomRender&&(x.paginationContainer.html(x.params.paginationCustomRender(x,o+1,a)),x.emit("onPaginationRendered",x,x.paginationContainer[0]))}x.params.loop||(x.params.prevButton&&x.prevButton&&x.prevButton.length>0&&(x.isBeginning?(x.prevButton.addClass(x.params.buttonDisabledClass),x.params.a11y&&x.a11y&&x.a11y.disable(x.prevButton)):(x.prevButton.removeClass(x.params.buttonDisabledClass),x.params.a11y&&x.a11y&&x.a11y.enable(x.prevButton))),x.params.nextButton&&x.nextButton&&x.nextButton.length>0&&(x.isEnd?(x.nextButton.addClass(x.params.buttonDisabledClass),x.params.a11y&&x.a11y&&x.a11y.disable(x.nextButton)):(x.nextButton.removeClass(x.params.buttonDisabledClass),x.params.a11y&&x.a11y&&x.a11y.enable(x.nextButton))))},x.updatePagination=function(){if(x.params.pagination&&x.paginationContainer&&x.paginationContainer.length>0){var t="";if("bullets"===x.params.paginationType){for(var e=x.params.loop?Math.ceil((x.slides.length-2*x.loopedSlides)/x.params.slidesPerGroup):x.snapGrid.length,i=0;e>i;i++)t+=x.params.paginationBulletRender?x.params.paginationBulletRender(x,i,x.params.bulletClass):"<"+x.params.paginationElement+' class="'+x.params.bulletClass+'"></'+x.params.paginationElement+">";x.paginationContainer.html(t),x.bullets=x.paginationContainer.find("."+x.params.bulletClass),x.params.paginationClickable&&x.params.a11y&&x.a11y&&x.a11y.initPagination()}"fraction"===x.params.paginationType&&(t=x.params.paginationFractionRender?x.params.paginationFractionRender(x,x.params.paginationCurrentClass,x.params.paginationTotalClass):'<span class="'+x.params.paginationCurrentClass+'"></span> / <span class="'+x.params.paginationTotalClass+'"></span>',x.paginationContainer.html(t)),"progress"===x.params.paginationType&&(t=x.params.paginationProgressRender?x.params.paginationProgressRender(x,x.params.paginationProgressbarClass):'<span class="'+x.params.paginationProgressbarClass+'"></span>',x.paginationContainer.html(t)),"custom"!==x.params.paginationType&&x.emit("onPaginationRendered",x,x.paginationContainer[0])}},x.update=function(t){function e(){x.rtl?-x.translate:x.translate,n=Math.min(Math.max(x.translate,x.maxTranslate()),x.minTranslate()),x.setWrapperTranslate(n),x.updateActiveIndex(),x.updateClasses()}if(x)if(x.updateContainerSize(),x.updateSlidesSize(),x.updateProgress(),x.updatePagination(),x.updateClasses(),x.params.scrollbar&&x.scrollbar&&x.scrollbar.set(),t){var i,n;x.controller&&x.controller.spline&&(x.controller.spline=void 0),x.params.freeMode?(e(),x.params.autoHeight&&x.updateAutoHeight()):(i=("auto"===x.params.slidesPerView||x.params.slidesPerView>1)&&x.isEnd&&!x.params.centeredSlides?x.slideTo(x.slides.length-1,0,!1,!0):x.slideTo(x.activeIndex,0,!1,!0),i||e())}else x.params.autoHeight&&x.updateAutoHeight()},x.onResize=function(t){x.params.breakpoints&&x.setBreakpoint();var e=x.params.allowSwipeToPrev,i=x.params.allowSwipeToNext;x.params.allowSwipeToPrev=x.params.allowSwipeToNext=!0,x.updateContainerSize(),x.updateSlidesSize(),("auto"===x.params.slidesPerView||x.params.freeMode||t)&&x.updatePagination(),x.params.scrollbar&&x.scrollbar&&x.scrollbar.set(),x.controller&&x.controller.spline&&(x.controller.spline=void 0);var n=!1;if(x.params.freeMode){var r=Math.min(Math.max(x.translate,x.maxTranslate()),x.minTranslate());x.setWrapperTranslate(r),x.updateActiveIndex(),x.updateClasses(),x.params.autoHeight&&x.updateAutoHeight()}else x.updateClasses(),n=("auto"===x.params.slidesPerView||x.params.slidesPerView>1)&&x.isEnd&&!x.params.centeredSlides?x.slideTo(x.slides.length-1,0,!1,!0):x.slideTo(x.activeIndex,0,!1,!0);x.params.lazyLoading&&!n&&x.lazy&&x.lazy.load(),x.params.allowSwipeToPrev=e,x.params.allowSwipeToNext=i},x.touchEventsDesktop={start:"mousedown",move:"mousemove",end:"mouseup"},window.navigator.pointerEnabled?x.touchEventsDesktop={start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled&&(x.touchEventsDesktop={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}),x.touchEvents={start:x.support.touch||!x.params.simulateTouch?"touchstart":x.touchEventsDesktop.start,move:x.support.touch||!x.params.simulateTouch?"touchmove":x.touchEventsDesktop.move,end:x.support.touch||!x.params.simulateTouch?"touchend":x.touchEventsDesktop.end},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&("container"===x.params.touchEventsTarget?x.container:x.wrapper).addClass("swiper-wp8-"+x.params.direction),x.initEvents=function(t){var e=t?"off":"on",i=t?"removeEventListener":"addEventListener",r="container"===x.params.touchEventsTarget?x.container[0]:x.wrapper[0],o=x.support.touch?r:document,a=!!x.params.nested;if(x.browser.ie)r[i](x.touchEvents.start,x.onTouchStart,!1),o[i](x.touchEvents.move,x.onTouchMove,a),o[i](x.touchEvents.end,x.onTouchEnd,!1);else{if(x.support.touch){var s=!("touchstart"!==x.touchEvents.start||!x.support.passiveListener||!x.params.passiveListeners)&&{passive:!0,capture:!1};r[i](x.touchEvents.start,x.onTouchStart,s),r[i](x.touchEvents.move,x.onTouchMove,a),r[i](x.touchEvents.end,x.onTouchEnd,s)}(n.simulateTouch&&!x.device.ios&&!x.device.android||n.simulateTouch&&!x.support.touch&&x.device.ios)&&(r[i]("mousedown",x.onTouchStart,!1),document[i]("mousemove",x.onTouchMove,a),document[i]("mouseup",x.onTouchEnd,!1))}window[i]("resize",x.onResize),x.params.nextButton&&x.nextButton&&x.nextButton.length>0&&(x.nextButton[e]("click",x.onClickNext),x.params.a11y&&x.a11y&&x.nextButton[e]("keydown",x.a11y.onEnterKey)),x.params.prevButton&&x.prevButton&&x.prevButton.length>0&&(x.prevButton[e]("click",x.onClickPrev),x.params.a11y&&x.a11y&&x.prevButton[e]("keydown",x.a11y.onEnterKey)),x.params.pagination&&x.params.paginationClickable&&(x.paginationContainer[e]("click","."+x.params.bulletClass,x.onClickIndex),x.params.a11y&&x.a11y&&x.paginationContainer[e]("keydown","."+x.params.bulletClass,x.a11y.onEnterKey)),(x.params.preventClicks||x.params.preventClicksPropagation)&&r[i]("click",x.preventClicks,!0)},x.attachEvents=function(){x.initEvents()},x.detachEvents=function(){x.initEvents(!0)},x.allowClick=!0,x.preventClicks=function(t){x.allowClick||(x.params.preventClicks&&t.preventDefault(),x.params.preventClicksPropagation&&x.animating&&(t.stopPropagation(),t.stopImmediatePropagation()))},x.onClickNext=function(t){t.preventDefault(),x.isEnd&&!x.params.loop||x.slideNext()},x.onClickPrev=function(t){t.preventDefault(),x.isBeginning&&!x.params.loop||x.slidePrev()},x.onClickIndex=function(t){t.preventDefault();var i=e(this).index()*x.params.slidesPerGroup;x.params.loop&&(i+=x.loopedSlides),x.slideTo(i)},x.updateClickedSlide=function(t){var i=a(t,"."+x.params.slideClass),n=!1;if(i)for(var r=0;r<x.slides.length;r++)x.slides[r]===i&&(n=!0);if(!i||!n)return x.clickedSlide=void 0,void(x.clickedIndex=void 0);if(x.clickedSlide=i,x.clickedIndex=e(i).index(),x.params.slideToClickedSlide&&void 0!==x.clickedIndex&&x.clickedIndex!==x.activeIndex){var o,s=x.clickedIndex,l="auto"===x.params.slidesPerView?x.currentSlidesPerView():x.params.slidesPerView;
if(x.params.loop){if(x.animating)return;o=parseInt(e(x.clickedSlide).attr("data-swiper-slide-index"),10),x.params.centeredSlides?s<x.loopedSlides-l/2||s>x.slides.length-x.loopedSlides+l/2?(x.fixLoop(),s=x.wrapper.children("."+x.params.slideClass+'[data-swiper-slide-index="'+o+'"]:not(.'+x.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){x.slideTo(s)},0)):x.slideTo(s):s>x.slides.length-l?(x.fixLoop(),s=x.wrapper.children("."+x.params.slideClass+'[data-swiper-slide-index="'+o+'"]:not(.'+x.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){x.slideTo(s)},0)):x.slideTo(s)}else x.slideTo(s)}};var M,T,E,S,C,A,P,L,k,I,R="input, select, textarea, button, video",D=Date.now(),z=[];x.animating=!1,x.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0};var O,F;x.onTouchStart=function(t){if(t.originalEvent&&(t=t.originalEvent),O="touchstart"===t.type,O||!("which"in t)||3!==t.which){if(x.params.noSwiping&&a(t,"."+x.params.noSwipingClass))return void(x.allowClick=!0);if(!x.params.swipeHandler||a(t,x.params.swipeHandler)){var i=x.touches.currentX="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,n=x.touches.currentY="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY;if(!(x.device.ios&&x.params.iOSEdgeSwipeDetection&&i<=x.params.iOSEdgeSwipeThreshold)){if(M=!0,T=!1,E=!0,C=void 0,F=void 0,x.touches.startX=i,x.touches.startY=n,S=Date.now(),x.allowClick=!0,x.updateContainerSize(),x.swipeDirection=void 0,x.params.threshold>0&&(L=!1),"touchstart"!==t.type){var r=!0;e(t.target).is(R)&&(r=!1),document.activeElement&&e(document.activeElement).is(R)&&document.activeElement.blur(),r&&t.preventDefault()}x.emit("onTouchStart",x,t)}}}},x.onTouchMove=function(t){if(t.originalEvent&&(t=t.originalEvent),!O||"mousemove"!==t.type){if(t.preventedByNestedSwiper)return x.touches.startX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,void(x.touches.startY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY);if(x.params.onlyExternal)return x.allowClick=!1,void(M&&(x.touches.startX=x.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,x.touches.startY=x.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,S=Date.now()));if(O&&x.params.touchReleaseOnEdges&&!x.params.loop)if(x.isHorizontal()){if(x.touches.currentX<x.touches.startX&&x.translate<=x.maxTranslate()||x.touches.currentX>x.touches.startX&&x.translate>=x.minTranslate())return}else if(x.touches.currentY<x.touches.startY&&x.translate<=x.maxTranslate()||x.touches.currentY>x.touches.startY&&x.translate>=x.minTranslate())return;if(O&&document.activeElement&&t.target===document.activeElement&&e(t.target).is(R))return T=!0,void(x.allowClick=!1);if(E&&x.emit("onTouchMove",x,t),!(t.targetTouches&&t.targetTouches.length>1)){if(x.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,x.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,"undefined"==typeof C){var i;x.isHorizontal()&&x.touches.currentY===x.touches.startY||!x.isHorizontal()&&x.touches.currentX===x.touches.startX?C=!1:(i=180*Math.atan2(Math.abs(x.touches.currentY-x.touches.startY),Math.abs(x.touches.currentX-x.touches.startX))/Math.PI,C=x.isHorizontal()?i>x.params.touchAngle:90-i>x.params.touchAngle)}if(C&&x.emit("onTouchMoveOpposite",x,t),"undefined"==typeof F&&x.browser.ieTouch&&(x.touches.currentX===x.touches.startX&&x.touches.currentY===x.touches.startY||(F=!0)),M){if(C)return void(M=!1);if(F||!x.browser.ieTouch){x.allowClick=!1,x.emit("onSliderMove",x,t),t.preventDefault(),x.params.touchMoveStopPropagation&&!x.params.nested&&t.stopPropagation(),T||(n.loop&&x.fixLoop(),P=x.getWrapperTranslate(),x.setWrapperTransition(0),x.animating&&x.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),x.params.autoplay&&x.autoplaying&&(x.params.autoplayDisableOnInteraction?x.stopAutoplay():x.pauseAutoplay()),I=!1,!x.params.grabCursor||x.params.allowSwipeToNext!==!0&&x.params.allowSwipeToPrev!==!0||x.setGrabCursor(!0)),T=!0;var r=x.touches.diff=x.isHorizontal()?x.touches.currentX-x.touches.startX:x.touches.currentY-x.touches.startY;r*=x.params.touchRatio,x.rtl&&(r=-r),x.swipeDirection=r>0?"prev":"next",A=r+P;var o=!0;if(r>0&&A>x.minTranslate()?(o=!1,x.params.resistance&&(A=x.minTranslate()-1+Math.pow(-x.minTranslate()+P+r,x.params.resistanceRatio))):0>r&&A<x.maxTranslate()&&(o=!1,x.params.resistance&&(A=x.maxTranslate()+1-Math.pow(x.maxTranslate()-P-r,x.params.resistanceRatio))),o&&(t.preventedByNestedSwiper=!0),!x.params.allowSwipeToNext&&"next"===x.swipeDirection&&P>A&&(A=P),!x.params.allowSwipeToPrev&&"prev"===x.swipeDirection&&A>P&&(A=P),x.params.threshold>0){if(!(Math.abs(r)>x.params.threshold||L))return void(A=P);if(!L)return L=!0,x.touches.startX=x.touches.currentX,x.touches.startY=x.touches.currentY,A=P,void(x.touches.diff=x.isHorizontal()?x.touches.currentX-x.touches.startX:x.touches.currentY-x.touches.startY)}x.params.followFinger&&((x.params.freeMode||x.params.watchSlidesProgress)&&x.updateActiveIndex(),x.params.freeMode&&(0===z.length&&z.push({position:x.touches[x.isHorizontal()?"startX":"startY"],time:S}),z.push({position:x.touches[x.isHorizontal()?"currentX":"currentY"],time:(new window.Date).getTime()})),x.updateProgress(A),x.setWrapperTranslate(A))}}}}},x.onTouchEnd=function(t){if(t.originalEvent&&(t=t.originalEvent),E&&x.emit("onTouchEnd",x,t),E=!1,M){x.params.grabCursor&&T&&M&&(x.params.allowSwipeToNext===!0||x.params.allowSwipeToPrev===!0)&&x.setGrabCursor(!1);var i=Date.now(),n=i-S;if(x.allowClick&&(x.updateClickedSlide(t),x.emit("onTap",x,t),300>n&&i-D>300&&(k&&clearTimeout(k),k=setTimeout(function(){x&&(x.params.paginationHide&&x.paginationContainer.length>0&&!e(t.target).hasClass(x.params.bulletClass)&&x.paginationContainer.toggleClass(x.params.paginationHiddenClass),x.emit("onClick",x,t))},300)),300>n&&300>i-D&&(k&&clearTimeout(k),x.emit("onDoubleTap",x,t))),D=Date.now(),setTimeout(function(){x&&(x.allowClick=!0)},0),!M||!T||!x.swipeDirection||0===x.touches.diff||A===P)return void(M=T=!1);M=T=!1;var r;if(r=x.params.followFinger?x.rtl?x.translate:-x.translate:-A,x.params.freeMode){if(r<-x.minTranslate())return void x.slideTo(x.activeIndex);if(r>-x.maxTranslate())return void x.slideTo(x.slides.length<x.snapGrid.length?x.snapGrid.length-1:x.slides.length-1);if(x.params.freeModeMomentum){if(z.length>1){var o=z.pop(),a=z.pop(),s=o.position-a.position,l=o.time-a.time;x.velocity=s/l,x.velocity=x.velocity/2,Math.abs(x.velocity)<x.params.freeModeMinimumVelocity&&(x.velocity=0),(l>150||(new window.Date).getTime()-o.time>300)&&(x.velocity=0)}else x.velocity=0;x.velocity=x.velocity*x.params.freeModeMomentumVelocityRatio,z.length=0;var c=1e3*x.params.freeModeMomentumRatio,h=x.velocity*c,u=x.translate+h;x.rtl&&(u=-u);var d,p=!1,f=20*Math.abs(x.velocity)*x.params.freeModeMomentumBounceRatio;if(u<x.maxTranslate())x.params.freeModeMomentumBounce?(u+x.maxTranslate()<-f&&(u=x.maxTranslate()-f),d=x.maxTranslate(),p=!0,I=!0):u=x.maxTranslate();else if(u>x.minTranslate())x.params.freeModeMomentumBounce?(u-x.minTranslate()>f&&(u=x.minTranslate()+f),d=x.minTranslate(),p=!0,I=!0):u=x.minTranslate();else if(x.params.freeModeSticky){var m,g=0;for(g=0;g<x.snapGrid.length;g+=1)if(x.snapGrid[g]>-u){m=g;break}u=Math.abs(x.snapGrid[m]-u)<Math.abs(x.snapGrid[m-1]-u)||"next"===x.swipeDirection?x.snapGrid[m]:x.snapGrid[m-1],x.rtl||(u=-u)}if(0!==x.velocity)c=Math.abs(x.rtl?(-u-x.translate)/x.velocity:(u-x.translate)/x.velocity);else if(x.params.freeModeSticky)return void x.slideReset();x.params.freeModeMomentumBounce&&p?(x.updateProgress(d),x.setWrapperTransition(c),x.setWrapperTranslate(u),x.onTransitionStart(),x.animating=!0,x.wrapper.transitionEnd(function(){x&&I&&(x.emit("onMomentumBounce",x),x.setWrapperTransition(x.params.speed),x.setWrapperTranslate(d),x.wrapper.transitionEnd(function(){x&&x.onTransitionEnd()}))})):x.velocity?(x.updateProgress(u),x.setWrapperTransition(c),x.setWrapperTranslate(u),x.onTransitionStart(),x.animating||(x.animating=!0,x.wrapper.transitionEnd(function(){x&&x.onTransitionEnd()}))):x.updateProgress(u),x.updateActiveIndex()}return void((!x.params.freeModeMomentum||n>=x.params.longSwipesMs)&&(x.updateProgress(),x.updateActiveIndex()))}var v,y=0,_=x.slidesSizesGrid[0];for(v=0;v<x.slidesGrid.length;v+=x.params.slidesPerGroup)"undefined"!=typeof x.slidesGrid[v+x.params.slidesPerGroup]?r>=x.slidesGrid[v]&&r<x.slidesGrid[v+x.params.slidesPerGroup]&&(y=v,_=x.slidesGrid[v+x.params.slidesPerGroup]-x.slidesGrid[v]):r>=x.slidesGrid[v]&&(y=v,_=x.slidesGrid[x.slidesGrid.length-1]-x.slidesGrid[x.slidesGrid.length-2]);var w=(r-x.slidesGrid[y])/_;if(n>x.params.longSwipesMs){if(!x.params.longSwipes)return void x.slideTo(x.activeIndex);"next"===x.swipeDirection&&x.slideTo(w>=x.params.longSwipesRatio?y+x.params.slidesPerGroup:y),"prev"===x.swipeDirection&&x.slideTo(w>1-x.params.longSwipesRatio?y+x.params.slidesPerGroup:y)}else{if(!x.params.shortSwipes)return void x.slideTo(x.activeIndex);"next"===x.swipeDirection&&x.slideTo(y+x.params.slidesPerGroup),"prev"===x.swipeDirection&&x.slideTo(y)}}},x._slideTo=function(t,e){return x.slideTo(t,e,!0,!0)},x.slideTo=function(t,e,i,n){"undefined"==typeof i&&(i=!0),"undefined"==typeof t&&(t=0),0>t&&(t=0),x.snapIndex=Math.floor(t/x.params.slidesPerGroup),x.snapIndex>=x.snapGrid.length&&(x.snapIndex=x.snapGrid.length-1);var r=-x.snapGrid[x.snapIndex];if(x.params.autoplay&&x.autoplaying&&(n||!x.params.autoplayDisableOnInteraction?x.pauseAutoplay(e):x.stopAutoplay()),x.updateProgress(r),x.params.normalizeSlideIndex)for(var o=0;o<x.slidesGrid.length;o++)-Math.floor(100*r)>=Math.floor(100*x.slidesGrid[o])&&(t=o);return!(!x.params.allowSwipeToNext&&r<x.translate&&r<x.minTranslate()||!x.params.allowSwipeToPrev&&r>x.translate&&r>x.maxTranslate()&&(x.activeIndex||0)!==t||("undefined"==typeof e&&(e=x.params.speed),x.previousIndex=x.activeIndex||0,x.activeIndex=t,x.updateRealIndex(),x.rtl&&-r===x.translate||!x.rtl&&r===x.translate?(x.params.autoHeight&&x.updateAutoHeight(),x.updateClasses(),"slide"!==x.params.effect&&x.setWrapperTranslate(r),1):(x.updateClasses(),x.onTransitionStart(i),0===e||x.browser.lteIE9?(x.setWrapperTranslate(r),x.setWrapperTransition(0),x.onTransitionEnd(i)):(x.setWrapperTranslate(r),x.setWrapperTransition(e),x.animating||(x.animating=!0,x.wrapper.transitionEnd(function(){x&&x.onTransitionEnd(i)}))),0)))},x.onTransitionStart=function(t){"undefined"==typeof t&&(t=!0),x.params.autoHeight&&x.updateAutoHeight(),x.lazy&&x.lazy.onTransitionStart(),t&&(x.emit("onTransitionStart",x),x.activeIndex!==x.previousIndex&&(x.emit("onSlideChangeStart",x),x.activeIndex>x.previousIndex?x.emit("onSlideNextStart",x):x.emit("onSlidePrevStart",x)))},x.onTransitionEnd=function(t){x.animating=!1,x.setWrapperTransition(0),"undefined"==typeof t&&(t=!0),x.lazy&&x.lazy.onTransitionEnd(),t&&(x.emit("onTransitionEnd",x),x.activeIndex!==x.previousIndex&&(x.emit("onSlideChangeEnd",x),x.activeIndex>x.previousIndex?x.emit("onSlideNextEnd",x):x.emit("onSlidePrevEnd",x))),x.params.history&&x.history&&x.history.setHistory(x.params.history,x.activeIndex),x.params.hashnav&&x.hashnav&&x.hashnav.setHash()},x.slideNext=function(t,e,i){return x.params.loop?x.animating?!1:(x.fixLoop(),x.container[0].clientLeft,x.slideTo(x.activeIndex+x.params.slidesPerGroup,e,t,i)):x.slideTo(x.activeIndex+x.params.slidesPerGroup,e,t,i)},x._slideNext=function(t){return x.slideNext(!0,t,!0)},x.slidePrev=function(t,e,i){return x.params.loop?x.animating?!1:(x.fixLoop(),x.container[0].clientLeft,x.slideTo(x.activeIndex-1,e,t,i)):x.slideTo(x.activeIndex-1,e,t,i)},x._slidePrev=function(t){return x.slidePrev(!0,t,!0)},x.slideReset=function(t,e){return x.slideTo(x.activeIndex,e,t)},x.disableTouchControl=function(){return x.params.onlyExternal=!0,!0},x.enableTouchControl=function(){return x.params.onlyExternal=!1,!0},x.setWrapperTransition=function(t,e){x.wrapper.transition(t),"slide"!==x.params.effect&&x.effects[x.params.effect]&&x.effects[x.params.effect].setTransition(t),x.params.parallax&&x.parallax&&x.parallax.setTransition(t),x.params.scrollbar&&x.scrollbar&&x.scrollbar.setTransition(t),x.params.control&&x.controller&&x.controller.setTransition(t,e),x.emit("onSetTransition",x,t)},x.setWrapperTranslate=function(t,e,i){var n=0,o=0,a=0;x.isHorizontal()?n=x.rtl?-t:t:o=t,x.params.roundLengths&&(n=r(n),o=r(o)),x.params.virtualTranslate||x.wrapper.transform(x.support.transforms3d?"translate3d("+n+"px, "+o+"px, "+a+"px)":"translate("+n+"px, "+o+"px)"),x.translate=x.isHorizontal()?n:o;var s,l=x.maxTranslate()-x.minTranslate();s=0===l?0:(t-x.minTranslate())/l,s!==x.progress&&x.updateProgress(t),e&&x.updateActiveIndex(),"slide"!==x.params.effect&&x.effects[x.params.effect]&&x.effects[x.params.effect].setTranslate(x.translate),x.params.parallax&&x.parallax&&x.parallax.setTranslate(x.translate),x.params.scrollbar&&x.scrollbar&&x.scrollbar.setTranslate(x.translate),x.params.control&&x.controller&&x.controller.setTranslate(x.translate,i),x.emit("onSetTranslate",x,x.translate)},x.getTranslate=function(t,e){var i,n,r,o;return"undefined"==typeof e&&(e="x"),x.params.virtualTranslate?x.rtl?-x.translate:x.translate:(r=window.getComputedStyle(t,null),window.WebKitCSSMatrix?(n=r.transform||r.webkitTransform,n.split(",").length>6&&(n=n.split(", ").map(function(t){return t.replace(",",".")}).join(", ")),o=new window.WebKitCSSMatrix("none"===n?"":n)):(o=r.MozTransform||r.OTransform||r.MsTransform||r.msTransform||r.transform||r.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=o.toString().split(",")),"x"===e&&(n=window.WebKitCSSMatrix?o.m41:parseFloat(16===i.length?i[12]:i[4])),"y"===e&&(n=window.WebKitCSSMatrix?o.m42:parseFloat(16===i.length?i[13]:i[5])),x.rtl&&n&&(n=-n),n||0)},x.getWrapperTranslate=function(t){return"undefined"==typeof t&&(t=x.isHorizontal()?"x":"y"),x.getTranslate(x.wrapper[0],t)},x.observers=[],x.initObservers=function(){if(x.params.observeParents)for(var t=x.container.parents(),e=0;e<t.length;e++)s(t[e]);s(x.container[0],{childList:!1}),s(x.wrapper[0],{attributes:!1})},x.disconnectObservers=function(){for(var t=0;t<x.observers.length;t++)x.observers[t].disconnect();x.observers=[]},x.createLoop=function(){x.wrapper.children("."+x.params.slideClass+"."+x.params.slideDuplicateClass).remove();var t=x.wrapper.children("."+x.params.slideClass);"auto"!==x.params.slidesPerView||x.params.loopedSlides||(x.params.loopedSlides=t.length),x.loopedSlides=parseInt(x.params.loopedSlides||x.params.slidesPerView,10),x.loopedSlides=x.loopedSlides+x.params.loopAdditionalSlides,x.loopedSlides>t.length&&(x.loopedSlides=t.length);var i,n=[],r=[];for(t.each(function(i,o){var a=e(this);i<x.loopedSlides&&r.push(o),i<t.length&&i>=t.length-x.loopedSlides&&n.push(o),a.attr("data-swiper-slide-index",i)}),i=0;i<r.length;i++)x.wrapper.append(e(r[i].cloneNode(!0)).addClass(x.params.slideDuplicateClass));for(i=n.length-1;i>=0;i--)x.wrapper.prepend(e(n[i].cloneNode(!0)).addClass(x.params.slideDuplicateClass))},x.destroyLoop=function(){x.wrapper.children("."+x.params.slideClass+"."+x.params.slideDuplicateClass).remove(),x.slides.removeAttr("data-swiper-slide-index")},x.reLoop=function(t){var e=x.activeIndex-x.loopedSlides;x.destroyLoop(),x.createLoop(),x.updateSlidesSize(),t&&x.slideTo(e+x.loopedSlides,0,!1)},x.fixLoop=function(){var t;x.activeIndex<x.loopedSlides?(t=x.slides.length-3*x.loopedSlides+x.activeIndex,t+=x.loopedSlides,x.slideTo(t,0,!1,!0)):("auto"===x.params.slidesPerView&&x.activeIndex>=2*x.loopedSlides||x.activeIndex>x.slides.length-2*x.params.slidesPerView)&&(t=-x.slides.length+x.activeIndex+x.loopedSlides,t+=x.loopedSlides,x.slideTo(t,0,!1,!0))},x.appendSlide=function(t){if(x.params.loop&&x.destroyLoop(),"object"==typeof t&&t.length)for(var e=0;e<t.length;e++)t[e]&&x.wrapper.append(t[e]);else x.wrapper.append(t);x.params.loop&&x.createLoop(),x.params.observer&&x.support.observer||x.update(!0)},x.prependSlide=function(t){x.params.loop&&x.destroyLoop();var e=x.activeIndex+1;if("object"==typeof t&&t.length){for(var i=0;i<t.length;i++)t[i]&&x.wrapper.prepend(t[i]);e=x.activeIndex+t.length}else x.wrapper.prepend(t);x.params.loop&&x.createLoop(),x.params.observer&&x.support.observer||x.update(!0),x.slideTo(e,0,!1)},x.removeSlide=function(t){x.params.loop&&(x.destroyLoop(),x.slides=x.wrapper.children("."+x.params.slideClass));var e,i=x.activeIndex;if("object"==typeof t&&t.length){for(var n=0;n<t.length;n++)e=t[n],x.slides[e]&&x.slides.eq(e).remove(),i>e&&i--;i=Math.max(i,0)}else e=t,x.slides[e]&&x.slides.eq(e).remove(),i>e&&i--,i=Math.max(i,0);x.params.loop&&x.createLoop(),x.params.observer&&x.support.observer||x.update(!0),x.params.loop?x.slideTo(i+x.loopedSlides,0,!1):x.slideTo(i,0,!1)},x.removeAllSlides=function(){for(var t=[],e=0;e<x.slides.length;e++)t.push(e);x.removeSlide(t)},x.effects={fade:{setTranslate:function(){for(var t=0;t<x.slides.length;t++){var e=x.slides.eq(t),i=e[0].swiperSlideOffset,n=-i;x.params.virtualTranslate||(n-=x.translate);var r=0;x.isHorizontal()||(r=n,n=0);var o=x.params.fade.crossFade?Math.max(1-Math.abs(e[0].progress),0):1+Math.min(Math.max(e[0].progress,-1),0);e.css({opacity:o}).transform("translate3d("+n+"px, "+r+"px, 0px)")}},setTransition:function(t){if(x.slides.transition(t),x.params.virtualTranslate&&0!==t){var e=!1;x.slides.transitionEnd(function(){if(!e&&x){e=!0,x.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],i=0;i<t.length;i++)x.wrapper.trigger(t[i])}})}}},flip:{setTranslate:function(){for(var t=0;t<x.slides.length;t++){var i=x.slides.eq(t),n=i[0].progress;x.params.flip.limitRotation&&(n=Math.max(Math.min(i[0].progress,1),-1));var r=i[0].swiperSlideOffset,o=-180*n,a=o,s=0,l=-r,c=0;if(x.isHorizontal()?x.rtl&&(a=-a):(c=l,l=0,s=-a,a=0),i[0].style.zIndex=-Math.abs(Math.round(n))+x.slides.length,x.params.flip.slideShadows){var h=i.find(x.isHorizontal()?".swiper-slide-shadow-left":".swiper-slide-shadow-top"),u=i.find(x.isHorizontal()?".swiper-slide-shadow-right":".swiper-slide-shadow-bottom");0===h.length&&(h=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"left":"top")+'"></div>'),i.append(h)),0===u.length&&(u=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"right":"bottom")+'"></div>'),i.append(u)),h.length&&(h[0].style.opacity=Math.max(-n,0)),u.length&&(u[0].style.opacity=Math.max(n,0))}i.transform("translate3d("+l+"px, "+c+"px, 0px) rotateX("+s+"deg) rotateY("+a+"deg)")}},setTransition:function(t){if(x.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),x.params.virtualTranslate&&0!==t){var i=!1;x.slides.eq(x.activeIndex).transitionEnd(function(){if(!i&&x&&e(this).hasClass(x.params.slideActiveClass)){i=!0,x.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=0;n<t.length;n++)x.wrapper.trigger(t[n])}})}}},cube:{setTranslate:function(){var t,i=0;x.params.cube.shadow&&(x.isHorizontal()?(t=x.wrapper.find(".swiper-cube-shadow"),0===t.length&&(t=e('<div class="swiper-cube-shadow"></div>'),x.wrapper.append(t)),t.css({height:x.width+"px"})):(t=x.container.find(".swiper-cube-shadow"),0===t.length&&(t=e('<div class="swiper-cube-shadow"></div>'),x.container.append(t))));for(var n=0;n<x.slides.length;n++){var r=x.slides.eq(n),o=90*n,a=Math.floor(o/360);x.rtl&&(o=-o,a=Math.floor(-o/360));var s=Math.max(Math.min(r[0].progress,1),-1),l=0,c=0,h=0;n%4===0?(l=4*-a*x.size,h=0):(n-1)%4===0?(l=0,h=4*-a*x.size):(n-2)%4===0?(l=x.size+4*a*x.size,h=x.size):(n-3)%4===0&&(l=-x.size,h=3*x.size+4*x.size*a),x.rtl&&(l=-l),x.isHorizontal()||(c=l,l=0);var u="rotateX("+(x.isHorizontal()?0:-o)+"deg) rotateY("+(x.isHorizontal()?o:0)+"deg) translate3d("+l+"px, "+c+"px, "+h+"px)";if(1>=s&&s>-1&&(i=90*n+90*s,x.rtl&&(i=90*-n-90*s)),r.transform(u),x.params.cube.slideShadows){var d=r.find(x.isHorizontal()?".swiper-slide-shadow-left":".swiper-slide-shadow-top"),p=r.find(x.isHorizontal()?".swiper-slide-shadow-right":".swiper-slide-shadow-bottom");0===d.length&&(d=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"left":"top")+'"></div>'),r.append(d)),0===p.length&&(p=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"right":"bottom")+'"></div>'),r.append(p)),d.length&&(d[0].style.opacity=Math.max(-s,0)),p.length&&(p[0].style.opacity=Math.max(s,0))}}if(x.wrapper.css({"-webkit-transform-origin":"50% 50% -"+x.size/2+"px","-moz-transform-origin":"50% 50% -"+x.size/2+"px","-ms-transform-origin":"50% 50% -"+x.size/2+"px","transform-origin":"50% 50% -"+x.size/2+"px"}),x.params.cube.shadow)if(x.isHorizontal())t.transform("translate3d(0px, "+(x.width/2+x.params.cube.shadowOffset)+"px, "+-x.width/2+"px) rotateX(90deg) rotateZ(0deg) scale("+x.params.cube.shadowScale+")");else{var f=Math.abs(i)-90*Math.floor(Math.abs(i)/90),m=1.5-(Math.sin(2*f*Math.PI/360)/2+Math.cos(2*f*Math.PI/360)/2),g=x.params.cube.shadowScale,v=x.params.cube.shadowScale/m,y=x.params.cube.shadowOffset;t.transform("scale3d("+g+", 1, "+v+") translate3d(0px, "+(x.height/2+y)+"px, "+-x.height/2/v+"px) rotateX(-90deg)")}var _=x.isSafari||x.isUiWebView?-x.size/2:0;x.wrapper.transform("translate3d(0px,0,"+_+"px) rotateX("+(x.isHorizontal()?0:i)+"deg) rotateY("+(x.isHorizontal()?-i:0)+"deg)")},setTransition:function(t){x.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),x.params.cube.shadow&&!x.isHorizontal()&&x.container.find(".swiper-cube-shadow").transition(t)}},coverflow:{setTranslate:function(){for(var t=x.translate,i=x.isHorizontal()?-t+x.width/2:-t+x.height/2,n=x.isHorizontal()?x.params.coverflow.rotate:-x.params.coverflow.rotate,r=x.params.coverflow.depth,o=0,a=x.slides.length;a>o;o++){var s=x.slides.eq(o),l=x.slidesSizesGrid[o],c=s[0].swiperSlideOffset,h=(i-c-l/2)/l*x.params.coverflow.modifier,u=x.isHorizontal()?n*h:0,d=x.isHorizontal()?0:n*h,p=-r*Math.abs(h),f=x.isHorizontal()?0:x.params.coverflow.stretch*h,m=x.isHorizontal()?x.params.coverflow.stretch*h:0;Math.abs(m)<.001&&(m=0),Math.abs(f)<.001&&(f=0),Math.abs(p)<.001&&(p=0),Math.abs(u)<.001&&(u=0),Math.abs(d)<.001&&(d=0);var g="translate3d("+m+"px,"+f+"px,"+p+"px)  rotateX("+d+"deg) rotateY("+u+"deg)";if(s.transform(g),s[0].style.zIndex=-Math.abs(Math.round(h))+1,x.params.coverflow.slideShadows){var v=s.find(x.isHorizontal()?".swiper-slide-shadow-left":".swiper-slide-shadow-top"),y=s.find(x.isHorizontal()?".swiper-slide-shadow-right":".swiper-slide-shadow-bottom");0===v.length&&(v=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"left":"top")+'"></div>'),s.append(v)),0===y.length&&(y=e('<div class="swiper-slide-shadow-'+(x.isHorizontal()?"right":"bottom")+'"></div>'),s.append(y)),v.length&&(v[0].style.opacity=h>0?h:0),y.length&&(y[0].style.opacity=-h>0?-h:0)}}if(x.browser.ie){var _=x.wrapper[0].style;_.perspectiveOrigin=i+"px 50%"}},setTransition:function(t){x.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t)}}},x.lazy={initialImageLoaded:!1,loadImageInSlide:function(t,i){if("undefined"!=typeof t&&("undefined"==typeof i&&(i=!0),0!==x.slides.length)){var n=x.slides.eq(t),r=n.find("."+x.params.lazyLoadingClass+":not(."+x.params.lazyStatusLoadedClass+"):not(."+x.params.lazyStatusLoadingClass+")");!n.hasClass(x.params.lazyLoadingClass)||n.hasClass(x.params.lazyStatusLoadedClass)||n.hasClass(x.params.lazyStatusLoadingClass)||(r=r.add(n[0])),0!==r.length&&r.each(function(){var t=e(this);t.addClass(x.params.lazyStatusLoadingClass);var r=t.attr("data-background"),o=t.attr("data-src"),a=t.attr("data-srcset"),s=t.attr("data-sizes");x.loadImage(t[0],o||r,a,s,!1,function(){if(r?(t.css("background-image",'url("'+r+'")'),t.removeAttr("data-background")):(a&&(t.attr("srcset",a),t.removeAttr("data-srcset")),s&&(t.attr("sizes",s),t.removeAttr("data-sizes")),o&&(t.attr("src",o),t.removeAttr("data-src"))),t.addClass(x.params.lazyStatusLoadedClass).removeClass(x.params.lazyStatusLoadingClass),n.find("."+x.params.lazyPreloaderClass+", ."+x.params.preloaderClass).remove(),x.params.loop&&i){var e=n.attr("data-swiper-slide-index");if(n.hasClass(x.params.slideDuplicateClass)){var l=x.wrapper.children('[data-swiper-slide-index="'+e+'"]:not(.'+x.params.slideDuplicateClass+")");x.lazy.loadImageInSlide(l.index(),!1)}else{var c=x.wrapper.children("."+x.params.slideDuplicateClass+'[data-swiper-slide-index="'+e+'"]');x.lazy.loadImageInSlide(c.index(),!1)}}x.emit("onLazyImageReady",x,n[0],t[0])}),x.emit("onLazyImageLoad",x,n[0],t[0])})}},load:function(){var t,i=x.params.slidesPerView;if("auto"===i&&(i=0),x.lazy.initialImageLoaded||(x.lazy.initialImageLoaded=!0),x.params.watchSlidesVisibility)x.wrapper.children("."+x.params.slideVisibleClass).each(function(){x.lazy.loadImageInSlide(e(this).index())});else if(i>1)for(t=x.activeIndex;t<x.activeIndex+i;t++)x.slides[t]&&x.lazy.loadImageInSlide(t);else x.lazy.loadImageInSlide(x.activeIndex);if(x.params.lazyLoadingInPrevNext)if(i>1||x.params.lazyLoadingInPrevNextAmount&&x.params.lazyLoadingInPrevNextAmount>1){var n=x.params.lazyLoadingInPrevNextAmount,r=i,o=Math.min(x.activeIndex+r+Math.max(n,r),x.slides.length),a=Math.max(x.activeIndex-Math.max(r,n),0);for(t=x.activeIndex+i;o>t;t++)x.slides[t]&&x.lazy.loadImageInSlide(t);for(t=a;t<x.activeIndex;t++)x.slides[t]&&x.lazy.loadImageInSlide(t)}else{var s=x.wrapper.children("."+x.params.slideNextClass);s.length>0&&x.lazy.loadImageInSlide(s.index());var l=x.wrapper.children("."+x.params.slidePrevClass);l.length>0&&x.lazy.loadImageInSlide(l.index())}},onTransitionStart:function(){x.params.lazyLoading&&(x.params.lazyLoadingOnTransitionStart||!x.params.lazyLoadingOnTransitionStart&&!x.lazy.initialImageLoaded)&&x.lazy.load()},onTransitionEnd:function(){x.params.lazyLoading&&!x.params.lazyLoadingOnTransitionStart&&x.lazy.load()}},x.scrollbar={isTouched:!1,setDragPosition:function(t){var e=x.scrollbar,i=x.isHorizontal()?"touchstart"===t.type||"touchmove"===t.type?t.targetTouches[0].pageX:t.pageX||t.clientX:"touchstart"===t.type||"touchmove"===t.type?t.targetTouches[0].pageY:t.pageY||t.clientY,n=i-e.track.offset()[x.isHorizontal()?"left":"top"]-e.dragSize/2,r=-x.minTranslate()*e.moveDivider,o=-x.maxTranslate()*e.moveDivider;r>n?n=r:n>o&&(n=o),n=-n/e.moveDivider,x.updateProgress(n),x.setWrapperTranslate(n,!0)},dragStart:function(t){var e=x.scrollbar;e.isTouched=!0,t.preventDefault(),t.stopPropagation(),e.setDragPosition(t),clearTimeout(e.dragTimeout),e.track.transition(0),x.params.scrollbarHide&&e.track.css("opacity",1),x.wrapper.transition(100),e.drag.transition(100),x.emit("onScrollbarDragStart",x)},dragMove:function(t){var e=x.scrollbar;e.isTouched&&(t.preventDefault?t.preventDefault():t.returnValue=!1,e.setDragPosition(t),x.wrapper.transition(0),e.track.transition(0),e.drag.transition(0),x.emit("onScrollbarDragMove",x))},dragEnd:function(){var t=x.scrollbar;t.isTouched&&(t.isTouched=!1,x.params.scrollbarHide&&(clearTimeout(t.dragTimeout),t.dragTimeout=setTimeout(function(){t.track.css("opacity",0),t.track.transition(400)},1e3)),x.emit("onScrollbarDragEnd",x),x.params.scrollbarSnapOnRelease&&x.slideReset())},draggableEvents:function(){return x.params.simulateTouch!==!1||x.support.touch?x.touchEvents:x.touchEventsDesktop}(),enableDraggable:function(){var t=x.scrollbar,i=x.support.touch?t.track:document;e(t.track).on(t.draggableEvents.start,t.dragStart),e(i).on(t.draggableEvents.move,t.dragMove),e(i).on(t.draggableEvents.end,t.dragEnd)},disableDraggable:function(){var t=x.scrollbar,i=x.support.touch?t.track:document;e(t.track).off(t.draggableEvents.start,t.dragStart),e(i).off(t.draggableEvents.move,t.dragMove),e(i).off(t.draggableEvents.end,t.dragEnd)},set:function(){if(x.params.scrollbar){var t=x.scrollbar;t.track=e(x.params.scrollbar),x.params.uniqueNavElements&&"string"==typeof x.params.scrollbar&&t.track.length>1&&1===x.container.find(x.params.scrollbar).length&&(t.track=x.container.find(x.params.scrollbar)),t.drag=t.track.find(".swiper-scrollbar-drag"),0===t.drag.length&&(t.drag=e('<div class="swiper-scrollbar-drag"></div>'),t.track.append(t.drag)),t.drag[0].style.width="",t.drag[0].style.height="",t.trackSize=x.isHorizontal()?t.track[0].offsetWidth:t.track[0].offsetHeight,t.divider=x.size/x.virtualSize,t.moveDivider=t.divider*(t.trackSize/x.size),t.dragSize=t.trackSize*t.divider,x.isHorizontal()?t.drag[0].style.width=t.dragSize+"px":t.drag[0].style.height=t.dragSize+"px",t.track[0].style.display=t.divider>=1?"none":"",x.params.scrollbarHide&&(t.track[0].style.opacity=0)}},setTranslate:function(){if(x.params.scrollbar){var t,e=x.scrollbar,i=(x.translate||0,e.dragSize);t=(e.trackSize-e.dragSize)*x.progress,x.rtl&&x.isHorizontal()?(t=-t,t>0?(i=e.dragSize-t,t=0):-t+e.dragSize>e.trackSize&&(i=e.trackSize+t)):0>t?(i=e.dragSize+t,t=0):t+e.dragSize>e.trackSize&&(i=e.trackSize-t),x.isHorizontal()?(e.drag.transform(x.support.transforms3d?"translate3d("+t+"px, 0, 0)":"translateX("+t+"px)"),e.drag[0].style.width=i+"px"):(e.drag.transform(x.support.transforms3d?"translate3d(0px, "+t+"px, 0)":"translateY("+t+"px)"),e.drag[0].style.height=i+"px"),x.params.scrollbarHide&&(clearTimeout(e.timeout),e.track[0].style.opacity=1,e.timeout=setTimeout(function(){e.track[0].style.opacity=0,e.track.transition(400)},1e3))}},setTransition:function(t){x.params.scrollbar&&x.scrollbar.drag.transition(t)}},x.controller={LinearSpline:function(t,e){this.x=t,this.y=e,this.lastIndex=t.length-1;var i,n;this.x.length,this.interpolate=function(t){return t?(n=r(this.x,t),i=n-1,(t-this.x[i])*(this.y[n]-this.y[i])/(this.x[n]-this.x[i])+this.y[i]):0};var r=function(){var t,e,i;return function(n,r){for(e=-1,t=n.length;t-e>1;)n[i=t+e>>1]<=r?e=i:t=i;return t}}()},getInterpolateFunction:function(t){x.controller.spline||(x.controller.spline=x.params.loop?new x.controller.LinearSpline(x.slidesGrid,t.slidesGrid):new x.controller.LinearSpline(x.snapGrid,t.snapGrid))},setTranslate:function(t,e){function n(e){t=e.rtl&&"horizontal"===e.params.direction?-x.translate:x.translate,"slide"===x.params.controlBy&&(x.controller.getInterpolateFunction(e),o=-x.controller.spline.interpolate(-t)),o&&"container"!==x.params.controlBy||(r=(e.maxTranslate()-e.minTranslate())/(x.maxTranslate()-x.minTranslate()),o=(t-x.minTranslate())*r+e.minTranslate()),x.params.controlInverse&&(o=e.maxTranslate()-o),e.updateProgress(o),e.setWrapperTranslate(o,!1,x),e.updateActiveIndex()}var r,o,a=x.params.control;if(x.isArray(a))for(var s=0;s<a.length;s++)a[s]!==e&&a[s]instanceof i&&n(a[s]);else a instanceof i&&e!==a&&n(a)},setTransition:function(t,e){function n(e){e.setWrapperTransition(t,x),0!==t&&(e.onTransitionStart(),e.wrapper.transitionEnd(function(){o&&(e.params.loop&&"slide"===x.params.controlBy&&e.fixLoop(),e.onTransitionEnd())}))}var r,o=x.params.control;if(x.isArray(o))for(r=0;r<o.length;r++)o[r]!==e&&o[r]instanceof i&&n(o[r]);else o instanceof i&&e!==o&&n(o)}},x.hashnav={onHashCange:function(){var t=document.location.hash.replace("#",""),e=x.slides.eq(x.activeIndex).attr("data-hash");t!==e&&x.slideTo(x.wrapper.children("."+x.params.slideClass+'[data-hash="'+t+'"]').index())},attachEvents:function(t){var i=t?"off":"on";e(window)[i]("hashchange",x.hashnav.onHashCange)},setHash:function(){if(x.hashnav.initialized&&x.params.hashnav)if(x.params.replaceState&&window.history&&window.history.replaceState)window.history.replaceState(null,null,"#"+x.slides.eq(x.activeIndex).attr("data-hash")||"");else{var t=x.slides.eq(x.activeIndex),e=t.attr("data-hash")||t.attr("data-history");document.location.hash=e||""}},init:function(){if(x.params.hashnav&&!x.params.history){x.hashnav.initialized=!0;var t=document.location.hash.replace("#","");if(t)for(var e=0,i=0,n=x.slides.length;n>i;i++){var r=x.slides.eq(i),o=r.attr("data-hash")||r.attr("data-history");if(o===t&&!r.hasClass(x.params.slideDuplicateClass)){var a=r.index();x.slideTo(a,e,x.params.runCallbacksOnInit,!0)}}x.params.hashnavWatchState&&x.hashnav.attachEvents()}},destroy:function(){x.params.hashnavWatchState&&x.hashnav.attachEvents(!0)}},x.history={init:function(){if(x.params.history){if(!window.history||!window.history.pushState)return x.params.history=!1,void(x.params.hashnav=!0);x.history.initialized=!0,this.paths=this.getPathValues(),(this.paths.key||this.paths.value)&&(this.scrollToSlide(0,this.paths.value,x.params.runCallbacksOnInit),x.params.replaceState||window.addEventListener("popstate",this.setHistoryPopState))}},setHistoryPopState:function(){x.history.paths=x.history.getPathValues(),x.history.scrollToSlide(x.params.speed,x.history.paths.value,!1)},getPathValues:function(){var t=window.location.pathname.slice(1).split("/"),e=t.length,i=t[e-2],n=t[e-1];
return{key:i,value:n}},setHistory:function(t,e){if(x.history.initialized&&x.params.history){var i=x.slides.eq(e),n=this.slugify(i.attr("data-history"));window.location.pathname.includes(t)||(n=t+"/"+n),x.params.replaceState?window.history.replaceState(null,null,n):window.history.pushState(null,null,n)}},slugify:function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},scrollToSlide:function(t,e,i){if(e)for(var n=0,r=x.slides.length;r>n;n++){var o=x.slides.eq(n),a=this.slugify(o.attr("data-history"));if(a===e&&!o.hasClass(x.params.slideDuplicateClass)){var s=o.index();x.slideTo(s,t,i)}}else x.slideTo(0,t,i)}},x.disableKeyboardControl=function(){x.params.keyboardControl=!1,e(document).off("keydown",l)},x.enableKeyboardControl=function(){x.params.keyboardControl=!0,e(document).on("keydown",l)},x.mousewheel={event:!1,lastScrollTime:(new window.Date).getTime()},x.params.mousewheelControl&&(x.mousewheel.event=navigator.userAgent.indexOf("firefox")>-1?"DOMMouseScroll":c()?"wheel":"mousewheel"),x.disableMousewheelControl=function(){if(!x.mousewheel.event)return!1;var t=x.container;return"container"!==x.params.mousewheelEventsTarged&&(t=e(x.params.mousewheelEventsTarged)),t.off(x.mousewheel.event,h),!0},x.enableMousewheelControl=function(){if(!x.mousewheel.event)return!1;var t=x.container;return"container"!==x.params.mousewheelEventsTarged&&(t=e(x.params.mousewheelEventsTarged)),t.on(x.mousewheel.event,h),!0},x.parallax={setTranslate:function(){x.container.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){d(this,x.progress)}),x.slides.each(function(){var t=e(this);t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var e=Math.min(Math.max(t[0].progress,-1),1);d(this,e)})})},setTransition:function(t){"undefined"==typeof t&&(t=x.params.speed),x.container.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var i=e(this),n=parseInt(i.attr("data-swiper-parallax-duration"),10)||t;0===t&&(n=0),i.transition(n)})}},x.zoom={scale:1,currentScale:1,isScaling:!1,gesture:{slide:void 0,slideWidth:void 0,slideHeight:void 0,image:void 0,imageWrap:void 0,zoomMax:x.params.zoomMax},image:{isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},velocity:{x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0},getDistanceBetweenTouches:function(t){if(t.targetTouches.length<2)return 1;var e=t.targetTouches[0].pageX,i=t.targetTouches[0].pageY,n=t.targetTouches[1].pageX,r=t.targetTouches[1].pageY,o=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-i,2));return o},onGestureStart:function(t){var i=x.zoom;if(!x.support.gestures){if("touchstart"!==t.type||"touchstart"===t.type&&t.targetTouches.length<2)return;i.gesture.scaleStart=i.getDistanceBetweenTouches(t)}return i.gesture.slide&&i.gesture.slide.length||(i.gesture.slide=e(this),0===i.gesture.slide.length&&(i.gesture.slide=x.slides.eq(x.activeIndex)),i.gesture.image=i.gesture.slide.find("img, svg, canvas"),i.gesture.imageWrap=i.gesture.image.parent("."+x.params.zoomContainerClass),i.gesture.zoomMax=i.gesture.imageWrap.attr("data-swiper-zoom")||x.params.zoomMax,0!==i.gesture.imageWrap.length)?(i.gesture.image.transition(0),void(i.isScaling=!0)):void(i.gesture.image=void 0)},onGestureChange:function(t){var e=x.zoom;if(!x.support.gestures){if("touchmove"!==t.type||"touchmove"===t.type&&t.targetTouches.length<2)return;e.gesture.scaleMove=e.getDistanceBetweenTouches(t)}e.gesture.image&&0!==e.gesture.image.length&&(e.scale=x.support.gestures?t.scale*e.currentScale:e.gesture.scaleMove/e.gesture.scaleStart*e.currentScale,e.scale>e.gesture.zoomMax&&(e.scale=e.gesture.zoomMax-1+Math.pow(e.scale-e.gesture.zoomMax+1,.5)),e.scale<x.params.zoomMin&&(e.scale=x.params.zoomMin+1-Math.pow(x.params.zoomMin-e.scale+1,.5)),e.gesture.image.transform("translate3d(0,0,0) scale("+e.scale+")"))},onGestureEnd:function(t){var e=x.zoom;!x.support.gestures&&("touchend"!==t.type||"touchend"===t.type&&t.changedTouches.length<2)||e.gesture.image&&0!==e.gesture.image.length&&(e.scale=Math.max(Math.min(e.scale,e.gesture.zoomMax),x.params.zoomMin),e.gesture.image.transition(x.params.speed).transform("translate3d(0,0,0) scale("+e.scale+")"),e.currentScale=e.scale,e.isScaling=!1,1===e.scale&&(e.gesture.slide=void 0))},onTouchStart:function(t,e){var i=t.zoom;i.gesture.image&&0!==i.gesture.image.length&&(i.image.isTouched||("android"===t.device.os&&e.preventDefault(),i.image.isTouched=!0,i.image.touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,i.image.touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))},onTouchMove:function(t){var e=x.zoom;if(e.gesture.image&&0!==e.gesture.image.length&&(x.allowClick=!1,e.image.isTouched&&e.gesture.slide)){e.image.isMoved||(e.image.width=e.gesture.image[0].offsetWidth,e.image.height=e.gesture.image[0].offsetHeight,e.image.startX=x.getTranslate(e.gesture.imageWrap[0],"x")||0,e.image.startY=x.getTranslate(e.gesture.imageWrap[0],"y")||0,e.gesture.slideWidth=e.gesture.slide[0].offsetWidth,e.gesture.slideHeight=e.gesture.slide[0].offsetHeight,e.gesture.imageWrap.transition(0),x.rtl&&(e.image.startX=-e.image.startX),x.rtl&&(e.image.startY=-e.image.startY));var i=e.image.width*e.scale,n=e.image.height*e.scale;if(!(i<e.gesture.slideWidth&&n<e.gesture.slideHeight)){if(e.image.minX=Math.min(e.gesture.slideWidth/2-i/2,0),e.image.maxX=-e.image.minX,e.image.minY=Math.min(e.gesture.slideHeight/2-n/2,0),e.image.maxY=-e.image.minY,e.image.touchesCurrent.x="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,e.image.touchesCurrent.y="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,!e.image.isMoved&&!e.isScaling){if(x.isHorizontal()&&Math.floor(e.image.minX)===Math.floor(e.image.startX)&&e.image.touchesCurrent.x<e.image.touchesStart.x||Math.floor(e.image.maxX)===Math.floor(e.image.startX)&&e.image.touchesCurrent.x>e.image.touchesStart.x)return void(e.image.isTouched=!1);if(!x.isHorizontal()&&Math.floor(e.image.minY)===Math.floor(e.image.startY)&&e.image.touchesCurrent.y<e.image.touchesStart.y||Math.floor(e.image.maxY)===Math.floor(e.image.startY)&&e.image.touchesCurrent.y>e.image.touchesStart.y)return void(e.image.isTouched=!1)}t.preventDefault(),t.stopPropagation(),e.image.isMoved=!0,e.image.currentX=e.image.touchesCurrent.x-e.image.touchesStart.x+e.image.startX,e.image.currentY=e.image.touchesCurrent.y-e.image.touchesStart.y+e.image.startY,e.image.currentX<e.image.minX&&(e.image.currentX=e.image.minX+1-Math.pow(e.image.minX-e.image.currentX+1,.8)),e.image.currentX>e.image.maxX&&(e.image.currentX=e.image.maxX-1+Math.pow(e.image.currentX-e.image.maxX+1,.8)),e.image.currentY<e.image.minY&&(e.image.currentY=e.image.minY+1-Math.pow(e.image.minY-e.image.currentY+1,.8)),e.image.currentY>e.image.maxY&&(e.image.currentY=e.image.maxY-1+Math.pow(e.image.currentY-e.image.maxY+1,.8)),e.velocity.prevPositionX||(e.velocity.prevPositionX=e.image.touchesCurrent.x),e.velocity.prevPositionY||(e.velocity.prevPositionY=e.image.touchesCurrent.y),e.velocity.prevTime||(e.velocity.prevTime=Date.now()),e.velocity.x=(e.image.touchesCurrent.x-e.velocity.prevPositionX)/(Date.now()-e.velocity.prevTime)/2,e.velocity.y=(e.image.touchesCurrent.y-e.velocity.prevPositionY)/(Date.now()-e.velocity.prevTime)/2,Math.abs(e.image.touchesCurrent.x-e.velocity.prevPositionX)<2&&(e.velocity.x=0),Math.abs(e.image.touchesCurrent.y-e.velocity.prevPositionY)<2&&(e.velocity.y=0),e.velocity.prevPositionX=e.image.touchesCurrent.x,e.velocity.prevPositionY=e.image.touchesCurrent.y,e.velocity.prevTime=Date.now(),e.gesture.imageWrap.transform("translate3d("+e.image.currentX+"px, "+e.image.currentY+"px,0)")}}},onTouchEnd:function(t){var e=t.zoom;if(e.gesture.image&&0!==e.gesture.image.length){if(!e.image.isTouched||!e.image.isMoved)return e.image.isTouched=!1,void(e.image.isMoved=!1);e.image.isTouched=!1,e.image.isMoved=!1;var i=300,n=300,r=e.velocity.x*i,o=e.image.currentX+r,a=e.velocity.y*n,s=e.image.currentY+a;0!==e.velocity.x&&(i=Math.abs((o-e.image.currentX)/e.velocity.x)),0!==e.velocity.y&&(n=Math.abs((s-e.image.currentY)/e.velocity.y));var l=Math.max(i,n);e.image.currentX=o,e.image.currentY=s;var c=e.image.width*e.scale,h=e.image.height*e.scale;e.image.minX=Math.min(e.gesture.slideWidth/2-c/2,0),e.image.maxX=-e.image.minX,e.image.minY=Math.min(e.gesture.slideHeight/2-h/2,0),e.image.maxY=-e.image.minY,e.image.currentX=Math.max(Math.min(e.image.currentX,e.image.maxX),e.image.minX),e.image.currentY=Math.max(Math.min(e.image.currentY,e.image.maxY),e.image.minY),e.gesture.imageWrap.transition(l).transform("translate3d("+e.image.currentX+"px, "+e.image.currentY+"px,0)")}},onTransitionEnd:function(t){var e=t.zoom;e.gesture.slide&&t.previousIndex!==t.activeIndex&&(e.gesture.image.transform("translate3d(0,0,0) scale(1)"),e.gesture.imageWrap.transform("translate3d(0,0,0)"),e.gesture.slide=e.gesture.image=e.gesture.imageWrap=void 0,e.scale=e.currentScale=1)},toggleZoom:function(t,i){var n=t.zoom;if(n.gesture.slide||(n.gesture.slide=t.clickedSlide?e(t.clickedSlide):t.slides.eq(t.activeIndex),n.gesture.image=n.gesture.slide.find("img, svg, canvas"),n.gesture.imageWrap=n.gesture.image.parent("."+t.params.zoomContainerClass)),n.gesture.image&&0!==n.gesture.image.length){var r,o,a,s,l,c,h,u,d,p,f,m,g,v,y,_,w,x;"undefined"==typeof n.image.touchesStart.x&&i?(r="touchend"===i.type?i.changedTouches[0].pageX:i.pageX,o="touchend"===i.type?i.changedTouches[0].pageY:i.pageY):(r=n.image.touchesStart.x,o=n.image.touchesStart.y),n.scale&&1!==n.scale?(n.scale=n.currentScale=1,n.gesture.imageWrap.transition(300).transform("translate3d(0,0,0)"),n.gesture.image.transition(300).transform("translate3d(0,0,0) scale(1)"),n.gesture.slide=void 0):(n.scale=n.currentScale=n.gesture.imageWrap.attr("data-swiper-zoom")||t.params.zoomMax,i?(w=n.gesture.slide[0].offsetWidth,x=n.gesture.slide[0].offsetHeight,a=n.gesture.slide.offset().left,s=n.gesture.slide.offset().top,l=a+w/2-r,c=s+x/2-o,d=n.gesture.image[0].offsetWidth,p=n.gesture.image[0].offsetHeight,f=d*n.scale,m=p*n.scale,g=Math.min(w/2-f/2,0),v=Math.min(x/2-m/2,0),y=-g,_=-v,h=l*n.scale,u=c*n.scale,g>h&&(h=g),h>y&&(h=y),v>u&&(u=v),u>_&&(u=_)):(h=0,u=0),n.gesture.imageWrap.transition(300).transform("translate3d("+h+"px, "+u+"px,0)"),n.gesture.image.transition(300).transform("translate3d(0,0,0) scale("+n.scale+")"))}},attachEvents:function(t){var i=t?"off":"on";if(x.params.zoom){var n=(x.slides,!("touchstart"!==x.touchEvents.start||!x.support.passiveListener||!x.params.passiveListeners)&&{passive:!0,capture:!1});x.support.gestures?(x.slides[i]("gesturestart",x.zoom.onGestureStart,n),x.slides[i]("gesturechange",x.zoom.onGestureChange,n),x.slides[i]("gestureend",x.zoom.onGestureEnd,n)):"touchstart"===x.touchEvents.start&&(x.slides[i](x.touchEvents.start,x.zoom.onGestureStart,n),x.slides[i](x.touchEvents.move,x.zoom.onGestureChange,n),x.slides[i](x.touchEvents.end,x.zoom.onGestureEnd,n)),x[i]("touchStart",x.zoom.onTouchStart),x.slides.each(function(t,n){e(n).find("."+x.params.zoomContainerClass).length>0&&e(n)[i](x.touchEvents.move,x.zoom.onTouchMove)}),x[i]("touchEnd",x.zoom.onTouchEnd),x[i]("transitionEnd",x.zoom.onTransitionEnd),x.params.zoomToggle&&x.on("doubleTap",x.zoom.toggleZoom)}},init:function(){x.zoom.attachEvents()},destroy:function(){x.zoom.attachEvents(!0)}},x._plugins=[];for(var N in x.plugins){var B=x.plugins[N](x,x.params[N]);B&&x._plugins.push(B)}return x.callPlugins=function(t){for(var e=0;e<x._plugins.length;e++)t in x._plugins[e]&&x._plugins[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},x.emitterEventListeners={},x.emit=function(t){x.params[t]&&x.params[t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);var e;if(x.emitterEventListeners[t])for(e=0;e<x.emitterEventListeners[t].length;e++)x.emitterEventListeners[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);x.callPlugins&&x.callPlugins(t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},x.on=function(t,e){return t=p(t),x.emitterEventListeners[t]||(x.emitterEventListeners[t]=[]),x.emitterEventListeners[t].push(e),x},x.off=function(t,e){var i;if(t=p(t),"undefined"==typeof e)return x.emitterEventListeners[t]=[],x;if(x.emitterEventListeners[t]&&0!==x.emitterEventListeners[t].length){for(i=0;i<x.emitterEventListeners[t].length;i++)x.emitterEventListeners[t][i]===e&&x.emitterEventListeners[t].splice(i,1);return x}},x.once=function(t,e){t=p(t);var i=function(){e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),x.off(t,i)};return x.on(t,i),x},x.a11y={makeFocusable:function(t){return t.attr("tabIndex","0"),t},addRole:function(t,e){return t.attr("role",e),t},addLabel:function(t,e){return t.attr("aria-label",e),t},disable:function(t){return t.attr("aria-disabled",!0),t},enable:function(t){return t.attr("aria-disabled",!1),t},onEnterKey:function(t){13===t.keyCode&&(e(t.target).is(x.params.nextButton)?(x.onClickNext(t),x.a11y.notify(x.isEnd?x.params.lastSlideMessage:x.params.nextSlideMessage)):e(t.target).is(x.params.prevButton)&&(x.onClickPrev(t),x.a11y.notify(x.isBeginning?x.params.firstSlideMessage:x.params.prevSlideMessage)),e(t.target).is("."+x.params.bulletClass)&&e(t.target)[0].click())},liveRegion:e('<span class="'+x.params.notificationClass+'" aria-live="assertive" aria-atomic="true"></span>'),notify:function(t){var e=x.a11y.liveRegion;0!==e.length&&(e.html(""),e.html(t))},init:function(){x.params.nextButton&&x.nextButton&&x.nextButton.length>0&&(x.a11y.makeFocusable(x.nextButton),x.a11y.addRole(x.nextButton,"button"),x.a11y.addLabel(x.nextButton,x.params.nextSlideMessage)),x.params.prevButton&&x.prevButton&&x.prevButton.length>0&&(x.a11y.makeFocusable(x.prevButton),x.a11y.addRole(x.prevButton,"button"),x.a11y.addLabel(x.prevButton,x.params.prevSlideMessage)),e(x.container).append(x.a11y.liveRegion)},initPagination:function(){x.params.pagination&&x.params.paginationClickable&&x.bullets&&x.bullets.length&&x.bullets.each(function(){var t=e(this);x.a11y.makeFocusable(t),x.a11y.addRole(t,"button"),x.a11y.addLabel(t,x.params.paginationBulletMessage.replace(/{{index}}/,t.index()+1))})},destroy:function(){x.a11y.liveRegion&&x.a11y.liveRegion.length>0&&x.a11y.liveRegion.remove()}},x.init=function(){x.params.loop&&x.createLoop(),x.updateContainerSize(),x.updateSlidesSize(),x.updatePagination(),x.params.scrollbar&&x.scrollbar&&(x.scrollbar.set(),x.params.scrollbarDraggable&&x.scrollbar.enableDraggable()),"slide"!==x.params.effect&&x.effects[x.params.effect]&&(x.params.loop||x.updateProgress(),x.effects[x.params.effect].setTranslate()),x.params.loop?x.slideTo(x.params.initialSlide+x.loopedSlides,0,x.params.runCallbacksOnInit):(x.slideTo(x.params.initialSlide,0,x.params.runCallbacksOnInit),0===x.params.initialSlide&&(x.parallax&&x.params.parallax&&x.parallax.setTranslate(),x.lazy&&x.params.lazyLoading&&(x.lazy.load(),x.lazy.initialImageLoaded=!0))),x.attachEvents(),x.params.observer&&x.support.observer&&x.initObservers(),x.params.preloadImages&&!x.params.lazyLoading&&x.preloadImages(),x.params.zoom&&x.zoom&&x.zoom.init(),x.params.autoplay&&x.startAutoplay(),x.params.keyboardControl&&x.enableKeyboardControl&&x.enableKeyboardControl(),x.params.mousewheelControl&&x.enableMousewheelControl&&x.enableMousewheelControl(),x.params.hashnavReplaceState&&(x.params.replaceState=x.params.hashnavReplaceState),x.params.history&&x.history&&x.history.init(),x.params.hashnav&&x.hashnav&&x.hashnav.init(),x.params.a11y&&x.a11y&&x.a11y.init(),x.emit("onInit",x)},x.cleanupStyles=function(){x.container.removeClass(x.classNames.join(" ")).removeAttr("style"),x.wrapper.removeAttr("style"),x.slides&&x.slides.length&&x.slides.removeClass([x.params.slideVisibleClass,x.params.slideActiveClass,x.params.slideNextClass,x.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),x.paginationContainer&&x.paginationContainer.length&&x.paginationContainer.removeClass(x.params.paginationHiddenClass),x.bullets&&x.bullets.length&&x.bullets.removeClass(x.params.bulletActiveClass),x.params.prevButton&&e(x.params.prevButton).removeClass(x.params.buttonDisabledClass),x.params.nextButton&&e(x.params.nextButton).removeClass(x.params.buttonDisabledClass),x.params.scrollbar&&x.scrollbar&&(x.scrollbar.track&&x.scrollbar.track.length&&x.scrollbar.track.removeAttr("style"),x.scrollbar.drag&&x.scrollbar.drag.length&&x.scrollbar.drag.removeAttr("style"))},x.destroy=function(t,e){x.detachEvents(),x.stopAutoplay(),x.params.scrollbar&&x.scrollbar&&x.params.scrollbarDraggable&&x.scrollbar.disableDraggable(),x.params.loop&&x.destroyLoop(),e&&x.cleanupStyles(),x.disconnectObservers(),x.params.zoom&&x.zoom&&x.zoom.destroy(),x.params.keyboardControl&&x.disableKeyboardControl&&x.disableKeyboardControl(),x.params.mousewheelControl&&x.disableMousewheelControl&&x.disableMousewheelControl(),x.params.a11y&&x.a11y&&x.a11y.destroy(),x.params.history&&!x.params.replaceState&&window.removeEventListener("popstate",x.history.setHistoryPopState),x.params.hashnav&&x.hashnav&&x.hashnav.destroy(),x.emit("onDestroy"),t!==!1&&(x=null)},x.init(),x}};i.prototype={isSafari:function(){var t=window.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}(),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(window.navigator.userAgent),isArray:function(t){return"[object Array]"===Object.prototype.toString.apply(t)},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>1||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>1,lteIE9:function(){var t=document.createElement("div");return t.innerHTML="<!--[if lte IE 9]><i></i><![endif]-->",1===t.getElementsByTagName("i").length}()},device:function(){var t=window.navigator.userAgent,e=t.match(/(Android);?[\s\/]+([\d.]+)?/),i=t.match(/(iPad).*OS\s([\d_]+)/),n=t.match(/(iPod)(.*OS\s([\d_]+))?/),r=!i&&t.match(/(iPhone\sOS|iOS)\s([\d_]+)/);return{ios:i||r||n,android:e}}(),support:{touch:window.Modernizr&&Modernizr.touch===!0||function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){var t=document.createElement("div").style;return"webkitPerspective"in t||"MozPerspective"in t||"OPerspective"in t||"MsPerspective"in t||"perspective"in t}(),flexbox:function(){for(var t=document.createElement("div").style,e="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),i=0;i<e.length;i++)if(e[i]in t)return!0}(),observer:function(){return"MutationObserver"in window||"WebkitMutationObserver"in window}(),passiveListener:function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveListener",null,e)}catch(t){}return t}(),gestures:function(){return"ongesturestart"in window}()},plugins:{}};for(var n=["jQuery","Zepto","Dom7"],r=0;r<n.length;r++)window[n[r]]&&t(window[n[r]]);var o;o="undefined"==typeof Dom7?window.Dom7||window.Zepto||window.jQuery:Dom7,o&&("transitionEnd"in o.fn||(o.fn.transitionEnd=function(t){function e(o){if(o.target===this)for(t.call(this,o),i=0;i<n.length;i++)r.off(n[i],e)}var i,n=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],r=this;if(t)for(i=0;i<n.length;i++)r.on(n[i],e);return this}),"transform"in o.fn||(o.fn.transform=function(t){for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return this}),"transition"in o.fn||(o.fn.transition=function(t){"string"!=typeof t&&(t+="ms");for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return this}),"outerWidth"in o.fn||(o.fn.outerWidth=function(t){return this.length>0?t?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null})),window.Swiper=i}(),"undefined"!=typeof module?module.exports=window.Swiper:"function"==typeof define&&define.amd&&define([],function(){"use strict";return window.Swiper}),window.TCE||(window.TCE={}),TCE.Tabs=function(t,e){this.options=$.extend({},this.defaults,e),this.element=t,this.on_window_resize=_.debounce(this.on_window_resize,100),_.bindAll(this,"on_nav_click","on_header_click","on_window_resize"),this.nav=$("[data-navigation]",this.element).children(),this.tabs=$("[data-tab]",this.element),this.init_navigation(),this.init_content()},$.extend(TCE.Tabs.prototype,{defaults:{equal_heights:!1},init_navigation:function(){var t=this.nav.filter(".active");0==t.length&&(t=this.nav.eq(0)),this.activate_nav_item(t),this.nav.on("click",this.on_nav_click),this.tabs.on("click",".header",this.on_header_click)},activate_nav_item:function(t){this.nav.not(t).filter(".active").removeClass("active"),t.hasClass("active")||t.addClass("active");var e=t.attr("href");void 0===e&&(e=t.children("a").attr("href"));var i=this.tabs.filter(e);this.activate_tab(i)},activate_tab:function(t){if(this.tabs.not(t).filter(".active_tab").removeClass("active_tab"),0==t.length||t.hasClass("active_tab")||t.addClass("active_tab"),1==this.hayclick){var e=t.find(".m_media_slide_viewport"),i=$(e.get(0));"undefined"==typeof i.data("swiper")&&t.find(".m_media_slide").each(function(){$(this).on("touchend",".m_media",function(t){Device.is_desktop&&(t.preventDefault(),$(t.target).trigger("click"))});$(this).swiper({slidesPerView:"auto",wrapperClass:"m_media_slide_wrapper",slideClass:"m_media",autoplay:5e3,preventLinks:!1})})}this.element.trigger($.Event("tab_change",{tab:t})),this.hayclick=!1},on_nav_click:function(t){t.preventDefault(),this.hayclick=!0,this.activate_nav_item($(t.currentTarget))},on_header_click:function(t){t.preventDefault();var e=$(t.currentTarget),i=e.closest(".tab"),n=i.attr("id"),r=n&&n.match(/\S/)?$("[href=#"+n+"]"):null;r&&r.length?this.activate_nav_item(r):this.activate_tab(i)},init_content:function(){this.equalize_heights(),this.options.equal_heights&&!Browser.is_msie("< 9")&&$(window).resize(this.on_window_resize)},on_window_resize:function(){this.tabs.css("height","auto"),_.defer(_.bind(this.equalize_heights,this))},equalize_heights:function(){if(this.options.equal_heights){var t=_.chain(this.tabs).map(function(t){return $(t)}).max(function(t){return t.height()}).value();this.tabs.css("height",t.height())}},current_tab:function(){return this.tabs.filter(".active")}}),$.fn.tabs=function(t){return $(this).each(function(){var e=$(this);e.data("m-tabs")||e.data("m-tabs",new TCE.Tabs(e,t))})},function(t){function e(e,i,n,r){t.each(a,function(t,o){o[e].call(this,i,n,r)})}function i(t){var i=s.Event(t);o=s.State(i),e("touchstart",t,o,i)}function n(t){var i=s.Event(t);o.move.push(i),e("touchmove",t,o,i)}function r(t){var i=s.Event(t);o.end=i,e("touchend",t,o,i)}var o,a={},s={on:function(){t(document).on("touchstart",i).on("touchmove",n).on("touchend touchcancel",r)},off:function(){t(document).off("touchstart",i).off("touchmove",n).off("touchend touchcancel",r)},track:function(t,e){a[t]=e},addEventParam:function(e,i){var n=t(e.target),r=n.offset(),o={pageX:e.point[0].x,pageY:e.point[0].y,offsetX:r.left-e.point[0].x,offsetY:r.top-e.point[0].y};return t.extend(o,i)},Event:function(e){var i={type:e.type,timestamp:(new Date).getTime(),target:e.target,point:[]},n=e.changedTouches||e.originalEvent.changedTouches||e.touches||e.originalEvent.touches;return t.each(n,function(t,e){i.point.push({x:e.pageX,y:e.pageY})}),i},State:function(t){return t.point[0],{start:t,move:[],end:null}},calc:{getDuration:function(t,e){return e.timestamp-t.timestamp},getDistance:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},getAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},getDirection:function(t){return-45>t&&t>-135?"top":t>=-45&&45>=t?"right":t>=45&&135>t?"down":t>=135||-135>=t?"left":"unknown"},getScale:function(t,e){var i=t.point,n=e.point;return 2===i.length&&2===n.length?(Math.sqrt(Math.pow(n[0].x-n[1].x,2)+Math.pow(n[0].y-n[1].y,2))/Math.sqrt(Math.pow(i[0].x-i[1].x,2)+Math.pow(i[0].y-i[1].y,2))).toFixed(2):0},getRotation:function(t,e){var i=t.point,n=e.point;return 2===i.length&&2===n.length?(180*Math.atan2(n[0].y-n[1].y,n[0].x-n[1].x)/Math.PI-180*Math.atan2(i[0].y-i[1].y,i[0].x-i[1].x)/Math.PI).toFixed(2):0}}};s.on(),t.toe=s}(jQuery,this),function(t,e){var i="swipe",n={distance:40,duration:1200,direction:"all"};e.track(i,{touchstart:function(t,e,n){e[i]={finger:n.point.length}},touchmove:function(t,e,n){e[i].finger=n.point.length>e[i].finger?n.point.length:e[i].finger},touchend:function(r,o,a){var s,l,c=t.extend(n,r.data);s=e.calc.getDuration(o.start,a),l=e.calc.getDistance(o.start.point[0],a.point[0]),c.duration>s&&l>c.distance&&(o[i].angle=e.calc.getAngle(o.start.point[0],a.point[0]),o[i].direction=e.calc.getDirection(o[i].angle),("all"===c.direction||o[i].direction===c.direction)&&t(r.target).trigger(t.Event(i,e.addEventParam(o.start,o[i]))))}})}(jQuery,jQuery.toe,this),function(t,e){var i="tap",n={distance:10,duration:300,finger:1};e.track(i,{touchstart:function(t,e,n){e[i]={finger:n.point.length}},touchmove:function(t,e,n){e[i].finger=n.point.length>e[i].finger?n.point.length:e[i].finger},touchend:function(r,o,a){var s,l,c=t.extend(n,r.data);s=e.calc.getDuration(o.start,a),l=e.calc.getDistance(o.start.point[0],a.point[0]),c.duration>s&&c.distance>l&&o[i].finger===c.finger&&t(r.target).trigger(t.Event(i,e.addEventParam(o.start,o[i])))}})}(jQuery,jQuery.toe,this),function(t,e){var i,n,r="taphold",o={distance:20,duration:500,finger:1};e.track(r,{touchstart:function(a,s,l){var c=t.extend(o,a.data);n=!1,s[r]={finger:l.point.length},clearTimeout(i),i=setTimeout(function(){n||s[r].finger===c.finger&&t(a.target).trigger(t.Event(r,e.addEventParam(l,s[r])))},c.duration)},touchmove:function(i,a,s){var l,c=t.extend(o,i.data);a[r].finger=s.point.length>a[r].finger?s.point.length:a[r].finger,l=e.calc.getDistance(a.start.point[0],s.point[0]),l>c.distance&&(n=!0)},touchend:function(){n=!0,clearTimeout(i)}})}(jQuery,jQuery.toe,this),function(t,e){var i,n="transform",r={scale:.1,rotation:15};e.track(n,{touchstart:function(t,e,r){i=!1,e[n]={start:r,move:[]}},touchmove:function(o,a,s){var l=t.extend(r,o.data);2===s.point.length&&(a[n].move.push(s),2!==a[n].start.point.length&&2===s.point.length&&(a[n].start=t.extend({},s)),a[n].rotation=e.calc.getRotation(a[n].start,s),a[n].scale=e.calc.getScale(a[n].start,s),(Math.abs(1-a[n].scale)>l.scale||Math.abs(a[n].rotation)>l.rotation)&&(i||(t(o.target).trigger(t.Event("transformstart",a[n])),i=!0),t(o.target).trigger(t.Event("transform",a[n]))))},touchend:function(r,o,a){i&&(i=!1,2!==a.point.length&&(o.end=t.extend({},o[n].move[o[n].move.length-1])),o[n].rotation=e.calc.getRotation(o[n].start,o.end),o[n].scale=e.calc.getScale(o[n].start,o.end),t(r.target).trigger(t.Event("transformend",o[n])))}})}(jQuery,jQuery.toe,this),function(t){"use strict";function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,r=0,o=i.length;o>r;r++)if(e=i[r]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define(function(){return e}):t.getStyleProperty=e}(window),function(t){"use strict";function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=a.length;i>e;e++){var n=a[e];t[n]=0}return t}function n(t){function n(t){if("string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var n=o(t);if("none"===n.display)return i();var l={};l.width=t.offsetWidth,l.height=t.offsetHeight;for(var c=l.isBorderBox=!(!s||!n[s]||"border-box"!==n[s]),h=0,u=a.length;u>h;h++){var d=a[h],p=n[d],f=parseFloat(p);l[d]=isNaN(f)?0:f}var m=l.paddingLeft+l.paddingRight,g=l.paddingTop+l.paddingBottom,v=l.marginLeft+l.marginRight,y=l.marginTop+l.marginBottom,_=l.borderLeftWidth+l.borderRightWidth,w=l.borderTopWidth+l.borderBottomWidth,x=c&&r,b=n.width.match("em")?!1:e(n.width);b!==!1&&(l.width=b+(x?0:m+_));var M=e(n.height);return M!==!1&&(l.height=M+(x?0:g+w)),l.innerWidth=l.width-(m+_),l.innerHeight=l.height-(g+w),l.outerWidth=l.width+v,l.outerHeight=l.height+y,l}}var r,s=t("boxSizing");return function(){if(s){var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style[s]="border-box";var i=document.body||document.documentElement;i.appendChild(t);var n=o(t);r=200===e(n.width),i.removeChild(t)}}(),n}var r=document.defaultView,o=r&&r.getComputedStyle?function(t){return r.getComputedStyle(t,null)}:function(t){return t.currentStyle},a=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define(["get-style-property"],n):t.getSize=n(t.getStyleProperty)}(window),function(t){"use strict";var e=document.documentElement,i=function(){};e.addEventListener?i=function(t,e,i){t.addEventListener(e,i,!1)}:e.attachEvent&&(i=function(e,i,n){e[i+n]=n.handleEvent?function(){var e=t.event;e.target=e.target||e.srcElement,n.handleEvent.call(n,e)}:function(){var i=t.event;i.target=i.target||i.srcElement,n.call(e,i)},e.attachEvent("on"+i,e[i+n])});var n=function(){};e.removeEventListener?n=function(t,e,i){t.removeEventListener(e,i,!1)}:e.detachEvent&&(n=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var r={bind:i,unbind:n};"function"==typeof define&&define.amd?define(r):t.eventie=r}(this),function(t){"use strict";function e(t){"function"==typeof t&&(e.isReady?t():o.push(t))}function i(t){var i="readystatechange"===t.type&&"complete"!==r.readyState;if(!e.isReady&&!i){e.isReady=!0;for(var n=0,a=o.length;a>n;n++){var s=o[n];s()}}}function n(n){return n.bind(r,"DOMContentLoaded",i),n.bind(r,"readystatechange",i),n.bind(t,"load",i),e}var r=t.document,o=[];e.isReady=!1,"function"==typeof define&&define.amd?define(["eventie"],n):t.docReady=n(t.eventie)}(this),function(t){"use strict";function e(){}function i(t,e){if(r)return e.indexOf(t);for(var i=e.length;i--;)if(e[i]===t)return i;return-1}var n=e.prototype,r=Array.prototype.indexOf?!0:!1;n._getEvents=function(){return this._events||(this._events={})},n.getListeners=function(t){var e,i,n=this._getEvents();if("object"==typeof t){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,e){var n,r=this.getListenersAsObject(t);for(n in r)r.hasOwnProperty(n)&&-1===i(e,r[n])&&r[n].push(e);return this},n.on=n.addListener,n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,e){var n,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&(n=i(e,o[r]),-1!==n&&o[r].splice(n,1));return this},n.off=n.removeListener,n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,r,o=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)o.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(r=e[n])&&("function"==typeof r?o.call(this,n,r):a.call(this,n,r));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if("object"===i)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.emitEvent=function(t,e){var i,n,r,o=this.getListenersAsObject(t);for(n in o)if(o.hasOwnProperty(n))for(i=o[n].length;i--;)r=e?o[n][i].apply(null,e):o[n][i](),r===!0&&this.removeListener(t,o[n][i]);return this},n.trigger=n.emitEvent,n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);
return this.emitEvent(t,e)},"function"==typeof define&&define.amd?define(function(){return e}):t.EventEmitter=e}(this),function(t){"use strict";function e(){}function i(t){function i(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function r(e,i){t.fn[e]=function(r){if("string"==typeof r){for(var a=n.call(arguments,1),s=0,l=this.length;l>s;s++){var c=this[s],h=t.data(c,e);if(h)if(t.isFunction(h[r])&&"_"!==r.charAt(0)){var u=h[r].apply(h,a);if(void 0!==u)return u}else o("no such method '"+r+"' for "+e+" instance");else o("cannot call methods on "+e+" prior to initialization; attempted to call '"+r+"'")}return this}return this.each(function(){var n=t.data(this,e);n?(n.option(r),n._init()):(n=new i(this,r),t.data(this,e,n))})}}if(t){var o="undefined"==typeof console?e:function(t){console.error(t)};t.bridget=function(t,e){i(e),r(t,e)}}}var n=Array.prototype.slice;"function"==typeof define&&define.amd?define(["jquery"],i):i(t.jQuery)}(window),function(t,e){"use strict";function i(t,e){return t[s](e)}function n(t){if(!t.parentNode){var e=document.createDocumentFragment();e.appendChild(t)}}function r(t,e){n(t);for(var i=t.parentNode.querySelectorAll(e),r=0,o=i.length;o>r;r++)if(i[r]===t)return!0;return!1}function o(t,e){return n(t),i(t,e)}var a,s=function(){if(e.matchesSelector)return"matchesSelector";for(var t=["webkit","moz","ms","o"],i=0,n=t.length;n>i;i++){var r=t[i],o=r+"MatchesSelector";if(e[o])return o}}();if(s){var l=document.createElement("div"),c=i(l,"div");a=c?i:o}else a=r;"function"==typeof define&&define.amd?define(function(){return a}):window.matchesSelector=a}(this,Element.prototype),function(t){"use strict";function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var n=t.getSize,r=t.getStyleProperty,o=t.EventEmitter,a=document.defaultView,s=a&&a.getComputedStyle?function(t){return a.getComputedStyle(t,null)}:function(t){return t.currentStyle},l=r("transition"),c=r("transform"),h=l&&c,u=!!r("perspective"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[l],p=["transform","transition","transitionDuration","transitionProperty"],f=function(){for(var t={},e=0,i=p.length;i>e;e++){var n=p[e],o=r(n);o&&o!==n&&(t[n]=o)}return t}();e(i.prototype,o.prototype),i.prototype._create=function(){this.css({position:"absolute"})},i.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.prototype.getSize=function(){this.size=n(this.element)},i.prototype.css=function(t){var e=this.element.style;for(var i in t){var n=f[i]||i;"NaNpx"==t[i]&&(t[i]="0px"),e[n]=t[i]}},i.prototype.getPosition=function(){var t=s(this.element),e=this.layout.options,i=e.isOriginLeft,n=e.isOriginTop,r=parseInt(t[i?"left":"right"],10),o=parseInt(t[n?"top":"bottom"],10);r=isNaN(r)?0:r,o=isNaN(o)?0:o;var a=this.layout.size;r-=i?a.paddingLeft:a.paddingRight,o-=n?a.paddingTop:a.paddingBottom,this.position.x=r,this.position.y=o},i.prototype.layoutPosition=function(){var t=this.layout.size,e=this.layout.options,i={};e.isOriginLeft?(i.left=this.position.x+t.paddingLeft+"px",i.right=""):(i.right=this.position.x+t.paddingRight+"px",i.left=""),e.isOriginTop?(i.top=this.position.y+t.paddingTop+"px",i.bottom=""):(i.bottom=this.position.y+t.paddingBottom+"px",i.top=""),this.css(i),this.emitEvent("layout",[this])};var m=u?function(t,e){return"translate3d("+t+"px, "+e+"px, 0)"}:function(t,e){return"translate("+t+"px, "+e+"px)"};i.prototype._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,r=parseInt(t,10),o=parseInt(e,10),a=r===this.position.x&&o===this.position.y;if(this.setPosition(t,e),a&&!this.isTransitioning)return void this.layoutPosition();var s=t-i,l=e-n,c={},h=this.layout.options;s=h.isOriginLeft?s:-s,l=h.isOriginTop?l:-l,c.transform=m(s,l),this.transition({to:c,onTransitionEnd:this.layoutPosition,isCleaning:!0})},i.prototype.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},i.prototype.moveTo=h?i.prototype._transitionTo:i.prototype.goTo,i.prototype.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},i.prototype._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to),t.onTransitionEnd&&t.onTransitionEnd.call(this)},i.prototype._transition=function(t){var e=this.layout.options.transitionDuration;if(!parseFloat(e))return void this._nonTransition(t);var i=t.to,n=[];for(var r in i)n.push(r);var o={};if(o.transitionProperty=n.join(","),o.transitionDuration=e,this.element.addEventListener(d,this,!1),(t.isCleaning||t.onTransitionEnd)&&this.on("transitionEnd",function(e){return t.isCleaning&&e._removeStyles(i),t.onTransitionEnd&&t.onTransitionEnd.call(e),!0}),t.from){this.css(t.from);var a=this.element.offsetHeight;a=null}this.css(o),this.css(i),this.isTransitioning=!0},i.prototype.transition=i.prototype[l?"_transition":"_nonTransition"],i.prototype.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},i.prototype.onotransitionend=function(t){this.ontransitionend(t)},i.prototype.ontransitionend=function(t){t.target===this.element&&(this.removeTransitionStyles(),this.element.removeEventListener(d,this,!1),this.isTransitioning=!1,this.emitEvent("transitionEnd",[this]))},i.prototype._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var g={transitionProperty:"",transitionDuration:""};i.prototype.removeTransitionStyles=function(){this.css(g)},i.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},i.prototype.remove=l?function(){var t=this;this.on("transitionEnd",function(){return t.removeElem(),!0}),this.hide()}:i.prototype.removeElem,i.prototype.reveal=function(){this.css({display:""});var t=this.layout.options;this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0})},i.prototype.hide=function(){this.css({display:""});var t=this.layout.options;this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:function(){this.css({display:"none"})}})},i.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},t.Outlayer={Item:i}}(window),function(t){"use strict";function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){return"[object Array]"===y.call(t)}function n(t){var e=[];if(i(t))e=t;else if("number"==typeof t.length)for(var n=0,r=t.length;r>n;n++)e.push(t[n]);else e.push(t);return e}function r(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()}function o(t,i){if("string"==typeof t&&(t=f.querySelector(t)),!t||!_(t))return void(m&&m.error("Bad "+this.settings.namespace+" element: "+t));this.element=t,this.options=e({},this.options),e(this.options,i);var n=++x;this.element.outlayerGUID=n,b[n]=this,this._create(),this.options.isInitLayout&&this.layout()}function a(t,i){t.prototype[i]=e({},o.prototype[i])}var s=t.Outlayer,l=s.Item,c=t.docReady,h=t.EventEmitter,u=t.eventie,d=t.getSize,p=t.matchesSelector,f=t.document,m=t.console,g=t.jQuery,v=function(){},y=Object.prototype.toString,_="object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},w=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},x=0,b={};o.prototype.settings={namespace:"outlayer",item:s.Item},o.prototype.options={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},e(o.prototype,h.prototype),o.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),e(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},o.prototype.reloadItems=function(){this.items=this._getItems(this.element.children)},o.prototype._getItems=function(t){for(var e=this._filterFindItemElements(t),i=this.settings.item,n=[],r=0,o=e.length;o>r;r++){var a=e[r],s=new i(a,this,this.options.itemOptions);n.push(s)}return n},o.prototype._filterFindItemElements=function(t){t=n(t);var e=this.options.itemSelector;if(!e)return t;for(var i=[],r=0,o=t.length;o>r;r++){var a=t[r];p(a,e)&&i.push(a);for(var s=a.querySelectorAll(e),l=0,c=s.length;c>l;l++)i.push(s[l])}return i},o.prototype.getItemElements=function(){for(var t=[],e=0,i=this.items.length;i>e;e++)t.push(this.items[e].element);return t},o.prototype.layout=function(){this._resetLayout(),this._manageStamps();var t=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},o.prototype._init=o.prototype.layout,o.prototype._resetLayout=function(){this.getSize()},o.prototype.getSize=function(){this.size=d(this.element)},o.prototype._getMeasurement=function(t,e){var i,n=this.options[t];n?("string"==typeof n?i=this.element.querySelector(n):_(n)&&(i=n),this[t]=i?d(i)[e]:n):this[t]=0},o.prototype.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},o.prototype._getItemsForLayout=function(t){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i];r.isIgnored||e.push(r)}return e},o.prototype._layoutItems=function(t,e){if(!t||!t.length)return void this.emitEvent("layoutComplete",[this,t]);this._itemsOn(t,"layout",function(){this.emitEvent("layoutComplete",[this,t])});for(var i=[],n=0,r=t.length;r>n;n++){var o=t[n],a=this._getItemLayoutPosition(o);a.item=o,a.isInstant=e,i.push(a)}this._processLayoutQueue(i)},o.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},o.prototype._processLayoutQueue=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];this._positionItem(n.item,n.x,n.y,n.isInstant)}},o.prototype._positionItem=function(t,e,i,n){n?t.goTo(e,i):t.moveTo(e,i)},o.prototype._postLayout=function(){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))},o.prototype._getContainerSize=v,o.prototype._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},o.prototype._itemsOn=function(t,e,i){function n(){return r++,r===o&&i.call(a),!0}for(var r=0,o=t.length,a=this,s=0,l=t.length;l>s;s++){var c=t[s];c.on(e,n)}},o.prototype.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},o.prototype.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},o.prototype.stamp=function(t){if(t=this._find(t)){this.stamps=this.stamps.concat(t);for(var e=0,i=t.length;i>e;e++){var n=t[e];this.ignore(n)}}},o.prototype.unstamp=function(t){if(t=this._find(t))for(var e=0,i=t.length;i>e;e++){var n=t[e],r=w(this.stamps,n);-1!==r&&this.stamps.splice(r,1),this.unignore(n)}},o.prototype._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n(t)):void 0},o.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var t=0,e=this.stamps.length;e>t;t++){var i=this.stamps[t];this._manageStamp(i)}}},o.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},o.prototype._manageStamp=v,o.prototype._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,n=d(t),r={left:e.left-i.left-n.marginLeft,top:e.top-i.top-n.marginTop,right:i.right-e.right-n.marginRight,bottom:i.bottom-e.bottom-n.marginBottom};return r},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.bindResize=function(){this.isResizeBound||(u.bind(t,"resize",this),this.isResizeBound=!0)},o.prototype.unbindResize=function(){u.unbind(t,"resize",this),this.isResizeBound=!1},o.prototype.onresize=function(){function t(){e.resize()}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},o.prototype.resize=function(){var t=d(this.element),e=this.size&&t;e&&t.innerWidth===this.size.innerWidth||(this.layout(),delete this.resizeTimeout)},o.prototype.addItems=function(t){var e=this._getItems(t);if(e.length)return this.items=this.items.concat(e),e},o.prototype.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},o.prototype.prepended=function(t){var e=this._getItems(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},o.prototype.reveal=function(t){if(t&&t.length)for(var e=0,i=t.length;i>e;e++){var n=t[e];n.reveal()}},o.prototype.hide=function(t){if(t&&t.length)for(var e=0,i=t.length;i>e;e++){var n=t[e];n.hide()}},o.prototype.getItem=function(t){for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];if(n.element===t)return n}},o.prototype.getItems=function(t){if(t&&t.length){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i],o=this.getItem(r);o&&e.push(o)}return e}},o.prototype.remove=function(t){t=n(t);var e=this.getItems(t);this._itemsOn(e,"remove",function(){this.emitEvent("removeComplete",[this,e])});for(var i=0,r=e.length;r>i;i++){var o=e[i];o.remove();var a=w(this.items,o);this.items.splice(a,1)}},o.prototype.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="";for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];n.destroy()}this.unbindResize(),delete this.element.outlayerGUID},o.data=function(t){var e=t&&t.outlayerGUID;return e&&b[e]},o.create=function(t,i){function n(){o.apply(this,arguments)}return e(n.prototype,o.prototype),a(n,"options"),a(n,"settings"),e(n.prototype.options,i),n.prototype.settings.namespace=t,n.data=o.data,n.Item=function(){l.apply(this,arguments)},n.Item.prototype=new o.Item,n.prototype.settings.item=n.Item,c(function(){for(var e=r(t),i=f.querySelectorAll(".js-"+e),o="data-"+e+"-options",a=0,s=i.length;s>a;a++){var l,c=i[a],h=c.getAttribute(o);try{l=h&&JSON.parse(h)}catch(u){m&&m.error("Error parsing "+o+" on "+c.nodeName.toLowerCase()+(c.id?"#"+c.id:"")+": "+u);continue}var d=new n(c,l);g&&g.data(c,t,d)}}),g&&g.bridget&&g.bridget(t,n),n},o.Item=l,t.Outlayer=o}(window),function(t){"use strict";function e(t,e){var n=t.create("masonry");return n.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns();var t=this.cols;for(this.colYs=[];t--;)this.colYs.push(0);this.maxY=0},n.prototype.measureColumns=function(){var t=this.items[0],i=t&&t.element;this.columnWidth||(this.columnWidth=i?e(i).outerWidth:this.size.innerWidth),this.columnWidth+=this.gutter,this.cols=Math.floor((this.size.innerWidth+this.gutter)/this.columnWidth),this.cols=Math.max(this.cols,1)},n.prototype._getItemLayoutPosition=function(t){t.getSize();var e=Math.ceil(t.size.outerWidth/this.columnWidth);e=Math.min(e,this.cols);for(var n=this._getColGroup(e),r=Math.min.apply(Math,n),o=i(n,r),a={x:this.columnWidth*o,y:r},s=r+t.size.outerHeight,l=this.cols+1-n.length,c=0;l>c;c++)this.colYs[o+c]=s;return a},n.prototype._getColGroup=function(t){if(1===t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++){var r=this.colYs.slice(n,n+t);e[n]=Math.max.apply(Math,r)}return e},n.prototype._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),r=this.options.isOriginLeft?n.left:n.right,o=r+i.outerWidth,a=Math.floor(r/this.columnWidth);a=Math.max(0,a);var s=Math.floor(o/this.columnWidth);s=Math.min(this.cols-1,s);for(var l=(this.options.isOriginTop?n.top:n.bottom)+i.outerHeight,c=a;s>=c;c++)this.colYs[c]=Math.max(l,this.colYs[c])},n.prototype._getContainerSize=function(){return this.maxY=Math.max.apply(Math,this.colYs),{height:this.maxY}},n}var i=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++){var r=t[i];if(r===e)return i}return-1};"function"==typeof define&&define.amd?define(["outlayer","get-size"],e):t.Masonry=e(t.Outlayer,t.getSize)}(window),window.TCE||(window.TCE={}),TCE.MorphDOM=function(t){_.bindAll(this,"on_device_change"),_.extend(this,_({morphs:{}}).chain().extend(this.defaults,t).pick("rel","default_device","morphs","target").value()),this.elements=_.chain($("[data-morph='"+this.rel+"']")).map(function(t){return t=$(t),_(t.data("morph-devices").split(/\s*,\s*/)).each(function(e){t.data("morph-into-"+e,!0)}),t}).sortBy(function(t){return t.data("morph-stack")}).value(),this.current_device=this.default_device,this.init()},_.extend(TCE.MorphDOM.prototype,{defaults:{rel:"morph",default_device:"desktop"},init:function(){var t;this.current_device!=(t=Device.device_type())&&this.morph_into(t),$(window).on("device_change",this.on_device_change)},morph_into:function(t){var e;this.init_device(t),e=$(this.target),_(this.elements).each(_.bind(function(i){var n,r=i.data("morph-into-"+t),o="clone"==i.data("morph-type"),a=i.data("morph-into-"+this.current_device);r&&!a?(n=i.data("morph-target"),n=n?$(n):e,o?this.clone_element(i,n):(this.placeholder(i),n.append(i))):this.default_device!=t&&a&&r||(o?this.declone_element(i):this.replace_placeholder(i))},this)),this.destroy_current_device_with(t),this.current_device=t},clone_element:function(t,e){var i;e.each(function(){var e=t.clone();i=i?i.add(e):e,$(this).append(e)}),t.data("morph-clone",i)},declone_element:function(t){var e;(e=t.data("morph-clone"))&&(e.remove(),t.data("morph-clone",null))},init_device:function(t){this.exec_morph_function(t,this.current_device,"init")},destroy_current_device_with:function(t){this.exec_morph_function(this.current_device,t,"destroy")},exec_morph_function:function(t,e,i){var n=this.morphs[t]||{},r=n[i];r&&r!=e&&(this.morphs[e]||{})[i]!=t&&("string"==typeof r&&(r=this.morphs[r][i]),r.call(this,t,e))},placeholder:function(t){var e=_.uniqueId("morph_"+this.rel+"_"),i=$("<input type='hidden' data-morph-placeholder='"+e+"'/>");t.before(i).data("morph-placeholder-id",e)},replace_placeholder:function(t){var e,i=t.data("morph-placeholder-id");i&&(e=$("[data-morph-placeholder='"+i+"']"),e.after(t).remove(),t.data("morph-placeholder-id",null))},on_device_change:function(t){t.device!=this.current_device&&this.morph_into(t.device)}}),window.MoveIt=function(){var t=function(){_.bindAll(this,"on_event")};return _.extend(t.prototype,{on:function(t,e,i,n){return i instanceof jQuery||(i=$(i)),i.each(_.bind(function(i,r){var o=n;r=$(r),n?n instanceof jQuery||(o=r.find(n)):o=r,r.on(t,_.curry(this.on_event,o,e,this.if_conditional,this.current_options))},this)),this},with_options:function(t){return this.current_options=t,this},only_if:function(t){return this.if_conditional=t,this},end:function(){this.current_options=this.if_conditional=null},on_event:function(t,e,i,n,r){(!i||i.apply(this,t,e,r))&&this[e](t,!0,n)},slide_toggle:function(t,e,i){0==parseInt(t.css("height"),10)?this.slide_down(t,e,i):this.slide_up(t,e,i)},execute_callback:function(t,e){if(t&&t[e]){var i=[].slice.call(arguments,2);t[e].apply(this,i)}},slide_down:function(t,e,i){var n=t.outerHeight();t.addClass("no_transition").css("height","auto");var r=t.outerHeight();0==e?(this.execute_callback(i,"before",t,"slide_down"),t.css("height",r),_.defer(function(){t.removeClass("no_transition")})):(t.css("height",n).removeClass("hidden").addClass("visible"),_.defer(_.bind(function(){this.execute_callback(i,"before",t,"slide_down"),t.removeClass("no_transition").css("height",r),0==r&&t.css("height","auto")},this)))},slide_up:function(t,e,i){0==e?(this.execute_callback(i,"before",t,"slide_up"),t.removeClass("visible").addClass("no_transition hidden").css("height",0),_.defer(function(){t.removeClass("no_transition")})):this.execute_callback(i,"before",t,"slide_up"),t.css("height",0).removeClass("visible no_transition").addClass("hidden")},fade_out:function(t,e){0==e?t.removeClass("visible").addClass("no_transition hidden").css("opacity",0):t.css("opacity",0).removeClass("visible no_transition").addClass("hidden")},fade_in:function(t,e){0==e?t.removeClass("visible").addClass("no_transition hidden").css("opacity",1):t.css("opacity",1).removeClass("visible no_transition").addClass("hidden")}}),new t}(),/*! iFrame Resizer (iframeSizer.min.js ) - v3.5.3 - 2016-02-23
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2016 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */
!function(t){"use strict";function e(e,i,n){"addEventListener"in t?e.addEventListener(i,n,!1):"attachEvent"in t&&e.attachEvent("on"+i,n)}function i(e,i,n){"removeEventListener"in t?e.removeEventListener(i,n,!1):"detachEvent"in t&&e.detachEvent("on"+i,n)}function n(){var e,i=["moz","webkit","o","ms"];for(e=0;e<i.length&&!B;e+=1)B=t[i[e]+"RequestAnimationFrame"];B||s("setup","RequestAnimationFrame not supported")}function r(e){var i="Host page: "+e;return t.top!==t.self&&(i=t.parentIFrame&&t.parentIFrame.getId?t.parentIFrame.getId()+": "+e:"Nested host page: "+e),i}function o(t){return O+"["+r(t)+"]"}function a(t){return H[t]?H[t].log:I}function s(t,e){h("log",t,e,a(t))}function l(t,e){h("info",t,e,a(t))}function c(t,e){h("warn",t,e,!0)}function h(e,i,n,r){!0===r&&"object"==typeof t.console&&console[e](o(i),n)}function u(n){function r(){function t(){y(X),m(q)}a("Height"),a("Width"),_(t,X,"init")}function o(){var t=V.substr(F).split(":");return{iframe:H[t[0]].iframe,id:t[0],height:t[1],width:t[2],type:t[3]}}function a(t){var e=Number(H[q]["max"+t]),i=Number(H[q]["min"+t]),n=t.toLowerCase(),r=Number(X[n]);s(q,"Checking "+n+" is in range "+i+"-"+e),i>r&&(r=i,s(q,"Set "+n+" to min value")),r>e&&(r=e,s(q,"Set "+n+" to max value")),X[n]=""+r}function h(){function t(){function t(){var t=0,n=!1;for(s(q,"Checking connection is from allowed list of origins: "+i);t<i.length;t++)if(i[t]===e){n=!0;break}return n}function n(){var t=H[q].remoteHost;return s(q,"Checking connection is from: "+t),e===t}return i.constructor===Array?t():n()}var e=n.origin,i=H[q].checkOrigin;if(i&&""+e!="null"&&!t())throw new Error("Unexpected message received from: "+e+" for "+X.iframe.id+". Message was: "+n.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function u(){return O===(""+V).substr(0,F)&&V.substr(F).split(":")[0]in H}function b(){var t=X.type in{"true":1,"false":1,undefined:1};return t&&s(q,"Ignoring init message from meta parent page"),t}function T(t){return V.substr(V.indexOf(":")+z+t)}function E(t){s(q,"MessageCallback passed: {iframe: "+X.iframe.id+", message: "+t+"}"),B("messageCallback",{iframe:X.iframe,message:JSON.parse(t)}),s(q,"--")}function S(){var e=document.body.getBoundingClientRect(),i=X.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:i.height,iframeWidth:i.width,clientHeight:Math.max(document.documentElement.clientHeight,t.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,t.innerWidth||0),offsetTop:parseInt(i.top-e.top,10),offsetLeft:parseInt(i.left-e.left,10),scrollTop:t.pageYOffset,scrollLeft:t.pageXOffset})}function C(t,e){function i(){w("Send Page Info","pageInfo:"+S(),t,e)}M(i,32)}function A(){function n(e,i){function n(){H[a]?C(H[a].iframe,a):r()}["scroll","resize"].forEach(function(r){s(a,e+r+" listener for sendPageInfo"),i(t,r,n)})}function r(){n("Remove ",i)}function o(){n("Add ",e)}var a=q;o(),H[a].stopPageInfo=r}function P(){H[q]&&H[q].stopPageInfo&&(H[q].stopPageInfo(),delete H[q].stopPageInfo)}function L(){var t=!0;return null===X.iframe&&(c(q,"IFrame ("+X.id+") not found"),t=!1),t}function k(t){var e=t.getBoundingClientRect();return f(q),{x:Math.floor(Number(e.left)+Number(N.x)),y:Math.floor(Number(e.top)+Number(N.y))}}function I(e){function i(){N=a,R(),s(q,"--")}function n(){return{x:Number(X.width)+o.x,y:Number(X.height)+o.y}}function r(){t.parentIFrame?t.parentIFrame["scrollTo"+(e?"Offset":"")](a.x,a.y):c(q,"Unable to scroll to requested position, window.parentIFrame not found")}var o=e?k(X.iframe):{x:0,y:0},a=n();s(q,"Reposition requested from iFrame (offset x:"+o.x+" y:"+o.y+")"),t.top!==t.self?r():i()}function R(){!1!==B("scrollCallback",N)?m(q):g()}function D(e){function i(){var t=k(a);s(q,"Moving to in page link (#"+r+") at x: "+t.x+" y: "+t.y),N={x:t.x,y:t.y},R(),s(q,"--")}function n(){t.parentIFrame?t.parentIFrame.moveToAnchor(r):s(q,"In page link #"+r+" not found and window.parentIFrame not found")}var r=e.split("#")[1]||"",o=decodeURIComponent(r),a=document.getElementById(o)||document.getElementsByName(o)[0];a?i():t.top!==t.self?n():s(q,"In page link #"+r+" not found")}function B(t,e){return d(q,t,e)}function U(){switch(H[q].firstRun&&Y(),X.type){case"close":p(X.iframe);break;case"message":E(T(6));break;case"scrollTo":I(!1);break;case"scrollToOffset":I(!0);break;case"pageInfo":C(H[q].iframe,q),A();break;case"pageInfoStop":P();break;case"inPageLink":D(T(9));break;case"reset":v(X);break;case"init":r(),B("initCallback",X.iframe),B("resizedCallback",X);break;default:r(),B("resizedCallback",X)}}function G(t){var e=!0;return H[t]||(e=!1,c(X.type+" No settings for "+t+". Message was: "+V)),e}function W(){for(var t in H)w("iFrame requested init",x(t),document.getElementById(t),t)}function Y(){H[q].firstRun=!1}var V=n.data,X={},q=null;"[iFrameResizerChild]Ready"===V?W():u()?(X=o(),q=j=X.id,!b()&&G(q)&&(s(q,"Received: "+V),L()&&h()&&U())):l(q,"Ignored: "+V)}function d(t,e,i){var n=null,r=null;if(H[t]){if(n=H[t][e],"function"!=typeof n)throw new TypeError(e+" on iFrame["+t+"] is not a function");r=n(i)}return r}function p(t){var e=t.id;s(e,"Removing iFrame: "+e),t.parentNode.removeChild(t),d(e,"closedCallback",e),s(e,"--"),delete H[e]}function f(e){null===N&&(N={x:void 0!==t.pageXOffset?t.pageXOffset:document.documentElement.scrollLeft,y:void 0!==t.pageYOffset?t.pageYOffset:document.documentElement.scrollTop},s(e,"Get page position: "+N.x+","+N.y))}function m(e){null!==N&&(t.scrollTo(N.x,N.y),s(e,"Set page position: "+N.x+","+N.y),g())}function g(){N=null}function v(t){function e(){y(t),w("reset","reset",t.iframe,t.id)}s(t.id,"Size reset requested by "+("init"===t.type?"host page":"iFrame")),f(t.id),_(e,t,"reset")}function y(t){function e(e){t.iframe.style[e]=t[e]+"px",s(t.id,"IFrame ("+r+") "+e+" set to "+t[e]+"px")}function i(e){R||"0"!==t[e]||(R=!0,s(r,"Hidden iFrame detected, creating visibility listener"),T())}function n(t){e(t),i(t)}var r=t.iframe.id;H[r]&&(H[r].sizeHeight&&n("height"),H[r].sizeWidth&&n("width"))}function _(t,e,i){i!==e.type&&B?(s(e.id,"Requesting animation frame"),B(t)):t()}function w(t,e,i,n){function r(){var r=H[n].targetOrigin;s(n,"["+t+"] Sending msg to iframe["+n+"] ("+e+") targetOrigin: "+r),i.contentWindow.postMessage(O+e,r)}function o(){l(n,"["+t+"] IFrame("+n+") not found"),H[n]&&delete H[n]}function a(){i&&"contentWindow"in i&&null!==i.contentWindow?r():o()}n=n||i.id,H[n]&&a()}function x(t){return t+":"+H[t].bodyMarginV1+":"+H[t].sizeWidth+":"+H[t].log+":"+H[t].interval+":"+H[t].enablePublicMethods+":"+H[t].autoResize+":"+H[t].bodyMargin+":"+H[t].heightCalculationMethod+":"+H[t].bodyBackground+":"+H[t].bodyPadding+":"+H[t].tolerance+":"+H[t].inPageLinks+":"+H[t].resizeFrom+":"+H[t].widthCalculationMethod}function b(t,i){function n(){function e(e){1/0!==H[b][e]&&0!==H[b][e]&&(t.style[e]=H[b][e]+"px",s(b,"Set "+e+" = "+H[b][e]+"px"))}function i(t){if(H[b]["min"+t]>H[b]["max"+t])throw new Error("Value for min"+t+" can not be greater than max"+t)}i("Height"),i("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}function r(){var t=i&&i.id||W.id+k++;return null!==document.getElementById(t)&&(t+=k++),t}function o(e){return j=e,""===e&&(t.id=e=r(),I=(i||{}).log,j=e,s(e,"Added missing iframe ID: "+e+" ("+t.src+")")),e}function a(){s(b,"IFrame scrolling "+(H[b].scrolling?"enabled":"disabled")+" for "+b),t.style.overflow=!1===H[b].scrolling?"hidden":"auto",t.scrolling=!1===H[b].scrolling?"no":"yes"}function l(){("number"==typeof H[b].bodyMargin||"0"===H[b].bodyMargin)&&(H[b].bodyMarginV1=H[b].bodyMargin,H[b].bodyMargin=""+H[b].bodyMargin+"px")}function h(){var e=H[b].firstRun,i=H[b].heightCalculationMethod in U;!e&&i&&v({iframe:t,height:0,width:0,type:"init"})}function u(){Function.prototype.bind&&(H[b].iframe.iFrameResizer={close:p.bind(null,H[b].iframe),resize:w.bind(null,"Window resize","resize",H[b].iframe),moveToAnchor:function(t){w("Move to anchor","inPageLink:"+t,H[b].iframe,b)},sendMessage:function(t){t=JSON.stringify(t),w("Send Message","message:"+t,H[b].iframe,b)}})}function d(i){function n(){w("iFrame.onload",i,t),h()}e(t,"load",n),w("init",i,t)}function f(t){if("object"!=typeof t)throw new TypeError("Options is not an object")}function m(t){for(var e in W)W.hasOwnProperty(e)&&(H[b][e]=t.hasOwnProperty(e)?t[e]:W[e])}function g(t){return""===t||"file://"===t?"*":t}function y(e){e=e||{},H[b]={firstRun:!0,iframe:t,remoteHost:t.src.split("/").slice(0,3).join("/")},f(e),m(e),H[b].targetOrigin=!0===H[b].checkOrigin?g(H[b].remoteHost):"*"}function _(){return b in H&&"iFrameResizer"in t}var b=o(t.id);_()?c(b,"Ignored iFrame, already setup."):(y(i),a(),n(),l(),d(x(b)),u())}function M(t,e){null===G&&(G=setTimeout(function(){G=null,t()},e))}function T(){function e(){function t(t){function e(e){return"0px"===H[t].iframe.style[e]}function i(t){return null!==t.offsetParent}i(H[t].iframe)&&(e("height")||e("width"))&&w("Visibility change","resize",H[t].iframe,t)}for(var e in H)t(e)}function i(t){s("window","Mutation observed: "+t[0].target+" "+t[0].type),M(e,16)}function n(){var t=document.querySelector("body"),e={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},n=new r(i);n.observe(t,e)}var r=t.MutationObserver||t.WebKitMutationObserver;r&&n()}function E(t){function e(){C("Window "+t,"resize")}s("window","Trigger event: "+t),M(e,16)}function S(){function t(){C("Tab Visable","resize")}"hidden"!==document.visibilityState&&(s("document","Trigger event: Visiblity change"),M(t,16))}function C(t,e){function i(t){return"parent"===H[t].resizeFrom&&H[t].autoResize&&!H[t].firstRun}for(var n in H)i(n)&&w(t,e,document.getElementById(n),n)}function A(){e(t,"message",u),e(t,"resize",function(){E("resize")}),e(document,"visibilitychange",S),e(document,"-webkit-visibilitychange",S),e(t,"focusin",function(){E("focus")}),e(t,"focus",function(){E("focus")})}function P(){function t(t,i){function n(){if(!i.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==i.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+i.tagName+">")}i&&(n(),b(i,t),e.push(i))}var e;return n(),A(),function(i,n){switch(e=[],typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(void 0,i));break;case"object":t(i,n);break;default:throw new TypeError("Unexpected data type ("+typeof n+")")}return e}}function L(t){t.fn.iFrameResize=function(t){return this.filter("iframe").each(function(e,i){b(i,t)}).end()}}var k=0,I=!1,R=!1,D="message",z=D.length,O="[iFrameSizer]",F=O.length,N=null,B=t.requestAnimationFrame,U={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},H={},G=null,j="Host Page",W={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){c("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};t.jQuery&&L(jQuery),"function"==typeof define&&define.amd?define([],P):"object"==typeof module&&"object"==typeof module.exports?module.exports=P():t.iFrameResize=t.iFrameResize||P()}(window||{}),function(t,e,i){"use strict";t.quiz=function(e,n){var r=this,o=i.documentElement.lang||"es",a=QUIZ_PARAMS.btn_restart[o]||QUIZ_PARAMS.btn_restart.en,s=QUIZ_PARAMS.str_success[o]||QUIZ_PARAMS.str_success.en;r.$el=t(e),r.$el.data("quiz",r),r.options=t.extend(t.quiz.defaultOptions,n);var l,c=r.options.questions,h=c.length,u=r.options.shuffle?r.options.shuffle:!1,d=r.options.subset?r.options.subset:!1,p=r.options.startScreen,f=r.options.startButton,m=r.options.homeButton,g=r.options.resultsScreen,v=r.options.gameOverScreen,y=1,w=0,x=!1;r.methods={init:function(){u&&(l=r.methods.shuffle(c)),0!=d&&(l=r.methods.subset(l,d),h=l.length),r.methods.setup(),t(i).on("click",f,function(t){t.preventDefault(),r.methods.start()}),t(i).on("click",m,function(t){t.preventDefault(),r.methods.home()}),t(i).on("click",".answers a",function(e){e.preventDefault(),setTimeout(function(){if(t("#quiz-next-btn").is(":visible"))t("#quiz-next-btn").click(),t(".number_question.active").next().addClass("active"),t(".number_question.active").prev().removeClass("active");else{t("#quiz-finish-btn").click(),t("#quiz-controls").css("visibility","visible"),t(".number_question").each(function(){t(this).addClass("active")});{t(".answers a.correct").length}}},500),r.methods.answerQuestion(this)}),t(i).on("click","#quiz-next-btn",function(t){t.preventDefault(),r.methods.nextQuestion()}),t(i).on("click","#quiz-finish-btn",function(t){t.preventDefault(),r.methods.finish()}),t(i).on("click","#quiz-restart-btn, #quiz-retry-btn",function(e){e.preventDefault(),t("#count-question div").removeAttr("style"),t(".number_question.active").each(function(){t(this).removeClass("active")}),t(".number_question").first().addClass("active"),t("#quiz-controls").css("visibility","hidden"),r.methods.restart()})},setup:function(){var e="";r.options.counter&&(e+='<div id="quiz-counter"></div>'),e+='<div id="questions">',t.each(l,function(i,n){e+='<div class="question-container">',e+='<p class="question">'+n.q+"</p>",e+='<ul class="answers">',t.each(n.options,function(t,i){e+='<li><a href="#" data-index="'+t+'">'+i+"</a></li>"}),e+="</ul>",e+="</div>"}),e+="</div>",0===t(g).length&&(e+='<div id="'+g.substr(1)+'">',e+='<p id="quiz-results"></p>',e+="</div>"),e+='<div id="quiz-controls">',e+='<p id="quiz-response"></p>',e+='<div id="quiz-buttons">',e+='<a href="#" id="quiz-next-btn">Next</a>',e+='<a href="#" id="quiz-finish-btn">Finish</a>',e+='<a href="#" id="quiz-restart-btn">'+a+"</a>",e+="</div>",e+="</div>",r.$el.append(e).addClass("quiz-container quiz-start-state"),t("#quiz-counter").hide(),t(".question-container").hide(),t(v).hide(),t(g).hide(),t("#quiz-controls").hide()},start:function(){r.$el.removeClass("quiz-start-state").addClass("quiz-questions-state"),t(p).hide(),t("#quiz-controls").hide(),t("#quiz-finish-btn").hide(),t("#quiz-restart-btn").hide(),t("#questions").show(),t("#quiz-counter").show(),t(".question-container:first-child").show().addClass("active-question"),r.methods.updateCounter()},answerQuestion:function(e){if(!x){x=!0;var i=t(e),n="",o=i.data("index"),a=y-1,s=l[a].correctIndex;if(o===s)i.addClass("correct"),n=l[a].correctResponse,w++,t("#question_"+a).css("background","#090");else if(i.addClass("incorrect"),n=l[a].incorrectResponse,t("#question_"+a).css("background","#c00"),!r.options.allowIncorrect)return void r.methods.gameOver(n);t("#quiz-response").html(n),t("#quiz-controls").fadeIn(),"function"==typeof r.options.answerCallback&&r.options.answerCallback(y,o===s)}},nextQuestion:function(){x=!1,t(".active-question").hide().removeClass("active-question").next(".question-container").show().addClass("active-question"),t("#quiz-controls").hide(),++y===h&&(t("#quiz-next-btn").hide(),t("#quiz-finish-btn").show()),r.methods.updateCounter(),"function"==typeof r.options.nextCallback&&r.options.nextCallback()},gameOver:function(e){if(0===t(v).length){var i="";i+='<div id="'+v.substr(1)+'">',i+='<p id="quiz-gameover-response"></p>',i+='<p><a href="#" id="quiz-retry-btn">Retry</a></p>',i+="</div>",r.$el.append(i)}t("#quiz-gameover-response").html(e),t("#quiz-counter").hide(),t("#questions").hide(),t(v).show()},finish:function(){r.$el.removeClass("quiz-questions-state").addClass("quiz-results-state"),t(".active-question").hide().removeClass("active-question"),t("#quiz-counter").hide(),t("#quiz-response").hide(),t("#quiz-finish-btn").hide(),t("#quiz-next-btn").hide(),t("#quiz-restart-btn").show(),t(g).show();var e=_(s).template(),i=e({q_right:w,q_total:h});t("#quiz-results").html(i),"function"==typeof r.options.finishCallback&&r.options.finishCallback(),u&&(l=r.methods.shuffle(c)),0!=d&&(l=r.methods.subset(l,d),h=l.length)},shuffle:function(t){for(var e,i,n=t.length;0!==n;)i=Math.floor(Math.random()*n),n-=1,e=t[n],t[n]=t[i],t[i]=e;return t},subset:function(t,e){return e<=t.length&&(t=t.slice(0,e)),t},restart:function(){r.methods.destroy(),r.methods.setup(),r.methods.reset(),r.$el.addClass("quiz-questions-state"),t("#questions").show(),t("#quiz-counter").show(),t(".question-container:first-child").show().addClass("active-question"),r.methods.updateCounter()},destroy:function(){t("#questions").remove(),t("#quiz-counter").remove(),t("#quiz-controls").remove()},reset:function(){x=!1,y=1,w=0,t(".answers a").removeClass("correct incorrect"),r.$el.removeClass().addClass("quiz-container"),t("#quiz-restart-btn").hide(),t(v).hide(),t(g).hide(),t("#quiz-controls").hide(),t("#quiz-response").show(),t("#quiz-next-btn").show(),t("#quiz-counter").hide(),t(".active-question").hide().removeClass("active-question")},home:function(){r.methods.reset(),r.$el.addClass("quiz-start-state"),t(p).show(),"function"==typeof r.options.homeCallback&&r.options.homeCallback()},updateCounter:function(){var e=r.options.counterFormat.replace("%current",y).replace("%total",h);t("#quiz-counter").html(e)}},r.methods.init()},t.quiz.defaultOptions={allowIncorrect:!0,counter:!0,counterFormat:"%current/%total",startScreen:"#quiz-start-screen",startButton:"#quiz-start-btn",homeButton:"#quiz-home-btn",resultsScreen:"#quiz-results-screen",gameOverScreen:"#quiz-gameover-screen"},t.fn.quiz=function(e){return this.each(function(){new t.quiz(this,e)})}}(jQuery,window,document),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){"use strict";function e(){}function i(t,e){this.x=t||0,this.y=e||0}function n(t,e,o,a,s,l,c,h,u,d){Object.defineProperty(this,"id",{value:r()}),this.uuid=Fs.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:n.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:n.DEFAULT_MAPPING,this.wrapS=void 0!==o?o:La,this.wrapT=void 0!==a?a:La,this.magFilter=void 0!==s?s:Oa,this.minFilter=void 0!==l?l:Na,this.anisotropy=void 0!==u?u:1,this.format=void 0!==c?c:ts,this.type=void 0!==h?h:Ua,this.offset=new i(0,0),this.repeat=new i(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==d?d:Cs,this.version=0,this.onUpdate=null}function r(){return Ns++}function o(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function a(t,e,i){this.uuid=Fs.generateUUID(),this.width=t,this.height=e,this.scissor=new o(0,0,t,e),this.scissorTest=!1,this.viewport=new o(0,0,t,e),i=i||{},void 0===i.minFilter&&(i.minFilter=Oa),this.texture=new n(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function s(t,e,i){a.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function l(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function c(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function h(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function u(t,e,i,r,o,a,s,l,c,h){t=void 0!==t?t:[],e=void 0!==e?e:xa,n.call(this,t,e,i,r,o,a,s,l,c,h),this.flipY=!1}function d(){this.seq=[],this.map={}}function p(t,e,i){var n=t[0];if(0>=n||n>0)return t;var r=e*i,o=Hs[r];if(void 0===o&&(o=new Float32Array(r),Hs[r]=o),0!==e){n.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=i,t[a].toArray(o,s)}return o}function f(t,e){var i=Gs[e];void 0===i&&(i=new Int32Array(e),Gs[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocTextureUnit();return i}function m(t,e){t.uniform1f(this.addr,e)}function g(t,e){t.uniform1i(this.addr,e)}function v(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function y(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function _(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function w(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function x(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function b(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function M(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTexture2D(e||Bs,n)}function T(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTextureCube(e||Us,n)}function E(t,e){t.uniform2iv(this.addr,e)}function S(t,e){t.uniform3iv(this.addr,e)}function C(t,e){t.uniform4iv(this.addr,e)}function A(t){switch(t){case 5126:return m;case 35664:return v;case 35665:return y;case 35666:return _;case 35674:return w;case 35675:return x;case 35676:return b;case 35678:return M;case 35680:return T;case 5124:case 35670:return g;case 35667:case 35671:return E;case 35668:case 35672:return S;case 35669:case 35673:return C}}function P(t,e){t.uniform1fv(this.addr,e)}function L(t,e){t.uniform1iv(this.addr,e)}function k(t,e){t.uniform2fv(this.addr,p(e,this.size,2))}function I(t,e){t.uniform3fv(this.addr,p(e,this.size,3))}function R(t,e){t.uniform4fv(this.addr,p(e,this.size,4))}function D(t,e){t.uniformMatrix2fv(this.addr,!1,p(e,this.size,4))}function z(t,e){t.uniformMatrix3fv(this.addr,!1,p(e,this.size,9))}function O(t,e){t.uniformMatrix4fv(this.addr,!1,p(e,this.size,16))}function F(t,e,i){var n=e.length,r=f(i,n);t.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTexture2D(e[o]||Bs,r[o])}function N(t,e,i){var n=e.length,r=f(i,n);t.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTextureCube(e[o]||Us,r[o])}function B(t){switch(t){case 5126:return P;case 35664:return k;case 35665:return I;case 35666:return R;case 35674:return D;case 35675:return z;case 35676:return O;case 35678:return F;case 35680:return N;case 5124:case 35670:return L;case 35667:case 35671:return E;case 35668:case 35672:return S;case 35669:case 35673:return C}}function U(t,e,i){this.id=t,this.addr=i,this.setValue=A(e.type)}function H(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=B(e.type)}function G(t){this.id=t,d.call(this)}function j(t,e){t.seq.push(e),t.map[e.id]=e}function W(t,e,i){var n=t.name,r=n.length;for(js.lastIndex=0;;){var o=js.exec(n),a=js.lastIndex,s=o[1],l="]"===o[2],c=o[3];if(l&&(s=0|s),void 0===c||"["===c&&a+2===r){j(i,void 0===c?new U(s,t,e):new H(s,t,e));break}var h=i.map,u=h[s];void 0===u&&(u=new G(s),j(i,u)),i=u}}function Y(t,e,i){d.call(this),this.renderer=i;for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r!==n;++r){var o=t.getActiveUniform(e,r),a=o.name,s=t.getUniformLocation(e,a);W(o,s,this)}}function V(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function X(t,e){this.min=void 0!==t?t:new i(+1/0,+1/0),this.max=void 0!==e?e:new i(-1/0,-1/0)}function q(t,e){function n(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);o=f.createBuffer(),a=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o),f.bufferData(f.ARRAY_BUFFER,t,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW),d=f.createTexture(),p=f.createTexture(),m.bindTexture(f.TEXTURE_2D,d),f.texImage2D(f.TEXTURE_2D,0,f.RGB,16,16,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),m.bindTexture(f.TEXTURE_2D,p),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,16,16,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},l=r(s),h={vertex:f.getAttribLocation(l,"position"),uv:f.getAttribLocation(l,"uv")},u={renderType:f.getUniformLocation(l,"renderType"),map:f.getUniformLocation(l,"map"),occlusionMap:f.getUniformLocation(l,"occlusionMap"),opacity:f.getUniformLocation(l,"opacity"),color:f.getUniformLocation(l,"color"),scale:f.getUniformLocation(l,"scale"),rotation:f.getUniformLocation(l,"rotation"),screenPosition:f.getUniformLocation(l,"screenPosition")}}function r(e){var i=f.createProgram(),n=f.createShader(f.FRAGMENT_SHADER),r=f.createShader(f.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return f.shaderSource(n,o+e.fragmentShader),f.shaderSource(r,o+e.vertexShader),f.compileShader(n),f.compileShader(r),f.attachShader(i,n),f.attachShader(i,r),f.linkProgram(i),i}var o,a,s,l,h,u,d,p,f=t.context,m=t.state;this.render=function(r,s,g){if(0!==e.length){var v=new c,y=g.w/g.z,_=.5*g.z,w=.5*g.w,x=16/g.w,b=new i(x*y,x),M=new c(1,1,0),T=new i(1,1),E=new X;E.min.set(g.x,g.y),E.max.set(g.x+(g.z-16),g.y+(g.w-16)),void 0===l&&n(),f.useProgram(l),m.initAttributes(),m.enableAttribute(h.vertex),m.enableAttribute(h.uv),m.disableUnusedAttributes(),f.uniform1i(u.occlusionMap,0),f.uniform1i(u.map,1),f.bindBuffer(f.ARRAY_BUFFER,o),f.vertexAttribPointer(h.vertex,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(h.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),m.disable(f.CULL_FACE),m.setDepthWrite(!1);for(var S=0,C=e.length;C>S;S++){x=16/g.w,b.set(x*y,x);var A=e[S];if(v.set(A.matrixWorld.elements[12],A.matrixWorld.elements[13],A.matrixWorld.elements[14]),v.applyMatrix4(s.matrixWorldInverse),v.applyProjection(s.projectionMatrix),M.copy(v),T.x=g.x+M.x*_+_-8,T.y=g.y+M.y*w+w-8,E.containsPoint(T)===!0){m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,null),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,d),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGB,T.x,T.y,16,16,0),f.uniform1i(u.renderType,0),f.uniform2f(u.scale,b.x,b.y),f.uniform3f(u.screenPosition,M.x,M.y,M.z),m.disable(f.BLEND),m.enable(f.DEPTH_TEST),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,p),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,T.x,T.y,16,16,0),f.uniform1i(u.renderType,1),m.disable(f.DEPTH_TEST),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,d),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),A.positionScreen.copy(M),A.customUpdateCallback?A.customUpdateCallback(A):A.updateLensFlares(),f.uniform1i(u.renderType,2),m.enable(f.BLEND);for(var P=0,L=A.lensFlares.length;L>P;P++){var k=A.lensFlares[P];k.opacity>.001&&k.scale>.001&&(M.x=k.x,M.y=k.y,M.z=k.z,x=k.size*k.scale/g.w,b.x=x*y,b.y=x,f.uniform3f(u.screenPosition,M.x,M.y,M.z),f.uniform2f(u.scale,b.x,b.y),f.uniform1f(u.rotation,k.rotation),f.uniform1f(u.opacity,k.opacity),f.uniform3f(u.color,k.color.r,k.color.g,k.color.b),m.setBlending(k.blending,k.blendEquation,k.blendSrc,k.blendDst),t.setTexture2D(k.texture,1),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0))}}}m.enable(f.CULL_FACE),m.enable(f.DEPTH_TEST),m.setDepthWrite(!0),t.resetGLState()}}}function $(t,e){function i(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);a=f.createBuffer(),s=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,a),f.bufferData(f.ARRAY_BUFFER,t,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,s),f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW),h=r(),u={position:f.getAttribLocation(h,"position"),uv:f.getAttribLocation(h,"uv")},d={uvOffset:f.getUniformLocation(h,"uvOffset"),uvScale:f.getUniformLocation(h,"uvScale"),rotation:f.getUniformLocation(h,"rotation"),scale:f.getUniformLocation(h,"scale"),color:f.getUniformLocation(h,"color"),map:f.getUniformLocation(h,"map"),opacity:f.getUniformLocation(h,"opacity"),modelViewMatrix:f.getUniformLocation(h,"modelViewMatrix"),projectionMatrix:f.getUniformLocation(h,"projectionMatrix"),fogType:f.getUniformLocation(h,"fogType"),fogDensity:f.getUniformLocation(h,"fogDensity"),fogNear:f.getUniformLocation(h,"fogNear"),fogFar:f.getUniformLocation(h,"fogFar"),fogColor:f.getUniformLocation(h,"fogColor"),alphaTest:f.getUniformLocation(h,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8,i.height=8;var o=i.getContext("2d");o.fillStyle="white",o.fillRect(0,0,8,8),p=new n(i),p.needsUpdate=!0}function r(){var e=f.createProgram(),i=f.createShader(f.VERTEX_SHADER),n=f.createShader(f.FRAGMENT_SHADER);return f.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),f.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),f.compileShader(i),f.compileShader(n),f.attachShader(e,i),f.attachShader(e,n),f.linkProgram(e),e}function o(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var a,s,h,u,d,p,f=t.context,m=t.state,g=new c,v=new l,y=new c;this.render=function(n,r){if(0!==e.length){void 0===h&&i(),f.useProgram(h),m.initAttributes(),m.enableAttribute(u.position),m.enableAttribute(u.uv),m.disableUnusedAttributes(),m.disable(f.CULL_FACE),m.enable(f.BLEND),f.bindBuffer(f.ARRAY_BUFFER,a),f.vertexAttribPointer(u.position,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(u.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,s),f.uniformMatrix4fv(d.projectionMatrix,!1,r.projectionMatrix.elements),m.activeTexture(f.TEXTURE0),f.uniform1i(d.map,0);
var l=0,c=0,_=n.fog;_?(f.uniform3f(d.fogColor,_.color.r,_.color.g,_.color.b),_&&_.isFog?(f.uniform1f(d.fogNear,_.near),f.uniform1f(d.fogFar,_.far),f.uniform1i(d.fogType,1),l=1,c=1):_&&_.isFogExp2&&(f.uniform1f(d.fogDensity,_.density),f.uniform1i(d.fogType,2),l=2,c=2)):(f.uniform1i(d.fogType,0),l=0,c=0);for(var w=0,x=e.length;x>w;w++){var b=e[w];b.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,b.matrixWorld),b.z=-b.modelViewMatrix.elements[14]}e.sort(o);for(var M=[],w=0,x=e.length;x>w;w++){var b=e[w],T=b.material;if(T.visible!==!1){f.uniform1f(d.alphaTest,T.alphaTest),f.uniformMatrix4fv(d.modelViewMatrix,!1,b.modelViewMatrix.elements),b.matrixWorld.decompose(g,v,y),M[0]=y.x,M[1]=y.y;var E=0;n.fog&&T.fog&&(E=c),l!==E&&(f.uniform1i(d.fogType,E),l=E),null!==T.map?(f.uniform2f(d.uvOffset,T.map.offset.x,T.map.offset.y),f.uniform2f(d.uvScale,T.map.repeat.x,T.map.repeat.y)):(f.uniform2f(d.uvOffset,0,0),f.uniform2f(d.uvScale,1,1)),f.uniform1f(d.opacity,T.opacity),f.uniform3f(d.color,T.color.r,T.color.g,T.color.b),f.uniform1f(d.rotation,T.rotation),f.uniform2fv(d.scale,M),m.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),m.setDepthTest(T.depthTest),m.setDepthWrite(T.depthWrite),T.map?t.setTexture2D(T.map,0):t.setTexture2D(p,0),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0)}}m.enable(f.CULL_FACE),t.resetGLState()}}}function Z(){Object.defineProperty(this,"id",{value:Q()}),this.uuid=Fs.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Oo,this.side=Co,this.shading=ko,this.vertexColors=Io,this.opacity=1,this.transparent=!1,this.blendSrc=Qo,this.blendDst=Ko,this.blendEquation=Go,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=sa,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0}function Q(){return Vc++}function K(t){Z.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function J(t){Z.call(this),this.type="MeshDepthMaterial",this.depthPacking=zs,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function te(t,e){this.min=void 0!==t?t:new c(+1/0,+1/0,+1/0),this.max=void 0!==e?e:new c(-1/0,-1/0,-1/0)}function ee(t,e){this.center=void 0!==t?t:new c,this.radius=void 0!==e?e:0}function ie(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function ne(t,e){this.normal=void 0!==t?t:new c(1,0,0),this.constant=void 0!==e?e:0}function re(t,e,i,n,r,o){this.planes=[void 0!==t?t:new ne,void 0!==e?e:new ne,void 0!==i?i:new ne,void 0!==n?n:new ne,void 0!==r?r:new ne,void 0!==o?o:new ne]}function oe(t,e,n,r){function s(e,i,n,r){var o=e.geometry,a=null,s=T,l=e.customDepthMaterial;if(n&&(s=E,l=e.customDistanceMaterial),l)a=l;else{var c=!1;i.morphTargets&&(o&&o.isBufferGeometry?c=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o&&o.isGeometry&&(c=o.morphTargets&&o.morphTargets.length>0));var h=e.isSkinnedMesh&&i.skinning,u=0;c&&(u|=x),h&&(u|=b),a=s[u]}if(t.localClippingEnabled&&i.clipShadows===!0&&0!==i.clippingPlanes.length){var d=a.uuid,p=i.uuid,f=S[d];void 0===f&&(f={},S[d]=f);var m=f[p];void 0===m&&(m=a.clone(),f[p]=m),a=m}a.visible=i.visible,a.wireframe=i.wireframe;var g=i.side;return N.renderSingleSided&&g==Po&&(g=Co),N.renderReverseSided&&(g===Co?g=Ao:g===Ao&&(g=Co)),a.side=g,a.clipShadows=i.clipShadows,a.clippingPlanes=i.clippingPlanes,a.wireframeLinewidth=i.wireframeLinewidth,a.linewidth=i.linewidth,n&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function l(t,e,i){if(t.visible!==!1){var n=0!==(t.layers.mask&e.layers.mask);if(n&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(t.frustumCulled===!1||p.intersectsObject(t)===!0)){var r=t.material;r.visible===!0&&(t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),w.push(t))}for(var o=t.children,a=0,s=o.length;s>a;a++)l(o[a],e,i)}}var u=t.context,d=t.state,p=new re,f=new h,m=e.shadows,g=new i,v=new i(r.maxTextureSize,r.maxTextureSize),y=new c,_=new c,w=[],x=1,b=2,M=(x|b)+1,T=new Array(M),E=new Array(M),S={},C=[new c(1,0,0),new c(-1,0,0),new c(0,0,1),new c(0,0,-1),new c(0,1,0),new c(0,-1,0)],A=[new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,0,1),new c(0,0,-1)],P=[new o,new o,new o,new o,new o,new o],L=new J;L.depthPacking=Os,L.clipping=!0;for(var k=Yc.distanceRGBA,I=Ws.clone(k.uniforms),R=0;R!==M;++R){var D=0!==(R&x),z=0!==(R&b),O=L.clone();O.morphTargets=D,O.skinning=z,T[R]=O;var F=new K({defines:{USE_SHADOWMAP:""},uniforms:I,vertexShader:k.vertexShader,fragmentShader:k.fragmentShader,morphTargets:D,skinning:z,clipping:!0});E[R]=F}var N=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Eo,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,i){if(N.enabled!==!1&&(N.autoUpdate!==!1||N.needsUpdate!==!1)&&0!==m.length){d.clearColor(1,1,1,1),d.disable(u.BLEND),d.setDepthTest(!0),d.setScissorTest(!1);for(var r,o,c=0,h=m.length;h>c;c++){var x=m[c],b=x.shadow;if(void 0!==b){var M=b.camera;if(g.copy(b.mapSize),g.min(v),x&&x.isPointLight){r=6,o=!0;var T=g.x,E=g.y;P[0].set(2*T,E,T,E),P[1].set(0,E,T,E),P[2].set(3*T,E,T,E),P[3].set(T,E,T,E),P[4].set(3*T,0,T,E),P[5].set(T,0,T,E),g.x*=4,g.y*=2}else r=1,o=!1;if(null===b.map){var S={minFilter:Ra,magFilter:Ra,format:ts};b.map=new a(g.x,g.y,S),M.updateProjectionMatrix()}b&&b.isSpotLightShadow&&b.update(x);var L=b.map,k=b.matrix;_.setFromMatrixPosition(x.matrixWorld),M.position.copy(_),t.setRenderTarget(L),t.clear();for(var I=0;r>I;I++){if(o){y.copy(M.position),y.add(C[I]),M.up.copy(A[I]),M.lookAt(y);var R=P[I];d.viewport(R)}else y.setFromMatrixPosition(x.target.matrixWorld),M.lookAt(y);M.updateMatrixWorld(),M.matrixWorldInverse.getInverse(M.matrixWorld),k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(M.projectionMatrix),k.multiply(M.matrixWorldInverse),f.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),p.setFromMatrix(f),w.length=0,l(e,i,M);for(var D=0,z=w.length;z>D;D++){var O=w[D],F=n.update(O),B=O.material;if(B&&B.isMultiMaterial)for(var U=F.groups,H=B.materials,G=0,j=U.length;j>G;G++){var W=U[G],Y=H[W.materialIndex];if(Y.visible===!0){var V=s(O,Y,o,_);t.renderBufferDirect(M,null,F,V,O,W)}}else{var V=s(O,B,o,_);t.renderBufferDirect(M,null,F,V,O,null)}}}}else console.warn("THREE.WebGLShadowMap:",x,"has no shadow.")}var X=t.getClearColor(),q=t.getClearAlpha();t.setClearColor(X,q),N.needsUpdate=!1}}}function ae(t,e){this.origin=void 0!==t?t:new c,this.direction=void 0!==e?e:new c}function se(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||se.DefaultOrder}function le(){this.mask=1}function ce(){function t(){r.setFromEuler(n,!1)}function e(){n.setFromQuaternion(r,void 0,!1)}Object.defineProperty(this,"id",{value:he()}),this.uuid=Fs.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ce.DefaultUp.clone();var i=new c,n=new se,r=new l,o=new c(1,1,1);n.onChange(t),r.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:i},rotation:{enumerable:!0,value:n},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new h},normalMatrix:{value:new ie}}),this.matrix=new h,this.matrixWorld=new h,this.matrixAutoUpdate=ce.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new le,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}function he(){return Xc++}function ue(t,e){this.start=void 0!==t?t:new c,this.end=void 0!==e?e:new c}function de(t,e,i){this.a=void 0!==t?t:new c,this.b=void 0!==e?e:new c,this.c=void 0!==i?i:new c}function pe(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new c,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new V,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function fe(t){Z.call(this),this.type="MeshBasicMaterial",this.color=new V(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=da,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function me(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Fs.generateUUID(),this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=i===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ge(t,e){return new me(new Int8Array(t),e)}function ve(t,e){return new me(new Uint8Array(t),e)}function ye(t,e){return new me(new Uint8ClampedArray(t),e)}function _e(t,e){return new me(new Int16Array(t),e)}function we(t,e){return new me(new Uint16Array(t),e)}function xe(t,e){return new me(new Int32Array(t),e)}function be(t,e){return new me(new Uint32Array(t),e)}function Me(t,e){return new me(new Float32Array(t),e)}function Te(t,e){return new me(new Float64Array(t),e)}function Ee(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new me(t,e).setDynamic(!0)}function Se(){Object.defineProperty(this,"id",{value:Ce()}),this.uuid=Fs.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ce(){return qc++}function Ae(){Object.defineProperty(this,"id",{value:Ce()}),this.uuid=Fs.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Pe(){Object.defineProperty(this,"id",{value:Ce()}),this.uuid=Fs.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Le(t,e){ce.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Pe,this.material=void 0!==e?e:new fe({color:16777215*Math.random()}),this.drawMode=Ts,this.updateMorphTargets()}function ke(t,e,i,n,r,o){function a(t,e,i){var n=0;return n+=(t+1)*(e+1)*2,n+=(t+1)*(i+1)*2,n+=(i+1)*(e+1)*2}function s(t,e,i){var n=0;return n+=t*e*2,n+=t*i*2,n+=i*e*2,6*n}function l(t,e,i,n,r,o,a,s,l,u,d){for(var b=o/l,M=a/u,T=o/2,E=a/2,S=s/2,C=l+1,A=u+1,P=0,L=0,k=new c,I=0;A>I;I++)for(var R=I*M-E,D=0;C>D;D++){var z=D*b-T;k[t]=z*n,k[e]=R*r,k[i]=S,f[v]=k.x,f[v+1]=k.y,f[v+2]=k.z,k[t]=0,k[e]=0,k[i]=s>0?1:-1,m[v]=k.x,m[v+1]=k.y,m[v+2]=k.z,g[y]=D/l,g[y+1]=1-I/u,v+=3,y+=2,P+=1}for(I=0;u>I;I++)for(D=0;l>D;D++){var O=w+D+C*I,F=w+D+C*(I+1),N=w+(D+1)+C*(I+1),B=w+(D+1)+C*I;p[_]=O,p[_+1]=F,p[_+2]=B,p[_+3]=F,p[_+4]=N,p[_+5]=B,_+=6,L+=6}h.addGroup(x,L,d),x+=L,w+=P}Pe.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var h=this;n=Math.floor(n)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var u=a(n,r,o),d=s(n,r,o),p=new(d>65535?Uint32Array:Uint16Array)(d),f=new Float32Array(3*u),m=new Float32Array(3*u),g=new Float32Array(2*u),v=0,y=0,_=0,w=0,x=0;l("z","y","x",-1,-1,i,e,t,o,r,0),l("z","y","x",1,-1,i,e,-t,o,r,1),l("x","z","y",1,1,t,i,e,n,o,2),l("x","z","y",1,-1,t,i,-e,n,o,3),l("x","y","z",1,-1,t,e,i,n,r,4),l("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(new me(p,1)),this.addAttribute("position",new me(f,3)),this.addAttribute("normal",new me(m,3)),this.addAttribute("uv",new me(g,2))}function Ie(t,e,i,n){Pe.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};for(var r=t/2,o=e/2,a=Math.floor(i)||1,s=Math.floor(n)||1,l=a+1,c=s+1,h=t/a,u=e/s,d=new Float32Array(l*c*3),p=new Float32Array(l*c*3),f=new Float32Array(l*c*2),m=0,g=0,v=0;c>v;v++)for(var y=v*u-o,_=0;l>_;_++){var w=_*h-r;d[m]=w,d[m+1]=-y,p[m+2]=1,f[g]=_/a,f[g+1]=1-v/s,m+=3,g+=2}m=0;for(var x=new(d.length/3>65535?Uint32Array:Uint16Array)(a*s*6),v=0;s>v;v++)for(var _=0;a>_;_++){var b=_+l*v,M=_+l*(v+1),T=_+1+l*(v+1),E=_+1+l*v;x[m]=b,x[m+1]=M,x[m+2]=E,x[m+3]=M,x[m+4]=T,x[m+5]=E,m+=6}this.setIndex(new me(x,1)),this.addAttribute("position",new me(d,3)),this.addAttribute("normal",new me(p,3)),this.addAttribute("uv",new me(f,2))}function Re(){ce.call(this),this.type="Camera",this.matrixWorldInverse=new h,this.projectionMatrix=new h}function De(t,e,i,n){Re.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ze(t,e,i,n,r,o){Re.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Oe(t,e,i){function n(t){s=t}function r(i){i.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(l=t.UNSIGNED_INT,c=4):(l=t.UNSIGNED_SHORT,c=2)}function o(e,n){t.drawElements(s,n,l,e*c),i.calls++,i.vertices+=n,s===t.TRIANGLES&&(i.faces+=n/3)}function a(n,r,o){var a=e.get("ANGLE_instanced_arrays");return null===a?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(a.drawElementsInstancedANGLE(s,o,l,r*c,n.maxInstancedCount),i.calls++,i.vertices+=o*n.maxInstancedCount,void(s===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*o/3)))}var s,l,c;return{setMode:n,setIndex:r,render:o,renderInstances:a}}function Fe(t,e,i){function n(t){a=t}function r(e,n){t.drawArrays(a,e,n),i.calls++,i.vertices+=n,a===t.TRIANGLES&&(i.faces+=n/3)}function o(n){var r=e.get("ANGLE_instanced_arrays");if(null===r)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var o=n.attributes.position,s=0;o&&o.isInterleavedBufferAttribute?(s=o.data.count,r.drawArraysInstancedANGLE(a,0,s,n.maxInstancedCount)):(s=o.count,r.drawArraysInstancedANGLE(a,0,s,n.maxInstancedCount)),i.calls++,i.vertices+=s*n.maxInstancedCount,a===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*s/3)}var a;return{setMode:n,render:r,renderInstances:o}}function Ne(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new c,color:new V,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":n={position:new c,direction:new c,color:new V,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":n={position:new c,color:new V,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"HemisphereLight":n={direction:new c,skyColor:new V,groundColor:new V}}return t[e.id]=n,n}}}function Be(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}function Ue(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),Be(i)),n}function He(t){switch(t){case Cs:return["Linear","( value )"];case As:return["sRGB","( value )"];case Ls:return["RGBE","( value )"];case Is:return["RGBM","( value, 7.0 )"];case Rs:return["RGBM","( value, 16.0 )"];case Ds:return["RGBD","( value, 256.0 )"];case Ps:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Ge(t,e){var i=He(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function je(t,e){var i=He(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function We(t,e){var i;switch(e){case ga:i="Linear";break;case va:i="Reinhard";break;case ya:i="Uncharted2";break;case _a:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Ye(t,e,i){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(qe).join("\n")}function Ve(t){var e=[];for(var i in t){var n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join("\n")}function Xe(t,e){for(var i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;n>r;r++){var o=t.getActiveAttrib(e,r),a=o.name;i[a]=t.getAttribLocation(e,a)}return i}function qe(t){return""!==t}function $e(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Ze(t){function e(t,e){var i=Gc[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return Ze(i)}var i=/#include +<([\w\d.]+)>/g;return t.replace(i,e)}function Qe(t){function e(t,e,i,n){for(var r="",o=parseInt(e);o<parseInt(i);o++)r+=n.replace(/\[ i \]/g,"[ "+o+" ]");return r}var i=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(i,e)}function Ke(t,e,i,n){var r=t.context,o=i.extensions,a=i.defines,s=i.__webglShader.vertexShader,l=i.__webglShader.fragmentShader,c="SHADOWMAP_TYPE_BASIC";n.shadowMapType===Eo?c="SHADOWMAP_TYPE_PCF":n.shadowMapType===So&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",u="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(n.envMap){switch(i.envMap.mapping){case xa:case ba:h="ENVMAP_TYPE_CUBE";break;case Sa:case Ca:h="ENVMAP_TYPE_CUBE_UV";break;case Ma:case Ta:h="ENVMAP_TYPE_EQUIREC";break;case Ea:h="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case ba:case Ta:u="ENVMAP_MODE_REFRACTION"}switch(i.combine){case da:d="ENVMAP_BLENDING_MULTIPLY";break;case pa:d="ENVMAP_BLENDING_MIX";break;case fa:d="ENVMAP_BLENDING_ADD"}}var p,f,m=t.gammaFactor>0?t.gammaFactor:1,g=Ye(o,n,t.extensions),v=Ve(a),y=r.createProgram();i.isRawShaderMaterial?(p=[v,"\n"].filter(qe).join("\n"),f=[g,v,"\n"].filter(qe).join("\n")):(p=["precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,v,n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(qe).join("\n"),f=[g,"precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,v,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"","#define GAMMA_FACTOR "+m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(n.numClippingPlanes-n.numClipIntersection),n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",n.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",n.toneMapping!==ma?"#define TONE_MAPPING":"",n.toneMapping!==ma?Gc.tonemapping_pars_fragment:"",n.toneMapping!==ma?We("toneMapping",n.toneMapping):"",n.outputEncoding||n.mapEncoding||n.envMapEncoding||n.emissiveMapEncoding?Gc.encodings_pars_fragment:"",n.mapEncoding?Ge("mapTexelToLinear",n.mapEncoding):"",n.envMapEncoding?Ge("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Ge("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.outputEncoding?je("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(qe).join("\n")),s=Ze(s,n),s=$e(s,n),l=Ze(l,n),l=$e(l,n),i.isShaderMaterial||(s=Qe(s),l=Qe(l));var _=p+s,w=f+l,x=Ue(r,r.VERTEX_SHADER,_),b=Ue(r,r.FRAGMENT_SHADER,w);r.attachShader(y,x),r.attachShader(y,b),void 0!==i.index0AttributeName?r.bindAttribLocation(y,0,i.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);var M=r.getProgramInfoLog(y),T=r.getShaderInfoLog(x),E=r.getShaderInfoLog(b),S=!0,C=!0;r.getProgramParameter(y,r.LINK_STATUS)===!1?(S=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(y,r.VALIDATE_STATUS),"gl.getProgramInfoLog",M,T,E)):""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):(""===T||""===E)&&(C=!1),C&&(this.diagnostics={runnable:S,material:i,programLog:M,vertexShader:{log:T,prefix:p},fragmentShader:{log:E,prefix:f}}),r.deleteShader(x),r.deleteShader(b);var A;this.getUniforms=function(){return void 0===A&&(A=new Y(r,y,t)),A};var P;return this.getAttributes=function(){return void 0===P&&(P=Xe(r,y)),P},this.destroy=function(){r.deleteProgram(y),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=$c++,this.code=e,this.usedTimes=1,this.program=y,this.vertexShader=x,this.fragmentShader=b,this}function Je(t,e){function i(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var i=e.maxVertexUniforms,n=Math.floor((i-20)/4),r=n;return void 0!==t&&t&&t.isSkinnedMesh&&(r=Math.min(t.skeleton.bones.length,r),r<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")),r}function n(t,e){var i;return t?t&&t.isTexture?i=t.encoding:t&&t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=Cs,i===Cs&&e&&(i=Ps),i}var r=[],o={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking"];this.getParameters=function(r,a,s,l,c,h){var u=o[r.type],d=i(h),p=t.getPrecision();null!==r.precision&&(p=e.getMaxPrecision(r.precision),p!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",p,"instead."));var f=t.getCurrentRenderTarget(),m={shaderID:u,precision:p,supportsVertexTextures:e.vertexTextures,outputEncoding:n(f?f.texture:null,t.gammaOutput),map:!!r.map,mapEncoding:n(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:n(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(r.envMap.mapping===Sa||r.envMap.mapping===Ca),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:n(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,combine:r.combine,vertexColors:r.vertexColors,fog:!!s,useFog:r.fog,fogExp:s&&s.isFogExp2,flatShading:r.shading===Lo,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:d,useVertexTexture:e.floatVertexTextures&&h&&h.skeleton&&h.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numHemiLights:a.hemi.length,numClippingPlanes:l,numClipIntersection:c,shadowMapEnabled:t.shadowMap.enabled&&h.receiveShadow&&a.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===Po,flipSided:r.side===Ao,depthPacking:void 0!==r.depthPacking?r.depthPacking:!1};return m},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var r=0;r<a.length;r++)i.push(e[a[r]]);return i.join()},this.acquireProgram=function(e,i,n){for(var o,a=0,s=r.length;s>a;a++){var l=r[a];if(l.code===n){o=l,++o.usedTimes;break}}return void 0===o&&(o=new Ke(t,n,e,i),r.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function ti(t,e,i){function n(t){var r=t.target,s=l[r.id];null!==s.index&&o(s.index),a(s.attributes),r.removeEventListener("dispose",n),delete l[r.id];var c=e.get(r);c.wireframe&&o(c.wireframe),e.delete(r);var h=e.get(s);h.wireframe&&o(h.wireframe),e.delete(s),i.memory.geometries--}function r(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function o(e){var i=r(e);void 0!==i&&(t.deleteBuffer(i),s(e))}function a(t){for(var e in t)o(t[e])}function s(t){e.delete(t.isInterleavedBufferAttribute?t.data:t)}var l={};return{get:function(t){var e=t.geometry;if(void 0!==l[e.id])return l[e.id];e.addEventListener("dispose",n);var r;return e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Pe).setFromObject(t)),r=e._bufferGeometry),l[e.id]=r,i.memory.geometries++,r}}}function ei(t,e,i){function n(e){var i=c.get(e);e.geometry.isGeometry&&i.updateFromObject(e);var n=i.index,o=i.attributes;null!==n&&r(n,t.ELEMENT_ARRAY_BUFFER);for(var a in o)r(o[a],t.ARRAY_BUFFER);var s=i.morphAttributes;for(var a in s)for(var l=s[a],h=0,u=l.length;u>h;h++)r(l[h],t.ARRAY_BUFFER);return i}function r(t,i){var n=t.isInterleavedBufferAttribute?t.data:t,r=e.get(n);void 0===r.__webglBuffer?o(r,n,i):r.version!==n.version&&a(r,n,i)}function o(e,i,n){e.__webglBuffer=t.createBuffer(),t.bindBuffer(n,e.__webglBuffer);var r=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(n,i.array,r),e.version=i.version}function a(e,i,n){t.bindBuffer(n,e.__webglBuffer),i.dynamic===!1?t.bufferData(n,i.array,t.STATIC_DRAW):-1===i.updateRange.count?t.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),e.version=i.version}function s(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function l(i){var n=e.get(i);if(void 0!==n.wireframe)return n.wireframe;var o=[],a=i.index,s=i.attributes,l=s.position;if(null!==a)for(var c=a.array,h=0,u=c.length;u>h;h+=3){var d=c[h+0],p=c[h+1],f=c[h+2];o.push(d,p,p,f,f,d)
}else for(var c=s.position.array,h=0,u=c.length/3-1;u>h;h+=3){var d=h+0,p=h+1,f=h+2;o.push(d,p,p,f,f,d)}var m=l.count>65535?Uint32Array:Uint16Array,g=new me(new m(o),1);return r(g,t.ELEMENT_ARRAY_BUFFER),n.wireframe=g,g}var c=new ti(t,e,i);return{getAttributeBuffer:s,getWireframeAttribute:l,update:n}}function ii(t,e,i,n,r,o,a){function s(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i);var r=n.getContext("2d");return r.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function l(t){return Fs.isPowerOfTwo(t.width)&&Fs.isPowerOfTwo(t.height)}function c(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=Fs.nearestPowerOfTwo(t.width),e.height=Fs.nearestPowerOfTwo(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function h(t){return t.wrapS!==La||t.wrapT!==La?!0:t.minFilter!==Ra&&t.minFilter!==Oa?!0:!1}function u(e){return e===Ra||e===Da||e===za?t.NEAREST:t.LINEAR}function d(t){var e=t.target;e.removeEventListener("dispose",d),f(e),C.textures--}function p(t){var e=t.target;e.removeEventListener("dispose",p),m(e),C.textures--}function f(e){var i=n.get(e);if(e.image&&i.__image__webglTextureCube)t.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;t.deleteTexture(i.__webglTexture)}n.delete(e)}function m(e){var i=n.get(e),r=n.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e&&e.isWebGLRenderTargetCube)for(var o=0;6>o;o++)t.deleteFramebuffer(i.__webglFramebuffer[o]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[o]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer);n.delete(e.texture),n.delete(e)}}function g(e,r){var o=n.get(e);if(e.version>0&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(a.complete!==!1)return void w(o,e,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function v(e,a){var c=n.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",d),c.__image__webglTextureCube=t.createTexture(),C.textures++),i.activeTexture(t.TEXTURE0+a),i.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var h=e&&e.isCompressedTexture,u=e.image[0]&&e.image[0].isDataTexture,p=[],f=0;6>f;f++)p[f]=h||u?u?e.image[f].image:e.image[f]:s(e.image[f],r.maxCubemapSize);var m=p[0],g=l(m),v=o(e.format),y=o(e.type);_(t.TEXTURE_CUBE_MAP,e,g);for(var f=0;6>f;f++)if(h)for(var w,x=p[f].mipmaps,b=0,M=x.length;M>b;b++)w=x[b],e.format!==ts&&e.format!==Ja?i.getCompressedTextureFormats().indexOf(v)>-1?i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,b,v,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,b,v,w.width,w.height,0,v,y,w.data);else u?i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,p[f].width,p[f].height,0,v,y,p[f].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,v,y,p[f]);e.generateMipmaps&&g&&t.generateMipmap(t.TEXTURE_CUBE_MAP),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else i.activeTexture(t.TEXTURE0+a),i.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function y(e,r){i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)}function _(i,a,s){var l;if(s?(t.texParameteri(i,t.TEXTURE_WRAP_S,o(a.wrapS)),t.texParameteri(i,t.TEXTURE_WRAP_T,o(a.wrapT)),t.texParameteri(i,t.TEXTURE_MAG_FILTER,o(a.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,o(a.minFilter))):(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(a.wrapS!==La||a.wrapT!==La)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(i,t.TEXTURE_MAG_FILTER,u(a.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,u(a.minFilter)),a.minFilter!==Ra&&a.minFilter!==Oa&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),l=e.get("EXT_texture_filter_anisotropic")){if(a.type===Va&&null===e.get("OES_texture_float_linear"))return;if(a.type===Xa&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(t.texParameterf(i,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function w(e,n,a){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",d),e.__webglTexture=t.createTexture(),C.textures++),i.activeTexture(t.TEXTURE0+a),i.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,n.unpackAlignment);var u=s(n.image,r.maxTextureSize);h(n)&&l(u)===!1&&(u=c(u));var p=l(u),f=o(n.format),m=o(n.type);_(t.TEXTURE_2D,n,p);var g,v=n.mipmaps;if(n&&n.isDepthTexture){var y=t.DEPTH_COMPONENT;if(n.type===Va){if(!A)throw new Error("Float Depth Texture only supported in WebGL2.0");y=t.DEPTH_COMPONENT32F}else A&&(y=t.DEPTH_COMPONENT16);n.format===os&&(y=t.DEPTH_STENCIL),i.texImage2D(t.TEXTURE_2D,0,y,u.width,u.height,0,f,m,null)}else if(n&&n.isDataTexture)if(v.length>0&&p){for(var w=0,x=v.length;x>w;w++)g=v[w],i.texImage2D(t.TEXTURE_2D,w,f,g.width,g.height,0,f,m,g.data);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,f,u.width,u.height,0,f,m,u.data);else if(n&&n.isCompressedTexture)for(var w=0,x=v.length;x>w;w++)g=v[w],n.format!==ts&&n.format!==Ja?i.getCompressedTextureFormats().indexOf(f)>-1?i.compressedTexImage2D(t.TEXTURE_2D,w,f,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(t.TEXTURE_2D,w,f,g.width,g.height,0,f,m,g.data);else if(v.length>0&&p){for(var w=0,x=v.length;x>w;w++)g=v[w],i.texImage2D(t.TEXTURE_2D,w,f,f,m,g);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,f,f,m,u);n.generateMipmaps&&p&&t.generateMipmap(t.TEXTURE_2D),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function x(e,r,a,s){var l=o(r.texture.format),c=o(r.texture.type);i.texImage2D(s,0,l,r.width,r.height,0,l,c,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function b(e,i){t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer&&!i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):i.depthBuffer&&i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i.width,i.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function M(e,i){var r=i&&i.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),g(i.depthTexture,0);var o=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===rs)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(i.depthTexture.format!==os)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}function T(e){var i=n.get(e),r=e&&e.isWebGLRenderTargetCube;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");M(i.__webglFramebuffer,e)}else if(r){i.__webglDepthbuffer=[];for(var o=0;6>o;o++)t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=t.createRenderbuffer(),b(i.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),b(i.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function E(e){var r=n.get(e),o=n.get(e.texture);e.addEventListener("dispose",p),o.__webglTexture=t.createTexture(),C.textures++;var a=e&&e.isWebGLRenderTargetCube,s=l(e);if(a){r.__webglFramebuffer=[];for(var c=0;6>c;c++)r.__webglFramebuffer[c]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(a){i.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),_(t.TEXTURE_CUBE_MAP,e.texture,s);for(var c=0;6>c;c++)x(r.__webglFramebuffer[c],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+c);e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_CUBE_MAP),i.bindTexture(t.TEXTURE_CUBE_MAP,null)}else i.bindTexture(t.TEXTURE_2D,o.__webglTexture),_(t.TEXTURE_2D,e.texture,s),x(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_2D),i.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&T(e)}function S(e){var r=e.texture;if(r.generateMipmaps&&l(e)&&r.minFilter!==Ra&&r.minFilter!==Oa){var o=e&&e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=n.get(r).__webglTexture;i.bindTexture(o,a),t.generateMipmap(o),i.bindTexture(o,null)}}var C=a.memory,A="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=g,this.setTextureCube=v,this.setTextureCubeDynamic=y,this.setupRenderTarget=E,this.updateRenderTargetMipmap=S}function ni(){var t={};return{get:function(e){var i=e.uuid,n=t[i];return void 0===n&&(n={},t[i]=n),n},"delete":function(e){delete t[e.uuid]},clear:function(){t={}}}}function ri(t,e,i){function n(){var e=!1,i=new o,n=null,r=new o;return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,o,a){i.set(e,n,o,a),r.equals(i)===!1&&(t.clearColor(e,n,o,a),r.copy(i))},reset:function(){e=!1,n=null,r.set(0,0,0,1)}}}function r(){var e=!1,i=null,n=null,r=null;return{setTest:function(e){e?p(t.DEPTH_TEST):f(t.DEPTH_TEST)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case ra:t.depthFunc(t.NEVER);break;case oa:t.depthFunc(t.ALWAYS);break;case aa:t.depthFunc(t.LESS);break;case sa:t.depthFunc(t.LEQUAL);break;case la:t.depthFunc(t.EQUAL);break;case ca:t.depthFunc(t.GEQUAL);break;case ha:t.depthFunc(t.GREATER);break;case ua:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}}function a(){var e=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(e){e?p(t.STENCIL_TEST):f(t.STENCIL_TEST)},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,a){(n!==e||r!==i||o!==a)&&(t.stencilFunc(e,i,a),n=e,r=i,o=a)},setOp:function(e,i,n){(a!==e||s!==i||l!==n)&&(t.stencilOp(e,i,n),a=e,s=i,l=n)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null}}}function s(e,i,n){var r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;n>a;a++)t.texImage2D(i+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}function l(){z(0,0,0,1),O(1),F(0),p(t.DEPTH_TEST),w(sa),E(!1),S(_o),p(t.CULL_FACE),p(t.BLEND),g(Oo)}function c(){for(var t=0,e=Y.length;e>t;t++)Y[t]=0}function h(i){if(Y[i]=1,0===V[i]&&(t.enableVertexAttribArray(i),V[i]=1),0!==X[i]){var n=e.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(i,0),X[i]=0}}function u(e,i,n){Y[e]=1,0===V[e]&&(t.enableVertexAttribArray(e),V[e]=1),X[e]!==i&&(n.vertexAttribDivisorANGLE(e,i),X[e]=i)}function d(){for(var e=0,i=V.length;e!==i;++e)V[e]!==Y[e]&&(t.disableVertexAttribArray(e),V[e]=0)}function p(e){q[e]!==!0&&(t.enable(e),q[e]=!0)}function f(e){q[e]!==!1&&(t.disable(e),q[e]=!1)}function m(){if(null===$&&($=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)$.push(i[n]);return $}function g(e,n,r,o,a,s,l,c){e!==zo?p(t.BLEND):f(t.BLEND),(e!==Z||c!==ne)&&(e===Fo?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===No?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===Bo?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),Z=e,ne=c),e===Uo?(a=a||n,s=s||r,l=l||o,(n!==Q||a!==te)&&(t.blendEquationSeparate(i(n),i(a)),Q=n,te=a),(r!==K||o!==J||s!==ee||l!==ie)&&(t.blendFuncSeparate(i(r),i(o),i(s),i(l)),K=r,J=o,ee=s,ie=l)):(Q=null,K=null,J=null,te=null,ee=null,ie=null)}function v(t){H.setMask(t)}function y(t){G.setTest(t)}function _(t){G.setMask(t)}function w(t){G.setFunc(t)}function x(t){j.setTest(t)}function b(t){j.setMask(t)}function M(t,e,i){j.setFunc(t,e,i)}function T(t,e,i){j.setOp(t,e,i)}function E(e){re!==e&&(t.frontFace(e?t.CW:t.CCW),re=e)}function S(e){e!==yo?(p(t.CULL_FACE),e!==oe&&t.cullFace(e===_o?t.BACK:e===wo?t.FRONT:t.FRONT_AND_BACK)):f(t.CULL_FACE),oe=e}function C(e){e!==ae&&(t.lineWidth(e),ae=e)}function A(e,i,n){e?(p(t.POLYGON_OFFSET_FILL),(se!==i||le!==n)&&(t.polygonOffset(i,n),se=i,le=n)):f(t.POLYGON_OFFSET_FILL)}function P(){return ce}function L(e){ce=e,e?p(t.SCISSOR_TEST):f(t.SCISSOR_TEST)}function k(e){void 0===e&&(e=t.TEXTURE0+he-1),ue!==e&&(t.activeTexture(e),ue=e)}function I(e,i){null===ue&&k();var n=de[ue];void 0===n&&(n={type:void 0,texture:void 0},de[ue]=n),(n.type!==e||n.texture!==i)&&(t.bindTexture(e,i||me[e]),n.type=e,n.texture=i)}function R(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error(e)}}function D(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error(e)}}function z(t,e,i,n){H.setClear(t,e,i,n)}function O(t){G.setClear(t)}function F(t){j.setClear(t)}function N(e){pe.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),pe.copy(e))}function B(e){fe.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),fe.copy(e))}function U(){for(var e=0;e<V.length;e++)1===V[e]&&(t.disableVertexAttribArray(e),V[e]=0);q={},$=null,ue=null,de={},Z=null,re=null,oe=null,H.reset(),G.reset(),j.reset()}var H=new n,G=new r,j=new a,W=t.getParameter(t.MAX_VERTEX_ATTRIBS),Y=new Uint8Array(W),V=new Uint8Array(W),X=new Uint8Array(W),q={},$=null,Z=null,Q=null,K=null,J=null,te=null,ee=null,ie=null,ne=!1,re=null,oe=null,ae=null,se=null,le=null,ce=null,he=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ue=null,de={},pe=new o,fe=new o,me={};return me[t.TEXTURE_2D]=s(t.TEXTURE_2D,t.TEXTURE_2D,1),me[t.TEXTURE_CUBE_MAP]=s(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:H,depth:G,stencil:j},init:l,initAttributes:c,enableAttribute:h,enableAttributeAndDivisor:u,disableUnusedAttributes:d,enable:p,disable:f,getCompressedTextureFormats:m,setBlending:g,setColorWrite:v,setDepthTest:y,setDepthWrite:_,setDepthFunc:w,setStencilTest:x,setStencilWrite:b,setStencilFunc:M,setStencilOp:T,setFlipSided:E,setCullFace:S,setLineWidth:C,setPolygonOffset:A,getScissorTest:P,setScissorTest:L,activeTexture:k,bindTexture:I,compressedTexImage2D:R,texImage2D:D,clearColor:z,clearDepth:O,clearStencil:F,scissor:N,viewport:B,reset:U}}function oi(t,e,i){function n(){if(void 0!==o)return o;var i=e.get("EXT_texture_filter_anisotropic");return o=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==i.precision?i.precision:"highp",s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=i.logarithmicDepthBuffer===!0&&!!e.get("EXT_frag_depth"),c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),g=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=h>0,y=!!e.get("OES_texture_float"),_=v&&y;return{getMaxAnisotropy:n,getMaxPrecision:r,precision:a,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:_}}function ai(t){var e={};return{get:function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n,n}}}function si(){function t(){c.value!==n&&(c.value=n,c.needsUpdate=r>0),i.numPlanes=r,i.numIntersection=0}function e(t,e,n,r){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,r!==!0||null===a){var h=n+4*o,u=e.matrixWorldInverse;l.getNormalMatrix(u),(null===a||a.length<h)&&(a=new Float32Array(h));for(var d=0,p=n;d!==o;++d,p+=4)s.copy(t[d]).applyMatrix4(u,l),s.normal.toArray(a,p),a[p+3]=s.constant}c.value=a,c.needsUpdate=!0}return i.numPlanes=o,a}var i=this,n=null,r=0,o=!1,a=!1,s=new ne,l=new ie,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,a){var s=0!==t.length||i||0!==r||o;return o=i,n=e(t,a,0),r=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(i,s,l,h,u,d){if(!o||null===i||0===i.length||a&&!l)a?e(null):t();else{var p=a?0:r,f=4*p,m=u.clippingState||null;c.value=m,m=e(i,h,f,d);for(var g=0;g!==f;++g)m[g]=n[g];u.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=p}}}function li(t){function e(){return null===ue?Ee:1}function i(t,e,i,n){X===!0&&(t*=n,e*=n,i*=n),Ke.clearColor(t,e,i,n)}function n(){Ke.init(),Ke.scissor(ve.copy(Se).multiplyScalar(Ee)),Ke.viewport(_e.copy(Ae).multiplyScalar(Ee)),i(xe.r,xe.g,xe.b,be)}function r(){he=null,ge=null,me="",pe=-1,Ke.reset()}function a(t){t.preventDefault(),r(),n(),ti.clear()}function s(t){var e=t.target;e.removeEventListener("dispose",s),l(e)}function l(t){u(t),ti.delete(t)}function u(t){var e=ti.get(t).program;t.program=void 0,void 0!==e&&hi.releaseProgram(e)}function d(t,e,i,n){var r;if(i&&i.isInstancedBufferGeometry&&(r=Ze.get("ANGLE_instanced_arrays"),null===r))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0),Ke.initAttributes();var o=i.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var l in a){var c=a[l];if(c>=0){var h=o[l];if(void 0!==h){var u=Xe.FLOAT,d=h.array,p=h.normalized;d instanceof Float32Array?u=Xe.FLOAT:d instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):d instanceof Uint16Array?u=Xe.UNSIGNED_SHORT:d instanceof Int16Array?u=Xe.SHORT:d instanceof Uint32Array?u=Xe.UNSIGNED_INT:d instanceof Int32Array?u=Xe.INT:d instanceof Int8Array?u=Xe.BYTE:d instanceof Uint8Array&&(u=Xe.UNSIGNED_BYTE);var f=h.itemSize,m=ci.getAttributeBuffer(h);if(h.isInterleavedBufferAttribute){var g=h.data,v=g.stride,y=h.offset;g&&g.isInstancedInterleavedBuffer?(Ke.enableAttributeAndDivisor(c,g.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=g.meshPerAttribute*g.count)):Ke.enableAttribute(c),Xe.bindBuffer(Xe.ARRAY_BUFFER,m),Xe.vertexAttribPointer(c,f,u,p,v*g.array.BYTES_PER_ELEMENT,(n*v+y)*g.array.BYTES_PER_ELEMENT)}else h.isInstancedBufferAttribute?(Ke.enableAttributeAndDivisor(c,h.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=h.meshPerAttribute*h.count)):Ke.enableAttribute(c),Xe.bindBuffer(Xe.ARRAY_BUFFER,m),Xe.vertexAttribPointer(c,f,u,p,0,n*f*h.array.BYTES_PER_ELEMENT)}else if(void 0!==s){var _=s[l];if(void 0!==_)switch(_.length){case 2:Xe.vertexAttrib2fv(c,_);break;case 3:Xe.vertexAttrib3fv(c,_);break;case 4:Xe.vertexAttrib4fv(c,_);break;default:Xe.vertexAttrib1fv(c,_)}}}}Ke.disableUnusedAttributes()}function p(t,e){return Math.abs(e[0])-Math.abs(t[0])}function f(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function m(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function g(t,e,i,n,r){var o,a;i.transparent?(o=ie,a=++ne):(o=J,a=++te);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=i,s.z=We.z,s.group=r):(s={id:t.id,object:t,geometry:e,material:i,z:We.z,group:r},o.push(s))}function v(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ge.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),_(Ge)}function y(t){return Ge.center.set(0,0,0),Ge.radius=.7071067811865476,Ge.applyMatrix4(t.matrixWorld),_(Ge)}function _(t){if(!Re.intersectsSphere(t))return!1;var e=Be.numPlanes;if(0===e)return!0;var i=ce.clippingPlanes,n=t.center,r=-t.radius,o=0;do if(i[o].distanceToPoint(n)<r)return!1;while(++o!==e);return!0}function w(t,e){if(t.visible!==!1){var i=0!==(t.layers.mask&e.layers.mask);if(i)if(t.isLight)Q.push(t);else if(t.isSprite)(t.frustumCulled===!1||y(t)===!0)&&se.push(t);else if(t.isLensFlare)le.push(t);else if(t.isImmediateRenderObject)ce.sortObjects===!0&&(We.setFromMatrixPosition(t.matrixWorld),We.applyProjection(je)),g(t,null,t.material,We.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||v(t)===!0)){var n=t.material;if(n.visible===!0){ce.sortObjects===!0&&(We.setFromMatrixPosition(t.matrixWorld),We.applyProjection(je));var r=ci.update(t);if(n.isMultiMaterial)for(var o=r.groups,a=n.materials,s=0,l=o.length;l>s;s++){var c=o[s],h=a[c.materialIndex];h.visible===!0&&g(t,r,h,We.z,c)}else g(t,r,n,We.z,null)}}for(var u=t.children,s=0,l=u.length;l>s;s++)w(u[s],e)}}function x(t,e,i,n){for(var r=0,o=t.length;o>r;r++){var a=t[r],s=a.object,l=a.geometry,c=void 0===n?a.material:n,h=a.group;if(s.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.onBeforeRender(ce,e,i,l,c,h),s.isImmediateRenderObject){M(c);var u=T(i,e.fog,c,s);me="",s.render(function(t){ce.renderBufferImmediate(t,u,c)})}else ce.renderBufferDirect(i,e.fog,l,c,s,h);s.onAfterRender(ce,e,i,l,c,h)}}function b(t,e,i){var n=ti.get(t),r=hi.getParameters(t,Ye,e,Be.numPlanes,Be.numIntersection,i),o=hi.getProgramCode(t,r),a=n.program,l=!0;if(void 0===a)t.addEventListener("dispose",s);else if(a.code!==o)u(t);else{if(void 0!==r.shaderID)return;l=!1}if(l){if(r.shaderID){var c=Yc[r.shaderID];n.__webglShader={name:t.type,uniforms:Ws.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else n.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=n.__webglShader,a=hi.acquireProgram(t,r,o),n.program=a,t.program=a}var h=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<ce.maxMorphTargets;d++)h["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var d=0;d<ce.maxMorphNormals;d++)h["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var p=n.__webglShader.uniforms;(!t.isShaderMaterial&&!t.isRawShaderMaterial||t.clipping===!0)&&(n.numClippingPlanes=Be.numPlanes,n.numIntersection=Be.numIntersection,p.clippingPlanes=Be.uniform),n.fog=e,n.lightsHash=Ye.hash,t.lights&&(p.ambientLightColor.value=Ye.ambient,p.directionalLights.value=Ye.directional,p.spotLights.value=Ye.spot,p.pointLights.value=Ye.point,p.hemisphereLights.value=Ye.hemi,p.directionalShadowMap.value=Ye.directionalShadowMap,p.directionalShadowMatrix.value=Ye.directionalShadowMatrix,p.spotShadowMap.value=Ye.spotShadowMap,p.spotShadowMatrix.value=Ye.spotShadowMatrix,p.pointShadowMap.value=Ye.pointShadowMap,p.pointShadowMatrix.value=Ye.pointShadowMatrix);var f=n.program.getUniforms(),m=Y.seqWithValue(f.seq,p);n.uniformsList=m}function M(t){t.side===Po?Ke.disable(Xe.CULL_FACE):Ke.enable(Xe.CULL_FACE),Ke.setFlipSided(t.side===Ao),t.transparent===!0?Ke.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):Ke.setBlending(zo),Ke.setDepthFunc(t.depthFunc),Ke.setDepthTest(t.depthTest),Ke.setDepthWrite(t.depthWrite),Ke.setColorWrite(t.colorWrite),Ke.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function T(t,e,i,n){we=0;var r=ti.get(i);if(Ue&&(He||t!==ge)){var o=t===ge&&i.id===pe;Be.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,o)}i.needsUpdate===!1&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:i.lights&&r.lightsHash!==Ye.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===Be.numPlanes&&r.numIntersection===Be.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(b(i,e,n),i.needsUpdate=!1);var a=!1,s=!1,l=!1,c=r.program,h=c.getUniforms(),u=r.__webglShader.uniforms;if(c.id!==he&&(Xe.useProgram(c.program),he=c.id,a=!0,s=!0,l=!0),i.id!==pe&&(pe=i.id,s=!0),a||t!==ge){if(h.set(Xe,t,"projectionMatrix"),Qe.logarithmicDepthBuffer&&h.setValue(Xe,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==ge&&(ge=t,s=!0,l=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var d=h.map.cameraPosition;void 0!==d&&d.setValue(Xe,We.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&h.setValue(Xe,"viewMatrix",t.matrixWorldInverse),h.set(Xe,ce,"toneMappingExposure"),h.set(Xe,ce,"toneMappingWhitePoint")}if(i.skinning){h.setOptional(Xe,n,"bindMatrix"),h.setOptional(Xe,n,"bindMatrixInverse");var p=n.skeleton;p&&(Qe.floatVertexTextures&&p.useVertexTexture?(h.set(Xe,p,"boneTexture"),h.set(Xe,p,"boneTextureWidth"),h.set(Xe,p,"boneTextureHeight")):h.setOptional(Xe,p,"boneMatrices"))}return s&&(i.lights&&D(u,l),e&&i.fog&&P(u,e),(i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshDepthMaterial)&&E(u,i),i.isLineBasicMaterial?S(u,i):i.isLineDashedMaterial?(S(u,i),C(u,i)):i.isPointsMaterial?A(u,i):i.isMeshLambertMaterial?L(u,i):i.isMeshPhongMaterial?k(u,i):i.isMeshPhysicalMaterial?R(u,i):i.isMeshStandardMaterial?I(u,i):i.isMeshDepthMaterial?i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&(u.opacity.value=i.opacity),Y.upload(Xe,r.uniformsList,u,ce)),h.set(Xe,n,"modelViewMatrix"),h.set(Xe,n,"normalMatrix"),h.setValue(Xe,"modelMatrix",n.matrixWorld),c}function E(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){i.isWebGLRenderTarget&&(i=i.texture);var n=i.offset,r=i.repeat;t.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function S(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function C(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function A(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Ee,t.scale.value=.5*Te,t.map.value=e.map,null!==e.map){var i=e.map.offset,n=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}function P(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function L(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function k(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function I(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function R(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,I(t,e)}function D(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function z(t){for(var e=0,i=0,n=t.length;n>i;i++){var r=t[i];r.castShadow&&(Ye.shadows[e++]=r)
}Ye.shadows.length=e}function O(t,e){var i,n,r,o,a,s,l,c=0,u=0,d=0,p=e.matrixWorldInverse,f=0,m=0,g=0,v=0;for(i=0,n=t.length;n>i;i++)if(r=t[i],o=r.color,a=r.intensity,s=r.distance,l=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)c+=o.r*a,u+=o.g*a,d+=o.b*a;else if(r.isDirectionalLight){var y=ui.get(r);y.color.copy(r.color).multiplyScalar(r.intensity),y.direction.setFromMatrixPosition(r.matrixWorld),We.setFromMatrixPosition(r.target.matrixWorld),y.direction.sub(We),y.direction.transformDirection(p),y.shadow=r.castShadow,r.castShadow&&(y.shadowBias=r.shadow.bias,y.shadowRadius=r.shadow.radius,y.shadowMapSize=r.shadow.mapSize),Ye.directionalShadowMap[f]=l,Ye.directionalShadowMatrix[f]=r.shadow.matrix,Ye.directional[f++]=y}else if(r.isSpotLight){var y=ui.get(r);y.position.setFromMatrixPosition(r.matrixWorld),y.position.applyMatrix4(p),y.color.copy(o).multiplyScalar(a),y.distance=s,y.direction.setFromMatrixPosition(r.matrixWorld),We.setFromMatrixPosition(r.target.matrixWorld),y.direction.sub(We),y.direction.transformDirection(p),y.coneCos=Math.cos(r.angle),y.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),y.decay=0===r.distance?0:r.decay,y.shadow=r.castShadow,r.castShadow&&(y.shadowBias=r.shadow.bias,y.shadowRadius=r.shadow.radius,y.shadowMapSize=r.shadow.mapSize),Ye.spotShadowMap[g]=l,Ye.spotShadowMatrix[g]=r.shadow.matrix,Ye.spot[g++]=y}else if(r.isPointLight){var y=ui.get(r);y.position.setFromMatrixPosition(r.matrixWorld),y.position.applyMatrix4(p),y.color.copy(r.color).multiplyScalar(r.intensity),y.distance=r.distance,y.decay=0===r.distance?0:r.decay,y.shadow=r.castShadow,r.castShadow&&(y.shadowBias=r.shadow.bias,y.shadowRadius=r.shadow.radius,y.shadowMapSize=r.shadow.mapSize),Ye.pointShadowMap[m]=l,void 0===Ye.pointShadowMatrix[m]&&(Ye.pointShadowMatrix[m]=new h),We.setFromMatrixPosition(r.matrixWorld).negate(),Ye.pointShadowMatrix[m].identity().setPosition(We),Ye.point[m++]=y}else if(r.isHemisphereLight){var y=ui.get(r);y.direction.setFromMatrixPosition(r.matrixWorld),y.direction.transformDirection(p),y.direction.normalize(),y.skyColor.copy(r.color).multiplyScalar(a),y.groundColor.copy(r.groundColor).multiplyScalar(a),Ye.hemi[v++]=y}Ye.ambient[0]=c,Ye.ambient[1]=u,Ye.ambient[2]=d,Ye.directional.length=f,Ye.spot.length=g,Ye.point.length=m,Ye.hemi.length=v,Ye.hash=f+","+m+","+g+","+v+","+Ye.shadows.length}function F(){var t=we;return t>=Qe.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Qe.maxTextures),we+=1,t}function N(t){var e;if(t===Pa)return Xe.REPEAT;if(t===La)return Xe.CLAMP_TO_EDGE;if(t===ka)return Xe.MIRRORED_REPEAT;if(t===Ra)return Xe.NEAREST;if(t===Da)return Xe.NEAREST_MIPMAP_NEAREST;if(t===za)return Xe.NEAREST_MIPMAP_LINEAR;if(t===Oa)return Xe.LINEAR;if(t===Fa)return Xe.LINEAR_MIPMAP_NEAREST;if(t===Na)return Xe.LINEAR_MIPMAP_LINEAR;if(t===Ua)return Xe.UNSIGNED_BYTE;if(t===qa)return Xe.UNSIGNED_SHORT_4_4_4_4;if(t===$a)return Xe.UNSIGNED_SHORT_5_5_5_1;if(t===Za)return Xe.UNSIGNED_SHORT_5_6_5;if(t===Ha)return Xe.BYTE;if(t===Ga)return Xe.SHORT;if(t===ja)return Xe.UNSIGNED_SHORT;if(t===Wa)return Xe.INT;if(t===Ya)return Xe.UNSIGNED_INT;if(t===Va)return Xe.FLOAT;if(t===Xa&&(e=Ze.get("OES_texture_half_float"),null!==e))return e.HALF_FLOAT_OES;if(t===Ka)return Xe.ALPHA;if(t===Ja)return Xe.RGB;if(t===ts)return Xe.RGBA;if(t===es)return Xe.LUMINANCE;if(t===is)return Xe.LUMINANCE_ALPHA;if(t===rs)return Xe.DEPTH_COMPONENT;if(t===os)return Xe.DEPTH_STENCIL;if(t===Go)return Xe.FUNC_ADD;if(t===jo)return Xe.FUNC_SUBTRACT;if(t===Wo)return Xe.FUNC_REVERSE_SUBTRACT;if(t===Xo)return Xe.ZERO;if(t===qo)return Xe.ONE;if(t===$o)return Xe.SRC_COLOR;if(t===Zo)return Xe.ONE_MINUS_SRC_COLOR;if(t===Qo)return Xe.SRC_ALPHA;if(t===Ko)return Xe.ONE_MINUS_SRC_ALPHA;if(t===Jo)return Xe.DST_ALPHA;if(t===ta)return Xe.ONE_MINUS_DST_ALPHA;if(t===ea)return Xe.DST_COLOR;if(t===ia)return Xe.ONE_MINUS_DST_COLOR;if(t===na)return Xe.SRC_ALPHA_SATURATE;if((t===as||t===ss||t===ls||t===cs)&&(e=Ze.get("WEBGL_compressed_texture_s3tc"),null!==e)){if(t===as)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===ss)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===ls)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===cs)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===hs||t===us||t===ds||t===ps)&&(e=Ze.get("WEBGL_compressed_texture_pvrtc"),null!==e)){if(t===hs)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===us)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ds)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===ps)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===fs&&(e=Ze.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;if((t===Yo||t===Vo)&&(e=Ze.get("EXT_blend_minmax"),null!==e)){if(t===Yo)return e.MIN_EXT;if(t===Vo)return e.MAX_EXT}return t===Qa&&(e=Ze.get("WEBGL_depth_texture"),null!==e)?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",go),t=t||{};var B=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),U=void 0!==t.context?t.context:null,H=void 0!==t.alpha?t.alpha:!1,G=void 0!==t.depth?t.depth:!0,j=void 0!==t.stencil?t.stencil:!0,W=void 0!==t.antialias?t.antialias:!1,X=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,Z=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,Q=[],J=[],te=-1,ie=[],ne=-1,ae=new Float32Array(8),se=[],le=[];this.domElement=B,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ga,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var ce=this,he=null,ue=null,de=null,pe=-1,me="",ge=null,ve=new o,ye=null,_e=new o,we=0,xe=new V(0),be=0,Me=B.width,Te=B.height,Ee=1,Se=new o(0,0,Me,Te),Ce=!1,Ae=new o(0,0,Me,Te),Re=new re,Be=new si,Ue=!1,He=!1,Ge=new ee,je=new h,We=new c,Ye={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Ve={calls:0,vertices:0,faces:0,points:0};this.info={render:Ve,memory:{geometries:0,textures:0},programs:null};var Xe;try{var qe={alpha:H,depth:G,stencil:j,antialias:W,premultipliedAlpha:X,preserveDrawingBuffer:Z};if(Xe=U||B.getContext("webgl",qe)||B.getContext("experimental-webgl",qe),null===Xe)throw null!==B.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Xe.getShaderPrecisionFormat&&(Xe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),B.addEventListener("webglcontextlost",a,!1)}catch($e){console.error("THREE.WebGLRenderer: "+$e)}var Ze=new ai(Xe);Ze.get("WEBGL_depth_texture"),Ze.get("OES_texture_float"),Ze.get("OES_texture_float_linear"),Ze.get("OES_texture_half_float"),Ze.get("OES_texture_half_float_linear"),Ze.get("OES_standard_derivatives"),Ze.get("ANGLE_instanced_arrays"),Ze.get("OES_element_index_uint")&&(Pe.MaxIndex=4294967296);var Qe=new oi(Xe,Ze,t),Ke=new ri(Xe,Ze,N),ti=new ni,li=new ii(Xe,Ze,Ke,ti,Qe,N,this.info),ci=new ei(Xe,ti,this.info),hi=new Je(this,Qe),ui=new Ne;this.info.programs=hi.programs;var di=new Fe(Xe,Ze,Ve),pi=new Oe(Xe,Ze,Ve),fi=new ze(-1,1,1,-1,0,1),mi=new De,gi=new Le(new Ie(2,2),new fe({depthTest:!1,depthWrite:!1,fog:!1})),vi=Yc.cube,yi=new Le(new ke(5,5,5),new K({uniforms:vi.uniforms,vertexShader:vi.vertexShader,fragmentShader:vi.fragmentShader,side:Ao,depthTest:!1,depthWrite:!1,fog:!1}));n(),this.context=Xe,this.capabilities=Qe,this.extensions=Ze,this.properties=ti,this.state=Ke;var _i=new oe(this,Ye,ci,Qe);this.shadowMap=_i;var wi=new $(this,se),xi=new q(this,le);this.getContext=function(){return Xe},this.getContextAttributes=function(){return Xe.getContextAttributes()},this.forceContextLoss=function(){Ze.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return Qe.getMaxAnisotropy()},this.getPrecision=function(){return Qe.precision},this.getPixelRatio=function(){return Ee},this.setPixelRatio=function(t){void 0!==t&&(Ee=t,this.setSize(Ae.z,Ae.w,!1))},this.getSize=function(){return{width:Me,height:Te}},this.setSize=function(t,e,i){Me=t,Te=e,B.width=t*Ee,B.height=e*Ee,i!==!1&&(B.style.width=t+"px",B.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,n){Ke.viewport(Ae.set(t,e,i,n))},this.setScissor=function(t,e,i,n){Ke.scissor(Se.set(t,e,i,n))},this.setScissorTest=function(t){Ke.setScissorTest(Ce=t)},this.getClearColor=function(){return xe},this.setClearColor=function(t,e){xe.set(t),be=void 0!==e?e:1,i(xe.r,xe.g,xe.b,be)},this.getClearAlpha=function(){return be},this.setClearAlpha=function(t){be=t,i(xe.r,xe.g,xe.b,be)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=Xe.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=Xe.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Xe.STENCIL_BUFFER_BIT),Xe.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.resetGLState=r,this.dispose=function(){ie=[],ne=-1,J=[],te=-1,B.removeEventListener("webglcontextlost",a,!1)},this.renderBufferImmediate=function(t,e,i){Ke.initAttributes();var n=ti.get(t);t.hasPositions&&!n.position&&(n.position=Xe.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=Xe.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=Xe.createBuffer()),t.hasColors&&!n.color&&(n.color=Xe.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(Xe.bindBuffer(Xe.ARRAY_BUFFER,n.position),Xe.bufferData(Xe.ARRAY_BUFFER,t.positionArray,Xe.DYNAMIC_DRAW),Ke.enableAttribute(r.position),Xe.vertexAttribPointer(r.position,3,Xe.FLOAT,!1,0,0)),t.hasNormals){if(Xe.bindBuffer(Xe.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&i.shading===Lo)for(var o=0,a=3*t.count;a>o;o+=9){var s=t.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,h=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=c,s[o+2]=h,s[o+3]=l,s[o+4]=c,s[o+5]=h,s[o+6]=l,s[o+7]=c,s[o+8]=h}Xe.bufferData(Xe.ARRAY_BUFFER,t.normalArray,Xe.DYNAMIC_DRAW),Ke.enableAttribute(r.normal),Xe.vertexAttribPointer(r.normal,3,Xe.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Xe.bindBuffer(Xe.ARRAY_BUFFER,n.uv),Xe.bufferData(Xe.ARRAY_BUFFER,t.uvArray,Xe.DYNAMIC_DRAW),Ke.enableAttribute(r.uv),Xe.vertexAttribPointer(r.uv,2,Xe.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==Io&&(Xe.bindBuffer(Xe.ARRAY_BUFFER,n.color),Xe.bufferData(Xe.ARRAY_BUFFER,t.colorArray,Xe.DYNAMIC_DRAW),Ke.enableAttribute(r.color),Xe.vertexAttribPointer(r.color,3,Xe.FLOAT,!1,0,0)),Ke.disableUnusedAttributes(),Xe.drawArrays(Xe.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,i,n,r,o,a){M(r);var s=T(t,i,r,o),l=!1,c=n.id+"_"+s.id+"_"+r.wireframe;c!==me&&(me=c,l=!0);var h=o.morphTargetInfluences;if(void 0!==h){for(var u=[],f=0,m=h.length;m>f;f++){var g=h[f];u.push([g,f])}u.sort(p),u.length>8&&(u.length=8);for(var v=n.morphAttributes,f=0,m=u.length;m>f;f++){var g=u[f];if(ae[f]=g[0],0!==g[0]){var y=g[1];r.morphTargets===!0&&v.position&&n.addAttribute("morphTarget"+f,v.position[y]),r.morphNormals===!0&&v.normal&&n.addAttribute("morphNormal"+f,v.normal[y])}else r.morphTargets===!0&&n.removeAttribute("morphTarget"+f),r.morphNormals===!0&&n.removeAttribute("morphNormal"+f)}for(var f=u.length,_=ae.length;_>f;f++)ae[f]=0;s.getUniforms().setValue(Xe,"morphTargetInfluences",ae),l=!0}var y=n.index,w=n.attributes.position,x=1;r.wireframe===!0&&(y=ci.getWireframeAttribute(n),x=2);var b;null!==y?(b=pi,b.setIndex(y)):b=di,l&&(d(r,s,n),null!==y&&Xe.bindBuffer(Xe.ELEMENT_ARRAY_BUFFER,ci.getAttributeBuffer(y)));var E=0;null!==y?E=y.count:void 0!==w&&(E=w.count);var S=n.drawRange.start*x,C=n.drawRange.count*x,A=null!==a?a.start*x:0,P=null!==a?a.count*x:1/0,L=Math.max(S,A),k=Math.min(E,S+C,A+P)-1,I=Math.max(0,k-L+1);if(0!==I){if(o.isMesh)if(r.wireframe===!0)Ke.setLineWidth(r.wireframeLinewidth*e()),b.setMode(Xe.LINES);else switch(o.drawMode){case Ts:b.setMode(Xe.TRIANGLES);break;case Es:b.setMode(Xe.TRIANGLE_STRIP);break;case Ss:b.setMode(Xe.TRIANGLE_FAN)}else if(o.isLine){var R=r.linewidth;void 0===R&&(R=1),Ke.setLineWidth(R*e()),b.setMode(o.isLineSegments?Xe.LINES:Xe.LINE_STRIP)}else o.isPoints&&b.setMode(Xe.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&b.renderInstances(n,L,I):b.render(L,I)}},this.render=function(t,e,n,r){if(void 0!==e&&e.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");me="",pe=-1,ge=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),je.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Re.setFromMatrix(je),Q.length=0,te=-1,ne=-1,se.length=0,le.length=0,He=this.localClippingEnabled,Ue=Be.init(this.clippingPlanes,He,e),w(t,e),J.length=te+1,ie.length=ne+1,ce.sortObjects===!0&&(J.sort(f),ie.sort(m)),Ue&&Be.beginShadows(),z(Q),_i.render(t,e),O(Q,e),Ue&&Be.endShadows(),Ve.calls=0,Ve.vertices=0,Ve.faces=0,Ve.points=0,void 0===n&&(n=null),this.setRenderTarget(n);var o=t.background;if(null===o?i(xe.r,xe.g,xe.b,be):o&&o.isColor&&(i(o.r,o.g,o.b,1),r=!0),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),o&&o.isCubeTexture?(mi.projectionMatrix.copy(e.projectionMatrix),mi.matrixWorld.extractRotation(e.matrixWorld),mi.matrixWorldInverse.getInverse(mi.matrixWorld),yi.material.uniforms.tCube.value=o,yi.modelViewMatrix.multiplyMatrices(mi.matrixWorldInverse,yi.matrixWorld),ci.update(yi),ce.renderBufferDirect(mi,null,yi.geometry,yi.material,yi,null)):o&&o.isTexture&&(gi.material.map=o,ci.update(gi),ce.renderBufferDirect(fi,null,gi.geometry,gi.material,gi,null)),t.overrideMaterial){var a=t.overrideMaterial;x(J,t,e,a),x(ie,t,e,a)}else Ke.setBlending(zo),x(J,t,e),x(ie,t,e);wi.render(t,e),xi.render(t,e,_e),n&&li.updateRenderTargetMipmap(n),Ke.setDepthTest(!0),Ke.setDepthWrite(!0),Ke.setColorWrite(!0)},this.setFaceCulling=function(t,e){Ke.setCullFace(t),Ke.setFlipSided(e===bo)},this.allocTextureUnit=F,this.setTexture2D=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),li.setTexture2D(e,i)}}(),this.setTexture=function(){var t=!1;return function(e,i){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),li.setTexture2D(e,i)}}(),this.setTextureCube=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?li.setTextureCube(e,i):li.setTextureCubeDynamic(e,i)}}(),this.getCurrentRenderTarget=function(){return ue},this.setRenderTarget=function(t){ue=t,t&&void 0===ti.get(t).__webglFramebuffer&&li.setupRenderTarget(t);var e,i=t&&t.isWebGLRenderTargetCube;if(t){var n=ti.get(t);e=i?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,ve.copy(t.scissor),ye=t.scissorTest,_e.copy(t.viewport)}else e=null,ve.copy(Se).multiplyScalar(Ee),ye=Ce,_e.copy(Ae).multiplyScalar(Ee);if(de!==e&&(Xe.bindFramebuffer(Xe.FRAMEBUFFER,e),de=e),Ke.scissor(ve),Ke.setScissorTest(ye),Ke.viewport(_e),i){var r=ti.get(t.texture);Xe.framebufferTexture2D(Xe.FRAMEBUFFER,Xe.COLOR_ATTACHMENT0,Xe.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,n,r,o){if((t&&t.isWebGLRenderTarget)===!1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var a=ti.get(t).__webglFramebuffer;if(a){var s=!1;a!==de&&(Xe.bindFramebuffer(Xe.FRAMEBUFFER,a),s=!0);try{var l=t.texture,c=l.format,h=l.type;if(c!==ts&&N(c)!==Xe.getParameter(Xe.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===Ua||N(h)===Xe.getParameter(Xe.IMPLEMENTATION_COLOR_READ_TYPE)||h===Va&&(Ze.get("OES_texture_float")||Ze.get("WEBGL_color_buffer_float"))||h===Xa&&Ze.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Xe.checkFramebufferStatus(Xe.FRAMEBUFFER)===Xe.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&Xe.readPixels(e,i,n,r,N(c),N(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Xe.bindFramebuffer(Xe.FRAMEBUFFER,de)}}}}function ci(t,e){this.name="",this.color=new V(t),this.density=void 0!==e?e:25e-5}function hi(t,e,i){this.name="",this.color=new V(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function ui(){ce.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function di(t,e,i,n,r){ce.call(this),this.lensFlares=[],this.positionScreen=new c,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)}function pi(t){Z.call(this),this.type="SpriteMaterial",this.color=new V(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function fi(t){ce.call(this),this.type="Sprite",this.material=void 0!==t?t:new pi}function mi(){ce.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function gi(t,e,i,r,o,a,s,l,c,h,u,d){n.call(this,null,a,s,l,c,h,r,o,u,d),this.image={data:t,width:e,height:i},this.magFilter=void 0!==c?c:Ra,this.minFilter=void 0!==h?h:Ra,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function vi(t,e,i){if(this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new h,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var n=Math.sqrt(4*this.bones.length);n=Fs.nextPowerOfTwo(Math.ceil(n)),n=Math.max(n,4),this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new gi(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,ts,Va)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,o=this.bones.length;o>r;r++)this.boneInverses.push(new h)}}function yi(t){ce.call(this),this.type="Bone",this.skin=t}function _i(t,e,i){Le.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new h,this.bindMatrixInverse=new h;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,o,a=0,s=this.geometry.bones.length;s>a;++a)o=this.geometry.bones[a],r=new yi(this),n.push(r),r.name=o.name,r.position.fromArray(o.pos),r.quaternion.fromArray(o.rotq),void 0!==o.scl&&r.scale.fromArray(o.scl);for(var a=0,s=this.geometry.bones.length;s>a;++a)o=this.geometry.bones[a],-1!==o.parent&&null!==o.parent&&void 0!==n[o.parent]?n[o.parent].add(n[a]):this.add(n[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new vi(n,void 0,i),this.matrixWorld)}function wi(t){Z.call(this),this.type="LineBasicMaterial",this.color=new V(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function xi(t,e,i){return 1===i?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new bi(t,e)):(ce.call(this),this.type="Line",this.geometry=void 0!==t?t:new Pe,void(this.material=void 0!==e?e:new wi({color:16777215*Math.random()})))}function bi(t,e){xi.call(this,t,e),this.type="LineSegments"}function Mi(t){Z.call(this),this.type="PointsMaterial",this.color=new V(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Ti(t,e){ce.call(this),this.type="Points",this.geometry=void 0!==t?t:new Pe,this.material=void 0!==e?e:new Mi({color:16777215*Math.random()})}function Ei(){ce.call(this),this.type="Group"}function Si(t,e,i,r,o,a,s,l,c){function h(){requestAnimationFrame(h),t.readyState>=t.HAVE_CURRENT_DATA&&(u.needsUpdate=!0)}n.call(this,t,e,i,r,o,a,s,l,c),this.generateMipmaps=!1;var u=this;h()}function Ci(t,e,i,r,o,a,s,l,c,h,u,d){n.call(this,null,a,s,l,c,h,r,o,u,d),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Ai(t,e,i,r,o,a,s,l,c){n.call(this,t,e,i,r,o,a,s,l,c),this.needsUpdate=!0}function Pi(t,e,i,r,o,a,s,l,c,h){if(h=void 0!==h?h:rs,h!==rs&&h!==os)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n.call(this,null,r,o,a,s,l,h,i,c),this.image={width:t,height:e},this.type=void 0!==i?i:ja,this.magFilter=void 0!==s?s:Ra,this.minFilter=void 0!==l?l:Ra,this.flipY=!1,this.generateMipmaps=!1}function Li(t){function e(t,e){return t-e}Pe.call(this);var i=[0,0],n={},r=["a","b","c"];if(t&&t.isGeometry){for(var o=t.vertices,a=t.faces,s=0,l=new Uint32Array(6*a.length),c=0,h=a.length;h>c;c++)for(var u=a[c],d=0;3>d;d++){i[0]=u[r[d]],i[1]=u[r[(d+1)%3]],i.sort(e);var p=i.toString();void 0===n[p]&&(l[2*s]=i[0],l[2*s+1]=i[1],n[p]=!0,s++)}for(var f=new Float32Array(2*s*3),c=0,h=s;h>c;c++)for(var d=0;2>d;d++){var m=o[l[2*c+d]],g=6*c+3*d;f[g+0]=m.x,f[g+1]=m.y,f[g+2]=m.z}this.addAttribute("position",new me(f,3))}else if(t&&t.isBufferGeometry)if(null!==t.index){var v=t.index.array,o=t.attributes.position,y=t.groups,s=0;0===y.length&&t.addGroup(0,v.length);for(var l=new Uint32Array(2*v.length),_=0,w=y.length;w>_;++_)for(var x=y[_],b=x.start,M=x.count,c=b,T=b+M;T>c;c+=3)for(var d=0;3>d;d++){i[0]=v[c+d],i[1]=v[c+(d+1)%3],i.sort(e);var p=i.toString();void 0===n[p]&&(l[2*s]=i[0],l[2*s+1]=i[1],n[p]=!0,s++)}for(var f=new Float32Array(2*s*3),c=0,h=s;h>c;c++)for(var d=0;2>d;d++){var g=6*c+3*d,E=l[2*c+d];f[g+0]=o.getX(E),f[g+1]=o.getY(E),f[g+2]=o.getZ(E)}this.addAttribute("position",new me(f,3))}else{for(var o=t.attributes.position.array,s=o.length/3,S=s/3,f=new Float32Array(2*s*3),c=0,h=S;h>c;c++)for(var d=0;3>d;d++){var g=18*c+6*d,C=9*c+3*d;f[g+0]=o[C],f[g+1]=o[C+1],f[g+2]=o[C+2];var E=9*c+3*((d+1)%3);f[g+3]=o[E],f[g+4]=o[E+1],f[g+5]=o[E+2]}this.addAttribute("position",new me(f,3))}}function ki(t,e,i){Pe.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,o,a,s,l=[],c=[],h=e+1;for(n=0;i>=n;n++)for(s=n/i,r=0;e>=r;r++)a=r/e,o=t(a,s),l.push(o.x,o.y,o.z),c.push(a,s);var u,d,p,f,m=[];for(n=0;i>n;n++)for(r=0;e>r;r++)u=n*h+r,d=n*h+r+1,p=(n+1)*h+r+1,f=(n+1)*h+r,m.push(u,d,f),m.push(d,p,f);this.setIndex((m.length>65535?be:we)(m,1)),this.addAttribute("position",Me(l,3)),this.addAttribute("uv",Me(c,2)),this.computeVertexNormals()}function Ii(t,e,i){Se.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new ki(t,e,i)),this.mergeVertices()}function Ri(t,e,n,r){function o(t){for(var i=new c,n=new c,r=new c,o=0;o<e.length;o+=3)d(e[o+0],i),d(e[o+1],n),d(e[o+2],r),a(i,n,r,t)}function a(t,e,i,n){var r,o,a=Math.pow(2,n),s=[];for(r=0;a>=r;r++){s[r]=[];var l=t.clone().lerp(i,r/a),c=e.clone().lerp(i,r/a),h=a-r;for(o=0;h>=o;o++)s[r][o]=0===o&&r===a?l:l.clone().lerp(c,o/h)}for(r=0;a>r;r++)for(o=0;2*(a-r)-1>o;o++){var d=Math.floor(o/2);o%2===0?(u(s[r][d+1]),u(s[r+1][d]),u(s[r][d])):(u(s[r][d+1]),u(s[r+1][d+1]),u(s[r+1][d]))}}function s(t){for(var e=new c,i=0;i<v.length;i+=3)e.x=v[i+0],e.y=v[i+1],e.z=v[i+2],e.normalize().multiplyScalar(t),v[i+0]=e.x,v[i+1]=e.y,v[i+2]=e.z}function l(){for(var t=new c,e=0;e<v.length;e+=3){t.x=v[e+0],t.y=v[e+1],t.z=v[e+2];var i=m(t)/2/Math.PI+.5,n=g(t)/Math.PI+.5;y.push(i,1-n)}p(),h()}function h(){for(var t=0;t<y.length;t+=6){var e=y[t+0],i=y[t+2],n=y[t+4],r=Math.max(e,i,n),o=Math.min(e,i,n);r>.9&&.1>o&&(.2>e&&(y[t+0]+=1),.2>i&&(y[t+2]+=1),.2>n&&(y[t+4]+=1))}}function u(t){v.push(t.x,t.y,t.z)}function d(e,i){var n=3*e;i.x=t[n+0],i.y=t[n+1],i.z=t[n+2]}function p(){for(var t=new c,e=new c,n=new c,r=new c,o=new i,a=new i,s=new i,l=0,h=0;l<v.length;l+=9,h+=6){t.set(v[l+0],v[l+1],v[l+2]),e.set(v[l+3],v[l+4],v[l+5]),n.set(v[l+6],v[l+7],v[l+8]),o.set(y[h+0],y[h+1]),a.set(y[h+2],y[h+3]),s.set(y[h+4],y[h+5]),r.copy(t).add(e).add(n).divideScalar(3);var u=m(r);f(o,h+0,t,u),f(a,h+2,e,u),f(s,h+4,n,u)}}function f(t,e,i,n){0>n&&1===t.x&&(y[e]=t.x-1),0===i.x&&0===i.z&&(y[e]=n/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function g(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}Pe.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1,r=r||0;var v=[],y=[];o(r),s(n),l(),this.addAttribute("position",Me(v,3)),this.addAttribute("normal",Me(v.slice(),3)),this.addAttribute("uv",Me(y,2)),this.normalizeNormals(),this.boundingSphere=new ee(new c,n)}function Di(t,e){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];Ri.call(this,i,n,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function zi(t,e){Se.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Di(t,e)),this.mergeVertices()}function Oi(t,e){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Ri.call(this,i,n,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Fi(t,e){Se.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Oi(t,e)),this.mergeVertices()}function Ni(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Ri.call(this,n,r,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Bi(t,e){Se.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ni(t,e)),this.mergeVertices()}function Ui(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Ri.call(this,r,o,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Hi(t,e){Se.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ui(t,e)),this.mergeVertices()}function Gi(t,e,i,n){Se.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new Ri(t,e,i,n)),this.mergeVertices()}function ji(t,e,n,r,o){function a(){for(d=0;e>d;d++)s(d);s(o===!1?e:0),h(),l()}function s(i){var o=t.getPointAt(i/e),a=u.normals[i],s=u.binormals[i];for(p=0;r>=p;p++){var l=p/r*Math.PI*2,c=Math.sin(l),h=-Math.cos(l);m.x=h*a.x+c*s.x,m.y=h*a.y+c*s.y,m.z=h*a.z+c*s.z,m.normalize(),y.push(m.x,m.y,m.z),f.x=o.x+n*m.x,f.y=o.y+n*m.y,f.z=o.z+n*m.z,v.push(f.x,f.y,f.z)}}function l(){for(p=1;e>=p;p++)for(d=1;r>=d;d++){var t=(r+1)*(p-1)+(d-1),i=(r+1)*p+(d-1),n=(r+1)*p+d,o=(r+1)*(p-1)+d;w.push(t,i,o),w.push(i,n,o)}}function h(){for(d=0;e>=d;d++)for(p=0;r>=p;p++)g.x=d/e,g.y=p/r,_.push(g.x,g.y)}Pe.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:o},e=e||64,n=n||1,r=r||8,o=o||!1;var u=t.computeFrenetFrames(e,o);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;var d,p,f=new c,m=new c,g=new i,v=[],y=[],_=[],w=[];a(),this.setIndex((w.length>65535?be:we)(w,1)),this.addAttribute("position",Me(v,3)),this.addAttribute("normal",Me(y,3)),this.addAttribute("uv",Me(_,2))}function Wi(t,e,i,n,r,o){Se.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new ji(t,e,i,n,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Yi(t,e,n,r,o,a){function s(t,e,i,n,r){var o=Math.cos(t),a=Math.sin(t),s=i/e*t,l=Math.cos(s);r.x=n*(2+l)*.5*o,r.y=n*(2+l)*a*.5,r.z=n*Math.sin(s)*.5}Pe.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:o,q:a},t=t||100,e=e||40,n=Math.floor(n)||64,r=Math.floor(r)||8,o=o||2,a=a||3;var l,h,u=(r+1)*(n+1),d=r*n*2*3,p=new me(new(d>65535?Uint32Array:Uint16Array)(d),1),f=new me(new Float32Array(3*u),3),m=new me(new Float32Array(3*u),3),g=new me(new Float32Array(2*u),2),v=0,y=0,_=new c,w=new c,x=new i,b=new c,M=new c,T=new c,E=new c,S=new c;for(l=0;n>=l;++l){var C=l/n*o*Math.PI*2;for(s(C,o,a,t,b),s(C+.01,o,a,t,M),E.subVectors(M,b),S.addVectors(M,b),T.crossVectors(E,S),S.crossVectors(T,E),T.normalize(),S.normalize(),h=0;r>=h;++h){var A=h/r*Math.PI*2,P=-e*Math.cos(A),L=e*Math.sin(A);_.x=b.x+(P*S.x+L*T.x),_.y=b.y+(P*S.y+L*T.y),_.z=b.z+(P*S.z+L*T.z),f.setXYZ(v,_.x,_.y,_.z),w.subVectors(_,b).normalize(),m.setXYZ(v,w.x,w.y,w.z),x.x=l/n,x.y=h/r,g.setXY(v,x.x,x.y),v++}}for(h=1;n>=h;h++)for(l=1;r>=l;l++){var k=(r+1)*(h-1)+(l-1),I=(r+1)*h+(l-1),R=(r+1)*h+l,D=(r+1)*(h-1)+l;p.setX(y,k),y++,p.setX(y,I),y++,p.setX(y,D),y++,p.setX(y,I),y++,p.setX(y,R),y++,p.setX(y,D),y++}this.setIndex(p),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function Vi(t,e,i,n,r,o,a){Se.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Yi(t,e,i,n,r,o)),this.mergeVertices()}function Xi(t,e,i,n,r){Pe.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||100,e=e||40,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var o,a,s=(i+1)*(n+1),l=i*n*2*3,h=new(l>65535?Uint32Array:Uint16Array)(l),u=new Float32Array(3*s),d=new Float32Array(3*s),p=new Float32Array(2*s),f=0,m=0,g=0,v=new c,y=new c,_=new c;for(o=0;i>=o;o++)for(a=0;n>=a;a++){var w=a/n*r,x=o/i*Math.PI*2;y.x=(t+e*Math.cos(x))*Math.cos(w),y.y=(t+e*Math.cos(x))*Math.sin(w),y.z=e*Math.sin(x),u[f]=y.x,u[f+1]=y.y,u[f+2]=y.z,v.x=t*Math.cos(w),v.y=t*Math.sin(w),_.subVectors(y,v).normalize(),d[f]=_.x,d[f+1]=_.y,d[f+2]=_.z,p[m]=a/n,p[m+1]=o/i,f+=3,m+=2}for(o=1;i>=o;o++)for(a=1;n>=a;a++){var b=(n+1)*o+a-1,M=(n+1)*(o-1)+a-1,T=(n+1)*(o-1)+a,E=(n+1)*o+a;h[g]=b,h[g+1]=M,h[g+2]=E,h[g+3]=M,h[g+4]=T,h[g+5]=E,g+=6}this.setIndex(new me(h,1)),this.addAttribute("position",new me(u,3)),this.addAttribute("normal",new me(d,3)),this.addAttribute("uv",new me(p,2))}function qi(t,e,i,n,r){Se.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Xi(t,e,i,n,r))}function $i(t,e){return"undefined"==typeof t?void(t=[]):(Se.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())}function Zi(t,e){e=e||{};var i=e.font;if((i&&i.isFont)===!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Se;var n=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),$i.call(this,n,e),this.type="TextGeometry"}function Qi(t,e,i,n,r,o,a){Pe.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s=o+a,l=(e+1)*(i+1),h=new me(new Float32Array(3*l),3),u=new me(new Float32Array(3*l),3),d=new me(new Float32Array(2*l),2),p=0,f=[],m=new c,g=0;i>=g;g++){for(var v=[],y=g/i,_=0;e>=_;_++){var w=_/e,x=-t*Math.cos(n+w*r)*Math.sin(o+y*a),b=t*Math.cos(o+y*a),M=t*Math.sin(n+w*r)*Math.sin(o+y*a);
m.set(x,b,M).normalize(),h.setXYZ(p,x,b,M),u.setXYZ(p,m.x,m.y,m.z),d.setXY(p,w,1-y),v.push(p),p++}f.push(v)}for(var T=[],g=0;i>g;g++)for(var _=0;e>_;_++){var E=f[g][_+1],S=f[g][_],C=f[g+1][_],A=f[g+1][_+1];(0!==g||o>0)&&T.push(E,S,A),(g!==i-1||s<Math.PI)&&T.push(S,C,A)}this.setIndex(new(h.count>65535?be:we)(T,1)),this.addAttribute("position",h),this.addAttribute("normal",u),this.addAttribute("uv",d),this.boundingSphere=new ee(new c,t)}function Ki(t,e,i,n,r,o,a){Se.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Qi(t,e,i,n,r,o,a))}function Ji(t,e,n,r,o,a){Pe.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:a},t=t||20,e=e||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?Math.max(1,r):1;var s,l,h,u=(n+1)*(r+1),d=n*r*2*3,p=new me(new(d>65535?Uint32Array:Uint16Array)(d),1),f=new me(new Float32Array(3*u),3),m=new me(new Float32Array(3*u),3),g=new me(new Float32Array(2*u),2),v=0,y=0,_=t,w=(e-t)/r,x=new c,b=new i;for(l=0;r>=l;l++){for(h=0;n>=h;h++)s=o+h/n*a,x.x=_*Math.cos(s),x.y=_*Math.sin(s),f.setXYZ(v,x.x,x.y,x.z),m.setXYZ(v,0,0,1),b.x=(x.x/e+1)/2,b.y=(x.y/e+1)/2,g.setXY(v,b.x,b.y),v++;_+=w}for(l=0;r>l;l++){var M=l*(n+1);for(h=0;n>h;h++){s=h+M;var T=s,E=s+n+1,S=s+n+2,C=s+1;p.setX(y,T),y++,p.setX(y,E),y++,p.setX(y,S),y++,p.setX(y,T),y++,p.setX(y,S),y++,p.setX(y,C),y++}}this.setIndex(p),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function tn(t,e,i,n,r,o){Se.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Ji(t,e,i,n,r,o))}function en(t,e,i,n){Se.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Ie(t,e,i,n))}function nn(t,e,n,r){Pe.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Fs.clamp(r,0,2*Math.PI);var o,a,s,l=(e+1)*t.length,h=e*t.length*2*3,u=new me(new(h>65535?Uint32Array:Uint16Array)(h),1),d=new me(new Float32Array(3*l),3),p=new me(new Float32Array(2*l),2),f=0,m=0,g=1/e,v=new c,y=new i;for(a=0;e>=a;a++){var _=n+a*g*r,w=Math.sin(_),x=Math.cos(_);for(s=0;s<=t.length-1;s++)v.x=t[s].x*w,v.y=t[s].y,v.z=t[s].x*x,d.setXYZ(f,v.x,v.y,v.z),y.x=a/e,y.y=s/(t.length-1),p.setXY(f,y.x,y.y),f++}for(a=0;e>a;a++)for(s=0;s<t.length-1;s++){o=s+a*t.length;var b=o,M=o+t.length,T=o+t.length+1,E=o+1;u.setX(m,b),m++,u.setX(m,M),m++,u.setX(m,E),m++,u.setX(m,M),m++,u.setX(m,T),m++,u.setX(m,E),m++}if(this.setIndex(u),this.addAttribute("position",d),this.addAttribute("uv",p),this.computeVertexNormals(),r===2*Math.PI){var S=this.attributes.normal.array,C=new c,A=new c,P=new c;for(o=e*t.length*3,a=0,s=0;a<t.length;a++,s+=3)C.x=S[s+0],C.y=S[s+1],C.z=S[s+2],A.x=S[o+s+0],A.y=S[o+s+1],A.z=S[o+s+2],P.addVectors(C,A).normalize(),S[s+0]=S[o+s+0]=P.x,S[s+1]=S[o+s+1]=P.y,S[s+2]=S[o+s+2]=P.z}}function rn(t,e,i,n){Se.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new nn(t,e,i,n)),this.mergeVertices()}function on(t,e){Se.call(this),this.type="ShapeGeometry",Array.isArray(t)===!1&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()}function an(t,e){function i(t,e){return t-e}Pe.call(this),e=void 0!==e?e:1;var n,r=Math.cos(Fs.DEG2RAD*e),o=[0,0],a={},s=["a","b","c"];t&&t.isBufferGeometry?(n=new Se,n.fromBufferGeometry(t)):n=t.clone(),n.mergeVertices(),n.computeFaceNormals();for(var l=n.vertices,c=n.faces,h=0,u=c.length;u>h;h++)for(var d=c[h],p=0;3>p;p++){o[0]=d[s[p]],o[1]=d[s[(p+1)%3]],o.sort(i);var f=o.toString();void 0===a[f]?a[f]={vert1:o[0],vert2:o[1],face1:h,face2:void 0}:a[f].face2=h}var m=[];for(var f in a){var g=a[f];if(void 0===g.face2||c[g.face1].normal.dot(c[g.face2].normal)<=r){var v=l[g.vert1];m.push(v.x),m.push(v.y),m.push(v.z),v=l[g.vert2],m.push(v.x),m.push(v.y),m.push(v.z)}}this.addAttribute("position",new me(new Float32Array(m),3))}function sn(t,e,n,r,o,a,s,l){function h(){var t=(r+1)*(o+1);return a===!1&&(t+=(r+1)*m+r*m),t}function u(){var t=r*o*2*3;return a===!1&&(t+=r*m*3),t}function d(){var i,a,h=new c,u=new c,d=0,p=(e-t)/n;for(a=0;o>=a;a++){var m=[],g=a/o,v=g*(e-t)+t;for(i=0;r>=i;i++){var C=i/r,A=C*l+s,P=Math.sin(A),L=Math.cos(A);u.x=v*P,u.y=-g*n+E,u.z=v*L,_.setXYZ(b,u.x,u.y,u.z),h.set(P,p,L).normalize(),w.setXYZ(b,h.x,h.y,h.z),x.setXY(b,C,1-g),m.push(b),b++}T.push(m)}for(i=0;r>i;i++)for(a=0;o>a;a++){var k=T[a][i],I=T[a+1][i],R=T[a+1][i+1],D=T[a][i+1];y.setX(M,k),M++,y.setX(M,I),M++,y.setX(M,D),M++,y.setX(M,I),M++,y.setX(M,R),M++,y.setX(M,D),M++,d+=6}f.addGroup(S,d,0),S+=d}function p(n){var o,a,h,u=new i,d=new c,p=0,m=n===!0?t:e,g=n===!0?1:-1;for(a=b,o=1;r>=o;o++)_.setXYZ(b,0,E*g,0),w.setXYZ(b,0,g,0),u.x=.5,u.y=.5,x.setXY(b,u.x,u.y),b++;for(h=b,o=0;r>=o;o++){var v=o/r,T=v*l+s,C=Math.cos(T),A=Math.sin(T);d.x=m*A,d.y=E*g,d.z=m*C,_.setXYZ(b,d.x,d.y,d.z),w.setXYZ(b,0,g,0),u.x=.5*C+.5,u.y=.5*A*g+.5,x.setXY(b,u.x,u.y),b++}for(o=0;r>o;o++){var P=a+o,L=h+o;n===!0?(y.setX(M,L),M++,y.setX(M,L+1),M++,y.setX(M,P),M++):(y.setX(M,L+1),M++,y.setX(M,L),M++,y.setX(M,P),M++),p+=3}f.addGroup(S,p,n===!0?1:2),S+=p}Pe.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};var f=this;t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,r=Math.floor(r)||8,o=Math.floor(o)||1,a=void 0!==a?a:!1,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var m=0;a===!1&&(t>0&&m++,e>0&&m++);var g=h(),v=u(),y=new me(new(v>65535?Uint32Array:Uint16Array)(v),1),_=new me(new Float32Array(3*g),3),w=new me(new Float32Array(3*g),3),x=new me(new Float32Array(2*g),2),b=0,M=0,T=[],E=n/2,S=0;d(),a===!1&&(t>0&&p(!0),e>0&&p(!1)),this.setIndex(y),this.addAttribute("position",_),this.addAttribute("normal",w),this.addAttribute("uv",x)}function ln(t,e,i,n,r,o,a,s){Se.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new sn(t,e,i,n,r,o,a,s)),this.mergeVertices()}function cn(t,e,i,n,r,o,a){ln.call(this,0,t,e,i,n,r,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function hn(t,e,i,n,r,o,a){sn.call(this,0,t,e,i,n,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function un(t,e,i,n){Pe.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r=e+2,o=new Float32Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r);a[2]=1,s[0]=.5,s[1]=.5;for(var l=0,h=3,u=2;e>=l;l++,h+=3,u+=2){var d=i+l/e*n;o[h]=t*Math.cos(d),o[h+1]=t*Math.sin(d),a[h+2]=1,s[u]=(o[h]/t+1)/2,s[u+1]=(o[h+1]/t+1)/2}for(var p=[],h=1;e>=h;h++)p.push(h,h+1,0);this.setIndex(new me(new Uint16Array(p),1)),this.addAttribute("position",new me(o,3)),this.addAttribute("normal",new me(a,3)),this.addAttribute("uv",new me(s,2)),this.boundingSphere=new ee(new c,t)}function dn(t,e,i,n){Se.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new un(t,e,i,n))}function pn(t,e,i,n,r,o){Se.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new ke(t,e,i,n,r,o)),this.mergeVertices()}function fn(){K.call(this,{uniforms:Ws.merge([Wc.lights,{opacity:{value:1}}]),vertexShader:Gc.shadow_vert,fragmentShader:Gc.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function mn(t){K.call(this,t),this.type="RawShaderMaterial"}function gn(t){this.uuid=Fs.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0}function vn(t){Z.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new V(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function yn(t){vn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function _n(t){Z.call(this),this.type="MeshPhongMaterial",this.color=new V(16777215),this.specular=new V(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=da,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function wn(t){Z.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.morphTargets=!1,this.setValues(t)}function xn(t){Z.call(this),this.type="MeshLambertMaterial",this.color=new V(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=da,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function bn(t){Z.call(this),this.type="LineDashedMaterial",this.color=new V(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function Mn(t,e,i){var n=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,r===!1&&void 0!==n.onStart&&n.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)}}function Tn(t){this.manager=void 0!==t?t:th}function En(t){this.manager=void 0!==t?t:th,this._parser=null}function Sn(t){this.manager=void 0!==t?t:th,this._parser=null}function Cn(t){this.manager=void 0!==t?t:th}function An(t){this.manager=void 0!==t?t:th}function Pn(t){this.manager=void 0!==t?t:th}function Ln(t,e){ce.call(this),this.type="Light",this.color=new V(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function kn(t,e,i){Ln.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ce.DefaultUp),this.updateMatrix(),this.groundColor=new V(e)}function In(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new h}function Rn(){In.call(this,new De(50,1,.5,500))}function Dn(t,e,i,n,r,o){Ln.call(this,t,e),this.type="SpotLight",this.position.copy(ce.DefaultUp),this.updateMatrix(),this.target=new ce,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Rn}function zn(t,e,i,n){Ln.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new In(new De(90,1,.5,500))}function On(){In.call(this,new ze(-5,5,5,-5,.5,500))}function Fn(t,e){Ln.call(this,t,e),this.type="DirectionalLight",this.position.copy(ce.DefaultUp),this.updateMatrix(),this.target=new ce,this.shadow=new On}function Nn(t,e){Ln.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Bn(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function Un(t,e,i,n){Bn.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Hn(t,e,i,n){Bn.call(this,t,e,i,n)}function Gn(t,e,i,n){Bn.call(this,t,e,i,n)}function jn(t,e,i,n){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=ih.convertArray(e,this.TimeBufferType),this.values=ih.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Wn(t,e,i,n){jn.call(this,t,e,i,n)}function Yn(t,e,i,n){Bn.call(this,t,e,i,n)}function Vn(t,e,i,n){jn.call(this,t,e,i,n)}function Xn(t,e,i,n){jn.call(this,t,e,i,n)}function qn(t,e,i,n){jn.call(this,t,e,i,n)}function $n(t,e,i){jn.call(this,t,e,i)}function Zn(t,e,i,n){jn.call(this,t,e,i,n)}function Qn(){jn.apply(this,arguments)}function Kn(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=Fs.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Jn(t){this.manager=void 0!==t?t:th,this.textures={}}function tr(t){this.manager=void 0!==t?t:th}function er(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function ir(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:th,this.withCredentials=!1}function nr(t){this.manager=void 0!==t?t:th,this.texturePath=""}function rr(){}function or(t,e){this.v1=t,this.v2=e}function ar(){this.curves=[],this.autoClose=!1}function sr(t,e,i,n,r,o,a,s){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function lr(t){this.points=void 0===t?[]:t}function cr(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n}function hr(t,e,i){this.v0=t,this.v1=e,this.v2=i}function ur(){dr.apply(this,arguments),this.holes=[]}function dr(t){ar.call(this),this.currentPoint=new i,t&&this.fromPoints(t)}function pr(){this.subPaths=[],this.currentPath=null}function fr(t){this.data=t}function mr(t){this.manager=void 0!==t?t:th}function gr(){return void 0===ah&&(ah=new(window.AudioContext||window.webkitAudioContext)),ah}function vr(t){this.manager=void 0!==t?t:th}function yr(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new De,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new De,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function _r(t,e,i){ce.call(this),this.type="CubeCamera";var n=90,r=1,o=new De(n,r,t,e);o.up.set(0,-1,0),o.lookAt(new c(1,0,0)),this.add(o);var a=new De(n,r,t,e);a.up.set(0,-1,0),a.lookAt(new c(-1,0,0)),this.add(a);var l=new De(n,r,t,e);l.up.set(0,0,1),l.lookAt(new c(0,1,0)),this.add(l);var h=new De(n,r,t,e);h.up.set(0,0,-1),h.lookAt(new c(0,-1,0)),this.add(h);var u=new De(n,r,t,e);u.up.set(0,-1,0),u.lookAt(new c(0,0,1)),this.add(u);var d=new De(n,r,t,e);d.up.set(0,-1,0),d.lookAt(new c(0,0,-1)),this.add(d);var p={format:Ja,magFilter:Oa,minFilter:Oa};this.renderTarget=new s(i,i,p),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,n=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,o,i),i.activeCubeFace=1,t.render(e,a,i),i.activeCubeFace=2,t.render(e,l,i),i.activeCubeFace=3,t.render(e,h,i),i.activeCubeFace=4,t.render(e,u,i),i.texture.generateMipmaps=n,i.activeCubeFace=5,t.render(e,d,i),t.setRenderTarget(null)}}function wr(){ce.call(this),this.type="AudioListener",this.context=gr(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function xr(t){ce.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function br(t){xr.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Mr(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Tr(t,e,i){this.binding=t,this.valueSize=i;var n,r=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Er(t,e,i){this.path=e,this.parsedPath=i||Er.parseTrackName(e),this.node=Er.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Sr(){this.uuid=Fs.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Cr(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,r=n.length,o=new Array(r),a={endingStart:xs,endingEnd:xs},s=0;s!==r;++s){var l=n[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=gs,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Ar(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Pr(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Lr(){Pe.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function kr(t,e,i,n){this.uuid=Fs.generateUUID(),this.data=t,this.itemSize=e,this.offset=i,this.normalized=n===!0}function Ir(t,e){this.uuid=Fs.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Rr(t,e,i){Ir.call(this,t,e),this.meshPerAttribute=i||1}function Dr(t,e,i){me.call(this,t,e),this.meshPerAttribute=i||1}function zr(t,e,i,n){this.ray=new ae(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Or(t,e){return t.distance-e.distance}function Fr(t,e,i,n){if(t.visible!==!1&&(t.raycast(e,i),n===!0))for(var r=t.children,o=0,a=r.length;a>o;o++)Fr(r[o],e,i,!0)}function Nr(t){this.autoStart=void 0!==t?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Br(t){function e(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e}this.points=t;var i,n,r,o,a,s,l,h,u,d=[],p={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,n=Math.floor(i),r=i-n,d[0]=0===n?n:n-1,d[1]=n,d[2]=n>this.points.length-2?this.points.length-1:n+1,d[3]=n>this.points.length-3?this.points.length-1:n+2,s=this.points[d[0]],l=this.points[d[1]],h=this.points[d[2]],u=this.points[d[3]],o=r*r,a=r*o,p.x=e(s.x,l.x,h.x,u.x,r,o,a),p.y=e(s.y,l.y,h.y,u.y,r,o,a),p.z=e(s.z,l.z,h.z,u.z,r,o,a),p},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;i>t;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,r,o=0,a=0,s=0,l=new c,h=new c,u=[],d=0;for(u[0]=0,t||(t=100),n=this.points.length*t,l.copy(this.points[0]),e=1;n>e;e++)i=e/n,r=this.getPoint(i),h.copy(r),d+=h.distanceTo(l),l.copy(r),o=(this.points.length-1)*i,a=Math.floor(o),a!==s&&(u[a]=d,s=a);return u[u.length]=d,{chunks:u,total:d}},this.reparametrizeByArcLength=function(t){var e,i,n,r,o,a,s,l,h=[],u=new c,d=this.getLength();for(h.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=d.chunks[e]-d.chunks[e-1],s=Math.ceil(t*a/d.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),i=1;s-1>i;i++)n=r+i*(1/s)*(o-r),l=this.getPoint(n),h.push(u.copy(l).clone());h.push(u.copy(this.points[e]).clone())}this.points=h}}function Ur(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function Hr(t,e){Le.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",r=0,o=i-1,a=i/1;this.createAnimation(n,r,o,a),this.setAnimationWeight(n,1)}function Gr(t){ce.call(this),this.material=t,this.render=function(){}}function jr(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new Pe,c=new Me(2*a*3,3);l.addAttribute("position",c),bi.call(this,l,new wi({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Wr(t){ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new Pe,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1,o=32;o>n;n++,r++){var a=n/o*Math.PI*2,s=r/o*Math.PI*2;i.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}e.addAttribute("position",new Me(i,3));var l=new wi({fog:!1});this.cone=new bi(e,l),this.add(this.cone),this.update()}function Yr(t){this.bones=this.getBoneList(t);for(var e=new Se,i=0;i<this.bones.length;i++){var n=this.bones[i];n.parent&&n.parent.isBone&&(e.vertices.push(new c),e.vertices.push(new c),e.colors.push(new V(0,0,1)),e.colors.push(new V(0,1,0)))}e.dynamic=!0;var r=new wi({vertexColors:Do,depthTest:!1,depthWrite:!1,transparent:!0});bi.call(this,e,r),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Vr(t,e){this.light=t,this.light.updateMatrixWorld();var i=new Qi(e,4,2),n=new fe({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),Le.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Xr(t,e){ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new V,new V];var i=new Ki(e,4,2);i.rotateX(-Math.PI/2);for(var n=0,r=8;r>n;n++)i.faces[n].color=this.colors[4>n?0:1];var o=new fe({vertexColors:Ro,wireframe:!0});this.lightSphere=new Le(i,o),this.add(this.lightSphere),this.update()}function qr(t,e,i,n){e=e||1,i=new V(void 0!==i?i:4473924),n=new V(void 0!==n?n:8947848);for(var r=e/2,o=2*t/e,a=[],s=[],l=0,c=0,h=-t;e>=l;l++,h+=o){a.push(-t,0,h,t,0,h),a.push(h,0,-t,h,0,t);var u=l===r?i:n;u.toArray(s,c),c+=3,u.toArray(s,c),c+=3,u.toArray(s,c),c+=3,u.toArray(s,c),c+=3}var d=new Pe;d.addAttribute("position",new Me(a,3)),d.addAttribute("color",new Me(s,3));var p=new wi({vertexColors:Do});bi.call(this,d,p)}function $r(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Pe,c=new Me(2*a*3,3);l.addAttribute("position",c),bi.call(this,l,new wi({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Zr(t,e){ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var i=new Pe;i.addAttribute("position",new Me([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var n=new wi({fog:!1});this.add(new xi(i,n)),i=new Pe,i.addAttribute("position",new Me([0,0,0,0,0,1],3)),this.add(new xi(i,n)),this.update()}function Qr(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){n.vertices.push(new c),n.colors.push(new V(e)),void 0===o[t]&&(o[t]=[]),o[t].push(n.vertices.length-1)}var n=new Se,r=new wi({color:16777215,vertexColors:Ro}),o={},a=16755200,s=16711680,l=43775,h=16777215,u=3355443;e("n1","n2",a),e("n2","n4",a),e("n4","n3",a),e("n3","n1",a),e("f1","f2",a),e("f2","f4",a),e("f4","f3",a),e("f3","f1",a),e("n1","f1",a),e("n2","f2",a),e("n3","f3",a),e("n4","f4",a),e("p","n1",s),e("p","n2",s),e("p","n3",s),e("p","n4",s),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",h),e("p","c",u),e("cn1","cn2",u),e("cn3","cn4",u),e("cf1","cf2",u),e("cf3","cf4",u),bi.call(this,n,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Kr(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new te,Le.call(this,new pn(1,1,1),new fe({color:i,wireframe:!0}))}function Jr(t,e){void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Pe;r.setIndex(new me(i,1)),r.addAttribute("position",new me(n,3)),bi.call(this,r,new wi({color:e})),void 0!==t&&this.update(t)}function to(t,e,i,n,r,o){ce.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===o&&(o=.2*r),this.position.copy(e),this.line=new xi(sh,new wi({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Le(lh,new fe({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,o)}function eo(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new Pe;n.addAttribute("position",new me(e,3)),n.addAttribute("color",new me(i,3));var r=new wi({vertexColors:Do});bi.call(this,n,r)}function io(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),ch.call(this,t),this.type="catmullrom",this.closed=!0}function no(t,e,i,n,r,o){sr.call(this,t,e,i,i,n,r,o)}function ro(t,e,i,n,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new pe(t,e,i,r,o,a)}function oo(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ti(t,e)}function ao(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ti(t,e)}function so(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Mi(t)}function lo(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Mi(t)}function co(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Mi(t)}function ho(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new c(t,e,i)}function uo(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new bi(new an(t.geometry),new wi({color:void 0!==e?e:16777215}))}function po(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new bi(new Li(t.geometry),new wi({color:void 0!==e?e:16777215}))}function fo(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function mo(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}}(),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;var n=[],r=0,o=i.length;for(r=0;o>r;r++)n[r]=i[r];for(r=0;o>r;r++)n[r].call(this,t)}}}});var go="82",vo={LEFT:0,MIDDLE:1,RIGHT:2},yo=0,_o=1,wo=2,xo=3,bo=0,Mo=1,To=0,Eo=1,So=2,Co=0,Ao=1,Po=2,Lo=1,ko=2,Io=0,Ro=1,Do=2,zo=0,Oo=1,Fo=2,No=3,Bo=4,Uo=5,Ho={NoBlending:zo,NormalBlending:Oo,AdditiveBlending:Fo,SubtractiveBlending:No,MultiplyBlending:Bo,CustomBlending:Uo},Go=100,jo=101,Wo=102,Yo=103,Vo=104,Xo=200,qo=201,$o=202,Zo=203,Qo=204,Ko=205,Jo=206,ta=207,ea=208,ia=209,na=210,ra=0,oa=1,aa=2,sa=3,la=4,ca=5,ha=6,ua=7,da=0,pa=1,fa=2,ma=0,ga=1,va=2,ya=3,_a=4,wa=300,xa=301,ba=302,Ma=303,Ta=304,Ea=305,Sa=306,Ca=307,Aa={UVMapping:wa,CubeReflectionMapping:xa,CubeRefractionMapping:ba,EquirectangularReflectionMapping:Ma,EquirectangularRefractionMapping:Ta,SphericalReflectionMapping:Ea,CubeUVReflectionMapping:Sa,CubeUVRefractionMapping:Ca},Pa=1e3,La=1001,ka=1002,Ia={RepeatWrapping:Pa,ClampToEdgeWrapping:La,MirroredRepeatWrapping:ka},Ra=1003,Da=1004,za=1005,Oa=1006,Fa=1007,Na=1008,Ba={NearestFilter:Ra,NearestMipMapNearestFilter:Da,NearestMipMapLinearFilter:za,LinearFilter:Oa,LinearMipMapNearestFilter:Fa,LinearMipMapLinearFilter:Na},Ua=1009,Ha=1010,Ga=1011,ja=1012,Wa=1013,Ya=1014,Va=1015,Xa=1016,qa=1017,$a=1018,Za=1019,Qa=1020,Ka=1021,Ja=1022,ts=1023,es=1024,is=1025,ns=ts,rs=1026,os=1027,as=2001,ss=2002,ls=2003,cs=2004,hs=2100,us=2101,ds=2102,ps=2103,fs=2151,ms=2200,gs=2201,vs=2202,ys=2300,_s=2301,ws=2302,xs=2400,bs=2401,Ms=2402,Ts=0,Es=1,Ss=2,Cs=3e3,As=3001,Ps=3007,Ls=3002,ks=3003,Is=3004,Rs=3005,Ds=3006,zs=3200,Os=3201,Fs={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var r=0;36>r;r++)8===r||13===r||18===r||23===r?i[r]="-":14===r?i[r]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[r]=e[19===r?3&t|8:t]);
return i.join("")}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Fs.DEG2RAD},radToDeg:function(t){return t*Fs.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}};i.prototype={constructor:i,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new i,e=new i),t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*i-o*n+t.x,this.y=r*n+o*i+t.y,this}},n.DEFAULT_IMAGE=void 0,n.DEFAULT_MAPPING=wa,n.prototype={constructor:n,isTexture:!0,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){function e(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Fs.generateUUID()),void 0===t.images[n.uuid]&&(t.images[n.uuid]={uuid:n.uuid,url:e(n)}),i.image=n.uuid}return t.textures[this.uuid]=i,i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===wa){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case Pa:t.x=t.x-Math.floor(t.x);break;case La:t.x=t.x<0?0:1;break;case ka:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Pa:t.y=t.y-Math.floor(t.y);break;case La:t.y=t.y<0?0:1;break;case ka:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(n.prototype,e.prototype);var Ns=0;o.prototype={constructor:o,isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*e+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*e+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*e+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,o=.01,a=.1,s=t.elements,l=s[0],c=s[4],h=s[8],u=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-u)<o&&Math.abs(h-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+u)<a&&Math.abs(h+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var v=(l+1)/2,y=(d+1)/2,_=(g+1)/2,w=(c+u)/4,x=(h+f)/4,b=(p+m)/4;return v>y&&v>_?o>v?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=w/i,r=x/i):y>_?o>y?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=w/n,r=b/n):o>_?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(_),i=x/r,n=b/r),this.set(i,n,r,e),this}var M=Math.sqrt((m-p)*(m-p)+(h-f)*(h-f)+(u-c)*(u-c));return Math.abs(M)<.001&&(M=1),this.x=(m-p)/M,this.y=(h-f)/M,this.z=(u-c)/M,this.w=Math.acos((l+d+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new o,e=new o),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},Object.assign(a.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.isWebGLRenderTargetCube=!0,l.prototype={constructor:l,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if((t&&t.isEuler)===!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),l=t.order;return"XYZ"===l?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"YXZ"===l?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"ZXY"===l?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"ZYX"===l?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"YZX"===l?(this._x=o*n*r+i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r-o*a*s):"XZY"===l&&(this._x=o*n*r-i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r+o*a*s),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],o=i[8],a=i[1],s=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+s+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(h-l)*e,this._y=(o-c)*e,this._z=(a-r)*e):n>s&&n>u?(e=2*Math.sqrt(1+n-s-u),this._w=(h-l)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+c)/e):s>u?(e=2*Math.sqrt(1+s-n-u),this._w=(o-c)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(l+h)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(a-r)/e,this._x=(o+c)/e,this._y=(l+h)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,i=1e-6;return function(n,r){return void 0===t&&(t=new c),e=n.dot(r)+1,i>e?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+o*a+n*l-r*s,this._y=n*c+o*s+r*a-i*l,this._z=r*c+o*l+i*s-n*a,this._w=o*c-i*a-n*s-r*l,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,o=this._w,a=o*t._w+i*t._x+n*t._y+r*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,a),c=Math.sin((1-e)*l)/s,h=Math.sin(e*l)/s;return this._w=o*c+this._w*h,this._x=i*c+this._x*h,this._y=n*c+this._y*h,this._z=r*c+this._z*h,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(l,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,o,a){var s=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(h!==f||s!==u||l!==d||c!==p){var m=1-a,g=s*u+l*d+c*p+h*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),w=Math.atan2(_,g*v);m=Math.sin(m*w)/_,a=Math.sin(a*w)/_}var x=a*v;if(s=s*m+u*x,l=l*m+d*x,c=c*m+p*x,h=h*m+f*x,m===1-a){var b=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=b,l*=b,c*=b,h*=b}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=h}}),c.prototype={constructor:c,isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return(e&&e.isEuler)===!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new l),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,i){return void 0===t&&(t=new l),this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12],this.y=r[1]*e+r[5]*i+r[9]*n+r[13],this.z=r[2]*e+r[6]*i+r[10]*n+r[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,o=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,c=s*i+a*e-r*n,h=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+c*-a-h*-o,this.y=c*s+u*-o+h*-r-l*-a,this.z=h*s+u*-a+l*-o-c*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new h),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new h),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new c,e=new c),t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new c),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new c),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Fs.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var i=t;t=e,e=i}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},h.prototype={constructor:h,isMatrix4:!0,set:function(t,e,i,n,r,o,a,s,l,c,h,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new h).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new c);var i=this.elements,n=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),makeRotationFromEuler:function(t){(t&&t.isEuler)===!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){var u=o*c,d=o*h,p=a*c,f=a*h;e[0]=s*c,e[4]=-s*h,e[8]=l,e[1]=d+p*l,e[5]=u-f*l,e[9]=-a*s,e[2]=f-u*l,e[6]=p+d*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,g=s*h,v=l*c,y=l*h;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*l,e[1]=o*h,e[5]=o*c,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*c,g=s*h,v=l*c,y=l*h;e[0]=m-y*a,e[4]=-o*h,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*c,e[9]=y-m*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var u=o*c,d=o*h,p=a*c,f=a*h;e[0]=s*c,e[4]=p*l-d,e[8]=u*l+f,e[1]=s*h,e[5]=f*l+u,e[9]=d*l-p,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var _=o*s,w=o*l,x=a*s,b=a*l;e[0]=s*c,e[4]=b-_*h,e[8]=x*h+w,e[1]=h,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=w*h+x,e[10]=_-b*h}else if("XZY"===t.order){var _=o*s,w=o*l,x=a*s,b=a*l;e[0]=s*c,e[4]=-h,e[8]=l*c,e[1]=_*h+b,e[5]=o*c,e[9]=w*h-x,e[2]=x*h-w,e[6]=a*c,e[10]=b*h+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,l=r+r,c=i*a,h=i*s,u=i*l,d=n*s,p=n*l,f=r*l,m=o*a,g=o*s,v=o*l;return e[0]=1-(d+f),e[4]=h-v,e[8]=u+g,e[1]=h+v,e[5]=1-(c+f),e[9]=p-m,e[2]=u-g,e[6]=p+m,e[10]=1-(c+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,i;return function(n,r,o){void 0===t&&(t=new c,e=new c,i=new c);var a=this.elements;return i.subVectors(n,r).normalize(),0===i.lengthSq()&&(i.z=1),t.crossVectors(o,i).normalize(),0===t.lengthSq()&&(i.z+=1e-4,t.crossVectors(o,i).normalize()),e.crossVectors(i,t),a[0]=t.x,a[4]=e.x,a[8]=i.x,a[1]=t.y,a[5]=e.y,a[9]=i.y,a[2]=t.z,a[6]=e.z,a[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],_=i[11],w=i[15],x=n[0],b=n[4],M=n[8],T=n[12],E=n[1],S=n[5],C=n[9],A=n[13],P=n[2],L=n[6],k=n[10],I=n[14],R=n[3],D=n[7],z=n[11],O=n[15];return r[0]=o*x+a*E+s*P+l*R,r[4]=o*b+a*S+s*L+l*D,r[8]=o*M+a*C+s*k+l*z,r[12]=o*T+a*A+s*I+l*O,r[1]=c*x+h*E+u*P+d*R,r[5]=c*b+h*S+u*L+d*D,r[9]=c*M+h*C+u*k+d*z,r[13]=c*T+h*A+u*I+d*O,r[2]=p*x+f*E+m*P+g*R,r[6]=p*b+f*S+m*L+g*D,r[10]=p*M+f*C+m*k+g*z,r[14]=p*T+f*A+m*I+g*O,r[3]=v*x+y*E+_*P+w*R,r[7]=v*b+y*S+_*L+w*D,r[11]=v*M+y*C+_*k+w*z,r[15]=v*T+y*A+_*I+w*O,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0,o=i;n>r;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix4(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length/e.itemSize);for(var r=0,o=i;n>r;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix4(this),e.setXYZ(o,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14],p=t[3],f=t[7],m=t[11],g=t[15];return p*(+r*s*h-n*l*h-r*a*u+i*l*u+n*a*d-i*s*d)+f*(+e*s*d-e*l*u+r*o*u-n*o*d+n*l*c-r*s*c)+m*(+e*l*h-e*a*d-r*o*h+i*o*d+r*a*c-i*l*c)+g*(-n*a*c-e*s*h+e*a*u+n*o*h-i*o*u+i*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new c),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],_=n[15],w=p*y*u-v*f*u+v*h*m-c*y*m-p*h*_+c*f*_,x=g*f*u-d*y*u-g*h*m+l*y*m+d*h*_-l*f*_,b=d*v*u-g*p*u+g*c*m-l*v*m-d*c*_+l*p*_,M=g*p*h-d*v*h-g*c*f+l*v*f+d*c*y-l*p*y,T=r*w+o*x+a*b+s*M;if(0===T){var E="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(E);return console.warn(E),this.identity()}var S=1/T;return i[0]=w*S,i[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*_-o*f*_)*S,i[2]=(c*y*s-v*h*s+v*a*u-o*y*u-c*a*_+o*h*_)*S,i[3]=(p*h*s-c*f*s-p*a*u+o*f*u+c*a*m-o*h*m)*S,i[4]=x*S,i[5]=(d*y*s-g*f*s+g*a*m-r*y*m-d*a*_+r*f*_)*S,i[6]=(g*h*s-l*y*s-g*a*u+r*y*u+l*a*_-r*h*_)*S,i[7]=(l*f*s-d*h*s+d*a*u-r*f*u-l*a*m+r*h*m)*S,i[8]=b*S,i[9]=(g*p*s-d*v*s-g*o*m+r*v*m+d*o*_-r*p*_)*S,i[10]=(l*v*s-g*c*s+g*o*u-r*v*u-l*o*_+r*c*_)*S,i[11]=(d*c*s-l*p*s-d*o*u+r*p*u+l*o*m-r*c*m)*S,i[12]=M*S,i[13]=(d*v*a-g*p*a+g*o*f-r*v*f-d*o*y+r*p*y)*S,i[14]=(g*c*a-l*v*a-g*o*h+r*v*h+l*o*y-r*c*y)*S,i[15]=(l*p*a-d*c*a+d*o*h-r*p*h-l*o*f+r*c*f)*S,this
},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t,e;return function(i,n,r){void 0===t&&(t=new c,e=new h);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length(),u=this.determinant();0>u&&(a=-a),i.x=o[12],i.y=o[13],i.z=o[14],e.elements.set(this.elements);var d=1/a,p=1/s,f=1/l;return e.elements[0]*=d,e.elements[1]*=d,e.elements[2]*=d,e.elements[4]*=p,e.elements[5]*=p,e.elements[6]*=p,e.elements[8]*=f,e.elements[9]*=f,e.elements[10]*=f,n.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makeFrustum:function(t,e,i,n,r,o){var a=this.elements,s=2*r/(e-t),l=2*r/(n-i),c=(e+t)/(e-t),h=(n+i)/(n-i),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,n){var r=i*Math.tan(Fs.DEG2RAD*t*.5),o=-r,a=o*e,s=r*e;return this.makeFrustum(a,s,o,r,i,n)},makeOrthographic:function(t,e,i,n,r,o){var a=this.elements,s=1/(e-t),l=1/(i-n),c=1/(o-r),h=(e+t)*s,u=(i+n)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;16>n;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;16>i;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},u.prototype=Object.create(n.prototype),u.prototype.constructor=u,u.prototype.isCubeTexture=!0,Object.defineProperty(u.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Bs=new n,Us=new u,Hs=[],Gs=[];G.prototype.setValue=function(t,e){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var o=i[n];o.setValue(t,e[o.id])}};var js=/([\w\d_]+)(\])?(\[|\.)?/g;Y.prototype.setValue=function(t,e,i){var n=this.map[e];void 0!==n&&n.setValue(t,i,this.renderer)},Y.prototype.set=function(t,e,i){var n=this.map[i];void 0!==n&&n.setValue(t,e[i],this.renderer)},Y.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},Y.upload=function(t,e,i,n){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=i[a.id];s.needsUpdate!==!1&&a.setValue(t,s.value,n)}},Y.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var o=t[n];o.id in e&&i.push(o)}return i};var Ws={merge:function(t){for(var e={},i=0;i<t.length;i++){var n=this.clone(t[i]);for(var r in n)e[r]=n[r]}return e},clone:function(t){var e={};for(var i in t){e[i]={};for(var n in t[i]){var r=t[i][n];e[i][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?r.clone():Array.isArray(r)?r.slice():r}}return e}},Ys="#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",Vs="#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif\n",Xs="#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",qs="#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif\n",$s="#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",Zs="\nvec3 transformed = vec3( position );\n",Qs="\nvec3 objectNormal = vec3( normal );\n",Ks="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n	return any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n		if( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n			float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n			float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n			return distanceFalloff * maxDistanceCutoffFactor;\n#else\n			return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n		}\n		return 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n	return specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",Js="#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 );\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif\n",tl="#if NUM_CLIPPING_PLANES > 0\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n		vec4 plane = clippingPlanes[ i ];\n		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n	}\n		\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n			vec4 plane = clippingPlanes[ i ];\n			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		if ( clipped ) discard;\n	\n	#endif\n#endif\n",el="#if NUM_CLIPPING_PLANES > 0\n	#if ! defined( PHYSICAL ) && ! defined( PHONG )\n		varying vec3 vViewPosition;\n	#endif\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",il="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n	varying vec3 vViewPosition;\n#endif\n",nl="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n	vViewPosition = - mvPosition.xyz;\n#endif\n",rl="#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",ol="#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif\n",al="#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",sl="#ifdef USE_COLOR\n	vColor.xyz = color.xyz;\n#endif",ll="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract(sin(sn) * c);\n}\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",cl="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n	vec3 absDirection = abs(direction);\n	int face = -1;\n	if( absDirection.x > absDirection.z ) {\n		if(absDirection.x > absDirection.y )\n			face = direction.x > 0.0 ? 0 : 3;\n		else\n			face = direction.y > 0.0 ? 1 : 4;\n	}\n	else {\n		if(absDirection.z > absDirection.y )\n			face = direction.z > 0.0 ? 2 : 5;\n		else\n			face = direction.y > 0.0 ? 1 : 4;\n	}\n	return face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n	float dxRoughness = dFdx(roughness);\n	float dyRoughness = dFdy(roughness);\n	vec3 dx = dFdx( vec * scale * dxRoughness );\n	vec3 dy = dFdy( vec * scale * dyRoughness );\n	float d = max( dot( dx, dx ), dot( dy, dy ) );\n	d = clamp(d, 1.0, cubeUV_rangeClamp);\n	float mipLevel = 0.5 * log2(d);\n	return vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n	float a = 16.0 * cubeUV_rcpTextureSize;\n	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n	float powScale = exp2_packed.x * exp2_packed.y;\n	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n	bool bRes = mipLevel == 0.0;\n	scale =  bRes && (scale < a) ? a : scale;\n	vec3 r;\n	vec2 offset;\n	int face = getFaceFromDirection(direction);\n	float rcpPowScale = 1.0 / powScale;\n	if( face == 0) {\n		r = vec3(direction.x, -direction.z, direction.y);\n		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 1) {\n		r = vec3(direction.y, direction.x, direction.z);\n		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 2) {\n		r = vec3(direction.z, direction.x, direction.y);\n		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 3) {\n		r = vec3(direction.x, direction.z, direction.y);\n		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	else if( face == 4) {\n		r = vec3(direction.y, direction.x, -direction.z);\n		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	else {\n		r = vec3(direction.z, -direction.x, direction.y);\n		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	r = normalize(r);\n	float texelOffset = 0.5 * cubeUV_rcpTextureSize;\n	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n	vec2 base = offset + vec2( texelOffset );\n	return base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n	float roughnessVal = roughness* cubeUV_maxLods3;\n	float r1 = floor(roughnessVal);\n	float r2 = r1 + 1.0;\n	float t = fract(roughnessVal);\n	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n	float s = mipInfo.y;\n	float level0 = mipInfo.x;\n	float level1 = level0 + 1.0;\n	level1 = level1 > 5.0 ? 5.0 : level1;\n	level0 += min( floor( s + 0.5 ), 5.0 );\n	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n	vec4 result = mix(color10, color20, t);\n	return vec4(result.rgb, 1.0);\n}\n#endif\n",hl="#ifdef FLIP_SIDED\n	objectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",ul="#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif\n",dl="#ifdef USE_DISPLACEMENTMAP\n	transformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",pl="#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",fl="#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif\n",ml="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",gl="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",vl="#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	envColor = envMapTexelToLinear( envColor );\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif\n",yl="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n	uniform float reflectivity;\n	uniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n	#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n		varying vec3 vWorldPosition;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif\n",_l="#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif\n",wl="#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif\n",xl="#ifdef USE_FOG\n	#ifdef USE_LOGDEPTHBUF_EXT\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	#else\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n	#endif\n	#ifdef FOG_EXP2\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",bl="#ifdef USE_FOG\n	uniform vec3 fogColor;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",Ml="#ifdef USE_LIGHTMAP\n	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",Tl="#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",El="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n#endif\n",Sl="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		if ( testLightInRange( lightDistance, pointLight.distance ) ) {\n			directLight.color = pointLight.color;\n			directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		#include <normal_flip>\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n		#else\n			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n		#endif\n		#include <normal_flip>\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n		#elif defined( ENVMAP_TYPE_EQUIREC )\n			vec2 sampleUV;\n			sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n			sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_SPHERE )\n			vec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#endif\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif\n",Cl="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",Al="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3	diffuseColor;\n	vec3	specularColor;\n	float	specularShininess;\n	float	specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)\n",Pl="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n	material.clearCoat = saturate( clearCoat );	material.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",Ll="struct PhysicalMaterial {\n	vec3	diffuseColor;\n	float	specularRoughness;\n	vec3	specularColor;\n	#ifndef STANDARD\n		float clearCoat;\n		float clearCoatRoughness;\n	#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	#ifndef STANDARD\n		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n	#else\n		float clearCoatDHR = 0.0;\n	#endif\n	reflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n	reflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	#ifndef STANDARD\n		reflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n	#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	#ifndef STANDARD\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		float dotNL = dotNV;\n		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n	#else\n		float clearCoatDHR = 0.0;\n	#endif\n	reflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n	#ifndef STANDARD\n		reflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n	#endif\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",kl="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointDirectLightIrradiance( pointLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotDirectLightIrradiance( spotLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#ifdef USE_LIGHTMAP\n		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n	#endif\n	#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n	 	irradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n	#endif\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	vec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n	#ifndef STANDARD\n		vec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n	#else\n		vec3 clearCoatRadiance = vec3( 0.0 );\n	#endif\n		\n	RE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",Il="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",Rl="#ifdef USE_LOGDEPTHBUF\n	uniform float logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n#endif\n",Dl="#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n	uniform float logDepthBufFC;\n#endif",zl="#ifdef USE_LOGDEPTHBUF\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n	#else\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n	#endif\n#endif\n",Ol="#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif\n",Fl="#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n",Nl="#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",Bl="#ifdef USE_MAP\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n#endif\n",Ul="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.r;\n#endif\n",Hl="#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",Gl="#ifdef USE_MORPHNORMALS\n	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",jl="#ifdef USE_MORPHTARGETS\n	#ifndef USE_MORPHNORMALS\n	uniform float morphTargetInfluences[ 8 ];\n	#else\n	uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",Wl="#ifdef USE_MORPHTARGETS\n	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n	#endif\n#endif\n",Yl="#ifdef DOUBLE_SIDED\n	float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n	float flipNormal = 1.0;\n#endif\n",Vl="#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",Xl="#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n	}\n#endif\n",ql="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",$l="#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",Zl="#ifdef USE_SKINNING\n	vec4 mvPosition = modelViewMatrix * skinned;\n#else\n	vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",Ql="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.r;\n#endif\n",Kl="#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",Jl="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n		const vec2 offset = vec2( 0.0, 1.0 );\n		vec2 texelSize = vec2( 1.0 ) / size;\n		vec2 centroidUV = floor( uv * size + 0.5 ) / size;\n		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n		vec2 f = fract( uv * size + 0.5 );\n		float a = mix( lb, lt, f.y );\n		float b = mix( rb, rt, f.y );\n		float c = mix( a, b, f.x );\n		return c;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return 1.0;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		vec3 bd3D = normalize( lightToPosition );\n		float dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif\n",tc="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n#endif\n",ec="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n#endif\n",ic="float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#endif\n	return shadow;\n}\n",nc="#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",rc="#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif\n",oc="#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n#endif\n",ac="#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",sc="float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",lc="#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",cc="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",hc="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uc="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n#endif",dc="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n#endif\n",pc="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",fc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",mc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n#endif",gc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = uv2;\n#endif",vc="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n	#ifdef USE_SKINNING\n		vec4 worldPosition = modelMatrix * skinned;\n	#else\n		vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n	#endif\n#endif\n",yc="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n	gl_FragColor.a *= opacity;\n}\n",_c="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}\n",wc="#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <logdepthbuf_fragment>\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n	#endif\n}\n",xc="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",bc="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	gl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",Mc="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition;\n}\n",Tc="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldPosition );\n	vec2 sampleUV;\n	sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",Ec="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}\n",Sc="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",Cc="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	vLineDistance = scale * lineDistance;\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",Ac="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight;\n	reflectedLight.directDiffuse = vec3( 0.0 );\n	reflectedLight.directSpecular = vec3( 0.0 );\n	reflectedLight.indirectDiffuse = diffuseColor.rgb;\n	reflectedLight.indirectSpecular = vec3( 0.0 );\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <normal_flip>\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",Pc="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	#include <envmap_vertex>\n}\n",Lc="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <normal_flip>\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",kc="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n}\n",Ic="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_flip>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",Rc="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n}\n",Dc="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n	uniform float clearCoat;\n	uniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_flip>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",zc="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",Oc="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	gl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n	#include <logdepthbuf_fragment>\n}\n",Fc="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vNormal = normalize( normalMatrix * normal );\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",Nc="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",Bc="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <project_vertex>\n	#ifdef USE_SIZEATTENUATION\n		gl_PointSize = size * ( scale / - mvPosition.z );\n	#else\n		gl_PointSize = size;\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",Uc="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",Hc="#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",Gc={alphamap_fragment:Ys,alphamap_pars_fragment:Vs,alphatest_fragment:Xs,aomap_fragment:qs,aomap_pars_fragment:$s,begin_vertex:Zs,beginnormal_vertex:Qs,bsdfs:Ks,bumpmap_pars_fragment:Js,clipping_planes_fragment:tl,clipping_planes_pars_fragment:el,clipping_planes_pars_vertex:il,clipping_planes_vertex:nl,color_fragment:rl,color_pars_fragment:ol,color_pars_vertex:al,color_vertex:sl,common:ll,cube_uv_reflection_fragment:cl,defaultnormal_vertex:hl,displacementmap_pars_vertex:ul,displacementmap_vertex:dl,emissivemap_fragment:pl,emissivemap_pars_fragment:fl,encodings_fragment:ml,encodings_pars_fragment:gl,envmap_fragment:vl,envmap_pars_fragment:yl,envmap_pars_vertex:_l,envmap_vertex:wl,fog_fragment:xl,fog_pars_fragment:bl,lightmap_fragment:Ml,lightmap_pars_fragment:Tl,lights_lambert_vertex:El,lights_pars:Sl,lights_phong_fragment:Cl,lights_phong_pars_fragment:Al,lights_physical_fragment:Pl,lights_physical_pars_fragment:Ll,lights_template:kl,logdepthbuf_fragment:Il,logdepthbuf_pars_fragment:Rl,logdepthbuf_pars_vertex:Dl,logdepthbuf_vertex:zl,map_fragment:Ol,map_pars_fragment:Fl,map_particle_fragment:Nl,map_particle_pars_fragment:Bl,metalnessmap_fragment:Ul,metalnessmap_pars_fragment:Hl,morphnormal_vertex:Gl,morphtarget_pars_vertex:jl,morphtarget_vertex:Wl,normal_flip:Yl,normal_fragment:Vl,normalmap_pars_fragment:Xl,packing:ql,premultiplied_alpha_fragment:$l,project_vertex:Zl,roughnessmap_fragment:Ql,roughnessmap_pars_fragment:Kl,shadowmap_pars_fragment:Jl,shadowmap_pars_vertex:tc,shadowmap_vertex:ec,shadowmask_pars_fragment:ic,skinbase_vertex:nc,skinning_pars_vertex:rc,skinning_vertex:oc,skinnormal_vertex:ac,specularmap_fragment:sc,specularmap_pars_fragment:lc,tonemapping_fragment:cc,tonemapping_pars_fragment:hc,uv_pars_fragment:uc,uv_pars_vertex:dc,uv_vertex:pc,uv2_pars_fragment:fc,uv2_pars_vertex:mc,uv2_vertex:gc,worldpos_vertex:vc,cube_frag:yc,cube_vert:_c,depth_frag:wc,depth_vert:xc,distanceRGBA_frag:bc,distanceRGBA_vert:Mc,equirect_frag:Tc,equirect_vert:Ec,linedashed_frag:Sc,linedashed_vert:Cc,meshbasic_frag:Ac,meshbasic_vert:Pc,meshlambert_frag:Lc,meshlambert_vert:kc,meshphong_frag:Ic,meshphong_vert:Rc,meshphysical_frag:Dc,meshphysical_vert:zc,normal_frag:Oc,normal_vert:Fc,points_frag:Nc,points_vert:Bc,shadow_frag:Uc,shadow_vert:Hc};
V.prototype={constructor:V,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t}return function(e,i,n){if(e=Fs.euclideanModulo(e,1),i=Fs.clamp(i,0,1),n=Fs.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=.5>=n?n*(1+i):n+i-n*i,o=2*n-r;this.r=t(o,r,e+1/3),this.g=t(o,r,e),this.b=t(o,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,r=i[1],o=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(a,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=i[1],h=c.length;if(3===h)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(t&&t.length>0){var c=jc[t];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,n=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),c=(l+s)/2;if(l===s)e=0,i=0;else{var h=s-l;switch(i=.5>=c?h/(s+l):h/(2-s-l),s){case r:e=(o-a)/h+(a>o?6:0);break;case o:e=(a-r)/h+2;break;case a:e=(r-o)/h+4}e/=6}return n.h=e,n.s=i,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}};var jc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wc={common:{diffuse:{value:new V(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new o(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new V(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new V(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new o(0,0,1,1)}}},Yc={basic:{uniforms:Ws.merge([Wc.common,Wc.aomap,Wc.fog]),vertexShader:Gc.meshbasic_vert,fragmentShader:Gc.meshbasic_frag},lambert:{uniforms:Ws.merge([Wc.common,Wc.aomap,Wc.lightmap,Wc.emissivemap,Wc.fog,Wc.lights,{emissive:{value:new V(0)}}]),vertexShader:Gc.meshlambert_vert,fragmentShader:Gc.meshlambert_frag},phong:{uniforms:Ws.merge([Wc.common,Wc.aomap,Wc.lightmap,Wc.emissivemap,Wc.bumpmap,Wc.normalmap,Wc.displacementmap,Wc.fog,Wc.lights,{emissive:{value:new V(0)},specular:{value:new V(1118481)},shininess:{value:30}}]),vertexShader:Gc.meshphong_vert,fragmentShader:Gc.meshphong_frag},standard:{uniforms:Ws.merge([Wc.common,Wc.aomap,Wc.lightmap,Wc.emissivemap,Wc.bumpmap,Wc.normalmap,Wc.displacementmap,Wc.roughnessmap,Wc.metalnessmap,Wc.fog,Wc.lights,{emissive:{value:new V(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gc.meshphysical_vert,fragmentShader:Gc.meshphysical_frag},points:{uniforms:Ws.merge([Wc.points,Wc.fog]),vertexShader:Gc.points_vert,fragmentShader:Gc.points_frag},dashed:{uniforms:Ws.merge([Wc.common,Wc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gc.linedashed_vert,fragmentShader:Gc.linedashed_frag},depth:{uniforms:Ws.merge([Wc.common,Wc.displacementmap]),vertexShader:Gc.depth_vert,fragmentShader:Gc.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:Gc.normal_vert,fragmentShader:Gc.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Gc.cube_vert,fragmentShader:Gc.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Gc.equirect_vert,fragmentShader:Gc.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new c}},vertexShader:Gc.distanceRGBA_vert,fragmentShader:Gc.distanceRGBA_frag}};Yc.physical={uniforms:Ws.merge([Yc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Gc.meshphysical_vert,fragmentShader:Gc.meshphysical_frag},X.prototype={constructor:X,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new i;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new i;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y?!0:!1},getParameter:function(t,e){var n=e||new i;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,e){var n=e||new i;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Z.prototype={constructor:Z,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]="overdraw"===e?Number(i):i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t;i&&(t={textures:{},images:{}});var n={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Oo&&(n.blending=this.blending),this.shading!==ko&&(n.shading=this.shading),this.side!==Co&&(n.side=this.side),this.vertexColors!==Io&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),n.skinning=this.skinning,n.morphTargets=this.morphTargets,i){var r=e(t.textures),o=e(t.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(Z.prototype,e.prototype);var Vc=0;K.prototype=Object.create(Z.prototype),K.prototype.constructor=K,K.prototype.isShaderMaterial=!0,K.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ws.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},K.prototype.toJSON=function(t){var e=Z.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},J.prototype=Object.create(Z.prototype),J.prototype.constructor=J,J.prototype.isMeshDepthMaterial=!0,J.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},te.prototype={constructor:te,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=+1/0,i=+1/0,n=+1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;l>s;s+=3){var c=t[s],h=t[s+1],u=t[s+2];e>c&&(e=c),i>h&&(i=h),n>u&&(n=u),c>r&&(r=c),h>o&&(o=h),u>a&&(a=u)}this.min.set(e,i,n),this.max.set(r,o,a)},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new c;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new c;return function(e){var i=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var n=e.geometry;if(void 0!==n)if(n&&n.isGeometry)for(var r=n.vertices,o=0,a=r.length;a>o;o++)t.copy(r[o]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t);else if(n&&n.isBufferGeometry){var s=n.attributes.position;if(void 0!==s){var l,c,h;s&&s.isInterleavedBufferAttribute?(l=s.data.array,c=s.offset,h=s.data.stride):(l=s.array,c=0,h=3);for(var o=c,a=l.length;a>o;o+=h)t.fromArray(l,o),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t)}}}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new c;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new c;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z?!0:!1},getParameter:function(t,e){var i=e||new c;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new c),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){var i=e||new c;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new c;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new c;return function(e){var i=e||new ee;return this.getCenter(i.center),i.radius=.5*this.getSize(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new c,new c,new c,new c,new c,new c,new c,new c];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},ee.prototype={constructor:ee,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new te;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).getCenter(n);for(var r=0,o=0,a=e.length;a>o;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new c;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new te;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},ie.prototype={constructor:ie,isMatrix3:!0,set:function(t,e,i,n,r,o,a,s,l){var c=this.elements;return c[0]=t,c[1]=n,c[2]=a,c[3]=e,c[4]=r,c[5]=s,c[6]=i,c[7]=o,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0,o=i;n>r;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix3(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length/e.itemSize);for(var r=0,o=i;n>r;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix3(this),e.setXYZ(o,t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-i*r*c+i*a*s+n*r*l-n*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=d*l-c*u,f=c*h-d*s,m=u*s-l*h,g=r*p+o*f+a*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(a*u-d*o)*y,n[2]=(c*o-a*l)*y,n[3]=f*y,n[4]=(d*r-a*h)*y,n[5]=(a*s-c*r)*y,n[6]=m*y,n[7]=(o*h-u*r)*y,n[8]=(l*r-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;9>i;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}},ne.prototype={constructor:ne,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new c,e=new c;return function(i,n,r){var o=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),n=e||new c;return n.copy(this.normal).multiplyScalar(i)},intersectLine:function(){var t=new c;return function(e,i){var n=i||new c,r=e.delta(t),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/o;return 0>a||a>1?void 0:n.copy(r).multiplyScalar(a).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return 0>e&&i>0||0>i&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new c;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new c,e=new ie;return function(i,n){var r=this.coplanarPoint(t).applyMatrix4(i),o=n||e.getNormalMatrix(i),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},re.prototype={constructor:re,set:function(t,e,i,n,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(a-n,h-s,f-u,y-m).normalize(),e[1].setComponents(a+n,h+s,f+u,y+m).normalize(),e[2].setComponents(a+r,h+l,f+d,y+g).normalize(),e[3].setComponents(a-r,h-l,f-d,y-g).normalize(),e[4].setComponents(a-o,h-c,f-p,y-v).normalize(),e[5].setComponents(a+o,h+c,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new ee;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new ee;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;6>r;r++){var o=e[r].distanceToPoint(i);if(n>o)return!1}return!0},intersectsBox:function(){var t=new c,e=new c;return function(i){for(var n=this.planes,r=0;6>r;r++){var o=n[r];t.x=o.normal.x>0?i.min.x:i.max.x,e.x=o.normal.x>0?i.max.x:i.min.x,t.y=o.normal.y>0?i.min.y:i.max.y,e.y=o.normal.y>0?i.max.y:i.min.y,t.z=o.normal.z>0?i.min.z:i.max.z,e.z=o.normal.z>0?i.max.z:i.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},ae.prototype={constructor:ae,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new c;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new c;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new c;i.subVectors(t,this.origin);var n=i.dot(this.direction);return 0>n?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new c;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return 0>i?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new c,e=new c,i=new c;return function(n,r,o,a){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var s,l,c,h,u=.5*n.distanceTo(r),d=-this.direction.dot(e),p=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(s=d*f-p,l=d*p-f,h=u*g,s>=0)if(l>=-h)if(h>=l){var v=1/g;s*=v,l*=v,c=s*(s+d*l+2*p)+l*(d*s+l+2*f)+m}else l=u,s=Math.max(0,-(d*l+p)),c=-s*s+l*(l+2*f)+m;else l=-u,s=Math.max(0,-(d*l+p)),c=-s*s+l*(l+2*f)+m;
else-h>=l?(s=Math.max(0,-(-d*u+p)),l=s>0?-u:Math.min(Math.max(-u,-f),u),c=-s*s+l*(l+2*f)+m):h>=l?(s=0,l=Math.min(Math.max(-u,-f),u),c=l*(l+2*f)+m):(s=Math.max(0,-(d*u+p)),l=s>0?u:Math.min(Math.max(-u,-f),u),c=-s*s+l*(l+2*f)+m);else l=d>0?-u:u,s=Math.max(0,-(d*l+p)),c=-s*s+l*(l+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(l).add(t),c}}(),intersectSphere:function(){var t=new c;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=n-a,l=n+a;return 0>s&&0>l?null:0>s?this.at(l,i):this.at(s,i)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return 0>i*e?!0:!1},intersectBox:function(t,e){var i,n,r,o,a,s,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,o=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,o=(t.min.y-u.y)*c),i>o||r>n?null:((r>i||i!==i)&&(i=r),(n>o||n!==n)&&(n=o),h>=0?(a=(t.min.z-u.z)*h,s=(t.max.z-u.z)*h):(a=(t.max.z-u.z)*h,s=(t.min.z-u.z)*h),i>s||a>n?null:((a>i||i!==i)&&(i=a),(n>s||n!==n)&&(n=s),0>n?null:this.at(i>=0?i:n,e)))},intersectsBox:function(){var t=new c;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new c,e=new c,i=new c,n=new c;return function(r,o,a,s,l){e.subVectors(o,r),i.subVectors(a,r),n.crossVectors(e,i);var c,h=this.direction.dot(n);if(h>0){if(s)return null;c=1}else{if(!(0>h))return null;c=-1,h=-h}t.subVectors(this.origin,r);var u=c*this.direction.dot(i.crossVectors(t,i));if(0>u)return null;var d=c*this.direction.dot(e.cross(t));if(0>d)return null;if(u+d>h)return null;var p=-c*t.dot(n);return 0>p?null:this.at(p/h,l)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},se.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],se.DefaultOrder="XYZ",se.prototype={constructor:se,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=Fs.clamp,r=t.elements,o=r[0],a=r[4],s=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],p=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===e?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new l;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},le.prototype={constructor:le,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}},ce.DefaultUp=new c(0,1,0),ce.DefaultMatrixAutoUpdate=!0,Object.assign(ce.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new l;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new c(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new c(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new c(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new c;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new c(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new c(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new c(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new h;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new h;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i],o=r.getObjectByProperty(t,e);if(void 0!==o)return o}return void 0},getWorldPosition:function(t){var e=t||new c;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new c,e=new c;return function(i){var n=i||new l;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new l;return function(e){var i=e||new se;return this.getWorldQuaternion(t),i.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new c,e=new l;return function(i){var n=i||new c;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new l;return function(e){var i=e||new c;return this.getWorldQuaternion(t),i.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;n>i;i++)e[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,i=0,n=e.length;n>i;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||t===!0)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;n>i;i++)e[i].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t||""===t,n={};i&&(t={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),this.children.length>0){r.children=[];for(var o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(i){var a=e(t.geometries),s=e(t.materials),l=e(t.textures),c=e(t.images);a.length>0&&(n.geometries=a),s.length>0&&(n.materials=s),l.length>0&&(n.textures=l),c.length>0&&(n.images=c)}return n.object=r,n},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}});var Xc=0;ue.prototype={constructor:ue,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){var e=t||new c;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new c;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new c;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new c,e=new c;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),o=e.dot(t),a=o/r;return n&&(a=Fs.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),r=i||new c;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},de.normal=function(){var t=new c;return function(e,i,n,r){var o=r||new c;o.subVectors(n,i),t.subVectors(e,i),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),de.barycoordFromPoint=function(){var t=new c,e=new c,i=new c;return function(n,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),i.subVectors(n,r);var l=t.dot(t),h=t.dot(e),u=t.dot(i),d=e.dot(e),p=e.dot(i),f=l*d-h*h,m=s||new c;if(0===f)return m.set(-2,-1,-1);var g=1/f,v=(d*u-h*p)*g,y=(l*p-h*u)*g;return m.set(1-v-y,y,v)}}(),de.containsPoint=function(){var t=new c;return function(e,i,n,r){var o=de.barycoordFromPoint(e,i,n,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),de.prototype={constructor:de,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new c,e=new c;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new c;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return de.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new ne;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return de.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return de.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,i,n;return function(r,o){void 0===t&&(t=new ne,e=[new ue,new ue,new ue],i=new c,n=new c);var a=o||new c,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,i),this.containsPoint(i)===!0)a.copy(i);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(i,!0,n);var h=i.distanceToSquared(n);s>h&&(s=h,a.copy(n))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},pe.prototype={constructor:pe,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;i>e;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,i=t.vertexColors.length;i>e;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},fe.prototype=Object.create(Z.prototype),fe.prototype.constructor=fe,fe.prototype.isMeshBasicMaterial=!0,fe.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},me.prototype={constructor:me,isBufferAttribute:!0,set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;r>n;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;r>n;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new V),e[i++]=o.r,e[i++]=o.g,e[i++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;r>n;n++){var o=t[n];e[i++]=o.a,e[i++]=o.b,e[i++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,o=t.length;o>r;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new i),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;r>n;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new c),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;r>n;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new o),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z,e[i++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},Object.assign(Se.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new ie).getNormalMatrix(t),i=0,n=this.vertices.length;n>i;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(var i=0,n=this.faces.length;n>i;i++){var o=this.faces[i];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ce),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,r){var o=void 0!==s?[d[t].clone(),d[e].clone(),d[i].clone()]:[],a=void 0!==l?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],c=new pe(t,e,i,o,a,r);n.faces.push(c),void 0!==h&&n.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[i].clone()]),void 0!==u&&n.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[i].clone()])}var n=this,r=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,l=void 0!==o.color?o.color.array:void 0,h=void 0!==o.uv?o.uv.array:void 0,u=void 0!==o.uv2?o.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var d=[],p=[],f=[],m=0,g=0;m<a.length;m+=3,g+=2)n.vertices.push(new c(a[m],a[m+1],a[m+2])),void 0!==s&&d.push(new c(s[m],s[m+1],s[m+2])),void 0!==l&&n.colors.push(new V(l[m],l[m+1],l[m+2])),void 0!==h&&p.push(new i(h[g],h[g+1])),void 0!==u&&f.push(new i(u[g],u[g+1]));if(void 0!==r){var v=t.groups;if(v.length>0)for(var m=0;m<v.length;m++)for(var y=v[m],_=y.start,w=y.count,g=_,x=_+w;x>g;g+=3)e(r[g],r[g+1],r[g+2],y.materialIndex);else for(var m=0;m<r.length;m+=3)e(r[m],r[m+1],r[m+2])}else for(var m=0;m<a.length/3;m+=3)e(m,m+1,m+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new h;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new c,e=new c,i=0,n=this.faces.length;n>i;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,i,n,r,o,a;for(a=new Array(this.vertices.length),e=0,i=this.vertices.length;i>e;e++)a[e]=new c;if(t){var s,l,h,u=new c,d=new c;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],u.subVectors(h,l),d.subVectors(s,l),u.cross(d),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;r>n;n++)o=this.faces[n],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,i=this.vertices.length;i>e;e++)a[e].normalize();for(n=0,r=this.faces.length;r>n;n++){o=this.faces[n];var p=o.vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,i;for(this.computeFaceNormals(),t=0,e=this.faces.length;e>t;t++){i=this.faces[t];var n=i.vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;n>i;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;e>t;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new Se;for(o.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,s,l=this.morphNormals[t].faceNormals,h=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;n>i;i++)a=new c,s={a:new c,b:new c,c:new c},l.push(a),h.push(s)}var u=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],a=u.faceNormals[i],s=u.vertexNormals[i],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;n>i;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new te),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ee),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if((t&&t.isGeometry)===!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var n,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,l=t.faces,c=this.faceVertexUvs[0],h=t.faceVertexUvs[0],u=this.colors,d=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new ie).getNormalMatrix(e));for(var p=0,f=a.length;f>p;p++){var m=a[p],g=m.clone();void 0!==e&&g.applyMatrix4(e),o.push(g)}for(var p=0,f=d.length;f>p;p++)u.push(d[p].clone());for(p=0,f=l.length;f>p;p++){var v,y,_,w=l[p],x=w.vertexNormals,b=w.vertexColors;v=new pe(w.a+r,w.b+r,w.c+r),v.normal.copy(w.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var M=0,T=x.length;T>M;M++)y=x[M].clone(),void 0!==n&&y.applyMatrix3(n).normalize(),v.vertexNormals.push(y);v.color.copy(w.color);for(var M=0,T=b.length;T>M;M++)_=b[M],v.vertexColors.push(_.clone());v.materialIndex=w.materialIndex+i,s.push(v)}for(p=0,f=h.length;f>p;p++){var E=h[p],S=[];if(void 0!==E){for(var M=0,T=E.length;T>M;M++)S.push(E[M].clone());c.push(S)}}},mergeMesh:function(t){return(t&&t.isMesh)===!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,n,r,o,a,s,l={},c=[],h=[],u=4,d=Math.pow(10,u);for(i=0,n=this.vertices.length;n>i;i++)t=this.vertices[i],e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d),void 0===l[e]?(l[e]=i,c.push(this.vertices[i]),h[i]=c.length-1):h[i]=h[l[e]];var p=[];for(i=0,n=this.faces.length;n>i;i++){r=this.faces[i],r.a=h[r.a],r.b=h[r.b],r.c=h[r.c],o=[r.a,r.b,r.c];for(var f=-1,m=0;3>m;m++)if(o[m]===o[(m+1)%3]){f=m,p.push(i);break}}for(i=p.length-1;i>=0;i--){var g=p[i];for(this.faces.splice(g,1),a=0,s=this.faceVertexUvs.length;s>a;a++)this.faceVertexUvs[a].splice(g,1)}var v=this.vertices.length-c.length;return this.vertices=c,v},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,i=e.length,n=0;i>n;n++)e[n]._id=n;e.sort(t);var r,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===i&&(r=[]),s&&s.length===i&&(o=[]);for(var n=0;i>n;n++){var l=e[n]._id;r&&r.push(a[l]),o&&o.push(s[l])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==d[e]?d[e]:(d[e]=u.length/3,u.push(t.x,t.y,t.z),d[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=p.length,p.push(t.getHex()),f[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(var s=[],l=0;l<this.vertices.length;l++){var c=this.vertices[l];s.push(c.x,c.y,c.z)}for(var h=[],u=[],d={},p=[],f={},m=[],g={},l=0;l<this.faces.length;l++){var v=this.faces[l],y=!0,_=!1,w=void 0!==this.faceVertexUvs[0][l],x=v.normal.length()>0,b=v.vertexNormals.length>0,M=1!==v.color.r||1!==v.color.g||1!==v.color.b,T=v.vertexColors.length>0,E=0;if(E=t(E,0,0),E=t(E,1,y),E=t(E,2,_),E=t(E,3,w),E=t(E,4,x),E=t(E,5,b),E=t(E,6,M),E=t(E,7,T),h.push(E),h.push(v.a,v.b,v.c),h.push(v.materialIndex),w){var S=this.faceVertexUvs[0][l];h.push(n(S[0]),n(S[1]),n(S[2]))}if(x&&h.push(e(v.normal)),b){var C=v.vertexNormals;h.push(e(C[0]),e(C[1]),e(C[2]))}if(M&&h.push(i(v.color)),T){var A=v.vertexColors;h.push(i(A[0]),i(A[1]),i(A[2]))}}return r.data={},r.data.vertices=s,r.data.normals=u,p.length>0&&(r.data.colors=p),m.length>0&&(r.data.uvs=[m]),r.data.faces=h,r},clone:function(){return(new Se).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];for(var e=t.vertices,i=0,n=e.length;n>i;i++)this.vertices.push(e[i].clone());for(var r=t.colors,i=0,n=r.length;n>i;i++)this.colors.push(r[i].clone());for(var o=t.faces,i=0,n=o.length;n>i;i++)this.faces.push(o[i].clone());for(var i=0,n=t.faceVertexUvs.length;n>i;i++){var a=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var s=0,l=a.length;l>s;s++){for(var c=a[s],h=[],u=0,d=c.length;d>u;u++){var p=c[u];h.push(p.clone())}this.faceVertexUvs[i].push(h)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var qc=0;Object.assign(Ae.prototype,e.prototype,{computeBoundingBox:Se.prototype.computeBoundingBox,computeBoundingSphere:Se.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,i,n=[],r=t.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,o=t.faceVertexUvs,a=o[0]&&o[0].length>0,s=o[1]&&o[1].length>0,l=t.morphTargets,c=l.length;if(c>0){e=[];for(var h=0;c>h;h++)e[h]=[];this.morphTargets.position=e}var u,d=t.morphNormals,p=d.length;if(p>0){u=[];for(var h=0;p>h;h++)u[h]=[];this.morphTargets.normal=u}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===r.length,v=m.length===r.length,h=0;h<n.length;h++){var y=n[h];this.vertices.push(r[y.a],r[y.b],r[y.c]);var _=y.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var w=y.normal;this.normals.push(w,w,w)}var x=y.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var b=y.color;this.colors.push(b,b,b)}if(a===!0){var M=o[0][h];void 0!==M?this.uvs.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",h),this.uvs.push(new i,new i,new i))}if(s===!0){var M=o[1][h];void 0!==M?this.uvs2.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",h),this.uvs2.push(new i,new i,new i))}for(var T=0;c>T;T++){var E=l[T].vertices;e[T].push(E[y.a],E[y.b],E[y.c])}for(var T=0;p>T;T++){var S=d[T].vertexNormals[h];u[T].push(S.a,S.b,S.c)}g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(Pe.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return(e&&e.isBufferAttribute)===!1&&(e&&e.isInterleavedBufferAttribute)===!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new me(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new ie).getNormalMatrix(t);
n.applyToVector3Array(i.array),i.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ce),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t&&t.isPoints||t&&t.isLine){var i=new Me(3*e.vertices.length,3),n=new Me(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new Me(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t&&t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t&&t.isMesh){var i=e.__directGeometry;if(e.elementsNeedUpdate===!0&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}var n;return e.verticesNeedUpdate===!0&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),e.normalsNeedUpdate===!0&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),e.colorsNeedUpdate===!0&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Ae).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new me(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new me(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new me(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new me(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new me(o,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=t.vertices.length>65535?Uint32Array:Uint16Array,s=new a(3*t.indices.length);this.setIndex(new me(s,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var l in t.morphTargets){for(var c=[],h=t.morphTargets[l],u=0,d=h.length;d>u;u++){var p=h[u],f=new Me(3*p.length,3);c.push(f.copyVector3sArray(p))}this.morphAttributes[l]=c}if(t.skinIndices.length>0){var m=new Me(4*t.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var g=new Me(4*t.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new te);var t=this.attributes.position.array;void 0!==t?this.boundingBox.setFromArray(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new te,e=new c;return function(){null===this.boundingSphere&&(this.boundingSphere=new ee);var i=this.attributes.position;if(i){var n=i.array,r=this.boundingSphere.center;t.setFromArray(n),t.getCenter(r);for(var o=0,a=0,s=n.length;s>a;a+=3)e.fromArray(n,a),o=Math.max(o,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new me(new Float32Array(n.length),3));else for(var r=e.normal.array,o=0,a=r.length;a>o;o++)r[o]=0;var s,l,h,u=e.normal.array,d=new c,p=new c,f=new c,m=new c,g=new c;if(t){var v=t.array;0===i.length&&this.addGroup(0,v.length);for(var y=0,_=i.length;_>y;++y)for(var w=i[y],x=w.start,b=w.count,o=x,a=x+b;a>o;o+=3)s=3*v[o+0],l=3*v[o+1],h=3*v[o+2],d.fromArray(n,s),p.fromArray(n,l),f.fromArray(n,h),m.subVectors(f,p),g.subVectors(d,p),m.cross(g),u[s]+=m.x,u[s+1]+=m.y,u[s+2]+=m.z,u[l]+=m.x,u[l+1]+=m.y,u[l+2]+=m.z,u[h]+=m.x,u[h+1]+=m.y,u[h+2]+=m.z}else for(var o=0,a=n.length;a>o;o+=9)d.fromArray(n,o),p.fromArray(n,o+3),f.fromArray(n,o+6),m.subVectors(f,p),g.subVectors(d,p),m.cross(g),u[o]=m.x,u[o+1]=m.y,u[o+2]=m.z,u[o+3]=m.x,u[o+4]=m.y,u[o+5]=m.z,u[o+6]=m.x,u[o+7]=m.y,u[o+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if((t&&t.isBufferGeometry)===!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var r=i[n],o=r.array,a=t.attributes[n],s=a.array,l=a.itemSize,c=0,h=l*e;c<s.length;c++,h++)o[h]=s[c];return this},normalizeNormals:function(){for(var t,e,i,n,r=this.attributes.normal.array,o=0,a=r.length;a>o;o+=3)t=r[o],e=r[o+1],i=r[o+2],n=1/Math.sqrt(t*t+e*e+i*i),r[o]*=n,r[o+1]*=n,r[o+2]*=n},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Pe,e=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],o=r.array,a=r.itemSize,s=new o.constructor(e.length*a),l=0,c=0,h=0,u=e.length;u>h;h++){l=e[h]*a;for(var d=0;a>d;d++)s[c++]=o[l++]}t.addAttribute(n,new me(s,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:r}}var o=this.attributes;for(var i in o){var a=o[i],r=Array.prototype.slice.call(a.array);t.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new Pe).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=t.groups,a=0,s=o.length;s>a;a++){var l=o[a];this.addGroup(l.start,l.count,l.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Pe.MaxIndex=65535,Le.prototype=Object.assign(Object.create(ce.prototype),{constructor:Le,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return ce.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&t.length>0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,i=t.length;i>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,i,n,r,o,a){return de.barycoordFromPoint(t,e,i,n,y),r.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),r.add(o).add(a),r.clone()}function e(t,e,i,n,r,o,a){var s,l=t.material;if(s=l.side===Ao?i.intersectTriangle(o,r,n,!0,a):i.intersectTriangle(n,r,o,l.side!==Po,a),null===s)return null;w.copy(a),w.applyMatrix4(t.matrixWorld);var c=e.ray.origin.distanceTo(w);return c<e.near||c>e.far?null:{distance:c,point:w.clone(),object:t}}function n(i,n,r,o,a,c,h,d){s.fromArray(o,3*c),l.fromArray(o,3*h),u.fromArray(o,3*d);var p=e(i,n,r,s,l,u,_);return p&&(a&&(m.fromArray(a,2*c),g.fromArray(a,2*h),v.fromArray(a,2*d),p.uv=t(_,s,l,u,m,g,v)),p.face=new pe(c,h,d,de.normal(s,l,u)),p.faceIndex=c),p}var r=new h,o=new ae,a=new ee,s=new c,l=new c,u=new c,d=new c,p=new c,f=new c,m=new i,g=new i,v=new i,y=new c,_=new c,w=new c;return function(i,c){var h=this.geometry,y=this.material,w=this.matrixWorld;if(void 0!==y&&(null===h.boundingSphere&&h.computeBoundingSphere(),a.copy(h.boundingSphere),a.applyMatrix4(w),i.ray.intersectsSphere(a)!==!1&&(r.getInverse(w),o.copy(i.ray).applyMatrix4(r),null===h.boundingBox||o.intersectsBox(h.boundingBox)!==!1))){var x,b;if(h&&h.isBufferGeometry){var M,T,E,S=h.index,C=h.attributes,A=C.position.array;if(void 0!==C.uv&&(x=C.uv.array),null!==S)for(var P=S.array,L=0,k=P.length;k>L;L+=3)M=P[L],T=P[L+1],E=P[L+2],b=n(this,i,o,A,x,M,T,E),b&&(b.faceIndex=Math.floor(L/3),c.push(b));else for(var L=0,k=A.length;k>L;L+=9)M=L/3,T=M+1,E=M+2,b=n(this,i,o,A,x,M,T,E),b&&(b.index=M,c.push(b))}else if(h&&h.isGeometry){var I,R,D,z=y&&y.isMultiMaterial,O=z===!0?y.materials:null,F=h.vertices,N=h.faces,B=h.faceVertexUvs[0];B.length>0&&(x=B);for(var U=0,H=N.length;H>U;U++){var G=N[U],j=z===!0?O[G.materialIndex]:y;if(void 0!==j){if(I=F[G.a],R=F[G.b],D=F[G.c],j.morphTargets===!0){var W=h.morphTargets,Y=this.morphTargetInfluences;s.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(var V=0,X=W.length;X>V;V++){var q=Y[V];if(0!==q){var $=W[V].vertices;s.addScaledVector(d.subVectors($[G.a],I),q),l.addScaledVector(p.subVectors($[G.b],R),q),u.addScaledVector(f.subVectors($[G.c],D),q)}}s.add(I),l.add(R),u.add(D),I=s,R=l,D=u}if(b=e(this,i,o,I,R,D,_)){if(x){var Z=x[U];m.copy(Z[0]),g.copy(Z[1]),v.copy(Z[2]),b.uv=t(_,I,R,D,m,g,v)}b.face=G,b.faceIndex=U,c.push(b)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ke.prototype=Object.create(Pe.prototype),ke.prototype.constructor=ke,Ie.prototype=Object.create(Pe.prototype),Ie.prototype.constructor=Ie,Re.prototype=Object.create(ce.prototype),Re.prototype.constructor=Re,Re.prototype.isCamera=!0,Re.prototype.getWorldDirection=function(){var t=new l;return function(e){var i=e||new c;return this.getWorldQuaternion(t),i.set(0,0,-1).applyQuaternion(t)}}(),Re.prototype.lookAt=function(){var t=new h;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),Re.prototype.clone=function(){return(new this.constructor).copy(this)},Re.prototype.copy=function(t){return ce.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},De.prototype=Object.assign(Object.create(Re.prototype),{constructor:De,isPerspectiveCamera:!0,copy:function(t){return Re.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Fs.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Fs.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Fs.RAD2DEG*Math.atan(Math.tan(.5*Fs.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Fs.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*n/a,e-=o.offsetY*i/s,n*=o.width/a,i*=o.height/s}var l=this.filmOffset;0!==l&&(r+=t*l/this.getFilmWidth()),this.projectionMatrix.makeFrustum(r,r+n,e-i,e,t,this.far)},toJSON:function(t){var e=ce.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),ze.prototype=Object.assign(Object.create(Re.prototype),{constructor:ze,isOrthographicCamera:!0,copy:function(t){return Re.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,o){this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,o=i+t,a=n+e,s=n-e;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;r+=h*(this.view.offsetX/l),o=r+h*(this.view.width/l),a-=u*(this.view.offsetY/c),s=a-u*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(t){var e=ce.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var $c=0;ci.prototype.isFogExp2=!0,ci.prototype.clone=function(){return new ci(this.color.getHex(),this.density)},ci.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},hi.prototype.isFog=!0,hi.prototype.clone=function(){return new hi(this.color.getHex(),this.near,this.far)},hi.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ui.prototype=Object.create(ce.prototype),ui.prototype.constructor=ui,ui.prototype.copy=function(t,e){return ce.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},ui.prototype.toJSON=function(t){var e=ce.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},di.prototype=Object.assign(Object.create(ce.prototype),{constructor:di,isLensFlare:!0,copy:function(t){ce.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;i>e;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,i,n,r,o){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new V(16777215)),void 0===n&&(n=Oo),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:n})},updateLensFlares:function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;i>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),pi.prototype=Object.create(Z.prototype),pi.prototype.constructor=pi,pi.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},fi.prototype=Object.assign(Object.create(ce.prototype),{constructor:fi,isSprite:!0,raycast:function(){var t=new c;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.distanceSqToPoint(t),r=this.scale.x*this.scale.y/4;n>r||i.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),mi.prototype=Object.assign(Object.create(ce.prototype),{constructor:mi,copy:function(t){ce.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;n>i;i++){var r=e[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;n>i&&!(t<e[i].distance);i++);return e[i-1].object},raycast:function(){var t=new c;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new c,e=new c;return function(i){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);n[0].object.visible=!0;for(var o=1,a=n.length;a>o&&r>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;a>o;o++)n[o].object.visible=!1}}}(),toJSON:function(t){var e=ce.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,r=i.length;r>n;n++){var o=i[n];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),gi.prototype=Object.create(n.prototype),gi.prototype.constructor=gi,gi.prototype.isDataTexture=!0,Object.assign(vi.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;e>t;t++){var i=new h;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var t,e=0,i=this.bones.length;i>e;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,i=this.bones.length;i>e;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new h;return function(){for(var e=0,i=this.bones.length;i>e;e++){var n=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(n,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new vi(this.bones,this.boneInverses,this.useVertexTexture)}}),yi.prototype=Object.assign(Object.create(ce.prototype),{constructor:yi,isBone:!0,copy:function(t){return ce.prototype.copy.call(this,t),this.skin=t.skin,this}}),_i.prototype=Object.assign(Object.create(Le.prototype),{constructor:_i,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();1/0!==i?e.multiplyScalar(i):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var n=new o,r=this.geometry.attributes.skinWeight,t=0;t<r.count;t++){n.x=r.getX(t),n.y=r.getY(t),n.z=r.getZ(t),n.w=r.getW(t);var i=1/n.lengthManhattan();1/0!==i?n.multiplyScalar(i):n.set(1,0,0,0),r.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(){Le.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),wi.prototype=Object.create(Z.prototype),wi.prototype.constructor=wi,wi.prototype.isLineBasicMaterial=!0,wi.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},xi.prototype=Object.assign(Object.create(ce.prototype),{constructor:xi,isLine:!0,raycast:function(){var t=new h,e=new ae,i=new ee;return function(n,r){var o=n.linePrecision,a=o*o,s=this.geometry,l=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(l),n.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(n.ray).applyMatrix4(t);var h=new c,u=new c,d=new c,p=new c,f=this&&this.isLineSegments?2:1;if(s&&s.isBufferGeometry){var m=s.index,g=s.attributes,v=g.position.array;if(null!==m)for(var y=m.array,_=0,w=y.length-1;w>_;_+=f){var x=y[_],b=y[_+1];h.fromArray(v,3*x),u.fromArray(v,3*b);var M=e.distanceSqToSegment(h,u,p,d);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var T=n.ray.origin.distanceTo(p);T<n.near||T>n.far||r.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(var _=0,w=v.length/3-1;w>_;_+=f){h.fromArray(v,3*_),u.fromArray(v,3*_+3);var M=e.distanceSqToSegment(h,u,p,d);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var T=n.ray.origin.distanceTo(p);T<n.near||T>n.far||r.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else if(s&&s.isGeometry)for(var E=s.vertices,S=E.length,_=0;S-1>_;_+=f){var M=e.distanceSqToSegment(E[_],E[_+1],p,d);if(!(M>a)){p.applyMatrix4(this.matrixWorld);var T=n.ray.origin.distanceTo(p);T<n.near||T>n.far||r.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),bi.prototype=Object.assign(Object.create(xi.prototype),{constructor:bi,isLineSegments:!0}),Mi.prototype=Object.create(Z.prototype),Mi.prototype.constructor=Mi,Mi.prototype.isPointsMaterial=!0,Mi.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Ti.prototype=Object.assign(Object.create(ce.prototype),{constructor:Ti,isPoints:!0,raycast:function(){var t=new h,e=new ae,i=new ee;return function(n,r){function o(t,i){var o=e.distanceSqToPoint(t);if(d>o){var s=e.closestPointToPoint(t);s.applyMatrix4(l);var c=n.ray.origin.distanceTo(s);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:s.clone(),index:i,face:null,object:a})}}var a=this,s=this.geometry,l=this.matrixWorld,h=n.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(l),n.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(n.ray).applyMatrix4(t);var u=h/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,p=new c;if(s&&s.isBufferGeometry){var f=s.index,m=s.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,_=v.length;_>y;y++){var w=v[y];p.fromArray(g,3*w),o(p,w)}else for(var y=0,x=g.length/3;x>y;y++)p.fromArray(g,3*y),o(p,y)}else for(var b=s.vertices,y=0,x=b.length;x>y;y++)o(b[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ei.prototype=Object.assign(Object.create(ce.prototype),{constructor:Ei}),Si.prototype=Object.create(n.prototype),Si.prototype.constructor=Si,Ci.prototype=Object.create(n.prototype),Ci.prototype.constructor=Ci,Ci.prototype.isCompressedTexture=!0,Ai.prototype=Object.create(n.prototype),Ai.prototype.constructor=Ai,Pi.prototype=Object.create(n.prototype),Pi.prototype.constructor=Pi,Pi.prototype.isDepthTexture=!0,Li.prototype=Object.create(Pe.prototype),Li.prototype.constructor=Li,ki.prototype=Object.create(Pe.prototype),ki.prototype.constructor=ki,Ii.prototype=Object.create(Se.prototype),Ii.prototype.constructor=Ii,Ri.prototype=Object.create(Pe.prototype),Ri.prototype.constructor=Ri,Di.prototype=Object.create(Ri.prototype),Di.prototype.constructor=Di,zi.prototype=Object.create(Se.prototype),zi.prototype.constructor=zi,Oi.prototype=Object.create(Ri.prototype),Oi.prototype.constructor=Oi,Fi.prototype=Object.create(Se.prototype),Fi.prototype.constructor=Fi,Ni.prototype=Object.create(Ri.prototype),Ni.prototype.constructor=Ni,Bi.prototype=Object.create(Se.prototype),Bi.prototype.constructor=Bi,Ui.prototype=Object.create(Ri.prototype),Ui.prototype.constructor=Ui,Hi.prototype=Object.create(Se.prototype),Hi.prototype.constructor=Hi,Gi.prototype=Object.create(Se.prototype),Gi.prototype.constructor=Gi,ji.prototype=Object.create(Pe.prototype),ji.prototype.constructor=ji,Wi.prototype=Object.create(Se.prototype),Wi.prototype.constructor=Wi,Yi.prototype=Object.create(Pe.prototype),Yi.prototype.constructor=Yi,Vi.prototype=Object.create(Se.prototype),Vi.prototype.constructor=Vi,Xi.prototype=Object.create(Pe.prototype),Xi.prototype.constructor=Xi,qi.prototype=Object.create(Se.prototype),qi.prototype.constructor=qi;var Zc={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;e>r;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},triangulate:function(){function t(t,e,i,n,r,o){var a,s,l,c,h,u,d,p,f;if(s=t[o[e]].x,l=t[o[e]].y,c=t[o[i]].x,h=t[o[i]].y,u=t[o[n]].x,d=t[o[n]].y,0>=(c-s)*(d-l)-(h-l)*(u-s))return!1;var m,g,v,y,_,w,x,b,M,T,E,S,C,A,P;for(m=u-c,g=d-h,v=s-u,y=l-d,_=c-s,w=h-l,a=0;r>a;a++)if(p=t[o[a]].x,f=t[o[a]].y,!(p===s&&f===l||p===c&&f===h||p===u&&f===d)&&(x=p-s,b=f-l,M=p-c,T=f-h,E=p-u,S=f-d,P=m*T-g*M,C=_*b-w*x,A=v*S-y*E,P>=-Number.EPSILON&&A>=-Number.EPSILON&&C>=-Number.EPSILON))return!1;return!0}return function(e,i){var n=e.length;if(3>n)return null;var r,o,a,s=[],l=[],c=[];if(Zc.area(e)>0)for(o=0;n>o;o++)l[o]=o;else for(o=0;n>o;o++)l[o]=n-1-o;var h=n,u=2*h;for(o=h-1;h>2;){if(u--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),i?c:s;if(r=o,r>=h&&(r=0),o=r+1,o>=h&&(o=0),a=o+1,a>=h&&(a=0),t(e,r,o,a,h,l)){var d,p,f,m,g;for(d=l[r],p=l[o],f=l[a],s.push([e[d],e[p],e[f]]),c.push([l[r],l[o],l[a]]),m=o,g=o+1;h>g;m++,g++)l[m]=l[g];h--,u=2*h}}return i?c:s}}(),triangulateShape:function(t,e){function i(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function n(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function r(t,e,i,r,o){var a=e.x-t.x,s=e.y-t.y,l=r.x-i.x,c=r.y-i.y,h=t.x-i.x,u=t.y-i.y,d=s*l-a*c,p=s*h-a*u;if(Math.abs(d)>Number.EPSILON){var f;if(d>0){if(0>p||p>d)return[];if(f=c*h-l*u,0>f||f>d)return[]}else{if(p>0||d>p)return[];if(f=c*h-l*u,f>0||d>f)return[]}if(0===f)return!o||0!==p&&p!==d?[t]:[];if(f===d)return!o||0!==p&&p!==d?[e]:[];if(0===p)return[i];if(p===d)return[r];var m=f/d;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!==p||c*h!==l*u)return[];var g=0===a&&0===s,v=0===l&&0===c;if(g&&v)return t.x!==i.x||t.y!==i.y?[]:[t];if(g)return n(i,r,t)?[t]:[];if(v)return n(t,e,i)?[i]:[];var y,_,w,x,b,M,T,E;return 0!==a?(t.x<e.x?(y=t,w=t.x,_=e,x=e.x):(y=e,w=e.x,_=t,x=t.x),i.x<r.x?(b=i,T=i.x,M=r,E=r.x):(b=r,T=r.x,M=i,E=i.x)):(t.y<e.y?(y=t,w=t.y,_=e,x=e.y):(y=e,w=e.y,_=t,x=t.y),i.y<r.y?(b=i,T=i.y,M=r,E=r.y):(b=r,T=r.y,M=i,E=i.y)),T>=w?T>x?[]:x===T?o?[]:[b]:E>=x?[b,_]:[b,M]:w>E?[]:w===E?o?[]:[y]:E>=x?[y,_]:[y,M]}function o(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,a=i.x-t.x,s=i.y-t.y,l=n.x-t.x,c=n.y-t.y,h=r*s-o*a,u=r*c-o*l;if(Math.abs(h)>Number.EPSILON){var d=l*s-c*a;return h>0?u>=0&&d>=0:u>=0||d>=0}return u>0}function a(t,e){function i(t,e){var i=y.length-1,n=t-1;0>n&&(n=i);var r=t+1;r>i&&(r=0);var a=o(y[t],y[n],y[r],s[e]);if(!a)return!1;var l=s.length-1,c=e-1;0>c&&(c=l);var h=e+1;return h>l&&(h=0),a=o(s[e],s[c],s[h],y[t]),a?!0:!1}function n(t,e){var i,n,o;for(i=0;i<y.length;i++)if(n=i+1,n%=y.length,o=r(t,e,y[i],y[n],!0),o.length>0)return!0;return!1}function a(t,i){var n,o,a,s,l;for(n=0;n<_.length;n++)for(o=e[_[n]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,l=r(t,i,o[a],o[s],!0),l.length>0)return!0;return!1}for(var s,l,c,h,u,d,p,f,m,g,v,y=t.concat(),_=[],w=[],x=0,b=e.length;b>x;x++)_.push(x);for(var M=0,T=2*_.length;_.length>0;){if(T--,0>T){console.log("Infinite Loop! Holes left:"+_.length+", Probably Hole outside Shape!");break}for(c=M;c<y.length;c++){h=y[c],l=-1;for(var x=0;x<_.length;x++)if(d=_[x],p=h.x+":"+h.y+":"+d,void 0===w[p]){s=e[d];for(var E=0;E<s.length;E++)if(u=s[E],i(c,E)&&!n(h,u)&&!a(h,u)){l=E,_.splice(x,1),f=y.slice(0,c+1),m=y.slice(c),g=s.slice(l),v=s.slice(0,l+1),y=f.concat(g).concat(v).concat(m),M=c;break}if(l>=0)break;w[p]=!0}if(l>=0)break}}return y}i(t),e.forEach(i);for(var s,l,c,h,u,d,p={},f=t.concat(),m=0,g=e.length;g>m;m++)Array.prototype.push.apply(f,e[m]);for(s=0,l=f.length;l>s;s++)u=f[s].x+":"+f[s].y,void 0!==p[u]&&console.warn("THREE.ShapeUtils: Duplicate point",u,s),p[u]=s;var v=a(t,e),y=Zc.triangulate(v,!1);for(s=0,l=y.length;l>s;s++)for(h=y[s],c=0;3>c;c++)u=h[c].x+":"+h[c].y,d=p[u],void 0!==d&&(h[c]=d);return y.concat()},isClockWise:function(t){return Zc.area(t)<0},b2:function(){function t(t,e){var i=1-t;return i*i*e}function e(t,e){return 2*(1-t)*t*e}function i(t,e){return t*t*e}return function(n,r,o,a){return t(n,r)+e(n,o)+i(n,a)}}(),b3:function(){function t(t,e){var i=1-t;return i*i*i*e}function e(t,e){var i=1-t;return 3*i*i*t*e}function i(t,e){var i=1-t;return 3*i*t*t*e}function n(t,e){return t*t*t*e}return function(r,o,a,s,l){return t(r,o)+e(r,a)+i(r,s)+n(r,l)}}()};$i.prototype=Object.create(Se.prototype),$i.prototype.constructor=$i,$i.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;i>n;n++){var r=t[n];this.addShape(r,e)}},$i.prototype.addShape=function(t,e){function n(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,n){var r,o,a=1,s=t.x-e.x,l=t.y-e.y,c=n.x-t.x,h=n.y-t.y,u=s*s+l*l,d=s*h-l*c;if(Math.abs(d)>Number.EPSILON){var p=Math.sqrt(u),f=Math.sqrt(c*c+h*h),m=e.x-l/p,g=e.y+s/p,v=n.x-h/f,y=n.y+c/f,_=((v-m)*h-(y-g)*c)/(s*h-l*c);r=m+s*_-t.x,o=g+l*_-t.y;var w=r*r+o*o;if(2>=w)return new i(r,o);a=Math.sqrt(w/2)}else{var x=!1;s>Number.EPSILON?c>Number.EPSILON&&(x=!0):s<-Number.EPSILON?c<-Number.EPSILON&&(x=!0):Math.sign(l)===Math.sign(h)&&(x=!0),x?(r=-l,o=s,a=Math.sqrt(u)):(r=s,o=l,a=Math.sqrt(u/2))}return new i(r/a,o/a)}function o(){if(x){var t=0,e=W*t;for(X=0;Y>X;X++)j=O[X],h(j[2]+e,j[1]+e,j[0]+e);for(t=M+2*w,e=W*t,X=0;Y>X;X++)j=O[X],h(j[0]+e,j[1]+e,j[2]+e)}else{for(X=0;Y>X;X++)j=O[X],h(j[2],j[1],j[0]);for(X=0;Y>X;X++)j=O[X],h(j[0]+W*M,j[1]+W*M,j[2]+W*M)}}function a(){var t=0;for(s(F,t),t+=F.length,A=0,P=D.length;P>A;A++)C=D[A],s(C,t),t+=C.length}function s(t,e){var i,n;for(X=t.length;--X>=0;){i=X,n=X-1,0>n&&(n=t.length-1);var r=0,o=M+2*w;for(r=0;o>r;r++){var a=W*r,s=W*(r+1),l=e+i+a,c=e+n+a,h=e+n+s,d=e+i+s;u(l,c,h,d,t,r,o,i,n)}}}function l(t,e,i){L.vertices.push(new c(t,e,i))}function h(t,e,i){t+=k,e+=k,i+=k,L.faces.push(new pe(t,e,i,null,null,0));var n=S.generateTopUV(L,t,e,i);L.faceVertexUvs[0].push(n)
}function u(t,e,i,n){t+=k,e+=k,i+=k,n+=k,L.faces.push(new pe(t,e,n,null,null,1)),L.faces.push(new pe(e,i,n,null,null,1));var r=S.generateSideWallUV(L,t,e,i,n);L.faceVertexUvs[0].push([r[0],r[1],r[3]]),L.faceVertexUvs[0].push([r[1],r[2],r[3]])}var d,p,f,m,g,v=void 0!==e.amount?e.amount:100,y=void 0!==e.bevelThickness?e.bevelThickness:6,_=void 0!==e.bevelSize?e.bevelSize:y-2,w=void 0!==e.bevelSegments?e.bevelSegments:3,x=void 0!==e.bevelEnabled?e.bevelEnabled:!0,b=void 0!==e.curveSegments?e.curveSegments:12,M=void 0!==e.steps?e.steps:1,T=e.extrudePath,E=!1,S=void 0!==e.UVGenerator?e.UVGenerator:$i.WorldUVGenerator;T&&(d=T.getSpacedPoints(M),E=!0,x=!1,p=void 0!==e.frames?e.frames:T.computeFrenetFrames(M,!1),f=new c,m=new c,g=new c),x||(w=0,y=0,_=0);var C,A,P,L=this,k=this.vertices.length,I=t.extractPoints(b),R=I.shape,D=I.holes,z=!Zc.isClockWise(R);if(z){for(R=R.reverse(),A=0,P=D.length;P>A;A++)C=D[A],Zc.isClockWise(C)&&(D[A]=C.reverse());z=!1}var O=Zc.triangulateShape(R,D),F=R;for(A=0,P=D.length;P>A;A++)C=D[A],R=R.concat(C);for(var N,B,U,H,G,j,W=R.length,Y=O.length,V=[],X=0,q=F.length,$=q-1,Z=X+1;q>X;X++,$++,Z++)$===q&&($=0),Z===q&&(Z=0),V[X]=r(F[X],F[$],F[Z]);var Q,K=[],J=V.concat();for(A=0,P=D.length;P>A;A++){for(C=D[A],Q=[],X=0,q=C.length,$=q-1,Z=X+1;q>X;X++,$++,Z++)$===q&&($=0),Z===q&&(Z=0),Q[X]=r(C[X],C[$],C[Z]);K.push(Q),J=J.concat(Q)}for(N=0;w>N;N++){for(U=N/w,H=y*Math.cos(U*Math.PI/2),B=_*Math.sin(U*Math.PI/2),X=0,q=F.length;q>X;X++)G=n(F[X],V[X],B),l(G.x,G.y,-H);for(A=0,P=D.length;P>A;A++)for(C=D[A],Q=K[A],X=0,q=C.length;q>X;X++)G=n(C[X],Q[X],B),l(G.x,G.y,-H)}for(B=_,X=0;W>X;X++)G=x?n(R[X],J[X],B):R[X],E?(m.copy(p.normals[0]).multiplyScalar(G.x),f.copy(p.binormals[0]).multiplyScalar(G.y),g.copy(d[0]).add(m).add(f),l(g.x,g.y,g.z)):l(G.x,G.y,0);var te;for(te=1;M>=te;te++)for(X=0;W>X;X++)G=x?n(R[X],J[X],B):R[X],E?(m.copy(p.normals[te]).multiplyScalar(G.x),f.copy(p.binormals[te]).multiplyScalar(G.y),g.copy(d[te]).add(m).add(f),l(g.x,g.y,g.z)):l(G.x,G.y,v/M*te);for(N=w-1;N>=0;N--){for(U=N/w,H=y*Math.cos(U*Math.PI/2),B=_*Math.sin(U*Math.PI/2),X=0,q=F.length;q>X;X++)G=n(F[X],V[X],B),l(G.x,G.y,v+H);for(A=0,P=D.length;P>A;A++)for(C=D[A],Q=K[A],X=0,q=C.length;q>X;X++)G=n(C[X],Q[X],B),E?l(G.x,G.y+d[M-1].y,d[M-1].x+H):l(G.x,G.y,v+H)}o(),a()},$i.WorldUVGenerator={generateTopUV:function(t,e,n,r){var o=t.vertices,a=o[e],s=o[n],l=o[r];return[new i(a.x,a.y),new i(s.x,s.y),new i(l.x,l.y)]},generateSideWallUV:function(t,e,n,r,o){var a=t.vertices,s=a[e],l=a[n],c=a[r],h=a[o];return Math.abs(s.y-l.y)<.01?[new i(s.x,1-s.z),new i(l.x,1-l.z),new i(c.x,1-c.z),new i(h.x,1-h.z)]:[new i(s.y,1-s.z),new i(l.y,1-l.z),new i(c.y,1-c.z),new i(h.y,1-h.z)]}},Zi.prototype=Object.create($i.prototype),Zi.prototype.constructor=Zi,Qi.prototype=Object.create(Pe.prototype),Qi.prototype.constructor=Qi,Ki.prototype=Object.create(Se.prototype),Ki.prototype.constructor=Ki,Ji.prototype=Object.create(Pe.prototype),Ji.prototype.constructor=Ji,tn.prototype=Object.create(Se.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(Se.prototype),en.prototype.constructor=en,nn.prototype=Object.create(Pe.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(Se.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(Se.prototype),on.prototype.constructor=on,on.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;n>i;i++)this.addShape(t[i],e);return this},on.prototype.addShape=function(t,e){void 0===e&&(e={});var i,n,r,o=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,s=void 0===e.UVGenerator?$i.WorldUVGenerator:e.UVGenerator,l=this.vertices.length,h=t.extractPoints(o),u=h.shape,d=h.holes,p=!Zc.isClockWise(u);if(p){for(u=u.reverse(),i=0,n=d.length;n>i;i++)r=d[i],Zc.isClockWise(r)&&(d[i]=r.reverse());p=!1}var f=Zc.triangulateShape(u,d);for(i=0,n=d.length;n>i;i++)r=d[i],u=u.concat(r);var m,g,v=u.length,y=f.length;for(i=0;v>i;i++)m=u[i],this.vertices.push(new c(m.x,m.y,0));for(i=0;y>i;i++){g=f[i];var _=g[0]+l,w=g[1]+l,x=g[2]+l;this.faces.push(new pe(_,w,x,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,_,w,x))}},an.prototype=Object.create(Pe.prototype),an.prototype.constructor=an,sn.prototype=Object.create(Pe.prototype),sn.prototype.constructor=sn,ln.prototype=Object.create(Se.prototype),ln.prototype.constructor=ln,cn.prototype=Object.create(ln.prototype),cn.prototype.constructor=cn,hn.prototype=Object.create(sn.prototype),hn.prototype.constructor=hn,un.prototype=Object.create(Pe.prototype),un.prototype.constructor=un,dn.prototype=Object.create(Se.prototype),dn.prototype.constructor=dn,pn.prototype=Object.create(Se.prototype),pn.prototype.constructor=pn;var Qc=Object.freeze({WireframeGeometry:Li,ParametricGeometry:Ii,ParametricBufferGeometry:ki,TetrahedronGeometry:zi,TetrahedronBufferGeometry:Di,OctahedronGeometry:Fi,OctahedronBufferGeometry:Oi,IcosahedronGeometry:Bi,IcosahedronBufferGeometry:Ni,DodecahedronGeometry:Hi,DodecahedronBufferGeometry:Ui,PolyhedronGeometry:Gi,PolyhedronBufferGeometry:Ri,TubeGeometry:Wi,TubeBufferGeometry:ji,TorusKnotGeometry:Vi,TorusKnotBufferGeometry:Yi,TorusGeometry:qi,TorusBufferGeometry:Xi,TextGeometry:Zi,SphereBufferGeometry:Qi,SphereGeometry:Ki,RingGeometry:tn,RingBufferGeometry:Ji,PlaneBufferGeometry:Ie,PlaneGeometry:en,LatheGeometry:rn,LatheBufferGeometry:nn,ShapeGeometry:on,ExtrudeGeometry:$i,EdgesGeometry:an,ConeGeometry:cn,ConeBufferGeometry:hn,CylinderGeometry:ln,CylinderBufferGeometry:sn,CircleBufferGeometry:un,CircleGeometry:dn,BoxBufferGeometry:ke,BoxGeometry:pn});fn.prototype=Object.create(K.prototype),fn.prototype.constructor=fn,fn.prototype.isShadowMaterial=!0,mn.prototype=Object.create(K.prototype),mn.prototype.constructor=mn,mn.prototype.isRawShaderMaterial=!0,gn.prototype={constructor:gn,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,n=0,r=i.length;r>n;n++){var o=i[n].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},vn.prototype=Object.create(Z.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshStandardMaterial=!0,vn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yn.prototype=Object.create(vn.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshPhysicalMaterial=!0,yn.prototype.copy=function(t){return vn.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},_n.prototype=Object.create(Z.prototype),_n.prototype.constructor=_n,_n.prototype.isMeshPhongMaterial=!0,_n.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},wn.prototype=Object.create(Z.prototype),wn.prototype.constructor=wn,wn.prototype.isMeshNormalMaterial=!0,wn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},xn.prototype=Object.create(Z.prototype),xn.prototype.constructor=xn,xn.prototype.isMeshLambertMaterial=!0,xn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},bn.prototype=Object.create(Z.prototype),bn.prototype.constructor=bn,bn.prototype.isLineDashedMaterial=!0,bn.prototype.copy=function(t){return Z.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Kc=Object.freeze({ShadowMaterial:fn,SpriteMaterial:pi,RawShaderMaterial:mn,ShaderMaterial:K,PointsMaterial:Mi,MultiMaterial:gn,MeshPhysicalMaterial:yn,MeshStandardMaterial:vn,MeshPhongMaterial:_n,MeshNormalMaterial:wn,MeshLambertMaterial:xn,MeshDepthMaterial:J,MeshBasicMaterial:fe,LineDashedMaterial:bn,LineBasicMaterial:wi,Material:Z}),Jc={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){return this.enabled!==!1?this.files[t]:void 0},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},th=new Mn;Object.assign(Tn.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=Jc.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=/^data:(.*?)(;base64)?,(.*)$/,s=t.match(a);if(s){var l=s[1],c=!!s[2],h=s[3];h=window.decodeURIComponent(h),c&&(h=window.atob(h));try{var u,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":u=new ArrayBuffer(h.length);for(var p=new Uint8Array(u),f=0;f<h.length;f++)p[f]=h.charCodeAt(f);"blob"===d&&(u=new Blob([u],{type:l}));break;case"document":var m=new DOMParser;u=m.parseFromString(h,l);break;case"json":u=JSON.parse(h);break;default:u=h}window.setTimeout(function(){e&&e(u),r.manager.itemEnd(t)},0)}catch(g){window.setTimeout(function(){n&&n(g),r.manager.itemError(t)},0)}}else{var v=new XMLHttpRequest;v.open("GET",t,!0),v.addEventListener("load",function(i){var o=i.target.response;Jc.add(t,o),200===this.status?(e&&e(o),r.manager.itemEnd(t)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),e&&e(o),r.manager.itemEnd(t)):(n&&n(i),r.manager.itemError(t))},!1),void 0!==i&&v.addEventListener("progress",function(t){i(t)},!1),v.addEventListener("error",function(e){n&&n(e),r.manager.itemError(t)},!1),void 0!==this.responseType&&(v.responseType=this.responseType),void 0!==this.withCredentials&&(v.withCredentials=this.withCredentials),v.overrideMimeType&&v.overrideMimeType("text/plain"),v.send(null)}return r.manager.itemStart(t),v},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this}}),Object.assign(En.prototype,{load:function(t,e,i,n){function r(r){l.load(t[r],function(t){var i=o._parser(t,!0);a[r]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},c+=1,6===c&&(1===i.mipmapCount&&(s.minFilter=Oa),s.format=i.format,s.needsUpdate=!0,e&&e(s))},i,n)}var o=this,a=[],s=new Ci;s.image=a;var l=new Tn(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,h=0,u=t.length;u>h;++h)r(h);else l.load(t,function(t){var i=o._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,r=0;n>r;r++){a[r]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)a[r].mipmaps.push(i.mipmaps[r*i.mipmapCount+l]),a[r].format=i.format,a[r].width=i.width,a[r].height=i.height}else s.image.width=i.width,s.image.height=i.height,s.mipmaps=i.mipmaps;1===i.mipmapCount&&(s.minFilter=Oa),s.format=i.format,s.needsUpdate=!0,e&&e(s)},i,n);return s},setPath:function(t){return this.path=t,this}});var eh=Sn;Object.assign(Sn.prototype,{load:function(t,e,i,n){var r=this,o=new gi,a=new Tn(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var i=r._parser(t);i&&(void 0!==i.image?o.image=i.image:void 0!==i.data&&(o.image.width=i.width,o.image.height=i.height,o.image.data=i.data),o.wrapS=void 0!==i.wrapS?i.wrapS:La,o.wrapT=void 0!==i.wrapT?i.wrapT:La,o.magFilter=void 0!==i.magFilter?i.magFilter:Oa,o.minFilter=void 0!==i.minFilter?i.minFilter:Na,o.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(o.format=i.format),void 0!==i.type&&(o.type=i.type),void 0!==i.mipmaps&&(o.mipmaps=i.mipmaps),1===i.mipmapCount&&(o.minFilter=Oa),o.needsUpdate=!0,e&&e(o,i))},i,n),o}}),Object.assign(Cn.prototype,{load:function(t,e,i,n){var r=this,o=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(o.onload=function(){o.onload=null,URL.revokeObjectURL(o.src),e&&e(o),r.manager.itemEnd(t)},o.onerror=n,0===t.indexOf("data:"))o.src=t;else{var a=new Tn;a.setPath(this.path),a.setResponseType("blob"),a.setWithCredentials(this.withCredentials),a.load(t,function(t){o.src=URL.createObjectURL(t)},i,n)}return r.manager.itemStart(t),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(An.prototype,{load:function(t,e,i,n){function r(i){a.load(t[i],function(t){o.images[i]=t,s++,6===s&&(o.needsUpdate=!0,e&&e(o))},void 0,n)}var o=new u,a=new Cn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var s=0,l=0;l<t.length;++l)r(l);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Pn.prototype,{load:function(t,e,i,r){var o=new n,a=new Cn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setWithCredentials(this.withCredentials),a.setPath(this.path),a.load(t,function(i){var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);o.format=n?Ja:ts,o.image=i,o.needsUpdate=!0,void 0!==e&&e(o)},i,r),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Ln.prototype=Object.assign(Object.create(ce.prototype),{constructor:Ln,isLight:!0,copy:function(t){return ce.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=ce.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),kn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:kn,isHemisphereLight:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(In.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Rn.prototype=Object.assign(Object.create(In.prototype),{constructor:Rn,isSpotLightShadow:!0,update:function(t){var e=2*Fs.RAD2DEG*t.angle,i=this.mapSize.width/this.mapSize.height,n=t.distance||500,r=this.camera;(e!==r.fov||i!==r.aspect||n!==r.far)&&(r.fov=e,r.aspect=i,r.far=n,r.updateProjectionMatrix())}}),Dn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Dn,isSpotLight:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),zn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:zn,isPointLight:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),On.prototype=Object.assign(Object.create(In.prototype),{constructor:On}),Fn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Fn,isDirectionalLight:!0,copy:function(t){return Ln.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Nn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Nn,isAmbientLight:!0});var ih={arraySlice:function(t,e,i){return ih.isTypedArray(t)?new t.constructor(t.subarray(e,i)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,i){return t[e]-t[i]}for(var i=t.length,n=new Array(i),r=0;r!==i;++r)n[r]=r;return n.sort(e),n},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),o=0,a=0;a!==n;++o)for(var s=i[o]*e,l=0;l!==e;++l)r[a++]=t[s+l];return r},flattenJSON:function(t,e,i,n){for(var r=1,o=t[0];void 0!==o&&void 0===o[n];)o=t[r++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a)){do a=o[n],void 0!==a&&(e.push(o.time),i.push.apply(i,a)),o=t[r++];while(void 0!==o)}else if(void 0!==a.toArray){do a=o[n],void 0!==a&&(e.push(o.time),a.toArray(i,i.length)),o=t[r++];while(void 0!==o)}else do a=o[n],void 0!==a&&(e.push(o.time),i.push(a)),o=t[r++];while(void 0!==o)}}};Bn.prototype={constructor:Bn,evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var o;i:{n:if(!(n>t)){for(var a=i+2;;){if(void 0===n){if(r>t)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===a)break;if(r=n,n=e[++i],n>t)break e}o=e.length;break i}{if(t>=r)break t;var s=e[1];s>t&&(i=2,r=s);for(var a=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===a)break;if(n=r,r=e[--i-1],t>=r)break e}o=i,i=0}}for(;o>i;){var l=i+o>>>1;t<e[l]?o=l:i=l+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,o=0;o!==n;++o)e[o]=i[r+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}},Object.assign(Bn.prototype,{beforeStart_:Bn.prototype.copySampleValue_,afterEnd_:Bn.prototype.copySampleValue_}),Un.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Un,DefaultSettings_:{endingStart:xs,endingEnd:xs},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,o=t+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case bs:r=t,a=2*e-i;break;case Ms:r=n.length-2,a=e+n[r]-n[r+1];break;default:r=t,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case bs:o=t,s=2*i-e;break;case Ms:o=1,s=i+n[1]-n[0];break;default:o=t-1,s=e}var l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=o*c},interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f,w=0;w!==a;++w)r[w]=g*o[c+w]+v*o[l+w]+y*o[s+w]+_*o[h+w];return r}}),Hn.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Hn,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(i-e)/(n-e),h=1-c,u=0;u!==a;++u)r[u]=o[l+u]*h+o[s+u]*c;return r}}),Gn.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Gn,interpolate_:function(t){return this.copySampleValue_(t-1)}});var nh;nh={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:_s,InterpolantFactoryMethodDiscrete:function(t){return new Gn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Hn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Un(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case ys:e=this.InterpolantFactoryMethodDiscrete;break;case _s:e=this.InterpolantFactoryMethodLinear;break;case ws:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return void console.warn(i)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ys;case this.InterpolantFactoryMethodLinear:return _s;case this.InterpolantFactoryMethodSmooth:return ws}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,o=n-1;r!==n&&i[r]<t;)++r;for(;-1!==o&&i[o]>e;)--o;if(++o,0!==r||o!==n){r>=o&&(o=Math.max(o,1),r=o-1);var a=this.getValueSize();this.times=ih.arraySlice(i,r,o),this.values=ih.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("invalid value size in track",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("track is empty",this),t=!1);for(var o=null,a=0;a!==r;a++){var s=i[a];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("out of order keys",this,a,s,o),t=!1;break}o=s}if(void 0!==n&&ih.isTypedArray(n))for(var a=0,l=n.length;a!==l;++a){var c=n[a];if(isNaN(c)){console.error("value is not a valid number",this,a,c),t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=this.getInterpolation()===ws,r=1,o=t.length-1,a=1;o>a;++a){var s=!1,l=t[a],c=t[a+1];if(l!==c&&(1!==a||l!==l[0]))if(n)s=!0;else for(var h=a*i,u=h-i,d=h+i,p=0;p!==i;++p){var f=e[h+p];if(f!==e[u+p]||f!==e[d+p]){s=!0;break}}if(s){if(a!==r){t[r]=t[a];for(var m=a*i,g=r*i,p=0;p!==i;++p)e[g+p]=e[m+p]}++r}}if(o>0){t[r]=t[o];for(var m=o*i,g=r*i,p=0;p!==i;++p)e[g+p]=e[m+p];++r}return r!==t.length&&(this.times=ih.arraySlice(t,0,r),this.values=ih.arraySlice(e,0,r*i)),this}},Wn.prototype=Object.assign(Object.create(nh),{constructor:Wn,ValueTypeName:"vector"}),Yn.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Yn,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(i-e)/(n-e),h=s+a;s!==h;s+=4)l.slerpFlat(r,0,o,s-a,o,s,c);return r}}),Vn.prototype=Object.assign(Object.create(nh),{constructor:Vn,ValueTypeName:"quaternion",DefaultInterpolation:_s,InterpolantFactoryMethodLinear:function(t){return new Yn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Xn.prototype=Object.assign(Object.create(nh),{constructor:Xn,ValueTypeName:"number"}),qn.prototype=Object.assign(Object.create(nh),{constructor:qn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ys,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),$n.prototype=Object.assign(Object.create(nh),{constructor:$n,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ys,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Zn.prototype=Object.assign(Object.create(nh),{constructor:Zn,ValueTypeName:"color"}),Qn.prototype=nh,nh.constructor=Qn,Object.assign(Qn,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=Qn._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];ih.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:ih.convertArray(t.times,Array),values:ih.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xn;case"vector":case"vector2":case"vector3":case"vector4":return Wn;case"color":return Zn;case"quaternion":return Vn;case"bool":case"boolean":return $n;case"string":return qn}throw new Error("Unsupported typeName: "+t)}}),Kn.prototype={constructor:Kn,resetDuration:function(){for(var t=this.tracks,e=0,i=0,n=t.length;i!==n;++i){var r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Kn,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,o=i.length;r!==o;++r)e.push(Qn.parse(i[r]).scale(n));return new Kn(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e},r=0,o=i.length;r!==o;++r)e.push(Qn.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,o=[],a=0;r>a;a++){var s=[],l=[];s.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);var c=ih.getKeyframeOrder(s);s=ih.sortedArray(s,1,c),l=ih.sortedArray(l,1,c),n||0!==s[0]||(s.push(r),l.push(l[0])),o.push(new Xn(".morphTargetInfluences["+e[a].name+"]",s,l).scale(1/i))}return new Kn(t,-1,o)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;a>o;o++){var s=t[o],l=s.name.match(r);if(l&&l.length>1){var c=l[1],h=n[c];h||(n[c]=h=[]),h.push(s)}}var u=[];for(var c in n)u.push(Kn.CreateFromMorphTargetSequence(c,n[c],e,i));return u},parseAnimation:function(t,e){if(!t)return console.error("  no animation in JSONLoader data"),null;for(var i=function(t,e,i,n,r){if(0!==i.length){var o=[],a=[];ih.flattenJSON(i,o,a,n),0!==o.length&&r.push(new t(e,o,a))}},n=[],r=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var d=0;d<c[u].morphTargets.length;d++)h[c[u].morphTargets[d]]=-1;for(var p in h){for(var f=[],m=[],d=0;d!==c[u].morphTargets.length;++d){var g=c[u];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new Xn(".morphTargetInfluence["+p+"]",f,m))}o=h.length*(a||1)}else{var v=".bones["+e[l].name+"]";i(Wn,v+".position",c,"pos",n),i(Vn,v+".quaternion",c,"rot",n),i(Wn,v+".scale",c,"scl",n)}}if(0===n.length)return null;var y=new Kn(r,o,n);return y}}),Object.assign(Jn.prototype,{load:function(t,e,i,n){var r=this,o=new Tn(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,r=new Kc[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.shading&&(r.shading=t.shading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=(new i).fromArray(o)}if(void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var a=0,s=t.materials.length;s>a;a++)r.materials.push(this.parse(t.materials[a]));return r}}),Object.assign(tr.prototype,{load:function(t,e,i,n){var r=this,o=new Tn(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new Pe,i=t.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};
if(void 0!==i){var r=new n[i.type](i.array);e.setIndex(new me(r,1))}var o=t.data.attributes;for(var a in o){var s=o[a],r=new n[s.type](s.array);e.addAttribute(a,new me(r,s.itemSize,s.normalized))}var l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(var h=0,u=l.length;h!==u;++h){var d=l[h];e.addGroup(d.start,d.count,d.materialIndex)}var p=t.data.boundingSphere;if(void 0!==p){var f=new c;void 0!==p.center&&f.fromArray(p.center),e.boundingSphere=new ee(f,p.radius)}return e}}),er.prototype={constructor:er,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:function(){var t,e,i;return function(n,r,o){function a(t,i,n,a,l){var c,h=r+t,u=er.Handlers.get(h);null!==u?c=u.load(h):(e.setCrossOrigin(o),c=e.load(h)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=Pa),1!==i[1]&&(c.wrapT=Pa)),void 0!==n&&c.offset.fromArray(n),void 0!==a&&("repeat"===a[0]&&(c.wrapS=Pa),"mirror"===a[0]&&(c.wrapS=ka),"repeat"===a[1]&&(c.wrapT=Pa),"mirror"===a[1]&&(c.wrapT=ka)),void 0!==l&&(c.anisotropy=l);var d=Fs.generateUUID();return s[d]=c,d}void 0===t&&(t=new V),void 0===e&&(e=new Pn),void 0===i&&(i=new Jn);var s={},l={uuid:Fs.generateUUID(),type:"MeshLambertMaterial"};for(var c in n){var h=n[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=h;break;case"blending":l.blending=Ho[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":l.color=t.fromArray(h).getHex();break;case"colorSpecular":l.specular=t.fromArray(h).getHex();break;case"colorEmissive":l.emissive=t.fromArray(h).getHex();break;case"specularCoef":l.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=a(h,n.mapDiffuseRepeat,n.mapDiffuseOffset,n.mapDiffuseWrap,n.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=a(h,n.mapEmissiveRepeat,n.mapEmissiveOffset,n.mapEmissiveWrap,n.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=a(h,n.mapLightRepeat,n.mapLightOffset,n.mapLightWrap,n.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=a(h,n.mapAORepeat,n.mapAOOffset,n.mapAOWrap,n.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=a(h,n.mapBumpRepeat,n.mapBumpOffset,n.mapBumpWrap,n.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=a(h,n.mapNormalRepeat,n.mapNormalOffset,n.mapNormalWrap,n.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=[h,h];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=a(h,n.mapSpecularRepeat,n.mapSpecularOffset,n.mapSpecularWrap,n.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=a(h,n.mapMetalnessRepeat,n.mapMetalnessOffset,n.mapMetalnessWrap,n.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=a(h,n.mapRoughnessRepeat,n.mapRoughnessOffset,n.mapRoughnessWrap,n.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=a(h,n.mapAlphaRepeat,n.mapAlphaOffset,n.mapAlphaWrap,n.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=Ao;break;case"doubleSided":l.side=Po;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[c]=h;break;case"vertexColors":h===!0&&(l.vertexColors=Do),"face"===h&&(l.vertexColors=Ro);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,h)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),i.setTextures(s),i.parse(l)}}()},er.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;n>i;i+=2){var r=e[i],o=e[i+1];if(r.test(t))return o}return null}},Object.assign(ir.prototype,{load:function(t,e,i,n){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:er.prototype.extractUrlBase(t),a=new Tn(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(i){var n=JSON.parse(i),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var l=r.parse(n,o);e(l.geometry,l.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function n(e){function n(t,e){return t&1<<e}var r,o,a,s,h,u,d,p,f,m,g,v,y,_,w,x,b,M,T,E,S,C,A,P,L,k,I,R=t.faces,D=t.vertices,z=t.normals,O=t.colors,F=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&F++;for(r=0;F>r;r++)l.faceVertexUvs[r]=[]}for(s=0,h=D.length;h>s;)M=new c,M.x=D[s++]*e,M.y=D[s++]*e,M.z=D[s++]*e,l.vertices.push(M);for(s=0,h=R.length;h>s;)if(m=R[s++],g=n(m,0),v=n(m,1),y=n(m,3),_=n(m,4),w=n(m,5),x=n(m,6),b=n(m,7),g){if(E=new pe,E.a=R[s],E.b=R[s+1],E.c=R[s+3],S=new pe,S.a=R[s+1],S.b=R[s+2],S.c=R[s+3],s+=4,v&&(f=R[s++],E.materialIndex=f,S.materialIndex=f),a=l.faces.length,y)for(r=0;F>r;r++)for(P=t.uvs[r],l.faceVertexUvs[r][a]=[],l.faceVertexUvs[r][a+1]=[],o=0;4>o;o++)p=R[s++],k=P[2*p],I=P[2*p+1],L=new i(k,I),2!==o&&l.faceVertexUvs[r][a].push(L),0!==o&&l.faceVertexUvs[r][a+1].push(L);if(_&&(d=3*R[s++],E.normal.set(z[d++],z[d++],z[d]),S.normal.copy(E.normal)),w)for(r=0;4>r;r++)d=3*R[s++],A=new c(z[d++],z[d++],z[d]),2!==r&&E.vertexNormals.push(A),0!==r&&S.vertexNormals.push(A);if(x&&(u=R[s++],C=O[u],E.color.setHex(C),S.color.setHex(C)),b)for(r=0;4>r;r++)u=R[s++],C=O[u],2!==r&&E.vertexColors.push(new V(C)),0!==r&&S.vertexColors.push(new V(C));l.faces.push(E),l.faces.push(S)}else{if(T=new pe,T.a=R[s++],T.b=R[s++],T.c=R[s++],v&&(f=R[s++],T.materialIndex=f),a=l.faces.length,y)for(r=0;F>r;r++)for(P=t.uvs[r],l.faceVertexUvs[r][a]=[],o=0;3>o;o++)p=R[s++],k=P[2*p],I=P[2*p+1],L=new i(k,I),l.faceVertexUvs[r][a].push(L);if(_&&(d=3*R[s++],T.normal.set(z[d++],z[d++],z[d])),w)for(r=0;3>r;r++)d=3*R[s++],A=new c(z[d++],z[d++],z[d]),T.vertexNormals.push(A);if(x&&(u=R[s++],T.color.setHex(O[u])),b)for(r=0;3>r;r++)u=R[s++],T.vertexColors.push(new V(O[u]));l.faces.push(T)}}function r(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,n=t.skinWeights.length;n>i;i+=e){var r=t.skinWeights[i],a=e>1?t.skinWeights[i+1]:0,s=e>2?t.skinWeights[i+2]:0,c=e>3?t.skinWeights[i+3]:0;l.skinWeights.push(new o(r,a,s,c))}if(t.skinIndices)for(var i=0,n=t.skinIndices.length;n>i;i+=e){var h=t.skinIndices[i],u=e>1?t.skinIndices[i+1]:0,d=e>2?t.skinIndices[i+2]:0,p=e>3?t.skinIndices[i+3]:0;l.skinIndices.push(new o(h,u,d,p))}l.bones=t.bones,l.bones&&l.bones.length>0&&(l.skinWeights.length!==l.skinIndices.length||l.skinIndices.length!==l.vertices.length)&&console.warn("When skinning, number of vertices ("+l.vertices.length+"), skinIndices ("+l.skinIndices.length+"), and skinWeights ("+l.skinWeights.length+") should match.")}function a(e){if(void 0!==t.morphTargets)for(var i=0,n=t.morphTargets.length;n>i;i++){l.morphTargets[i]={},l.morphTargets[i].name=t.morphTargets[i].name,l.morphTargets[i].vertices=[];for(var r=l.morphTargets[i].vertices,o=t.morphTargets[i].vertices,a=0,s=o.length;s>a;a+=3){var h=new c;h.x=o[a]*e,h.y=o[a+1]*e,h.z=o[a+2]*e,r.push(h)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var u=l.faces,d=t.morphColors[0].colors,i=0,n=u.length;n>i;i++)u[i].color.fromArray(d,3*i)}}function s(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var n=0;n<i.length;n++){var r=Kn.parseAnimation(i[n],l.bones);r&&e.push(r)}if(l.morphTargets){var o=Kn.CreateClipsFromMorphTargetSequences(l.morphTargets,10);e=e.concat(o)}e.length>0&&(l.animations=e)}var l=new Se,h=void 0!==t.scale?1/t.scale:1;if(n(h),r(),a(h),s(),l.computeFaceNormals(),l.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:l};var u=er.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:l,materials:u}}}),Object.assign(nr.prototype,{load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this,o=new Tn(r.manager);o.load(t,function(t){r.parse(JSON.parse(t),e)},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),n=this.parseImages(t.images,function(){void 0!==e&&e(a)}),r=this.parseTextures(t.textures,n),o=this.parseMaterials(t.materials,r),a=this.parseObject(t.object,i,o);return t.animations&&(a.animations=this.parseAnimations(t.animations)),(void 0===t.images||0===t.images.length)&&void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new ir,n=new tr,r=0,o=t.length;o>r;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Qc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Qc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Qc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Qc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Qc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Qc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new Qc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Qc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Qc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Qc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Qc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=i.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new Jn;n.setTextures(e);for(var r=0,o=t.length;o>r;r++){var a=n.parse(t[r]);i[a.uuid]=a}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=Kn.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){function i(t){return n.manager.itemStart(t),a.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t)})}var n=this,r={};if(void 0!==t&&t.length>0){var o=new Mn(e),a=new Cn(o);a.setCrossOrigin(this.crossOrigin);for(var s=0,l=t.length;l>s;s++){var c=t[s],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;r[c.uuid]=i(h)}}return r},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var o=0,a=t.length;a>o;o++){var s=t[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var l=new n(e[s.image]);l.needsUpdate=!0,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=i(s.mapping,Aa)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.wrap&&(l.wrapS=i(s.wrap[0],Ia),l.wrapT=i(s.wrap[1],Ia)),void 0!==s.minFilter&&(l.minFilter=i(s.minFilter,Ba)),void 0!==s.magFilter&&(l.magFilter=i(s.magFilter,Ba)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),r[s.uuid]=l}return r},parseObject:function(){var t=new h;return function(e,i,n){function r(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),i[t]}function o(t){return void 0===t?void 0:(void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t])}var a;switch(e.type){case"Scene":a=new ui,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new V(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new hi(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new ci(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new De(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new ze(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new Nn(e.color,e.intensity);break;case"DirectionalLight":a=new Fn(e.color,e.intensity);break;case"PointLight":a=new zn(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new Dn(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new kn(e.color,e.groundColor,e.intensity);break;case"Mesh":var s=r(e.geometry),l=o(e.material);a=s.bones&&s.bones.length>0?new _i(s,l):new Le(s,l);break;case"LOD":a=new mi;break;case"Line":a=new xi(r(e.geometry),o(e.material),e.mode);break;case"LineSegments":a=new bi(r(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new Ti(r(e.geometry),o(e.material));break;case"Sprite":a=new fi(o(e.material));break;case"Group":a=new Ei;break;default:a=new ce}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var c in e.children)a.add(this.parseObject(e.children[c],i,n));if("LOD"===e.type)for(var h=e.levels,u=0;u<h.length;u++){var d=h[u],c=a.getObjectByProperty("uuid",d.object);void 0!==c&&a.addLevel(c,d.distance)}return a}}()}),rr.prototype={constructor:rr,getPoint:function(){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);for(var e=[],i=0;t>=i;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],i=0;t>=i;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),o+=e.distanceTo(r),n.push(o),r=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),r=0,o=n.length;i=e?e:t*n[o-1];for(var a,s=0,l=o-1;l>=s;)if(r=Math.floor(s+(l-s)/2),a=n[r]-i,0>a)s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,n[r]===i){var c=r/(o-1);return c}var h=n[r],u=n[r+1],d=u-h,p=(i-h)/d,c=(r+p)/(o-1);return c},getTangent:function(t){var e=1e-4,i=t-e,n=t+e;0>i&&(i=0),n>1&&(n=1);var r=this.getPoint(i),o=this.getPoint(n),a=o.clone().sub(r);return a.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var i,n,r,o=new c,a=[],s=[],l=[],u=new c,d=new h;for(i=0;t>=i;i++)n=i/t,a[i]=this.getTangentAt(n),a[i].normalize();s[0]=new c,l[0]=new c;var p=Number.MAX_VALUE,f=Math.abs(a[0].x),m=Math.abs(a[0].y),g=Math.abs(a[0].z);for(p>=f&&(p=f,o.set(1,0,0)),p>=m&&(p=m,o.set(0,1,0)),p>=g&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),i=1;t>=i;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),u.crossVectors(a[i-1],a[i]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(Fs.clamp(a[i-1].dot(a[i]),-1,1)),s[i].applyMatrix4(d.makeRotationAxis(u,r))),l[i].crossVectors(a[i],s[i]);if(e===!0)for(r=Math.acos(Fs.clamp(s[0].dot(s[t]),-1,1)),r/=t,a[0].dot(u.crossVectors(s[0],s[t]))>0&&(r=-r),i=1;t>=i;i++)s[i].applyMatrix4(d.makeRotationAxis(a[i],r*i)),l[i].crossVectors(a[i],s[i]);return{tangents:a,normals:s,binormals:l}}},rr.create=function(t,e){return t.prototype=Object.create(rr.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},or.prototype=Object.create(rr.prototype),or.prototype.constructor=or,or.prototype.isLineCurve=!0,or.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},or.prototype.getPointAt=function(t){return this.getPoint(t)},or.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},ar.prototype=Object.assign(Object.create(rr.prototype),{constructor:ar,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new or(e,t))},getPoint:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var r=i[n]-e,o=this.curves[n],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;n>i;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){t||(t=40);for(var e=[],i=0;t>=i;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var o=r[n],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),l=0;l<s.length;l++){var c=s[l];e&&e.equals(c)||(i.push(c),e=c)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new Se,i=0,n=t.length;n>i;i++){var r=t[i];e.vertices.push(new c(r.x,r.y,r.z||0))}return e}}),sr.prototype=Object.create(rr.prototype),sr.prototype.constructor=sr,sr.prototype.isEllipseCurve=!0,sr.prototype.getPoint=function(t){for(var e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;0>n;)n+=e;for(;n>e;)n-=e;n<Number.EPSILON&&(n=r?0:e),this.aClockwise!==!0||r||(n===e?n=-e:n-=e);var o=this.aStartAngle+t*n,a=this.aX+this.xRadius*Math.cos(o),s=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=a-this.aX,u=s-this.aY;a=h*l-u*c+this.aX,s=h*c+u*l+this.aY}return new i(a,s)};var rh={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,r){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*r},tangentSpline:function(t){var e=6*t*t-6*t,i=3*t*t-4*t+1,n=-6*t*t+6*t,r=3*t*t-2*t;return e+i+n+r},interpolate:function(t,e,i,n,r){var o=.5*(i-t),a=.5*(n-e),s=r*r,l=r*s;return(2*e-2*i+o+a)*l+(-3*e+3*i-2*o-a)*s+o*r+e}};lr.prototype=Object.create(rr.prototype),lr.prototype.constructor=lr,lr.prototype.isSplineCurve=!0,lr.prototype.getPoint=function(t){var e=this.points,n=(e.length-1)*t,r=Math.floor(n),o=n-r,a=e[0===r?r:r-1],s=e[r],l=e[r>e.length-2?e.length-1:r+1],c=e[r>e.length-3?e.length-1:r+2],h=rh.interpolate;return new i(h(a.x,s.x,l.x,c.x,o),h(a.y,s.y,l.y,c.y,o))},cr.prototype=Object.create(rr.prototype),cr.prototype.constructor=cr,cr.prototype.getPoint=function(t){var e=Zc.b3;return new i(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},cr.prototype.getTangent=function(t){var e=rh.tangentCubicBezier;return new i(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},hr.prototype=Object.create(rr.prototype),hr.prototype.constructor=hr,hr.prototype.getPoint=function(t){var e=Zc.b2;return new i(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},hr.prototype.getTangent=function(t){var e=rh.tangentQuadraticBezier;return new i(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()};var oh=Object.assign(Object.create(ar.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;i>e;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new or(this.currentPoint.clone(),new i(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var o=new hr(this.currentPoint.clone(),new i(t,e),new i(n,r));this.curves.push(o),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,o,a){var s=new cr(this.currentPoint.clone(),new i(t,e),new i(n,r),new i(o,a));this.curves.push(s),this.currentPoint.set(o,a)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),i=new lr(e);this.curves.push(i),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,i,n,r,o)},absarc:function(t,e,i,n,r,o){this.absellipse(t,e,i,i,n,r,o)},ellipse:function(t,e,i,n,r,o,a,s){var l=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(t+l,e+c,i,n,r,o,a,s)},absellipse:function(t,e,i,n,r,o,a,s){var l=new sr(t,e,i,n,r,o,a,s);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);this.currentPoint.copy(h)}});ur.prototype=Object.assign(Object.create(oh),{constructor:ur,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;n>i;i++)e[i]=this.holes[i].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),dr.prototype=oh,oh.constructor=dr,pr.prototype={moveTo:function(t,e){this.currentPath=new dr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,o){this.currentPath.bezierCurveTo(t,e,i,n,r,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i],o=new ur;o.curves=r.curves,e.push(o)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,o=0;i>o;r=o++){var a=e[r],s=e[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(0>c&&(a=e[o],l=-l,s=e[r],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var h=c*(t.x-a.x)-l*(t.y-a.y);if(0===h)return!0;if(0>h)continue;n=!n}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return n}var r=Zc.isClockWise,o=this.subPaths;if(0===o.length)return[];if(e===!0)return i(o);var a,s,l,c=[];if(1===o.length)return s=o[0],l=new ur,l.curves=s.curves,c.push(l),c;var h=!r(o[0].getPoints());h=t?!h:h;var u,d=[],p=[],f=[],m=0;p[m]=void 0,f[m]=[];for(var g=0,v=o.length;v>g;g++)s=o[g],u=s.getPoints(),a=r(u),a=t?!a:a,a?(!h&&p[m]&&m++,p[m]={s:new ur,p:u},p[m].s.curves=s.curves,h&&m++,f[m]=[]):f[m].push({h:s,p:u[0]});if(!p[0])return i(o);if(p.length>1){for(var y=!1,_=[],w=0,x=p.length;x>w;w++)d[w]=[];for(var w=0,x=p.length;x>w;w++)for(var b=f[w],M=0;M<b.length;M++){for(var T=b[M],E=!0,S=0;S<p.length;S++)n(T.p,p[S].p)&&(w!==S&&_.push({froms:w,tos:S,hole:M}),E?(E=!1,d[S].push(T)):y=!0);E&&d[w].push(T)}_.length>0&&(y||(f=d))}for(var C,g=0,A=p.length;A>g;g++){l=p[g].s,c.push(l),C=f[g];for(var P=0,L=C.length;L>P;P++)l.holes.push(C[P].h)}return c}},Object.assign(fr.prototype,{isFont:!0,generateShapes:function(t,e,i){function n(t){for(var i=String(t).split(""),n=e/o.resolution,a=0,s=[],l=0;l<i.length;l++){var c=r(i[l],n,a);a+=c.offset,s.push(c.path)}return s}function r(t,e,n){var r=o.glyphs[t]||o.glyphs["?"];if(r){var a,s,l,c,h,u,d,p,f,m,g,v=new pr,y=[],_=Zc.b2,w=Zc.b3;if(r.o)for(var x=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),b=0,M=x.length;M>b;){var T=x[b++];switch(T){case"m":a=x[b++]*e+n,s=x[b++]*e,v.moveTo(a,s);break;case"l":a=x[b++]*e+n,s=x[b++]*e,v.lineTo(a,s);break;case"q":if(l=x[b++]*e+n,c=x[b++]*e,d=x[b++]*e+n,p=x[b++]*e,v.quadraticCurveTo(d,p,l,c),g=y[y.length-1]){h=g.x,u=g.y;for(var E=1;i>=E;E++){var S=E/i;_(S,h,d,l),_(S,u,p,c)}}break;case"b":if(l=x[b++]*e+n,c=x[b++]*e,d=x[b++]*e+n,p=x[b++]*e,f=x[b++]*e+n,m=x[b++]*e,v.bezierCurveTo(d,p,f,m,l,c),g=y[y.length-1]){h=g.x,u=g.y;for(var E=1;i>=E;E++){var S=E/i;w(S,h,d,f,l),w(S,u,p,m,c)}}}}return{offset:r.ha*e,path:v}}}void 0===e&&(e=100),void 0===i&&(i=4);for(var o=this.data,a=n(t),s=[],l=0,c=a.length;c>l;l++)Array.prototype.push.apply(s,a[l].toShapes());return s}}),Object.assign(mr.prototype,{load:function(t,e,i,n){var r=this,o=new Tn(this.manager);o.load(t,function(t){var i;try{i=JSON.parse(t)}catch(n){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var o=r.parse(i);e&&e(o)},i,n)},parse:function(t){return new fr(t)}});var ah;Object.assign(vr.prototype,{load:function(t,e,i,n){var r=new Tn(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){var i=gr();i.decodeAudioData(t,function(t){e(t)})},i,n)}}),Object.assign(yr.prototype,{update:function(){var t,e,i,n,r,o,a,s=new h,l=new h;return function(c){var h=t!==this||e!==c.focus||i!==c.fov||n!==c.aspect*this.aspect||r!==c.near||o!==c.far||a!==c.zoom;if(h){t=this,e=c.focus,i=c.fov,n=c.aspect*this.aspect,r=c.near,o=c.far,a=c.zoom;var u,d,p=c.projectionMatrix.clone(),f=this.eyeSep/2,m=f*r/e,g=r*Math.tan(Fs.DEG2RAD*i*.5)/a;l.elements[12]=-f,s.elements[12]=f,u=-g*n+m,d=g*n+m,p.elements[0]=2*r/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraL.projectionMatrix.copy(p),u=-g*n-m,d=g*n-m,p.elements[0]=2*r/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(s)}}()}),_r.prototype=Object.create(ce.prototype),_r.prototype.constructor=_r,wr.prototype=Object.assign(Object.create(ce.prototype),{constructor:wr,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new c,e=new l,i=new c,n=new c;return function(r){ce.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),o.setPosition(t.x,t.y,t.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z)}}()}),xr.prototype=Object.assign(Object.create(ce.prototype),{constructor:xr,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.source.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();return t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()},pause:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;e>t;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;e>t;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},setLoop:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.loop=t)},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this
}}),br.prototype=Object.assign(Object.create(xr.prototype),{constructor:br,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new c;return function(e){ce.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(Mr.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Tr.prototype={constructor:Tr,accumulate:function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)i[r+a]=i[a];o=e}else{o+=e;var s=e/o;this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,1>r){var a=3*e;this._mixBufferRegion(i,n,a,1-r,e)}for(var s=e,l=e+e;s!==l;++s)if(i[s]!==i[s+e]){o.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,o=n;r!==o;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,r){if(n>=.5)for(var o=0;o!==r;++o)t[e+o]=t[i+o]},_slerp:function(t,e,i,n){l.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var o=1-n,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[i+a]*n}}},Er.prototype={constructor:Er,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=Er.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(i){var o=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[i])return void console.error("  can not bind to objectName of node, undefined",this);t=t[i]}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o]}}var s=t[n];if(void 0===s){var l=e.nodeName;return void console.error("  trying to update property for track: "+l+"."+n+" but it wasn't found.",t)}var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var h=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===r){r=a;break}}h=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(h=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(Er.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:Er.prototype.getValue,_setValue_unbound:Er.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),Er.Composite=function(t,e,i){var n=i||Er.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)},Er.Composite.prototype={constructor:Er.Composite,getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Er.create=function(t,e,i){return t&&t.isAnimationObjectGroup?new Er.Composite(t,e,i):new Er(t,e,i)},Er.parseTrackName=function(t){var e=/^((?:\w+[\/:])*)(\w+)?(?:\.(\w+)(?:\[(.+)\])?)?\.(\w+)(?:\[(.+)\])?$/,i=e.exec(t);if(!i)throw new Error("cannot parse trackName at all: "+t);var n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return n},Er.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var n=t.bones[i];if(n.name===e)return n}return null},n=i(t.skeleton);if(n)return n}if(t.children){var r=function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.name===e||n.uuid===e)return n;var o=r(n.children);if(o)return o}return null},o=r(t.children);if(o)return o}return null},Sr.prototype={constructor:Sr,isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,l=0,c=arguments.length;l!==c;++l){var h=arguments[l],u=h.uuid,d=n[u];if(void 0===d){d=e++,n[u]=d,t.push(h);for(var p=0,f=s;p!==f;++p)a[p].push(new Er(h,r[p],o[p]))}else if(i>d){var m=t[d],g=--i,v=t[g];n[v.uuid]=d,t[d]=v,n[u]=g,t[g]=h;for(var p=0,f=s;p!==f;++p){var y=a[p],_=y[g],w=y[d];y[d]=_,void 0===w&&(w=new Er(h,r[p],o[p])),y[g]=w}}else t[d]!==m&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,c=i[l];if(void 0!==c&&c>=e){var h=e++,u=t[h];i[u.uuid]=c,t[c]=u,i[l]=h,t[h]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[h],g=f[c];f[c]=m,f[h]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],c=l.uuid,h=n[c];if(void 0!==h)if(delete n[c],i>h){var u=--i,d=t[u],p=--e,f=t[p];n[d.uuid]=h,t[h]=d,n[f.uuid]=u,t[u]=f,t.pop();for(var m=0,g=o;m!==g;++m){var v=r[m],y=v[u],_=v[p];v[h]=y,v[u]=_,v.pop()}}else{var p=--e,f=t[p];n[f.uuid]=h,t[h]=f,t.pop();for(var m=0,g=o;m!==g;++m){var v=r[m];v[h]=v[p],v.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=new Array(l);n=r.length,i[t]=n,o.push(t),a.push(e),r.push(h);for(var u=c,d=s.length;u!==d;++u){var p=s[u];h[u]=new Er(p,t,e)}return h},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a],l=t[a];e[l]=i,o[i]=s,o.pop(),r[i]=r[a],r.pop(),n[i]=n[a],n.pop()}}},Cr.prototype={constructor:Cr,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,r=t._clip.duration,o=r/n,a=n/r;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+i,l[0]=t/a,l[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){var r=this._startTime;if(null!==r){var o=(t-r)*i;if(0>o||0===i)return;this._startTime=null,e=i*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var l=this._interpolants,c=this._propertyBindings,h=0,u=l.length;h!==u;++h)l[h].evaluate(a),c[h].accumulate(n,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(n===ms){-1===r&&(this.loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}}else{var o=n===vs;if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=i||0>e){var a=Math.floor(e/i);e-=i*a,r+=Math.abs(a);var s=this.repetitions-r;if(0>s)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var l=0>t;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1===(1&r))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=bs,n.endingEnd=bs):(n.endingStart=t?this.zeroSlopeAtStart?bs:xs:Ms,n.endingEnd=e?this.zeroSlopeAtEnd?bs:xs:Ms)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=i,this}},Object.assign(Ar.prototype,e.prototype,{clipAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Kn.findByName(i,t):t,o=null!==r?r.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[n];if(void 0!==l)return l;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new Cr(this,r,e);return this._bindAction(c,s),this._addInactiveAction(c,o,n),c},existingAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Kn.findByName(i,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a?a.actionByRoot[n]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(var r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==i;++a){var s=e[a];s.enabled&&s._update(n,t,r,o)}for(var l=this._bindings,c=this._nActiveBindings,a=0;a!==c;++a)l[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var c=l._cacheIndex,h=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=c,e[c]=h,e.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot,o=r[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName,s=a[e];if(void 0!==s)for(var l in s){var c=s[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),Object.assign(Ar.prototype,{_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,o=t._propertyBindings,a=t._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var h=0;h!==r;++h){var u=n[h],d=u.name,p=c[d];if(void 0!==p)o[h]=p;else{if(p=o[h],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[h].binding.parsedPath;p=new Tr(Er.create(i,d,f),u.ValueTypeName,u.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,s,d),o[h]=p}a[h].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var r=t._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=n.length,n.push(t),o.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null;var h=a.actionByRoot,u=(e._localRoot||this._root).uuid;delete h[u],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],o=this._bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,a=o[n],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[r];t:{for(var c in a)break t;delete o[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new Hn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),Lr.prototype=Object.create(Pe.prototype),Lr.prototype.constructor=Lr,Lr.prototype.isInstancedBufferGeometry=!0,Lr.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,materialIndex:i})},Lr.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=t.groups,a=0,s=o.length;s>a;a++){var l=o[a];this.addGroup(l.start,l.count,l.materialIndex)}return this},kr.prototype={constructor:kr,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}},Ir.prototype={constructor:Ir,isInterleavedBuffer:!0,set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;r>n;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},Rr.prototype=Object.create(Ir.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isInstancedInterleavedBuffer=!0,Rr.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Dr.prototype=Object.create(me.prototype),Dr.prototype.constructor=Dr,Dr.prototype.isInstancedBufferAttribute=!0,Dr.prototype.copy=function(t){return me.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},zr.prototype={constructor:zr,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return Fr(t,this,i,e),i.sort(Or),i},intersectObjects:function(t,e){var i=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=t.length;r>n;n++)Fr(t[n],this,i,e);return i.sort(Or),i}},Nr.prototype={constructor:Nr,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},Ur.prototype={constructor:Ur,set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Fs.clamp(t.y/this.radius,-1,1))),this}},Hr.prototype=Object.create(Le.prototype),Hr.prototype.constructor=Hr,Hr.prototype.createAnimation=function(t,e,i,n){var r={start:e,end:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},Hr.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/i,n={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o],l=s.name.match(i);if(l&&l.length>1){var c=l[1];n[c]||(n[c]={start:1/0,end:-1/0});var h=n[c];o<h.start&&(h.start=o),o>h.end&&(h.end=o),e||(e=c)}}for(var c in n){var h=n[c];this.createAnimation(c,h.start,h.end,t)}this.firstAnimation=e},Hr.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},Hr.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},Hr.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},Hr.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},Hr.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},Hr.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},Hr.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},Hr.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},Hr.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Hr.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},Hr.prototype.update=function(t){for(var e=0,i=this.animationsList.length;i>e;e++){var n=this.animationsList[e];if(n.active){var r=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.start+Fs.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}},Gr.prototype=Object.create(ce.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isImmediateRenderObject=!0,jr.prototype=Object.create(bi.prototype),jr.prototype.constructor=jr,jr.prototype.update=function(){var t=new c,e=new c,i=new ie;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,c=0,h=0,u=l.length;u>h;h++)for(var d=l[h],p=0,f=d.vertexNormals.length;f>p;p++){var m=s[d[n[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(r),e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1}else if(a&&a.isBufferGeometry)for(var v=a.attributes.position,y=a.attributes.normal,c=0,p=0,f=v.count;f>p;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1;return o.needsUpdate=!0,this}}(),Wr.prototype=Object.create(ce.prototype),Wr.prototype.constructor=Wr,Wr.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Wr.prototype.update=function(){var t=new c,e=new c;return function(){var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),Yr.prototype=Object.create(bi.prototype),Yr.prototype.constructor=Yr,Yr.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},Yr.prototype.update=function(){for(var t=this.geometry,e=(new h).getInverse(this.root.matrixWorld),i=new h,n=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent&&o.parent.isBone&&(i.multiplyMatrices(e,o.matrixWorld),t.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[n+1].setFromMatrixPosition(i),n+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},Vr.prototype=Object.create(Le.prototype),Vr.prototype.constructor=Vr,Vr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Vr.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Xr.prototype=Object.create(ce.prototype),Xr.prototype.constructor=Xr,Xr.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},Xr.prototype.update=function(){var t=new c;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),qr.prototype=Object.create(bi.prototype),qr.prototype.constructor=qr,qr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},$r.prototype=Object.create(bi.prototype),$r.prototype.constructor=$r,$r.prototype.update=function(){var t=new c,e=new c,i=new ie;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,c=0,h=s.length;h>c;c++){var u=s[c],d=u.normal;t.copy(a[u.a]).add(a[u.b]).add(a[u.c]).divideScalar(3).applyMatrix4(n),e.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(l,t.x,t.y,t.z),l+=1,r.setXYZ(l,e.x,e.y,e.z),l+=1}return r.needsUpdate=!0,this}}(),Zr.prototype=Object.create(ce.prototype),Zr.prototype.constructor=Zr,Zr.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Zr.prototype.update=function(){var t=new c,e=new c,i=new c;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t);var n=this.children[0],r=this.children[1];n.lookAt(i),n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(i),r.scale.z=i.length()}}(),Qr.prototype=Object.create(bi.prototype),Qr.prototype.constructor=Qr,Qr.prototype.update=function(){function t(t,o,a,s){n.set(o,a,s).unproject(r);var l=i[t];if(void 0!==l)for(var c=0,h=l.length;h>c;c++)e.vertices[l[c]].copy(n)}var e,i,n=new c,r=new Re;return function(){e=this.geometry,i=this.pointMap;var n=1,o=1;r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-n,-o,-1),t("n2",n,-o,-1),t("n3",-n,o,-1),t("n4",n,o,-1),t("f1",-n,-o,1),t("f2",n,-o,1),t("f3",-n,o,1),t("f4",n,o,1),t("u1",.7*n,1.1*o,-1),t("u2",.7*-n,1.1*o,-1),t("u3",0,2*o,-1),t("cf1",-n,0,1),t("cf2",n,0,1),t("cf3",0,-o,1),t("cf4",0,o,1),t("cn1",-n,0,-1),t("cn2",n,0,-1),t("cn3",0,-o,-1),t("cn4",0,o,-1),e.verticesNeedUpdate=!0
}}(),Kr.prototype=Object.create(Le.prototype),Kr.prototype.constructor=Kr,Kr.prototype.update=function(){this.box.setFromObject(this.object),this.box.getSize(this.scale),this.box.getCenter(this.position)},Jr.prototype=Object.create(bi.prototype),Jr.prototype.constructor=Jr,Jr.prototype.update=function(){var t=new te;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var i=t.min,n=t.max,r=this.geometry.attributes.position,o=r.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=i.x,o[4]=n.y,o[5]=n.z,o[6]=i.x,o[7]=i.y,o[8]=n.z,o[9]=n.x,o[10]=i.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=i.z,o[15]=i.x,o[16]=n.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=n.x,o[22]=i.y,o[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var sh=new Pe;sh.addAttribute("position",new Me([0,0,0,0,1,0],3));var lh=new sn(0,.5,1,5,1);lh.translate(0,-.5,0),to.prototype=Object.create(ce.prototype),to.prototype.constructor=to,to.prototype.setDirection=function(){var t,e=new c;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),to.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},to.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},eo.prototype=Object.create(bi.prototype),eo.prototype.constructor=eo;var ch=function(){function t(){}var e=new c,i=new t,n=new t,r=new t;return t.prototype.init=function(t,e,i,n){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-n,this.c3=2*t-2*e+i+n},t.prototype.initNonuniformCatmullRom=function(t,e,i,n,r,o,a){var s=(e-t)/r-(i-t)/(r+o)+(i-e)/o,l=(i-e)/o-(n-e)/(o+a)+(n-i)/a;s*=o,l*=o,this.init(e,i,s,l)},t.prototype.initCatmullRom=function(t,e,i,n,r){this.init(e,i,r*(i-t),r*(n-e))},t.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},rr.create(function(t){this.points=t||[],this.closed=!1},function(t){var o,a,s,l,h=this.points;l=h.length,2>l&&console.log("duh, you need at least 2 points"),o=(l-(this.closed?0:1))*t,a=Math.floor(o),s=o-a,this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/h.length)+1)*h.length:0===s&&a===l-1&&(a=l-2,s=1);var u,d,p,f;if(this.closed||a>0?u=h[(a-1)%l]:(e.subVectors(h[0],h[1]).add(h[0]),u=e),d=h[a%l],p=h[(a+1)%l],this.closed||l>a+2?f=h[(a+2)%l]:(e.subVectors(h[l-1],h[l-2]).add(h[l-1]),f=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,g=Math.pow(u.distanceToSquared(d),m),v=Math.pow(d.distanceToSquared(p),m),y=Math.pow(p.distanceToSquared(f),m);1e-4>v&&(v=1),1e-4>g&&(g=v),1e-4>y&&(y=v),i.initNonuniformCatmullRom(u.x,d.x,p.x,f.x,g,v,y),n.initNonuniformCatmullRom(u.y,d.y,p.y,f.y,g,v,y),r.initNonuniformCatmullRom(u.z,d.z,p.z,f.z,g,v,y)}else if("catmullrom"===this.type){var _=void 0!==this.tension?this.tension:.5;i.initCatmullRom(u.x,d.x,p.x,f.x,_),n.initCatmullRom(u.y,d.y,p.y,f.y,_),r.initCatmullRom(u.z,d.z,p.z,f.z,_)}var w=new c(i.calc(s),n.calc(s),r.calc(s));return w})}();io.prototype=Object.create(ch.prototype);var hh=rr.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t},function(t){var e=this.points,i=(e.length-1)*t,n=Math.floor(i),r=i-n,o=e[0==n?n:n-1],a=e[n],s=e[n>e.length-2?e.length-1:n+1],l=e[n>e.length-3?e.length-1:n+2],h=rh.interpolate;return new c(h(o.x,a.x,s.x,l.x,r),h(o.y,a.y,s.y,l.y,r),h(o.z,a.z,s.z,l.z,r))}),uh=rr.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e=Zc.b3;return new c(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),dh=rr.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=Zc.b2;return new c(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),ph=rr.create(function(t,e){this.v1=t,this.v2=e},function(t){if(1===t)return this.v2.clone();var e=new c;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e});no.prototype=Object.create(sr.prototype),no.prototype.constructor=no;var fh={createMultiMaterialObject:function(t,e){for(var i=new Ei,n=0,r=e.length;r>n;n++)i.add(new Le(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new h;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},mh=0,gh=1;Object.assign(X.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(te.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(ue.prototype,{center:function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)}}),Object.assign(ie.prototype,{multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}}),Object.assign(h.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}),Object.assign(ne.prototype,{isIntersectionLine:function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)}}),Object.assign(l.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)}}),Object.assign(ae.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(ur.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new $i(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new on(this,t)}}),Object.assign(c.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),Object.assign(ce.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(ce.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(mi.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),De.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Ln.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(me.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.assign(Pe.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pe.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Z.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new V}}}),Object.defineProperties(_n.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(K.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.defineProperties(Pr.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.assign(li.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(li.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(oe.prototype,{cullFace:{get:function(){return this.renderReverseSided?wo:_o},set:function(t){var e=t!==_o;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(a.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign(xr.prototype,{load:function(t){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var e=this,i=new vr;return i.load(t,function(t){e.setBuffer(t)}),this}}),Object.assign(Mr.prototype,{getData:function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()}});var vh={merge:function(t,e,i){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},yh={crossOrigin:void 0,loadTexture:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Pn;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,i,void 0,n);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new An;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,i,void 0,n);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};t.WebGLRenderTargetCube=s,t.WebGLRenderTarget=a,t.WebGLRenderer=li,t.ShaderLib=Yc,t.UniformsLib=Wc,t.UniformsUtils=Ws,t.ShaderChunk=Gc,t.FogExp2=ci,t.Fog=hi,t.Scene=ui,t.LensFlare=di,t.Sprite=fi,t.LOD=mi,t.SkinnedMesh=_i,t.Skeleton=vi,t.Bone=yi,t.Mesh=Le,t.LineSegments=bi,t.Line=xi,t.Points=Ti,t.Group=Ei,t.VideoTexture=Si,t.DataTexture=gi,t.CompressedTexture=Ci,t.CubeTexture=u,t.CanvasTexture=Ai,t.DepthTexture=Pi,t.TextureIdCount=r,t.Texture=n,t.MaterialIdCount=Q,t.CompressedTextureLoader=En,t.BinaryTextureLoader=Sn,t.DataTextureLoader=eh,t.CubeTextureLoader=An,t.TextureLoader=Pn,t.ObjectLoader=nr,t.MaterialLoader=Jn,t.BufferGeometryLoader=tr,t.DefaultLoadingManager=th,t.LoadingManager=Mn,t.JSONLoader=ir,t.ImageLoader=Cn,t.FontLoader=mr,t.XHRLoader=Tn,t.Loader=er,t.Cache=Jc,t.AudioLoader=vr,t.SpotLightShadow=Rn,t.SpotLight=Dn,t.PointLight=zn,t.HemisphereLight=kn,t.DirectionalLightShadow=On,t.DirectionalLight=Fn,t.AmbientLight=Nn,t.LightShadow=In,t.Light=Ln,t.StereoCamera=yr,t.PerspectiveCamera=De,t.OrthographicCamera=ze,t.CubeCamera=_r,t.Camera=Re,t.AudioListener=wr,t.PositionalAudio=br,t.getAudioContext=gr,t.AudioAnalyser=Mr,t.Audio=xr,t.VectorKeyframeTrack=Wn,t.StringKeyframeTrack=qn,t.QuaternionKeyframeTrack=Vn,t.NumberKeyframeTrack=Xn,t.ColorKeyframeTrack=Zn,t.BooleanKeyframeTrack=$n,t.PropertyMixer=Tr,t.PropertyBinding=Er,t.KeyframeTrack=Qn,t.AnimationUtils=ih,t.AnimationObjectGroup=Sr,t.AnimationMixer=Ar,t.AnimationClip=Kn,t.Uniform=Pr,t.InstancedBufferGeometry=Lr,t.BufferGeometry=Pe,t.GeometryIdCount=Ce,t.Geometry=Se,t.InterleavedBufferAttribute=kr,t.InstancedInterleavedBuffer=Rr,t.InterleavedBuffer=Ir,t.InstancedBufferAttribute=Dr,t.DynamicBufferAttribute=Ee,t.Float64Attribute=Te,t.Float32Attribute=Me,t.Uint32Attribute=be,t.Int32Attribute=xe,t.Uint16Attribute=we,t.Int16Attribute=_e,t.Uint8ClampedAttribute=ye,t.Uint8Attribute=ve,t.Int8Attribute=ge,t.BufferAttribute=me,t.Face3=pe,t.Object3DIdCount=he,t.Object3D=ce,t.Raycaster=zr,t.Layers=le,t.EventDispatcher=e,t.Clock=Nr,t.QuaternionLinearInterpolant=Yn,t.LinearInterpolant=Hn,t.DiscreteInterpolant=Gn,t.CubicInterpolant=Un,t.Interpolant=Bn,t.Triangle=de,t.Spline=Br,t.Math=Fs,t.Spherical=Ur,t.Plane=ne,t.Frustum=re,t.Sphere=ee,t.Ray=ae,t.Matrix4=h,t.Matrix3=ie,t.Box3=te,t.Box2=X,t.Line3=ue,t.Euler=se,t.Vector4=o,t.Vector3=c,t.Vector2=i,t.Quaternion=l,t.ColorKeywords=jc,t.Color=V,t.MorphBlendMesh=Hr,t.ImmediateRenderObject=Gr,t.VertexNormalsHelper=jr,t.SpotLightHelper=Wr,t.SkeletonHelper=Yr,t.PointLightHelper=Vr,t.HemisphereLightHelper=Xr,t.GridHelper=qr,t.FaceNormalsHelper=$r,t.DirectionalLightHelper=Zr,t.CameraHelper=Qr,t.BoundingBoxHelper=Kr,t.BoxHelper=Jr,t.ArrowHelper=to,t.AxisHelper=eo,t.ClosedSplineCurve3=io,t.CatmullRomCurve3=ch,t.SplineCurve3=hh,t.CubicBezierCurve3=uh,t.QuadraticBezierCurve3=dh,t.LineCurve3=ph,t.ArcCurve=no,t.EllipseCurve=sr,t.SplineCurve=lr,t.CubicBezierCurve=cr,t.QuadraticBezierCurve=hr,t.LineCurve=or,t.Shape=ur,t.ShapePath=pr,t.Path=dr,t.Font=fr,t.CurvePath=ar,t.Curve=rr,t.ShapeUtils=Zc,t.SceneUtils=fh,t.CurveUtils=rh,t.WireframeGeometry=Li,t.ParametricGeometry=Ii,t.ParametricBufferGeometry=ki,t.TetrahedronGeometry=zi,t.TetrahedronBufferGeometry=Di,t.OctahedronGeometry=Fi,t.OctahedronBufferGeometry=Oi,t.IcosahedronGeometry=Bi,t.IcosahedronBufferGeometry=Ni,t.DodecahedronGeometry=Hi,t.DodecahedronBufferGeometry=Ui,t.PolyhedronGeometry=Gi,t.PolyhedronBufferGeometry=Ri,t.TubeGeometry=Wi,t.TubeBufferGeometry=ji,t.TorusKnotGeometry=Vi,t.TorusKnotBufferGeometry=Yi,t.TorusGeometry=qi,t.TorusBufferGeometry=Xi,t.TextGeometry=Zi,t.SphereBufferGeometry=Qi,t.SphereGeometry=Ki,t.RingGeometry=tn,t.RingBufferGeometry=Ji,t.PlaneBufferGeometry=Ie,t.PlaneGeometry=en,t.LatheGeometry=rn,t.LatheBufferGeometry=nn,t.ShapeGeometry=on,t.ExtrudeGeometry=$i,t.EdgesGeometry=an,t.ConeGeometry=cn,t.ConeBufferGeometry=hn,t.CylinderGeometry=ln,t.CylinderBufferGeometry=sn,t.CircleBufferGeometry=un,t.CircleGeometry=dn,t.BoxBufferGeometry=ke,t.BoxGeometry=pn,t.ShadowMaterial=fn,t.SpriteMaterial=pi,t.RawShaderMaterial=mn,t.ShaderMaterial=K,t.PointsMaterial=Mi,t.MultiMaterial=gn,t.MeshPhysicalMaterial=yn,t.MeshStandardMaterial=vn,t.MeshPhongMaterial=_n,t.MeshNormalMaterial=wn,t.MeshLambertMaterial=xn,t.MeshDepthMaterial=J,t.MeshBasicMaterial=fe,t.LineDashedMaterial=bn,t.LineBasicMaterial=wi,t.Material=Z,t.REVISION=go,t.MOUSE=vo,t.CullFaceNone=yo,t.CullFaceBack=_o,t.CullFaceFront=wo,t.CullFaceFrontBack=xo,t.FrontFaceDirectionCW=bo,t.FrontFaceDirectionCCW=Mo,t.BasicShadowMap=To,t.PCFShadowMap=Eo,t.PCFSoftShadowMap=So,t.FrontSide=Co,t.BackSide=Ao,t.DoubleSide=Po,t.FlatShading=Lo,t.SmoothShading=ko,t.NoColors=Io,t.FaceColors=Ro,t.VertexColors=Do,t.NoBlending=zo,t.NormalBlending=Oo,t.AdditiveBlending=Fo,t.SubtractiveBlending=No,t.MultiplyBlending=Bo,t.CustomBlending=Uo,t.BlendingMode=Ho,t.AddEquation=Go,t.SubtractEquation=jo,t.ReverseSubtractEquation=Wo,t.MinEquation=Yo,t.MaxEquation=Vo,t.ZeroFactor=Xo,t.OneFactor=qo,t.SrcColorFactor=$o,t.OneMinusSrcColorFactor=Zo,t.SrcAlphaFactor=Qo,t.OneMinusSrcAlphaFactor=Ko,t.DstAlphaFactor=Jo,t.OneMinusDstAlphaFactor=ta,t.DstColorFactor=ea,t.OneMinusDstColorFactor=ia,t.SrcAlphaSaturateFactor=na,t.NeverDepth=ra,t.AlwaysDepth=oa,t.LessDepth=aa,t.LessEqualDepth=sa,t.EqualDepth=la,t.GreaterEqualDepth=ca,t.GreaterDepth=ha,t.NotEqualDepth=ua,t.MultiplyOperation=da,t.MixOperation=pa,t.AddOperation=fa,t.NoToneMapping=ma,t.LinearToneMapping=ga,t.ReinhardToneMapping=va,t.Uncharted2ToneMapping=ya,t.CineonToneMapping=_a,t.UVMapping=wa,t.CubeReflectionMapping=xa,t.CubeRefractionMapping=ba,t.EquirectangularReflectionMapping=Ma,t.EquirectangularRefractionMapping=Ta,t.SphericalReflectionMapping=Ea,t.CubeUVReflectionMapping=Sa,t.CubeUVRefractionMapping=Ca,t.TextureMapping=Aa,t.RepeatWrapping=Pa,t.ClampToEdgeWrapping=La,t.MirroredRepeatWrapping=ka,t.TextureWrapping=Ia,t.NearestFilter=Ra,t.NearestMipMapNearestFilter=Da,t.NearestMipMapLinearFilter=za,t.LinearFilter=Oa,t.LinearMipMapNearestFilter=Fa,t.LinearMipMapLinearFilter=Na,t.TextureFilter=Ba,t.UnsignedByteType=Ua,t.ByteType=Ha,t.ShortType=Ga,t.UnsignedShortType=ja,t.IntType=Wa,t.UnsignedIntType=Ya,t.FloatType=Va,t.HalfFloatType=Xa,t.UnsignedShort4444Type=qa,t.UnsignedShort5551Type=$a,t.UnsignedShort565Type=Za,t.UnsignedInt248Type=Qa,t.AlphaFormat=Ka,t.RGBFormat=Ja,t.RGBAFormat=ts,t.LuminanceFormat=es,t.LuminanceAlphaFormat=is,t.RGBEFormat=ns,t.DepthFormat=rs,t.DepthStencilFormat=os,t.RGB_S3TC_DXT1_Format=as,t.RGBA_S3TC_DXT1_Format=ss,t.RGBA_S3TC_DXT3_Format=ls,t.RGBA_S3TC_DXT5_Format=cs,t.RGB_PVRTC_4BPPV1_Format=hs,t.RGB_PVRTC_2BPPV1_Format=us,t.RGBA_PVRTC_4BPPV1_Format=ds,t.RGBA_PVRTC_2BPPV1_Format=ps,t.RGB_ETC1_Format=fs,t.LoopOnce=ms,t.LoopRepeat=gs,t.LoopPingPong=vs,t.InterpolateDiscrete=ys,t.InterpolateLinear=_s,t.InterpolateSmooth=ws,t.ZeroCurvatureEnding=xs,t.ZeroSlopeEnding=bs,t.WrapAroundEnding=Ms,t.TrianglesDrawMode=Ts,t.TriangleStripDrawMode=Es,t.TriangleFanDrawMode=Ss,t.LinearEncoding=Cs,t.sRGBEncoding=As,t.GammaEncoding=Ps,t.RGBEEncoding=Ls,t.LogLuvEncoding=ks,t.RGBM7Encoding=Is,t.RGBM16Encoding=Rs,t.RGBDEncoding=Ds,t.BasicDepthPacking=zs,t.RGBADepthPacking=Os,t.CubeGeometry=pn,t.Face4=ro,t.LineStrip=mh,t.LinePieces=gh,t.MeshFaceMaterial=gn,t.PointCloud=oo,t.Particle=fi,t.ParticleSystem=ao,t.PointCloudMaterial=so,t.ParticleBasicMaterial=lo,t.ParticleSystemMaterial=co,t.Vertex=ho,t.EdgesHelper=uo,t.WireframeHelper=po,t.GeometryUtils=vh,t.ImageUtils=yh,t.Projector=fo,t.CanvasRenderer=mo,Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AudioContext",{get:function(){return t.getAudioContext()}})}),THREE.EffectComposer=function(t,e){if(this.renderer=t,void 0===e){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},n=t.getSize();e=new THREE.WebGLRenderTarget(n.width,n.height,i)}this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t);var e=this.renderer.getSize();t.setSize(e.width,e.height)},insertPass:function(t,e){this.passes.splice(e,0,t)},render:function(t){var e,i,n=!1,r=this.passes.length;for(i=0;r>i;i++)if(e=this.passes[i],e.enabled!==!1){if(e.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),e.needsSwap){if(n){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(e instanceof THREE.MaskPass?n=!0:e instanceof THREE.ClearMaskPass&&(n=!1))}},reset:function(t){if(void 0===t){var e=this.renderer.getSize();t=this.renderTarget1.clone(),t.setSize(e.width,e.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(t,e)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),THREE.RenderPass=function(t,e,i,n,r){THREE.Pass.call(this),this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==r?r:0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(t,e,i){var n=t.autoClear;
t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var r,o;this.clearColor&&(r=t.getClearColor().getHex(),o=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),t.render(this.scene,this.camera,this.renderToScreen?null:i,this.clear),this.clearColor&&t.setClearColor(r,o),this.scene.overrideMaterial=null,t.autoClear=n}}),THREE.ShaderPass=function(t,e){THREE.Pass.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof THREE.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({defines:t.defines||{},uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}}),THREE.MaskPass=function(t,e){THREE.Pass.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.MaskPass,render:function(t,e,i){var n=t.context,r=t.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);var o,a;this.inverse?(o=0,a=1):(o=1,a=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),r.buffers.stencil.setFunc(n.ALWAYS,o,4294967295),r.buffers.stencil.setClear(a),t.render(this.scene,this.camera,i,this.clear),t.render(this.scene,this.camera,e,this.clear),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.stencil.setFunc(n.EQUAL,1,4294967295),r.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP)}}),THREE.ClearMaskPass=function(){THREE.Pass.call(this),this.needsSwap=!1},THREE.ClearMaskPass.prototype=Object.create(THREE.Pass.prototype),Object.assign(THREE.ClearMaskPass.prototype,{render:function(t){t.state.buffers.stencil.setTest(!1)}}),THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},function(t){"use strict";function e(t){u(function(){throw t})}function i(e){return this.then(e,t)}function n(e){return this.then(t,e)}function r(e,i){return this.then(function(t){return d(e)?e.apply(null,p(t)?t:[t]):x.onlyFuncs?t:e},i||t)}function o(t){function e(){t()}return this.then(e,e),this}function a(t){return this.then(function(e){return d(t)?t.apply(null,p(e)?e.splice(0,0,void 0)&&e:[void 0,e]):x.onlyFuncs?e:t},function(e){return t(e)})}function s(i){return this.then(t,i?function(t){throw i(t),t}:e)}function l(t,e){var i=g(t);if(1===i.length&&p(i[0])){if(!i[0].length)return x.fulfilled([]);i=i[0]}var n=[],r=x(),o=i.length;if(o)for(var a=function(t){i[t]=x.promisify(i[t]),i[t].then(function(a){n[t]=e?i[t]:a,--o||r.resolve(n)},function(a){e?(n[t]=i[t],--o||r.resolve(n)):r.reject(a)})},s=0,l=o;l>s;s++)a(s);else r.resolve(n);return r.promise}function c(t,e){return t.then(d(e)?e:function(){return e})}function h(t){var e=g(t);1===e.length&&p(e[0])&&(e=e[0]);for(var i=x(),n=0,r=e.length,o=x.resolved();r>n;n++)o=c(o,e[n]);return i.resolve(o),i.promise}var u,d=function(t){return"function"==typeof t},p=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},f=function(t){return!(!t||!(typeof t).match(/function|object/))},m=function(e){return e===!1||e===t||null===e},g=function(t,e){return[].slice.call(t,e)},v="undefined",y=typeof TypeError===v?Error:TypeError;if(typeof process!==v&&process.nextTick)u=process.nextTick;else if(typeof MessageChannel!==v){var _=new MessageChannel,w=[];_.port1.onmessage=function(){w.length&&w.shift()()},u=function(t){w.push(t),_.port2.postMessage(0)}}else u=function(t){setTimeout(t,0)};var x=function(e){function l(){if(0!==v){var t,e=_,i=0,n=e.length,r=~v?0:1;for(_=[];n>i;i++)(t=e[i][r])&&t(p)}}function c(t){function e(t){return function(e){return i?void 0:(i=!0,t(e))}}var i=!1;if(v)return this;try{var n=f(t)&&t.then;if(d(n)){if(t===w)throw new y("Promise can't resolve itself");return n.call(t,e(c),e(h)),this}}catch(r){return e(h)(r),this}return g(function(){p=t,v=1,l()}),this}function h(t){return v||g(function(){try{throw t}catch(e){p=e}v=-1,l()}),this}var p,g=(t!==e?e:x.alwaysAsync)?u:function(t){t()},v=0,_=[],w={then:function(t,e){var i=x();return _.push([function(e){try{i.resolve(m(t)?e:d(t)?t(e):x.onlyFuncs?e:t)}catch(n){i.reject(n)}},function(t){if((m(e)||!d(e)&&x.onlyFuncs)&&i.reject(t),e)try{i.resolve(d(e)?e(t):e)}catch(n){i.reject(n)}}]),0!==v&&g(l),i.promise},success:i,error:n,otherwise:n,apply:r,spread:r,ensure:o,nodify:a,rethrow:s,isPending:function(){return 0===v},getStatus:function(){return v}};return w.toSource=w.toString=w.valueOf=function(){return p===t?this:p},{promise:w,resolve:c,fulfill:c,reject:h}};if(x.deferred=x.defer=x,x.nextTick=u,x.alwaysAsync=!0,x.onlyFuncs=!0,x.resolve=x.resolved=x.fulfilled=function(t){return x(!0).resolve(t).promise},x.reject=x.rejected=function(t){return x(!0).reject(t).promise},x.wait=function(t){var e=x();return setTimeout(e.resolve,t||0),e.promise},x.delay=function(t,e){var i=x();return setTimeout(function(){try{i.resolve(d(t)?t.apply(null):t)}catch(e){i.reject(e)}},e||0),i.promise},x.promisify=function(t){return t&&d(t.then)?t:x.resolved(t)},x.all=function(){return l(arguments,!1)},x.resolveAll=function(){return l(arguments,!0)},x.sequence=function(){return h(arguments)},x.nodeCapsule=function(t,e){return e||(e=t,t=void 0),function(){var i=x(),n=g(arguments);n.push(function(t,e){t?i.reject(t):i.resolve(arguments.length>2?g(arguments,1):e)});try{e.apply(t,n)}catch(r){i.reject(r)}return i.promise}},"function"==typeof define&&define.amd)define("D.js",[],function(){return x});else if(typeof module!==v&&module.exports)module.exports=x;else if(typeof window!==v){var b=window.D;x.noConflict=function(){return window.D=b,x},window.D=x}}(),/*!
 * uEvent - to make any js object an event emitter
 * Copyright 2011 Jerome Etienne (http://jetienne.com)
 * Copyright 2015-2016 Damien "Mistic" Sorel (http://www.strangeplanet.fr)
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.uEvent=e()}(this,function(){"use strict";var t=function(){return!0},e=function(){return!1},i=function(){};return i.Event=function(t,e){var i=t,n=e;Object.defineProperties(this,{type:{get:function(){return i},set:function(){},enumerable:!0},args:{get:function(){return n},set:function(){},enumerable:!0}})},i.Event.prototype={constructor:i.Event,isDefaultPrevented:e,isPropagationStopped:e,preventDefault:function(){this.isDefaultPrevented=t},stopPropagation:function(){this.isPropagationStopped=t}},i.prototype={constructor:i,on:function(t,e){if(this.__events=this.__events||{},"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(this.__events[i]=this.__events[i]||[],this.__events[i].push(t[i]));else t.split(" ").forEach(function(t){this.__events[t]=this.__events[t]||[],this.__events[t].push(e)},this);return this},off:function(t,e){if(this.__events=this.__events||{},"object"==typeof t){for(var i in t)if(t.hasOwnProperty(i)&&i in this.__events){var n=this.__events[i].indexOf(t[i]);-1!==n&&this.__events[i].splice(n,1)}}else t?t.split(" ").forEach(function(t){if(t in this.__events)if(e){var i=this.__events[t].indexOf(e);-1!==i&&this.__events[t].splice(i,1)}else this.__events[t].length=0},this):this.__events={};return this},once:function(t,e){if(this.__once=this.__once||{},"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(this.__once[i]=this.__once[i]||[],this.__once[i].push(t[i]));else t.split(" ").forEach(function(t){this.__once[t]=this.__once[t]||[],this.__once[t].push(e)},this);return this},trigger:function(t){var e,n,r,o=Array.prototype.slice.call(arguments,1),a=new i.Event(t,o);if(o.push(a),this.__events&&t in this.__events)for(e=0,n=this.__events[t].length;n>e;e++)if(r=this.__events[t][e],"object"==typeof r?r.handleEvent(a):r.apply(this,o),a.isPropagationStopped())return a;if(this.__once&&t in this.__once){for(e=0,n=this.__once[t].length;n>e;e++)if(r=this.__once[t][e],"object"==typeof r?r.handleEvent(a):r.apply(this,o),a.isPropagationStopped())return delete this.__once[t],a;delete this.__once[t]}return a},change:function(t,e){var n,r,o,a=Array.prototype.slice.call(arguments,1),s=new i.Event(t,a);if(a.push(s),this.__events&&t in this.__events)for(n=0,r=this.__events[t].length;r>n;n++)if(a[0]=e,o=this.__events[t][n],e="object"==typeof o?o.handleEvent(s):o.apply(this,a),s.isPropagationStopped())return e;return e}},i.mixin=function(t,e){e=e||{},t="function"==typeof t?t.prototype:t,["on","off","once","trigger","change"].forEach(function(n){var r=e[n]||n;t[r]=i.prototype[n]}),Object.defineProperties(t,{__events:{value:null,writable:!0},__once:{value:null,writable:!0}})},i}),function(){"use strict";function t(e,i,n){return("string"==typeof i?i:i.toString()).replace(e.define||o,function(t,i,r,o){return 0===i.indexOf("def.")&&(i=i.substring(4)),i in n||(":"===r?(e.defineParams&&o.replace(e.defineParams,function(t,e,r){n[i]={arg:e,text:r}}),i in n||(n[i]=o)):new Function("def","def['"+i+"']="+o)(n)),""}).replace(e.use||o,function(i,r){e.useParams&&(r=r.replace(e.useParams,function(t,e,i,r){if(n[i]&&n[i].arg&&r){var o=(i+":"+r).replace(/'|\\/g,"_");return n.__exp=n.__exp||{},n.__exp[o]=n[i].text.replace(new RegExp("(^|[^\\w$])"+n[i].arg+"([^\\w$])","g"),"$1"+r+"$2"),e+"def.__exp['"+o+"']"}}));var o=new Function("def","return "+r)(n);return o?t(e,o,n):o})}function e(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var i,n={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};n.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}},i=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):i.doT=n;var r={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},o=/$^/;n.template=function(a,s,l){s=s||n.templateSettings;var c,h,u=s.append?r.append:r.split,d=0,p=s.use||s.define?t(s,a,l||{}):a;p=("var out='"+(s.strip?p.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):p).replace(/'|\\/g,"\\$&").replace(s.interpolate||o,function(t,i){return u.start+e(i)+u.end}).replace(s.encode||o,function(t,i){return c=!0,u.startencode+e(i)+u.end}).replace(s.conditional||o,function(t,i,n){return i?n?"';}else if("+e(n)+"){out+='":"';}else{out+='":n?"';if("+e(n)+"){out+='":"';}out+='"}).replace(s.iterate||o,function(t,i,n,r){return i?(d+=1,h=r||"i"+d,i=e(i),"';var arr"+d+"="+i+";if(arr"+d+"){var "+n+","+h+"=-1,l"+d+"=arr"+d+".length-1;while("+h+"<l"+d+"){"+n+"=arr"+d+"["+h+"+=1];out+='"):"';} } out+='"}).replace(s.evaluate||o,function(t,i){return"';"+e(i)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),c&&(s.selfcontained||!i||i._encodeHTML||(i._encodeHTML=n.encodeHTMLSource(s.doNotSkipEncoded)),p="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+n.encodeHTMLSource.toString()+"("+(s.doNotSkipEncoded||"")+"));"+p);try{return new Function(s.varname,p)}catch(f){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+p),f}},n.compile=function(t,e){return n.template(t,null,e)}}(),THREE.DeviceOrientationControls=function(t){var e=this;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var i=function(t){e.deviceOrientation=t},n=function(){e.screenOrientation=window.orientation||0},r=function(){var t=new THREE.Vector3(0,0,1),e=new THREE.Euler,i=new THREE.Quaternion,n=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,o,a,s,l){e.set(a,o,-s,"YXZ"),r.setFromEuler(e),r.multiply(n),r.multiply(i.setFromAxisAngle(t,-l))}}();this.connect=function(){n(),window.addEventListener("orientationchange",n,!1),window.addEventListener("deviceorientation",i,!1),e.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",n,!1),window.removeEventListener("deviceorientation",i,!1),e.enabled=!1},this.update=function(){if(e.enabled!==!1){var t=e.deviceOrientation.alpha?THREE.Math.degToRad(e.deviceOrientation.alpha)+this.alphaOffsetAngle:0,i=e.deviceOrientation.beta?THREE.Math.degToRad(e.deviceOrientation.beta):0,n=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.gamma):0,o=e.screenOrientation?THREE.Math.degToRad(e.screenOrientation):0;r(e.object.quaternion,t,i,n,o),this.alpha=t}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()},/*!
 * Photo Sphere Viewer 3.2.2
 * Copyright (c) 2014-2015 Jérémy Heleine
 * Copyright (c) 2015-2016 Damien "Mistic" Sorel
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
function(t,e){"function"==typeof define&&define.amd?define(["three","D.js","uevent","doT"],e):"object"==typeof module&&module.exports?module.exports=e(require("three"),require("d.js"),require("uevent"),require("dot")):t.PhotoSphereViewer=e(t.THREE,t.D,t.uEvent,t.doT)}(this,function(t,e,i,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(r.SYSTEM.loaded||r.loadSystem(),this.config=M.clone(r.DEFAULTS),M.deepmerge(this.config,t),!t.container)throw new b("No value given for container.");if(!r.SYSTEM.isCanvasSupported)throw new b("Canvas is not supported.");if(!(r.SYSTEM.isWebGLSupported&&this.config.webgl||M.checkTHREE("CanvasRenderer","Projector")))throw new b("Missing Three.js components: CanvasRenderer, Projector. Get them from three.js-examples package.");if(this.config.transition&&this.config.transition.blur)if(r.SYSTEM.isWebGLSupported&&this.config.webgl){if(!M.checkTHREE("EffectComposer","RenderPass","ShaderPass","MaskPass","CopyShader"))throw new b("Missing Three.js components: EffectComposer, RenderPass, ShaderPass, MaskPass, CopyShader. Get them from three.js-examples package.")}else this.config.transition.blur=!1,console.warn("PhotoSphereViewer: Using canvas rendering, blur transition disabled.");this.config.longitude_range&&2!==this.config.longitude_range.length&&(this.config.longitude_range=null,console.warn("PhotoSphereViewer: longitude_range must have exactly two elements.")),this.config.latitude_range?2!==this.config.latitude_range.length?(this.config.latitude_range=null,console.warn("PhotoSphereViewer: latitude_range must have exactly two elements.")):this.config.latitude_range[0]>this.config.latitude_range[1]&&(this.config.latitude_range=[this.config.latitude_range[1],this.config.latitude_range[0]],console.warn("PhotoSphereViewer: latitude_range values must be ordered.")):(void 0!==this.config.tilt_up_max||void 0!==this.config.tilt_down_max)&&(this.config.latitude_range=[void 0!==this.config.tilt_down_max?this.config.tilt_down_max-Math.PI/4:-M.HalfPI,void 0!==this.config.tilt_up_max?this.config.tilt_up_max+Math.PI/4:M.HalfPI],console.warn("PhotoSphereViewer: tilt_up_max and tilt_down_max are deprecated, use latitude_range instead.")),this.config.max_fov<this.config.min_fov&&(this.config.max_fov=r.DEFAULTS.max_fov,this.config.min_fov=r.DEFAULTS.min_fov,console.warn("PhotoSphereViewer: max_fov cannot be lower than min_fov.")),this.config.cache_texture&&(!M.isInteger(this.config.cache_texture)||this.config.cache_texture<0)&&(this.config.cache_texture=r.DEFAULTS.cache_texture,console.warn("PhotoSphreViewer: invalid valud for cache_texture")),this.config.min_fov=M.stayBetween(this.config.min_fov,1,179),this.config.max_fov=M.stayBetween(this.config.max_fov,1,179),this.config.default_fov=null===this.config.default_fov?this.config.max_fov/2+this.config.min_fov/2:M.stayBetween(this.config.default_fov,this.config.min_fov,this.config.max_fov),this.config.default_long=M.parseAngle(this.config.default_long),this.config.default_lat=M.stayBetween(M.parseAngle(this.config.default_lat,-Math.PI),-M.HalfPI,M.HalfPI),this.config.anim_lat=null===this.config.anim_lat?this.config.default_lat:M.stayBetween(M.parseAngle(this.config.anim_lat,-Math.PI),-M.HalfPI,M.HalfPI),this.config.anim_speed=M.parseSpeed(this.config.anim_speed),this.config.caption&&!this.config.navbar&&(this.config.navbar=["caption"]),this.config.longitude_range&&(this.config.longitude_range=this.config.longitude_range.map(function(t){return M.parseAngle(t)})),this.config.latitude_range&&(this.config.latitude_range=this.config.latitude_range.map(function(t){return M.stayBetween(M.parseAngle(t,-Math.PI),-M.HalfPI,M.HalfPI)})),this.config.fisheye===!0?this.config.fisheye=1:this.config.fisheye===!1&&(this.config.fisheye=0),this.parent="string"==typeof t.container?document.getElementById(t.container):t.container,this.container=null,this.loader=null,this.navbar=null,this.hud=null,this.panel=null,this.tooltip=null,this.canvas_container=null,this.renderer=null,this.composer=null,this.passes={},this.scene=null,this.camera=null,this.mesh=null,this.raycaster=null,this.doControls=null,this.prop={latitude:0,longitude:0,anim_speed:0,zoom_lvl:0,vFov:0,hFov:0,aspect:0,move_speed:.1,moving:!1,zooming:!1,start_mouse_x:0,start_mouse_y:0,mouse_x:0,mouse_y:0,mouse_history:[],pinch_dist:0,direction:null,orientation_reqid:null,autorotate_reqid:null,animation_promise:null,loading_promise:null,start_timeout:null,cache:[],size:{width:0,height:0},pano_data:{full_width:0,full_height:0,cropped_width:0,cropped_height:0,cropped_x:0,cropped_y:0}},Object.keys(r.TEMPLATES).forEach(function(t){this.config.templates[t]||(this.config.templates[t]=r.TEMPLATES[t]),"string"==typeof this.config.templates[t]&&(this.config.templates[t]=n.template(this.config.templates[t]))},this),this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),null!==this.config.size&&this._setViewerSize(this.config.size),this._onResize();var e=Math.round((this.config.default_fov-this.config.min_fov)/(this.config.max_fov-this.config.min_fov)*100);this.zoom(e-2*(e-50),!1),this.prop.move_speed=1/r.SYSTEM.pixelRatio*Math.PI/180*this.config.move_speed,this.rotate({longitude:this.config.default_long,latitude:this.config.default_lat},!1),this.config.navbar&&(this.container.classList.add("psv-container--has-navbar"),this.navbar=new c(this),this.navbar.hide()),this.hud=new a(this),this.hud.hide(),this.panel=new d(this),this.tooltip=new p(this.hud),this.parent.photoSphereViewer=this,this._bindEvents(),this.config.autoload&&this.load(),this.once("render",function(){this.config.navbar&&this.navbar.show(),this.hud.show(),this.config.markers&&(this.config.markers.forEach(function(t){this.hud.addMarker(t,!1)},this),this.hud.updatePositions()),this.trigger("ready")}.bind(this))}function o(t){this.psv=t instanceof r?t:t.psv,this.parent=t,this.container=null,this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(t){this.psv[t]=this[t].bind(this)},this)}function a(t){o.call(this,t),this.$svg=null,this.markers={},this.currentMarker=null,this.hoveringMarker=null,this.create()}function s(t){o.call(this,t),this.canvas=null,this.loader=null,this.create()}function l(t,e){if(!t.id)throw new b("missing marker id");if(t.image&&(!t.width||!t.height))throw new b("missing marker width/height");if((t.image||t.html)&&!(t.hasOwnProperty("x")&&t.hasOwnProperty("y")||t.hasOwnProperty("latitude")&&t.hasOwnProperty("longitude")))throw new b("missing marker position, latitude/longitude or x/y");this.psv=e,this.visible=!0,this.lockRotation=!1,this.dynamicSize=!1;var i,n=t.id,r=l.getType(t,!1);Object.defineProperties(this,{id:{configurable:!1,enumerable:!0,get:function(){return n},set:function(){}},type:{configurable:!1,enumerable:!0,get:function(){return r},set:function(){}},$el:{configurable:!1,enumerable:!0,get:function(){return i},set:function(){}},_def:{configurable:!1,enumerable:!0,get:function(){return this[r]},set:function(t){this[r]=t}}}),i=this.isNormal()?document.createElement("div"):this.isPolygon()?document.createElementNS(a.svgNS,"polygon"):document.createElementNS(a.svgNS,this.type),i.id="psv-marker-"+this.id,i.psvMarker=this,this.update(t)}function c(t){if(o.call(this,t),this.config=this.psv.config.navbar,this.items=[],this.config===!0)this.config=M.clone(r.DEFAULTS.navbar);else if("string"==typeof this.config)this.config=this.config.split(" ");else if(!Array.isArray(this.config)){console.warn('PhotoSphereViewer: hashmap form of "navbar" is deprecated, use an array instead.');var e=this.config;this.config=[];for(var i in e)e[i]&&this.config.push(i);this.config.sort(function(t,e){return r.DEFAULTS.navbar.indexOf(t)-r.DEFAULTS.navbar.indexOf(e)})}this.create()}function h(t,e){o.call(this,t),this.create(),this.setCaption(e)}function u(t,e){o.call(this,t),this.weight=e,this.create(),this.container.classList.add("psv-spacer--weight-"+(e||5))}function d(t){o.call(this,t),this.content=null,this.prop={mouse_x:0,mouse_y:0,mousedown:!1,opened:!1},this.create()}function p(t){o.call(this,t),this.config=this.psv.config.tooltip,this.timeout=null,this.create()}function f(t){o.call(this,t),this.constructor.id&&(this.id=this.constructor.id),this.enabled=!0}function m(t){f.call(this,t),this.create()}function g(t,e){f.call(this,t),this.config=e,this.config.id&&(this.id=this.config.id),this.create()}function v(t){f.call(this,t),this.create()}function y(t){f.call(this,t),this.create()}function _(t){f.call(this,t),this.create()}function w(t){f.call(this,t),this.prop={panelOpened:!1,panelOpening:!1},this.create()}function x(t){f.call(this,t),this.zoom_range=null,this.zoom_value=null,this.prop={mousedown:!1,buttondown:!1,longPressInterval:null},this.create()}function b(t){this.message=t,"captureStackTrace"in Error?Error.captureStackTrace(this,b):this.stack=(new Error).stack}i.mixin(r),r.prototype._loadXMP=function(t){if(!this.config.usexmpdata)return e.resolved(null);var i=e(),n=new XMLHttpRequest,r=this,o=0;return n.onreadystatechange=function(){if(4===n.readyState){if(200!==n.status&&201!==n.status&&202!==n.status&&0!==n.status)throw r.container.textContent="Cannot load image",new b("Cannot load image");r.loader&&r.loader.setProgress(100);var t=n.responseText,e=t.indexOf("<x:xmpmeta"),a=t.indexOf("</x:xmpmeta>"),s=t.substring(e,a);if(-1===e||-1===a||-1===s.indexOf("GPano:"))i.resolve(null);else{var l={full_width:parseInt(M.getXMPValue(s,"FullPanoWidthPixels")),full_height:parseInt(M.getXMPValue(s,"FullPanoHeightPixels")),cropped_width:parseInt(M.getXMPValue(s,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(M.getXMPValue(s,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(M.getXMPValue(s,"CroppedAreaLeftPixels")),cropped_y:parseInt(M.getXMPValue(s,"CroppedAreaTopPixels"))};l.full_width&&l.full_height&&l.cropped_width&&l.cropped_height?i.resolve(l):(console.warn("PhotoSphereViewer: invalid XMP data"),i.resolve(null))}}else 3===n.readyState&&r.loader&&r.loader.setProgress(o+=10)},n.onprogress=function(t){if(t.lengthComputable&&r.loader){var e=parseInt(t.loaded/t.total*100);e>o&&(o=e,r.loader.setProgress(o))}},n.onerror=function(){throw r.container.textContent="Cannot load image",new b("Cannot load image")},n.open("GET",t,!0),n.send(null),i.promise},r.prototype._loadTexture=function(i){var n=this;if(this.config.cache_texture){var o=this.getPanoramaCache(i);if(o)return this.prop.pano_data=o.pano_data,e.resolved(o.image)}return this._loadXMP(i).then(function(o){var a=e(),s=new t.ImageLoader,l=o?100:0;s.setCrossOrigin("anonymous");var c=function(e){n.loader&&n.loader.setProgress(100),n.trigger("panorama-load-progress",i,100),!o&&n.config.pano_data&&(o=M.clone(n.config.pano_data)),o||(o={full_width:e.width,full_height:e.height,cropped_width:e.width,cropped_height:e.height,cropped_x:0,cropped_y:0}),n.prop.pano_data=o;var s=Math.min(o.full_width,r.SYSTEM.maxTextureWidth)/o.full_width,l=M.clone(o);l.full_width*=s,l.full_height*=s,l.cropped_width*=s,l.cropped_height*=s,l.cropped_x*=s,l.cropped_y*=s,e.width=l.cropped_width,e.height=l.cropped_height;var c=document.createElement("canvas");c.width=l.full_width,c.height=l.full_height;var h=c.getContext("2d");h.drawImage(e,l.cropped_x,l.cropped_y,l.cropped_width,l.cropped_height);var u=new t.Texture(c);u.needsUpdate=!0,u.minFilter=t.LinearFilter,u.generateMipmaps=!1,n.config.cache_texture&&n._putPanoramaCache({panorama:i,image:u,pano_data:o}),a.resolve(u)},h=function(t){if(t.lengthComputable&&n.loader){var e=parseInt(t.loaded/t.total*100);e>l&&(l=e,n.loader.setProgress(l),n.trigger("panorama-load-progress",i,l))}},u=function(){throw n.container.textContent="Cannot load image",new b("Cannot load image")};return s.load(i,c,h,u),a.promise})},r.prototype._setTexture=function(t){this.scene||this._createScene(),this.mesh.material.map&&this.mesh.material.map.dispose(),this.mesh.material.map=t,this.trigger("panorama-loaded"),this.render()},r.prototype._createScene=function(){this.raycaster=new t.Raycaster,this.renderer=r.SYSTEM.isWebGLSupported&&this.config.webgl?new t.WebGLRenderer:new t.CanvasRenderer,this.renderer.setSize(this.prop.size.width,this.prop.size.height),this.renderer.setPixelRatio(r.SYSTEM.pixelRatio),this.camera=new t.PerspectiveCamera(this.config.default_fov,this.prop.size.width/this.prop.size.height,1,2*r.SPHERE_RADIUS),this.camera.position.set(0,0,0),this.config.gyroscope&&M.checkTHREE("DeviceOrientationControls")&&(this.doControls=new t.DeviceOrientationControls(this.camera)),this.scene=new t.Scene,this.scene.add(this.camera);var e=new t.SphereGeometry(r.SPHERE_RADIUS,this.config.sphere_segments,this.config.sphere_segments,-M.HalfPI),i=new t.MeshBasicMaterial;i.side=t.DoubleSide,i.overdraw=r.SYSTEM.isWebGLSupported&&this.config.webgl?0:.5,this.mesh=new t.Mesh(e,i),this.mesh.scale.x=-1,this.scene.add(this.mesh),this.canvas_container=document.createElement("div"),this.canvas_container.className="psv-canvas-container",this.renderer.domElement.className="psv-canvas",this.container.appendChild(this.canvas_container),this.canvas_container.appendChild(this.renderer.domElement),this.config.time_anim!==!1&&(this.prop.start_timeout=window.setTimeout(this.startAutorotate.bind(this),this.config.time_anim)),this.config.transition&&this.config.transition.blur&&(this.composer=new t.EffectComposer(this.renderer),this.passes.render=new t.RenderPass(this.scene,this.camera),this.passes.copy=new t.ShaderPass(t.CopyShader),this.passes.copy.renderToScreen=!0,this.passes.blur=new t.ShaderPass(t.GodraysShader),this.passes.blur.enabled=!1,this.passes.blur.renderToScreen=!0,this.passes.blur.uniforms.fDensity.value=0,this.passes.blur.uniforms.fWeight.value=.5,this.passes.blur.uniforms.fDecay.value=.5,this.passes.blur.uniforms.fExposure.value=1,this.composer.addPass(this.passes.render),this.composer.addPass(this.passes.copy),this.composer.addPass(this.passes.blur))},r.prototype._transition=function(e,i){var n=this,o=new t.SphereGeometry(1.5*r.SPHERE_RADIUS,this.config.sphere_segments,this.config.sphere_segments,-M.HalfPI),a=new t.MeshBasicMaterial;a.side=t.DoubleSide,a.overdraw=r.SYSTEM.isWebGLSupported&&this.config.webgl?0:.5,a.map=e,a.transparent=!0,a.opacity=0;var s=new t.Mesh(o,a);if(s.scale.x=-1,i){s.rotateY(i.longitude-this.prop.longitude);var l=new t.Vector3(0,1,0).cross(this.camera.getWorldDirection()).normalize(),c=(new t.Quaternion).setFromAxisAngle(l,i.latitude-this.prop.latitude);s.quaternion.multiplyQuaternions(c,s.quaternion)}this.scene.add(s),this.render();var h=this.prop.zoom_lvl;this.config.transition.blur&&(this.passes.copy.enabled=!1,this.passes.blur.enabled=!0);var u=function(t){a.opacity=t.opacity,n.config.transition.blur&&(n.passes.blur.uniforms.fDensity.value=t.density,n.zoom(t.zoom,!1)),n.render()};return M.animation({properties:{density:{start:0,end:1.5},opacity:{start:0,end:.5},zoom:{start:h,end:100}},duration:n.config.transition.duration/(n.config.transition.blur?4/3:2),easing:n.config.transition.blur?"outCubic":"linear",onTick:u}).then(function(){return M.animation({properties:{density:{start:1.5,end:0},opacity:{start:.5,end:1},zoom:{start:100,end:h}},duration:n.config.transition.duration/(n.config.transition.blur?4:2),easing:n.config.transition.blur?"inCubic":"linear",onTick:u})}).then(function(){n.config.transition.blur&&(n.passes.copy.enabled=!0,n.passes.blur.enabled=!1,n.zoom(h,!1)),n.mesh.material.map.dispose(),n.mesh.material.map=e,n.scene.remove(s),s.geometry.dispose(),s.geometry=null,s.material.dispose(),s.material=null,i?((n.config.latitude_range||n.config.longitude_range)&&(n.config.longitude_range=n.config.latitude_range=null,console.warn("PhotoSphereViewer: trying to perform transition with longitude_range and/or latitude_range, ranges cleared.")),n.rotate(i)):n.render()})},r.prototype._reverseAutorotate=function(){var t=this,e=-this.config.anim_speed,i=this.config.longitude_range;this.config.longitude_range=null,M.animation({properties:{speed:{start:this.config.anim_speed,end:0}},duration:300,easing:"inSine",onTick:function(e){t.config.anim_speed=e.speed}}).then(function(){return M.animation({properties:{speed:{start:0,end:e}},duration:300,easing:"outSine",onTick:function(e){t.config.anim_speed=e.speed}})}).then(function(){t.config.longitude_range=i,t.config.anim_speed=e})},r.prototype._putPanoramaCache=function(t){if(!this.config.cache_texture)throw new b("Cannot add panorama to cache, cache_texture is disabled");var e=this.getPanoramaCache(t.panorama);e?(e.image=t.image,e.pano_data=t.pano_data):(this.prop.cache=this.prop.cache.slice(0,this.config.cache_texture-1),this.prop.cache.unshift(t)),this.trigger("panorama-cached",t.panorama)},r.MOVE_THRESHOLD=4,r.INERTIA_WINDOW=300,r.SPHERE_RADIUS=100,r.KEYMAP={33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",107:"+",109:"-"},r.ICONS={},r.SYSTEM={loaded:!1,pixelRatio:1,isWebGLSupported:!1,isCanvasSupported:!1,deviceOrientationSupported:null,maxTextureWidth:0,mouseWheelEvent:null,fullscreenEvent:null},r.DEFAULTS={panorama:null,container:null,caption:null,autoload:!0,usexmpdata:!0,pano_data:null,webgl:!0,sphere_segments:64,min_fov:30,max_fov:90,default_fov:null,default_long:0,default_lat:0,longitude_range:null,latitude_range:null,move_speed:1,time_anim:2e3,anim_speed:"2rpm",anim_lat:null,fisheye:!1,navbar:["autorotate","zoom","download","markers","caption","gyroscope","fullscreen"],tooltip:{offset:5,arrow_size:7,delay:100},lang:{autorotate:"Automatic rotation",zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",download:"Download",fullscreen:"Fullscreen",markers:"Markers",gyroscope:"Gyroscope"},mousewheel:!0,mousemove:!0,keyboard:!0,gyroscope:!1,move_inertia:!0,click_event_on_marker:!1,transition:{duration:1500,loader:!0,blur:!1},loading_img:null,loading_txt:"Loading...",size:null,cache_texture:5,templates:{},markers:[]},r.TEMPLATES={markersList:'<div class="psv-markers-list-container">   <h1 class="psv-markers-list-title">{{= it.config.lang.markers }}</h1>   <ul class="psv-markers-list">   {{~ it.markers: marker }}     <li data-psv-marker="{{= marker.id }}" class="psv-markers-list-item {{? marker.className }}{{= marker.className }}{{?}}">       {{? marker.image }}<img class="psv-markers-list-image" src="{{= marker.image }}"/>{{?}}       <p class="psv-markers-list-name">{{? marker.tooltip }}{{= marker.tooltip.content }}{{?? marker.html }}{{= marker.html }}{{??}}{{= marker.id }}{{?}}</p>     </li>   {{~}}   </ul> </div>'},r.prototype._bindEvents=function(){window.addEventListener("resize",this),document.addEventListener(r.SYSTEM.fullscreenEvent,this),this.config.mousemove&&(this.hud.container.style.cursor="move",this.hud.container.addEventListener("mousedown",this),this.hud.container.addEventListener("touchstart",this),window.addEventListener("mouseup",this),window.addEventListener("touchend",this),this.hud.container.addEventListener("mousemove",this),this.hud.container.addEventListener("touchmove",this)),this.config.mousewheel&&this.hud.container.addEventListener(r.SYSTEM.mouseWheelEvent,this),this.on("_side-reached",function(t){this.isAutorotateEnabled()&&("left"===t||"right"===t)&&this._reverseAutorotate()})},r.prototype.handleEvent=function(t){switch(t.type){case"resize":M.throttle(this._onResize(),50);break;case"keydown":this._onKeyDown(t);break;case"mousedown":this._onMouseDown(t);break;case"touchstart":this._onTouchStart(t);break;case"mouseup":this._onMouseUp(t);break;case"touchend":this._onTouchEnd(t);break;case"mousemove":this._onMouseMove(t);break;case"touchmove":this._onTouchMove(t);break;case r.SYSTEM.fullscreenEvent:this._fullscreenToggled();break;case r.SYSTEM.mouseWheelEvent:this._onMouseWheel(t)}},r.prototype._onResize=function(){(this.container.clientWidth!=this.prop.size.width||this.container.clientHeight!=this.prop.size.height)&&(this.prop.size.width=parseInt(this.container.clientWidth),this.prop.size.height=parseInt(this.container.clientHeight),this.prop.aspect=this.prop.size.width/this.prop.size.height,this.renderer&&(this.renderer.setSize(this.prop.size.width,this.prop.size.height),this.composer&&this.composer.reset(new t.WebGLRenderTarget(this.prop.size.width,this.prop.size.height)),this.render()),this.trigger("size-updated",this.getSize()))},r.prototype._onKeyDown=function(t){var e=0,i=0,n=0,o=t.key||r.KEYMAP[t.keyCode||t.which];switch(o){case"ArrowUp":i=.01;break;case"ArrowDown":i=-.01;break;case"ArrowRight":e=.01;break;case"ArrowLeft":e=-.01;break;case"PageUp":case"+":n=1;break;case"PageDown":case"-":n=-1}0!==n?this.zoom(this.prop.zoom_lvl+n):(0!==i||0!==e)&&this.rotate({longitude:this.prop.longitude+e*this.prop.move_speed*this.prop.hFov,latitude:this.prop.latitude+i*this.prop.move_speed*this.prop.vFov})},r.prototype._onMouseDown=function(t){this._startMove(t)},r.prototype._onTouchStart=function(t){1===t.touches.length?this._startMove(t.touches[0]):2===t.touches.length&&this._startZoom(t)},r.prototype._startMove=function(t){this.isGyroscopeEnabled()||(this.stopAll(),this.prop.mouse_x=this.prop.start_mouse_x=parseInt(t.clientX),this.prop.mouse_y=this.prop.start_mouse_y=parseInt(t.clientY),this.prop.moving=!0,this.prop.zooming=!1,this.prop.mouse_history.length=0,this._logMouseMove(t))},r.prototype._startZoom=function(t){var e=[{x:parseInt(t.touches[0].clientX),y:parseInt(t.touches[0].clientY)},{x:parseInt(t.touches[1].clientX),y:parseInt(t.touches[1].clientY)}];this.prop.pinch_dist=Math.sqrt(Math.pow(e[0].x-e[1].x,2)+Math.pow(e[0].y-e[1].y,2)),this.prop.moving=!1,this.prop.zooming=!0},r.prototype._onMouseUp=function(t){this._stopMove(t)},r.prototype._onTouchEnd=function(t){this._stopMove(t.changedTouches[0])},r.prototype._stopMove=function(t){return this.isGyroscopeEnabled()?void this._click(t):(this.prop.moving&&(Math.abs(t.clientX-this.prop.start_mouse_x)<r.MOVE_THRESHOLD&&Math.abs(t.clientY-this.prop.start_mouse_y)<r.MOVE_THRESHOLD?(this._click(t),this.prop.moving=!1):this.config.move_inertia?(this._logMouseMove(t),this._stopMoveInertia(t)):this.prop.moving=!1),this.prop.mouse_history.length=0,void(this.prop.zooming=!1))},r.prototype._stopMoveInertia=function(t){var e=this,i={x:t.clientX-this.prop.mouse_history[0][1],y:t.clientY-this.prop.mouse_history[0][2]},n=Math.sqrt(i.x*i.x+i.y*i.y);this.prop.animation_promise=M.animation({properties:{clientX:{start:t.clientX,end:t.clientX+i.x},clientY:{start:t.clientY,end:t.clientY+i.y}},duration:n*r.INERTIA_WINDOW/100,easing:"outCirc",onTick:function(t){e._move(t)},onCancel:function(){e.prop.moving=!1},onDone:function(){e.prop.moving=!1}})},r.prototype._click=function(t){var e=this.container.getBoundingClientRect(),i={target:t.target,client_x:t.clientX,client_y:t.clientY,viewer_x:parseInt(t.clientX-e.left),viewer_y:parseInt(t.clientY-e.top)},n=this.viewerCoordsToVector3(i.viewer_x,i.viewer_y);if(n){var r=this.vector3ToSphericalCoords(n);i.longitude=r.longitude,i.latitude=r.latitude;var o=this.sphericalCoordsToTextureCoords(i.longitude,i.latitude);i.texture_x=o.x,i.texture_y=o.y,this.trigger("click",i)}},r.prototype._onMouseMove=function(t){0!==t.buttons&&(t.preventDefault(),this._move(t))},r.prototype._onTouchMove=function(t){1===t.touches.length?(t.preventDefault(),this._move(t.touches[0])):2===t.touches.length&&(t.preventDefault(),this._zoom(t))},r.prototype._move=function(t){if(this.prop.moving){var e=parseInt(t.clientX),i=parseInt(t.clientY);this.rotate({longitude:this.prop.longitude-(e-this.prop.mouse_x)/this.prop.size.width*this.prop.move_speed*this.prop.hFov,latitude:this.prop.latitude+(i-this.prop.mouse_y)/this.prop.size.height*this.prop.move_speed*this.prop.vFov}),this.prop.mouse_x=e,this.prop.mouse_y=i,this._logMouseMove(t)}},r.prototype._zoom=function(t){if(this.prop.zooming){var e=[{x:parseInt(t.touches[0].clientX),y:parseInt(t.touches[0].clientY)},{x:parseInt(t.touches[1].clientX),y:parseInt(t.touches[1].clientY)}],i=Math.sqrt(Math.pow(e[0].x-e[1].x,2)+Math.pow(e[0].y-e[1].y,2)),n=80*(i-this.prop.pinch_dist)/this.prop.size.width;this.zoom(this.prop.zoom_lvl+n),this.prop.pinch_dist=i}},r.prototype._onMouseWheel=function(t){t.preventDefault(),t.stopPropagation();var e=void 0!==t.deltaY?-t.deltaY:void 0!==t.wheelDelta?t.wheelDelta:-t.detail;if(0!==e){var i=parseInt(e/Math.abs(e));this.zoom(this.prop.zoom_lvl+i)}},r.prototype._fullscreenToggled=function(){var t=this.isFullscreenEnabled();this.config.keyboard&&(t?this.startKeyboardControl():this.stopKeyboardControl()),this.trigger("fullscreen-updated",t)},r.prototype._logMouseMove=function(t){var e=Date.now();this.prop.mouse_history.push([e,t.clientX,t.clientY]);for(var i=null,n=0;n<this.prop.mouse_history.length;)this.prop.mouse_history[0][n]<e-r.INERTIA_WINDOW?this.prop.mouse_history.splice(n,1):i&&this.prop.mouse_history[0][n]-i>r.INERTIA_WINDOW/10?(this.prop.mouse_history.splice(0,n),n=0,i=this.prop.mouse_history[0][n]):(n++,i=this.prop.mouse_history[0][n])},r.prototype.load=function(){if(!this.config.panorama)throw new b("No value given for panorama.");this.setPanorama(this.config.panorama,!1)},r.prototype.getPosition=function(){return{longitude:this.prop.longitude,latitude:this.prop.latitude}},r.prototype.getZoomLevel=function(){return this.prop.zoom_lvl},r.prototype.getSize=function(){return{width:this.prop.size.width,height:this.prop.size.height}},r.prototype.isAutorotateEnabled=function(){return!!this.prop.autorotate_reqid},r.prototype.isGyroscopeEnabled=function(){return!!this.prop.orientation_reqid},r.prototype.isFullscreenEnabled=function(){return M.isFullscreenEnabled(this.parent)},r.prototype.render=function(t){t!==!1&&(this.prop.direction=this.sphericalCoordsToVector3(this.prop.longitude,this.prop.latitude),this.config.fisheye&&(this.prop.direction.multiplyScalar(this.config.fisheye/2),this.camera.position.copy(this.prop.direction).negate()),this.camera.lookAt(this.prop.direction)),this.camera.aspect=this.prop.aspect,this.camera.fov=this.prop.vFov,this.camera.updateProjectionMatrix(),this.composer?this.composer.render():this.renderer.render(this.scene,this.camera),this.trigger("render")},r.prototype.destroy=function(){this.stopAll(),this.stopKeyboardControl(),this.isFullscreenEnabled()&&M.exitFullscreen(),window.removeEventListener("resize",this),document.removeEventListener(r.SYSTEM.fullscreenEvent,this),this.config.mousemove&&(this.hud.container.removeEventListener("mousedown",this),this.hud.container.removeEventListener("touchstart",this),window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),this.hud.container.removeEventListener("mousemove",this),this.hud.container.removeEventListener("touchmove",this)),this.config.mousewheel&&this.hud.container.removeEventListener(r.SYSTEM.mouseWheelEvent,this),this.tooltip&&this.tooltip.destroy(),this.hud&&this.hud.destroy(),this.loader&&this.loader.destroy(),this.navbar&&this.navbar.destroy(),this.panel&&this.panel.destroy(),this.doControls&&this.doControls.disconnect(),this.scene&&(this.scene.remove(this.camera),this.scene.remove(this.mesh)),this.mesh&&(this.mesh.geometry.dispose(),this.mesh.geometry=null,this.mesh.material.map.dispose(),this.mesh.material.map=null,this.mesh.material.dispose(),this.mesh.material=null),this.canvas_container&&this.container.removeChild(this.canvas_container),this.parent.removeChild(this.container),delete this.parent.photoSphereViewer,delete this.parent,delete this.container,delete this.loader,delete this.navbar,delete this.hud,delete this.panel,delete this.tooltip,delete this.canvas_container,delete this.renderer,delete this.composer,delete this.scene,delete this.camera,delete this.mesh,delete this.doControls,delete this.raycaster,delete this.passes,delete this.config,this.prop.cache.length=0},r.prototype.setPanorama=function(t,e,i){if(null!==this.prop.loading_promise)throw new b("Loading already in progress");"boolean"==typeof e&&(i=e,e=void 0),e&&(this.cleanPosition(e),this.stopAll()),this.config.panorama=t;var n=this;return i&&this.config.transition&&this.scene?(this.config.transition.loader&&(this.loader=new s(this)),this.prop.loading_promise=this._loadTexture(this.config.panorama).then(function(t){return n.loader&&(n.loader.destroy(),n.loader=null),n._transition(t,e)}).ensure(function(){n.loader&&(n.loader.destroy(),n.loader=null),n.prop.loading_promise=null}).rethrow()):(this.loader=new s(this),this.prop.loading_promise=this._loadTexture(this.config.panorama).ensure(function(){n.loader&&(n.loader.destroy(),n.loader=null),n.prop.loading_promise=null}).then(function(t){n._setTexture(t),e&&n.rotate(e)}).rethrow()),this.prop.loading_promise},r.prototype.stopAll=function(){this.stopAutorotate(),this.stopAnimation(),this.stopGyroscopeControl()},r.prototype.startAutorotate=function(){this.stopAll();var t=this,e=null,i=null;!function n(r){r&&(i=null===e?0:r-e,e=r,t.rotate({longitude:t.prop.longitude+t.config.anim_speed*i/1e3,latitude:t.prop.latitude-(t.prop.latitude-t.config.anim_lat)/200})),t.prop.autorotate_reqid=window.requestAnimationFrame(n)}(null),this.trigger("autorotate",!0)},r.prototype.stopAutorotate=function(){this.prop.start_timeout&&(window.clearTimeout(this.prop.start_timeout),this.prop.start_timeout=null),this.prop.autorotate_reqid&&(window.cancelAnimationFrame(this.prop.autorotate_reqid),this.prop.autorotate_reqid=null,this.trigger("autorotate",!1))},r.prototype.toggleAutorotate=function(){this.isAutorotateEnabled()?this.stopAutorotate():this.startAutorotate()},r.prototype.startGyroscopeControl=function(){if(!this.config.gyroscope)return void console.warn("PhotoSphereViewer: gyroscope disabled");this.stopAll();var t=this;!function e(){t.doControls.update(),t.prop.direction=t.camera.getWorldDirection();var i=t.vector3ToSphericalCoords(t.prop.direction);t.prop.longitude=i.longitude,t.prop.latitude=i.latitude,t.render(!1),t.prop.orientation_reqid=window.requestAnimationFrame(e)}(),this.trigger("gyroscope-updated",!0)},r.prototype.stopGyroscopeControl=function(){this.prop.orientation_reqid&&(window.cancelAnimationFrame(this.prop.orientation_reqid),this.prop.orientation_reqid=null,this.trigger("gyroscope-updated",!1),this.render())},r.prototype.toggleGyroscopeControl=function(){this.isGyroscopeEnabled()?this.stopGyroscopeControl():this.startGyroscopeControl()},r.prototype.rotate=function(t,e){this.cleanPosition(t),this.applyRanges(t),this.prop.longitude=t.longitude,this.prop.latitude=t.latitude,e!==!1&&this.renderer&&(this.render(),this.trigger("position-updated",this.getPosition()))},r.prototype.animate=function(t,e){if(this.stopAll(),!e)return void this.rotate(t);if(this.cleanPosition(t),this.applyRanges(t),!e&&"number"!=typeof e){e=e?M.parseSpeed(e):this.config.anim_speed;var i=Math.acos(Math.cos(this.prop.latitude)*Math.cos(t.latitude)*Math.cos(this.prop.longitude-t.longitude)+Math.sin(this.prop.latitude)*Math.sin(t.latitude));e=i/e*1e3}var n=this.getShortestArc(this.prop.longitude,t.longitude);return this.prop.animation_promise=M.animation({properties:{longitude:{start:this.prop.longitude,end:this.prop.longitude+n},latitude:{start:this.prop.latitude,end:t.latitude}},duration:e,easing:"inOutSine",onTick:this.rotate.bind(this)}),this.prop.animation_promise},r.prototype.stopAnimation=function(){this.prop.animation_promise&&(this.prop.animation_promise.cancel(),this.prop.animation_promise=null)},r.prototype.zoom=function(t,e){this.prop.zoom_lvl=M.stayBetween(Math.round(t),0,100),this.prop.vFov=this.config.max_fov+this.prop.zoom_lvl/100*(this.config.min_fov-this.config.max_fov),this.prop.hFov=2*Math.atan(Math.tan(this.prop.vFov*Math.PI/180/2)*this.prop.aspect)*180/Math.PI,e!==!1&&this.renderer&&(this.render(),this.trigger("zoom-updated",this.getZoomLevel()))},r.prototype.zoomIn=function(){this.prop.zoom_lvl<100&&this.zoom(this.prop.zoom_lvl+1)},r.prototype.zoomOut=function(){this.prop.zoom_lvl>0&&this.zoom(this.prop.zoom_lvl-1)},r.prototype.toggleFullscreen=function(){this.isFullscreenEnabled()?M.exitFullscreen():M.requestFullscreen(this.parent)},r.prototype.startKeyboardControl=function(){window.addEventListener("keydown",this)},r.prototype.stopKeyboardControl=function(){window.removeEventListener("keydown",this)},r.prototype.preloadPanorama=function(t){if(!this.config.cache_texture)throw new b("Cannot preload panorama, cache_texture is disabled");return this._loadTexture(t)},r.prototype.clearPanoramaCache=function(t){if(!this.config.cache_texture)throw new b("Cannot clear cache, cache_texture is disabled");if(t){for(var e=0,i=this.prop.cache.length;i>e;e++)if(this.prop.cache[e].panorama===t){this.prop.cache.splice(e,1);break}}else this.prop.cache.length=0},r.prototype.getPanoramaCache=function(t){if(!this.config.cache_texture)throw new b("Cannot query cache, cache_texture is disabled");return this.prop.cache.filter(function(e){return e.panorama===t}).shift()},r.loadSystem=function(){var t=r.SYSTEM;
t.loaded=!0,t.pixelRatio=window.devicePixelRatio||1,t.isWebGLSupported=M.isWebGLSupported(),t.isCanvasSupported=M.isCanvasSupported(),t.maxTextureWidth=t.isWebGLSupported?M.getMaxTextureWidth():4096,t.mouseWheelEvent=M.mouseWheelEvent(),t.fullscreenEvent=M.fullscreenEvent(),t.deviceOrientationSupported=e(),"DeviceOrientationEvent"in window?window.addEventListener("deviceorientation",r.deviceOrientationListener,!1):t.deviceOrientationSupported.reject()},r.deviceOrientationListener=function(t){null!==t.alpha?r.SYSTEM.deviceOrientationSupported.resolve():r.SYSTEM.deviceOrientationSupported.reject(),window.removeEventListener("deviceorientation",r.deviceOrientationListener)},r.prototype._setViewerSize=function(t){["width","height"].forEach(function(e){t[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])},this)},r.prototype.textureCoordsToSphericalCoords=function(t,e){var i=(t+this.prop.pano_data.cropped_x)/this.prop.pano_data.full_width*M.TwoPI,n=(e+this.prop.pano_data.cropped_y)/this.prop.pano_data.full_height*Math.PI;return{longitude:i>=Math.PI?i-Math.PI:i+Math.PI,latitude:M.HalfPI-n}},r.prototype.sphericalCoordsToTextureCoords=function(t,e){var i=t/M.TwoPI*this.prop.pano_data.full_width,n=e/Math.PI*this.prop.pano_data.full_height;return{x:parseInt(t<Math.PI?i+this.prop.pano_data.full_width/2:i-this.prop.pano_data.full_width/2)-this.prop.pano_data.cropped_x,y:parseInt(this.prop.pano_data.full_height/2-n)-this.prop.pano_data.cropped_y}},r.prototype.sphericalCoordsToVector3=function(e,i){return new t.Vector3(r.SPHERE_RADIUS*-Math.cos(i)*Math.sin(e),r.SPHERE_RADIUS*Math.sin(i),r.SPHERE_RADIUS*Math.cos(i)*Math.cos(e))},r.prototype.vector3ToSphericalCoords=function(t){var e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),i=Math.atan2(t.x,t.z);return{longitude:0>i?-i:M.TwoPI-i,latitude:M.HalfPI-e}},r.prototype.viewerCoordsToVector3=function(e,i){var n=new t.Vector2(2*e/this.prop.size.width-1,-2*i/this.prop.size.height+1);this.raycaster.setFromCamera(n,this.camera);var r=this.raycaster.intersectObjects(this.scene.children);return 1===r.length?r[0].point:null},r.prototype.vector3ToViewerCoords=function(t){return t=t.clone(),t.project(this.camera),{top:parseInt((1-t.y)/2*this.prop.size.height),left:parseInt((t.x+1)/2*this.prop.size.width)}},r.prototype.cleanPosition=function(t){if(t.hasOwnProperty("x")&&t.hasOwnProperty("y")){var e=this.textureCoordsToSphericalCoords(t.x,t.y);t.longitude=e.longitude,t.latitude=e.latitude}t.longitude=M.parseAngle(t.longitude),t.latitude=M.stayBetween(M.parseAngle(t.latitude,-Math.PI),-M.HalfPI,M.HalfPI)},r.prototype.applyRanges=function(t){var e,i;this.config.longitude_range&&(e=M.clone(this.config.longitude_range),i=this.prop.hFov/180*Math.PI/2,e[0]=M.parseAngle(e[0]+i),e[1]=M.parseAngle(e[1]-i),e[0]>e[1]?t.longitude>e[1]&&t.longitude<e[0]&&(t.longitude>e[0]/2+e[1]/2?(t.longitude=e[0],this.trigger("_side-reached","left")):(t.longitude=e[1],this.trigger("_side-reached","right"))):t.longitude<e[0]?(t.longitude=e[0],this.trigger("_side-reached","left")):t.longitude>e[1]&&(t.longitude=e[1],this.trigger("_side-reached","right"))),this.config.latitude_range&&(e=M.clone(this.config.latitude_range),i=this.prop.vFov/180*Math.PI/2,e[0]=M.parseAngle(Math.min(e[0]+i,e[1]),-Math.PI),e[1]=M.parseAngle(Math.max(e[1]-i,e[0]),-Math.PI),t.latitude<e[0]?(t.latitude=e[0],this.trigger("_side-reached","bottom")):t.latitude>e[1]&&(t.latitude=e[1],this.trigger("_side-reached","top")))},r.prototype.getShortestArc=function(t,e){var i=[0,M.TwoPI,-M.TwoPI];return i.reduce(function(i,n){return n=e-t+n,Math.abs(n)<Math.abs(i)?n:i},1/0)},o.prototype.create=function(){this.container=document.createElement("div"),this.constructor.className&&(this.container.className=this.constructor.className),this.parent.container.appendChild(this.container)},o.prototype.destroy=function(){this.parent.container.removeChild(this.container),this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(t){delete this.psv[t]},this),delete this.container,delete this.psv,delete this.parent},o.prototype.hide=function(){this.container.style.display="none"},o.prototype.show=function(){this.container.style.display=null},a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.className="psv-hud",a.publicMethods=["addMarker","removeMarker","updateMarker","clearMarkers","getMarker","getCurrentMarker","gotoMarker","hideMarker","showMarker","toggleMarker"],a.svgNS="https://www.w3.org/TR/SVG/",a.prototype.create=function(){o.prototype.create.call(this),this.$svg=document.createElementNS(a.svgNS,"svg"),this.$svg.setAttribute("class","psv-hud-svg-container"),this.container.appendChild(this.$svg),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.psv.on("click",this),this.psv.on("render",this)},a.prototype.destroy=function(){this.clearMarkers(!1),this.container.removeEventListener("mouseenter",this),this.container.removeEventListener("mouseleave",this),this.container.removeEventListener("mousemove",this),this.psv.off("click",this),this.psv.off("render",this),delete this.$svg,o.prototype.destroy.call(this)},a.prototype.handleEvent=function(t){switch(t.type){case"mouseenter":this._onMouseEnter(t);break;case"mouseleave":this._onMouseLeave(t);break;case"mousemove":this._onMouseMove(t);break;case"click":this._onClick(t.args[0],t);break;case"render":this.updatePositions()}},a.prototype.addMarker=function(t,e){if(!t.id)throw new b("missing marker id");if(this.markers[t.id])throw new b('marker "'+t.id+'" already exists');var i=new l(t,this.psv);return i.isNormal()?this.container.appendChild(i.$el):this.$svg.appendChild(i.$el),this.markers[i.id]=i,e!==!1&&this.updatePositions(),i},a.prototype.getMarker=function(t){var e="object"==typeof t?t.id:t;if(!this.markers[e])throw new b('cannot find marker "'+e+'"');return this.markers[e]},a.prototype.getCurrentMarker=function(){return this.currentMarker},a.prototype.updateMarker=function(t,e){var i=this.getMarker(t);return i.update(t),e!==!1&&this.updatePositions(),i},a.prototype.removeMarker=function(t,e){t=this.getMarker(t),t.isNormal()?this.container.removeChild(t.$el):this.$svg.removeChild(t.$el),this.hoveringMarker==t&&this.psv.tooltip.hideTooltip(),delete this.markers[t.id],e!==!1&&this.updatePositions()},a.prototype.clearMarkers=function(t){Object.keys(this.markers).forEach(function(t){this.removeMarker(t,!1)},this),t!==!1&&this.updatePositions()},a.prototype.gotoMarker=function(t,e){t=this.getMarker(t),this.psv.animate(t,e)},a.prototype.hideMarker=function(t){this.getMarker(t).visible=!1,this.updatePositions()},a.prototype.showMarker=function(t){this.getMarker(t).visible=!0,this.updatePositions()},a.prototype.toggleMarker=function(t){this.getMarker(t).visible^=!0,this.updatePositions()},a.prototype.updatePositions=function(){var t=this.psv.isGyroscopeEnabled()?this.psv.camera.rotation.z/Math.PI*180:0;for(var e in this.markers){var i=this.markers[e],n=i.visible;if(n&&i.isPolygon()){var r=this._getPolygonPositions(i);if(n=r.length>2){i.position2D=this._getPolygonDimensions(i,r);var o="";r.forEach(function(t){o+=t.left+","+t.top+" "}),i.$el.setAttributeNS(null,"points",o)}}else if(n){var a=this._getMarkerPosition(i);n=this._isMarkerVisible(i,a),n&&(i.position2D=a,i.$el.style.transform="translate3D("+a.left+"px, "+a.top+"px, 0px)"+(!i.lockRotation&&t?" rotateZ("+t+"deg)":""))}M.toggleClass(i.$el,"psv-marker--visible",n)}},a.prototype._isMarkerVisible=function(t,e){return t.position3D.dot(this.psv.prop.direction)>0&&e.left+t.width>=0&&e.left-t.width<=this.psv.prop.size.width&&e.top+t.height>=0&&e.top-t.height<=this.psv.prop.size.height},a.prototype._getMarkerPosition=function(t){if(t.dynamicSize){t.$el.classList.add("psv-marker--transparent");var e=t.$el.getBoundingClientRect();t.$el.classList.remove("psv-marker--transparent"),t.width=e.right-e.left,t.height=e.bottom-e.top}var i=this.psv.vector3ToViewerCoords(t.position3D);return i.top-=t.height*t.anchor.top,i.left-=t.width*t.anchor.left,i},a.prototype._getPolygonPositions=function(t){var e=t.positions3D.length,i=t.positions3D.map(function(t){return{vector:t,visible:t.dot(this.psv.prop.direction)>0}},this),n=[];return i.forEach(function(t,r){if(!t.visible){var o=[0===r?i[e-1]:i[r-1],r===e-1?i[0]:i[r+1]];o.forEach(function(e){e.visible&&n.push({visible:e,invisible:t,index:r})})}}),n.reverse().forEach(function(t){i.splice(t.index,0,{vector:this._getPolygonIntermediaryPoint(t.visible.vector,t.invisible.vector),visible:!0})},this),i.filter(function(t){return t.visible}).map(function(t){return this.psv.vector3ToViewerCoords(t.vector)},this)},a.prototype._getPolygonIntermediaryPoint=function(e,i){var n=this.psv.prop.direction.clone().normalize(),o=(new t.Vector3).crossVectors(e,i).normalize(),a=(new t.Vector3).crossVectors(o,e).normalize(),s=(new t.Vector3).addVectors(e.clone().multiplyScalar(-n.dot(a)),a.clone().multiplyScalar(n.dot(e))).normalize(),l=(new t.Vector3).crossVectors(s,n);return s.applyAxisAngle(l,.01).multiplyScalar(r.SPHERE_RADIUS)},a.prototype._getPolygonDimensions=function(t,e){var i=+1/0,n=+1/0,r=-1/0,o=-1/0;return e.forEach(function(t){i=Math.min(i,t.left),n=Math.min(n,t.top),r=Math.max(r,t.left),o=Math.max(o,t.top)}),t.width=r-i,t.height=o-n,{top:n,left:i}},a.prototype._onMouseEnter=function(t){var e;t.target&&(e=t.target.psvMarker)&&e.tooltip&&!e.isPolygon()&&(this.hoveringMarker=e,this.psv.tooltip.showTooltip({content:e.tooltip.content,position:e.tooltip.position,top:e.position2D.top,left:e.position2D.left,marker:e}))},a.prototype._onMouseLeave=function(t){var e;if(t.target&&(e=t.target.psvMarker)){if(e.isPolygon()&&t.relatedTarget&&M.hasParent(t.relatedTarget,this.psv.tooltip.container))return;this.hoveringMarker=null,this.psv.tooltip.hideTooltip()}},a.prototype._onMouseMove=function(t){if(!this.psv.prop.moving){var e;if(t.target&&(e=t.target.psvMarker)&&e.tooltip&&e.isPolygon()||t.target&&M.hasParent(t.target,this.psv.tooltip.container)&&(e=this.hoveringMarker)){this.hoveringMarker=e;var i=this.psv.container.getBoundingClientRect();this.psv.tooltip.showTooltip({content:e.tooltip.content,position:e.tooltip.position,top:t.clientY-i.top-this.psv.config.tooltip.arrow_size/2,left:t.clientX-i.left-this.psv.config.tooltip.arrow_size,marker:{width:2*this.psv.config.tooltip.arrow_size,height:2*this.psv.config.tooltip.arrow_size}})}else this.hoveringMarker&&this.hoveringMarker.isPolygon()&&this.psv.tooltip.hideTooltip()}},a.prototype._onClick=function(t,e){var i;t.target&&(i=M.getClosest(t.target,".psv-marker"))&&i.psvMarker?(this.currentMarker=i.psvMarker,this.psv.trigger("select-marker",i.psvMarker),this.psv.config.click_event_on_marker?t.marker=i.psvMarker:e.stopPropagation()):this.currentMarker&&(this.psv.trigger("unselect-marker",this.currentMarker),this.currentMarker=null),i&&i.psvMarker&&i.psvMarker.content?this.psv.panel.showPanel(i.psvMarker.content):this.psv.panel.prop.opened&&(e.stopPropagation(),this.psv.panel.hidePanel())},s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.className="psv-loader-container",s.prototype.create=function(){o.prototype.create.call(this),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.canvas=document.createElement("canvas"),this.canvas.className="psv-loader-canvas",this.canvas.width=this.loader.clientWidth,this.canvas.height=this.loader.clientWidth,this.loader.appendChild(this.canvas),this.tickness=(this.loader.offsetWidth-this.loader.clientWidth)/2;var t;if(this.psv.config.loading_img?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.psv.config.loading_img):this.psv.config.loading_txt&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.psv.config.loading_txt),t){var e=Math.round(Math.sqrt(2*Math.pow(this.canvas.width/2-this.tickness/2,2)));t.style.maxWidth=e+"px",t.style.maxHeight=e+"px",this.loader.appendChild(t)}},s.prototype.destroy=function(){delete this.loader,delete this.canvas,o.prototype.destroy.call(this)},s.prototype.setProgress=function(t){var e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=this.tickness,e.strokeStyle=M.getStyle(this.loader,"color"),e.beginPath(),e.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2-this.tickness/2,-Math.PI/2,t/100*2*Math.PI-Math.PI/2),e.stroke()},l.getType=function(t,e){var i=["image","html","polygon_px","polygon_rad","rect","circle","ellipse","path"],n=[];if(i.forEach(function(e){t[e]&&n.push(e)}),0===n.length&&!e)throw new b("missing marker content, either "+i.join(", "));if(n.length>1)throw new b("multiple marker content, either "+i.join(", "));return n[0]},l.prototype.isNormal=function(){return"image"==this.type||"html"==this.type},l.prototype.isPolygon=function(){return"polygon_px"==this.type||"polygon_rad"==this.type},l.prototype.isSvg=function(){return"rect"==this.type||"circle"==this.type||"ellipse"==this.type||"path"==this.type},l.prototype.update=function(t){if(t&&t!==this){var e=l.getType(t,!0);if(void 0!==e&&e!==this.type)throw new b("cannot change marker type");M.deepmerge(this,t)}this.isNormal()?this.$el.setAttribute("class","psv-marker psv-marker--normal"):this.$el.setAttribute("class","psv-marker psv-marker--svg"),this.className&&M.addClasses(this.$el,this.className),this.tooltip&&(this.$el.classList.add("has-tooltip"),"string"==typeof this.tooltip&&(this.tooltip={content:this.tooltip})),this.style&&M.deepmerge(this.$el.style,this.style),this.anchor=M.parsePosition(this.anchor),this.$el.style.transformOrigin=100*this.anchor.left+"% "+100*this.anchor.top+"%",this.isNormal()?this._updateNormal():this.isPolygon()?this._updatePolygon():this._updateSvg()},l.prototype._updateNormal=function(){this.width&&this.height?(this.$el.style.width=this.width+"px",this.$el.style.height=this.height+"px",this.dynamicSize=!1):this.dynamicSize=!0,this.image?this.$el.style.backgroundImage="url("+this.image+")":this.$el.innerHTML=this.html,this.psv.cleanPosition(this),this.position3D=this.psv.sphericalCoordsToVector3(this.longitude,this.latitude)},l.prototype._updateSvg=function(){switch(this.dynamicSize=!0,this.type){case"rect":"number"==typeof this._def?this._def={x:0,y:0,width:this._def,height:this._def}:Array.isArray(this._def)?this._def={x:0,y:0,width:this._def[0],height:this._def[1]}:this._def.x=this._def.y=0;break;case"circle":"number"==typeof this._def?this._def={cx:this._def,cy:this._def,r:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[0],r:this._def[0]}:this._def.cx=this._def.cy=this._def.r;break;case"ellipse":"number"==typeof this._def?this._def={cx:this._def,cy:this._def,rx:this._def,ry:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[1],rx:this._def[0],ry:this._def[1]}:(this._def.cx=this._def.rx,this._def.cy=this._def.ry);break;case"path":"string"==typeof this._def&&(this._def={d:this._def})}Object.getOwnPropertyNames(this._def).forEach(function(t){this.$el.setAttributeNS(null,t,this._def[t])},this),this.svgStyle?Object.getOwnPropertyNames(this.svgStyle).forEach(function(t){this.$el.setAttributeNS(null,t,this.svgStyle[t])},this):this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"),this.psv.cleanPosition(this),this.position3D=this.psv.sphericalCoordsToVector3(this.longitude,this.latitude)},l.prototype._updatePolygon=function(){this.dynamicSize=!0,this.svgStyle?Object.getOwnPropertyNames(this.svgStyle).forEach(function(t){this.$el.setAttributeNS(null,t,this.svgStyle[t])},this):this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"),[this.polygon_rad,this.polygon_px].forEach(function(t){if(t&&"object"!=typeof t[0])for(var e=0;e<t.length;e++)t.splice(e,2,[t[e],t[e+1]])}),this.polygon_rad=this.polygon_px?this.polygon_px.map(function(t){var e=this.psv.textureCoordsToSphericalCoords(t[0],t[1]);return[e.longitude,e.latitude]},this):this.polygon_rad.map(function(t){return[M.parseAngle(t[0]),M.stayBetween(M.parseAngle(t[1],-Math.PI),-M.HalfPI,M.HalfPI)]}),this.longitude=this.polygon_rad[0][0],this.latitude=this.polygon_rad[0][1],this.positions3D=this.polygon_rad.map(function(t){return this.psv.sphericalCoordsToVector3(t[0],t[1])},this)},c.prototype=Object.create(o.prototype),c.prototype.constructor=c,c.className="psv-navbar psv-navbar--open",c.publicMethods=["showNavbar","hideNavbar","toggleNavbar","getNavbarButton"],c.prototype.create=function(){o.prototype.create.call(this),this.config.forEach(function(t){if("object"==typeof t)this.items.push(new g(this,t));else switch(t){case m.id:this.items.push(new m(this));break;case x.id:this.items.push(new x(this));break;case v.id:this.items.push(new v(this));break;case w.id:this.items.push(new w(this));break;case y.id:this.items.push(new y(this));break;case _.id:this.psv.config.gyroscope&&this.items.push(new _(this));break;case"caption":this.items.push(new h(this,this.psv.config.caption));break;case"spacer":t="spacer-5";default:var e=t.match(/^spacer\-([0-9]+)$/);if(null===e)throw new b("Unknown button "+t);this.items.push(new u(this,e[1]))}},this)},c.prototype.destroy=function(){this.items.forEach(function(t){t.destroy()}),delete this.items,delete this.config,o.prototype.destroy.call(this)},c.prototype.getNavbarButton=function(t){var e=null;return this.items.some(function(i){return i.id===t?(e=i,!0):void 0}),e||console.warn('PhotoSphereViewer: button "'+t+'" not found in the navbar.'),e},c.prototype.showNavbar=function(){this.toggleNavbar(!0)},c.prototype.hideNavbar=function(){this.toggleNavbar(!1)},c.prototype.toggleNavbar=function(t){M.toggleClass(this.container,"psv-navbar--open",t)},h.prototype=Object.create(o.prototype),h.prototype.constructor=h,h.className="psv-caption",h.publicMethods=["setCaption"],h.prototype.setCaption=function(t){this.container.innerHTML=t?t:""},u.prototype=Object.create(o.prototype),u.prototype.constructor=u,u.className="psv-spacer",d.prototype=Object.create(o.prototype),d.prototype.constructor=d,d.className="psv-panel",d.publicMethods=["showPanel","hidePanel"],d.prototype.create=function(){o.prototype.create.call(this),this.container.innerHTML='<div class="psv-panel-resizer"></div><div class="psv-panel-close-button"></div><div class="psv-panel-content"></div>',this.content=this.container.querySelector(".psv-panel-content");var t=this.container.querySelector(".psv-panel-close-button");t.addEventListener("click",this.hidePanel.bind(this)),this.psv.config.mousewheel&&this.container.addEventListener(r.SYSTEM.mouseWheelEvent,function(t){t.stopPropagation()});var e=this.container.querySelector(".psv-panel-resizer");e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this)},d.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),delete this.prop,delete this.content,o.prototype.destroy.call(this)},d.prototype.handleEvent=function(t){switch(t.type){case"mousedown":this._onMouseDown(t);break;case"touchstart":this._onTouchStart(t);break;case"mousemove":this._onMouseMove(t);break;case"touchmove":this._onTouchMove(t);break;case"mouseup":this._onMouseUp(t);break;case"touchend":this._onMouseUp(t)}},d.prototype.showPanel=function(t,e){this.content.innerHTML=t,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),M.toggleClass(this.content,"psv-panel-content--no-margin",!!e),this.prop.opened=!0,this.psv.trigger("open-panel")},d.prototype.hidePanel=function(){this.content.innerHTML=null,this.prop.opened=!1,this.container.classList.remove("psv-panel--open"),this.psv.trigger("close-panel")},d.prototype._onMouseDown=function(t){t.stopPropagation(),this._startResize(t)},d.prototype._onTouchStart=function(t){t.stopPropagation(),this._startResize(t.changedTouches[0])},d.prototype._startResize=function(t){this.prop.mouse_x=parseInt(t.clientX),this.prop.mouse_y=parseInt(t.clientY),this.prop.mousedown=!0,this.content.classList.add("psv-panel-content--no-interaction")},d.prototype._onMouseUp=function(t){this.prop.mousedown&&(t.stopPropagation(),this.prop.mousedown=!1,this.content.classList.remove("psv-panel-content--no-interaction"))},d.prototype._onMouseMove=function(t){this.prop.mousedown&&(t.stopPropagation(),this._resize(t))},d.prototype._onTouchMove=function(t){this.prop.mousedown&&(t.stopPropagation(),this._resize(t.touches[0]))},d.prototype._resize=function(t){var e=parseInt(t.clientX),i=parseInt(t.clientY);this.container.style.width=this.container.offsetWidth-(e-this.prop.mouse_x)+"px",this.prop.mouse_x=e,this.prop.mouse_y=i},p.prototype=Object.create(o.prototype),p.prototype.constructor=p,p.className="psv-tooltip",p.publicMethods=["showTooltip","hideTooltip","isTooltipVisible"],p.leftMap={0:"left",.5:"center",1:"right"},p.topMap={0:"top",.5:"center",1:"bottom"},p.prototype.create=function(){o.prototype.create.call(this),this.container.innerHTML='<div class="psv-tooltip-arrow"></div><div class="psv-tooltip-content"></div>',this.container.style.top="-1000px",this.container.style.left="-1000px",this.content=this.container.querySelector(".psv-tooltip-content"),this.arrow=this.container.querySelector(".psv-tooltip-arrow"),this.psv.on("render",this)},p.prototype.destroy=function(){this.psv.off("render",this),delete this.config,o.prototype.destroy.call(this)},p.prototype.handleEvent=function(t){switch(t.type){case"render":this.hideTooltip()}},p.prototype.isTooltipVisible=function(){return this.container.classList.contains("psv-tooltip--visible")},p.prototype.showTooltip=function(t){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null);var e=this.isTooltipVisible(),i=this.container,n=this.content,r=this.arrow;if(t.position||(t.position=["top","center"]),t.marker||(t.marker={width:0,height:0}),"string"==typeof t.position){var o=M.parsePosition(t.position);if(!(o.left in p.leftMap&&o.top in p.topMap))throw new b('unable to parse tooltip position "'+tooltip.position+'"');t.position=[p.topMap[o.top],p.leftMap[o.left]]}if("center"==t.position[0]&&"center"==t.position[1])throw new b('unable to parse tooltip position "center center"');if(e)for(var a=i.classList.length-1;a>=0;a--){var s=i.classList.item(a);"psv-tooltip"!=s&&"visible"!=s&&i.classList.remove(s)}else i.className="psv-tooltip";t.className&&M.addClasses(i,t.className),n.innerHTML=t.content,i.style.top="0px",i.style.left="0px";var l=i.getBoundingClientRect(),c={posClass:t.position.slice(),width:l.right-l.left,height:l.bottom-l.top,top:0,left:0,arrow_top:0,arrow_left:0};this._computeTooltipPosition(c,t);var h=!1;if(c.top<this.config.offset?(c.posClass[0]="bottom",h=!0):c.top+c.height>this.psv.prop.size.height-this.config.offset&&(c.posClass[0]="top",h=!0),c.left<this.config.offset?(c.posClass[1]="right",h=!0):c.left+c.width>this.psv.prop.size.width-this.config.offset&&(c.posClass[1]="left",h=!0),h&&this._computeTooltipPosition(c,t),i.style.top=c.top+"px",i.style.left=c.left+"px",r.style.top=c.arrow_top+"px",r.style.left=c.arrow_left+"px",i.classList.add("psv-tooltip--"+c.posClass.join("-")),!e){var u=this;this.timeout=window.setTimeout(function(){i.classList.add("psv-tooltip--visible"),u.psv.trigger("show-tooltip"),u.timeout=null},this.config.delay)}},p.prototype.hideTooltip=function(){if(this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),this.isTooltipVisible()){this.container.classList.remove("psv-tooltip--visible"),this.psv.trigger("hide-tooltip");var t=this;this.timeout=window.setTimeout(function(){t.content.innerHTML=null,t.container.style.top="-1000px",t.container.style.left="-1000px",t.timeout=null},this.config.delay)}},p.prototype._computeTooltipPosition=function(t,e){var i=!1;switch(t.posClass[0]){case"bottom":t.top=e.top+e.marker.height+this.config.offset+this.config.arrow_size,t.arrow_top=2*-this.config.arrow_size,i=!0;break;case"center":t.top=e.top+e.marker.height/2-t.height/2,t.arrow_top=t.height/2-this.config.arrow_size;break;case"top":t.top=e.top-t.height-this.config.offset-this.config.arrow_size,t.arrow_top=t.height,i=!0}switch(t.posClass[1]){case"right":i?(t.left=e.left+e.marker.width/2-this.config.offset-this.config.arrow_size,t.arrow_left=this.config.offset):(t.left=e.left+e.marker.width+this.config.offset+this.config.arrow_size,t.arrow_left=2*-this.config.arrow_size);break;case"center":t.left=e.left+e.marker.width/2-t.width/2,t.arrow_left=t.width/2-this.config.arrow_size;break;case"left":i?(t.left=e.left-t.width+e.marker.width/2+this.config.offset+this.config.arrow_size,t.arrow_left=t.width-this.config.offset-2*this.config.arrow_size):(t.left=e.left-t.width-this.config.offset-this.config.arrow_size,t.arrow_left=t.width)}},f.prototype=Object.create(o.prototype),f.prototype.constructor=f,f.prototype.create=function(){o.prototype.create.call(this),this.constructor.icon&&this.setIcon(this.constructor.icon),this.container.addEventListener("click",function(){this.enabled&&this._onClick()}.bind(this))},f.prototype.setIcon=function(t,e){e||(e=this.container),t?(e.innerHTML=r.ICONS[t],e.querySelector("svg").setAttribute("class","psv-button-svg")):e.innerHTML=""},f.prototype.toggleActive=function(t){t=M.toggleClass(this.container,"psv-button--active",t),this.constructor.iconActive&&this.setIcon(t?this.constructor.iconActive:this.constructor.icon)},f.prototype.disable=function(){this.container.classList.add("psv-button--disabled"),this.enabled=!1},f.prototype.enable=function(){this.container.classList.remove("psv-button--disabled"),this.enabled=!0},f.prototype._onClick=function(){},m.prototype=Object.create(f.prototype),m.prototype.constructor=m,m.id="autorotate",m.className="psv-button psv-button--hover-scale psv-autorotate-button",m.icon="play.svg",m.iconActive="play-active.svg",m.prototype.create=function(){f.prototype.create.call(this),this.container.title=this.psv.config.lang.autorotate,this.psv.on("autorotate",this)},m.prototype.destroy=function(){this.psv.off("autorotate",this),f.prototype.destroy.call(this)},m.prototype.handleEvent=function(t){switch(t.type){case"autorotate":this.toggleActive(t.args[0])}},m.prototype._onClick=function(){this.psv.toggleAutorotate()},g.prototype=Object.create(f.prototype),g.prototype.constructor=g,g.className="psv-button psv-custom-button",g.prototype.create=function(){f.prototype.create.call(this),this.config.className&&M.addClasses(this.container,this.config.className),this.config.title&&(this.container.title=this.config.title),this.config.content&&(this.container.innerHTML=this.config.content),(this.config.enabled===!1||this.config.disabled===!0)&&this.disable(),(this.config.visible===!1||this.config.hidden===!0)&&this.hide()},g.prototype.destroy=function(){delete this.config,f.prototype.destroy.call(this)},g.prototype._onClick=function(){this.config.onClick&&this.config.onClick.apply(this.psv)},v.prototype=Object.create(f.prototype),v.prototype.constructor=v,v.id="download",v.className="psv-button psv-button--hover-scale psv-download-button",v.icon="download.svg",v.prototype.create=function(){f.prototype.create.call(this),this.container.title=this.psv.config.lang.download},v.prototype._onClick=function(){var t=document.createElement("a");t.href=this.psv.config.panorama,t.download=this.psv.config.panorama,this.psv.container.appendChild(t),t.click()},y.prototype=Object.create(f.prototype),y.prototype.constructor=y,y.id="fullscreen",y.className="psv-button psv-button--hover-scale psv-fullscreen-button",y.icon="fullscreen-in.svg",y.iconActive="fullscreen-out.svg",y.prototype.create=function(){f.prototype.create.call(this),this.container.title=this.psv.config.lang.fullscreen,this.psv.on("fullscreen-updated",this)},y.prototype.destroy=function(){this.psv.off("fullscreen-updated",this),f.prototype.destroy.call(this)},y.prototype.handleEvent=function(t){switch(t.type){case"fullscreen-updated":this.toggleActive(t.args[0])}},y.prototype._onClick=function(){this.psv.toggleFullscreen()},_.prototype=Object.create(f.prototype),_.prototype.constructor=_,_.id="gyroscope",_.className="psv-button psv-button--hover-scale psv-gyroscope-button",_.icon="compass.svg",_.prototype.create=function(){f.prototype.create.call(this),this.container.title=this.psv.config.lang.gyroscope,r.SYSTEM.deviceOrientationSupported.promise.then(this._onAvailabilityChange.bind(this,!0),this._onAvailabilityChange.bind(this,!1)),this.hide(),this.psv.on("gyroscope-updated",this)},_.prototype.destroy=function(){this.psv.off("gyroscope-updated",this),f.prototype.destroy.call(this)},_.prototype.handleEvent=function(t){switch(t.type){case"gyroscope-updated":this.toggleActive(t.args[0])}},_.prototype._onClick=function(){this.psv.toggleGyroscopeControl()},_.prototype._onAvailabilityChange=function(t){if(t){if(!M.checkTHREE("DeviceOrientationControls"))throw new b("Missing Three.js components: DeviceOrientationControls. Get them from three.js-examples package.");this.show()}},w.prototype=Object.create(f.prototype),w.prototype.constructor=w,w.id="markers",w.className="psv-button psv-button--hover-scale psv-markers-button",w.icon="pin.svg",w.publicMethods=["toggleMarkersList","showMarkersList","hideMarkersList"],w.prototype.create=function(){f.prototype.create.call(this),this.container.title=this.psv.config.lang.markers,this.psv.on("open-panel",this),this.psv.on("close-panel",this)},w.prototype.destroy=function(){this.psv.off("open-panel",this),this.psv.off("close-panel",this),delete this.prop,f.prototype.destroy.call(this)},w.prototype.handleEvent=function(t){switch(t.type){case"open-panel":this._onPanelOpened();break;case"close-panel":this._onPanelClosed()}},w.prototype._onClick=function(){this.toggleMarkersList()},w.prototype.toggleMarkersList=function(){this.prop.panelOpened?this.hideMarkersList():this.showMarkersList()},w.prototype.showMarkersList=function(){var t=[];for(var e in this.psv.hud.markers)t.push(this.psv.hud.markers[e]);var i=this.psv.config.templates.markersList({markers:this.psv.change("render-markers-list",t),config:this.psv.config});this.prop.panelOpening=!0,this.psv.panel.showPanel(i,!0),this.psv.panel.container.querySelector(".psv-markers-list").addEventListener("click",this._onClickItem.bind(this))},w.prototype.hideMarkersList=function(){this.prop.panelOpened&&this.psv.panel.hidePanel()},w.prototype._onClickItem=function(t){var e;t.target&&(e=M.getClosest(t.target,"li"))&&e.dataset.psvMarker&&(this.psv.hud.gotoMarker(e.dataset.psvMarker,1e3),this.psv.panel.hidePanel())},w.prototype._onPanelOpened=function(){this.prop.panelOpening?(this.prop.panelOpening=!1,this.prop.panelOpened=!0):this.prop.panelOpened=!1,this.toggleActive(this.prop.panelOpened)},w.prototype._onPanelClosed=function(){this.prop.panelOpened=!1,this.prop.panelOpening=!1,this.toggleActive(this.prop.panelOpened)},x.prototype=Object.create(f.prototype),x.prototype.constructor=x,x.id="zoom",x.className="psv-button psv-zoom-button",x.prototype.create=function(){f.prototype.create.call(this);var t=document.createElement("div");t.className="psv-zoom-button-minus",t.title=this.psv.config.lang.zoomOut,this.setIcon("zoom-out.svg",t),this.container.appendChild(t);var e=document.createElement("div");e.className="psv-zoom-button-range",this.container.appendChild(e),this.zoom_range=document.createElement("div"),this.zoom_range.className="psv-zoom-button-line",this.zoom_range.title=this.psv.config.lang.zoom,e.appendChild(this.zoom_range),this.zoom_value=document.createElement("div"),this.zoom_value.className="psv-zoom-button-handle",this.zoom_value.title=this.psv.config.lang.zoom,this.zoom_range.appendChild(this.zoom_value);var i=document.createElement("div");i.className="psv-zoom-button-plus",i.title=this.psv.config.lang.zoomIn,this.setIcon("zoom-in.svg",i),this.container.appendChild(i),this.zoom_range.addEventListener("mousedown",this),this.zoom_range.addEventListener("touchstart",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),t.addEventListener("mousedown",this._zoomOut.bind(this)),i.addEventListener("mousedown",this._zoomIn.bind(this)),this.psv.on("zoom-updated",this),this.psv.once("ready",function(){this._moveZoomValue(this.psv.prop.zoom_lvl)}.bind(this))},x.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),delete this.zoom_range,delete this.zoom_value,this.psv.off("zoom-updated",this),f.prototype.destroy.call(this)
},x.prototype.handleEvent=function(t){switch(t.type){case"mousedown":this._initZoomChangeWithMouse(t);break;case"touchstart":this._initZoomChangeByTouch(t);break;case"mousemove":this._changeZoomWithMouse(t);break;case"touchmove":this._changeZoomByTouch(t);break;case"mouseup":this._stopZoomChange(t);break;case"touchend":this._stopZoomChange(t);break;case"zoom-updated":this._moveZoomValue(t.args[0])}},x.prototype._moveZoomValue=function(t){this.zoom_value.style.left=t/100*this.zoom_range.offsetWidth-this.zoom_value.offsetWidth/2+"px"},x.prototype._initZoomChangeWithMouse=function(t){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(t.clientX))},x.prototype._initZoomChangeByTouch=function(t){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(t.changedTouches[0].clientX))},x.prototype._zoomIn=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomIn(),window.setTimeout(this._startLongPressInterval.bind(this,1),200))},x.prototype._zoomOut=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomOut(),window.setTimeout(this._startLongPressInterval.bind(this,-1),200))},x.prototype._startLongPressInterval=function(t){this.prop.buttondown&&(this.prop.longPressInterval=window.setInterval(function(){this.psv.zoom(this.psv.prop.zoom_lvl+t)}.bind(this),50))},x.prototype._stopZoomChange=function(){this.enabled&&(window.clearInterval(this.prop.longPressInterval),this.prop.longPressInterval=null,this.prop.mousedown=!1,this.prop.buttondown=!1)},x.prototype._changeZoomWithMouse=function(t){this.enabled&&(t.preventDefault(),this._changeZoom(t.clientX))},x.prototype._changeZoomByTouch=function(t){this.enabled&&(t.preventDefault(),this._changeZoom(t.changedTouches[0].clientX))},x.prototype._changeZoom=function(t){if(this.prop.mousedown){var e=parseInt(t)-this.zoom_range.getBoundingClientRect().left,i=e/this.zoom_range.offsetWidth*100;this.psv.zoom(i)}},b.prototype=Object.create(Error.prototype),b.prototype.name="PSVError",b.prototype.constructor=b;var M={};/**
 * Returns a function, that, when invoked, will only be triggered at most once during a given window of time.
 * @copyright underscore.js - modified by Clément Prévost {@link http://stackoverflow.com/a/27078401}
 * @param {Function} func
 * @param {int} wait
 * @returns {Function}
 */
/**
 * Merge the enumerable attributes of two objects.
 * Modified to replace arrays instead of merge.
 * Modified to alter the target object.
 * @copyright Nicholas Fisher {@link mailto:nfisher110@gmail.com} - modified by Damien "Mistic" Sorel
 * @param {Object} target
 * @param {Object} src
 * @returns {Object} target
 */
return M.TwoPI=2*Math.PI,M.HalfPI=Math.PI/2,M.checkTHREE=function(){for(var e=0,i=arguments.length;i>e;e++)if(!(arguments[e]in t))return!1;return!0},M.isCanvasSupported=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},M.getWebGLCtx=function(){var t=document.createElement("canvas"),e=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=null;return t.getContext&&e.some(function(e){try{return i=t.getContext(e),i&&"function"==typeof i.getParameter}catch(n){return!1}})?i:null},M.isWebGLSupported=function(){return!!window.WebGLRenderingContext&&null!==M.getWebGLCtx()},M.getMaxTextureWidth=function(){var t=M.getWebGLCtx();return null!==t?t.getParameter(t.MAX_TEXTURE_SIZE):void 0},M.toggleClass=function(t,e,i){return void 0===i?t.classList.toggle(e):i&&!t.classList.contains(e)?(t.classList.add(e),!0):i?void 0:(t.classList.remove(e),!1)},M.addClasses=function(t,e){e&&e.split(" ").forEach(function(e){t.classList.add(e)})},M.removeClasses=function(t,e){e&&e.split(" ").forEach(function(e){t.classList.remove(e)})},M.hasParent=function(t,e){do if(t===e)return!0;while(t=t.parentNode);return!1},M.getClosest=function(t,e){var i=t.matches||t.msMatchesSelector;do if(i.bind(t)(e))return t;while(t=t.parentElement);return null},M.mouseWheelEvent=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},M.fullscreenEvent=function(){var t={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"msFullscreenEnabled"};for(var e in t)if(e in document)return t[e];return"fullscreenchange"},M.stayBetween=function(t,e,i){return Math.max(e,Math.min(i,t))},M.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},M.getXMPValue=function(t,e){var i;return null!==(i=t.match("<GPano:"+e+">(.*)</GPano:"+e+">"))?i[1]:null!==(i=t.match("GPano:"+e+'="(.*?)"'))?i[1]:null},M.isFullscreenEnabled=function(t){return(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)===t},M.requestFullscreen=function(t){(t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen||t.msRequestFullscreen).call(t)},M.exitFullscreen=function(){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)},M.getStyle=function(t,e){return window.getComputedStyle(t,null)[e]},M.parsePosition=function(t){if(!t)return{top:.5,left:.5};if("object"==typeof t)return t;var e=t.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=void 0!==M.parsePosition.positions[e[0]]?[e[0],"center"]:[e[0],e[0]]);var i="left"!=e[1]&&"right"!=e[1]&&"top"!=e[0]&&"bottom"!=e[0];e=e.map(function(t){return M.parsePosition.positions[t]||t}),i||e.reverse();var n=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return n?{left:n[1]/100,top:n[2]/100}:{top:.5,left:.5}},M.parsePosition.positions={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},M.parseSpeed=function(t){if("string"==typeof t){t=t.toString().trim();var e=parseFloat(t.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),i=t.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(i.match(/(pm|per minute)$/)&&(e/=60),i){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=e*Math.PI/180;break;case"radians per minute":case"radians per second":t=e;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=e*M.TwoPI;break;default:throw new b('unknown speed unit "'+i+'"')}}return t},M.parseAngle=function(t,e){if("string"==typeof t){var i=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!i)throw new b('unknown angle "'+t+'"');var n=parseFloat(i[1]),r=i[2];if(r)switch(r){case"deg":case"degs":t=n/180*Math.PI;break;case"rad":case"rads":t=n;break;default:throw new b('unknown angle unit "'+r+'"')}}return e!==!1&&(void 0===e&&(e=0),t=(t-e)%M.TwoPI,0>t&&(t=M.TwoPI+t),t+=e),t},M.animation=function(t){function i(e){if(-1!==n.promise.getStatus()){null===r&&(r=e);var o,a=(e-r)/t.duration,s={};if(1>a){for(o in t.properties)s[o]=t.properties[o].start+(t.properties[o].end-t.properties[o].start)*t.easing(a);t.onTick(s,a),window.requestAnimationFrame(i)}else{for(o in t.properties)s[o]=t.properties[o].end;t.onTick(s,1),t.onDone&&t.onDone(),n.resolve()}}}var n=e(),r=null;t.easing&&"string"!=typeof t.easing||(t.easing=M.animation.easings[t.easing||"linear"]),void 0!==t.delay?window.setTimeout(function(){window.requestAnimationFrame(i)},t.delay):window.requestAnimationFrame(i);var o=n.promise;return o.cancel=function(){t.onCancel&&t.onCancel(),n.reject()},o},M.animation.easings={linear:function(t){return t},inQuad:function(t){return t*t},outQuad:function(t){return t*(2-t)},inOutQuad:function(t){return.5>t?2*t*t:-1+(4-2*t)*t},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},inQuart:function(t){return t*t*t*t},outQuart:function(t){return 1- --t*t*t*t},inOutQuart:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return 1+--t*t*t*t*t},inOutQuint:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t},inSine:function(t){return 1-Math.cos(t*(Math.PI/2))},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return.5-.5*Math.cos(Math.PI*t)},inExpo:function(t){return Math.pow(2,10*(t-1))},outExpo:function(t){return 1-Math.pow(2,-10*t)},inOutExpo:function(t){return t=2*t-1,0>t?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t)},inCirc:function(t){return 1-Math.sqrt(1-t*t)},outCirc:function(t){return t--,Math.sqrt(1-t*t)},inOutCirc:function(t){return t*=2,1>t?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)}},M.throttle=function(t,e){var i,n,r,o=null,a=0,s=function(){a=Date.now(),o=null,r=t.apply(i,n),o||(i=n=null)};return function(){var l=Date.now();a||(a=l);var c=e-(l-a);return i=this,n=arguments,0>=c||c>e?(o&&(clearTimeout(o),o=null),a=l,r=t.apply(i,n),o||(i=n=null)):o||(o=setTimeout(s,c)),r}},M.isPlainObject=function(t){if("object"==typeof t&&null!==t){if("function"==typeof Object.getPrototypeOf){var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}return"[object Object]"==Object.prototype.toString.call(t)}return!1},M.deepmerge=function(t,e){var i=e;return function n(t,e){return Array.isArray(e)?(t&&Array.isArray(t)?t.length=0:t=[],e.forEach(function(e,i){t[i]=n(null,e)})):"object"==typeof e?((!t||Array.isArray(t))&&(t={}),Object.keys(e).forEach(function(r){"object"==typeof e[r]&&e[r]&&M.isPlainObject(e[r])?e[r]!=i&&(t[r]?n(t[r],e[r]):t[r]=n(null,e[r])):t[r]=e[r]})):t=e,t}(t,e)},M.clone=function(t){return M.deepmerge(null,t)},t.GodraysShader={uniforms:{tDiffuse:{type:"t",value:0,texture:null},fX:{type:"f",value:.5},fY:{type:"f",value:.5},fExposure:{type:"f",value:.6},fDecay:{type:"f",value:.93},fDensity:{type:"f",value:.96},fWeight:{type:"f",value:.4},fClamp:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main()","{","vUv = vec2( uv.x, uv.y );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tDiffuse;","uniform float fX;","uniform float fY;","uniform float fExposure;","uniform float fDecay;","uniform float fDensity;","uniform float fWeight;","uniform float fClamp;","const int iSamples = 20;","void main()","{","vec2 deltaTextCoord = vec2(vUv - vec2(fX,fY));","deltaTextCoord *= 1.0 /  float(iSamples) * fDensity;","vec2 coord = vUv;","float illuminationDecay = 1.0;","vec4 FragColor = vec4(0.0);","for(int i=0; i < iSamples ; i++)","{","coord -= deltaTextCoord;","vec4 texel = texture2D(tDiffuse, coord);","texel *= illuminationDecay * fWeight;","FragColor += texel;","illuminationDecay *= fDecay;","}","FragColor *= fExposure;","FragColor = clamp(FragColor, 0.0, fClamp);","gl_FragColor = FragColor;","}"].join("\n")},function(t){if(t.requestAnimationFrame=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,t.cancelAnimationFrame=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame,!t.requestAnimationFrame){var e,i=[],n=[],r=0;t.requestAnimationFrame=function(t){return i.push([++r,t]),e||(e=setInterval(function(){if(i.length){var t=+new Date,r=n;for(n=i,i=r;n.length;)n.shift()[1](t)}else clearInterval(e),e=void 0},20)),r},t.cancelAnimationFrame=function(t){var e,r;for(e=0,r=i.length;r>e;e+=1)if(i[e][0]===t)return void i.splice(e,1);for(e=0,r=n.length;r>e;e+=1)if(n[e][0]===t)return void n.splice(e,1)}}}(window),r.ICONS["compass.svg"]='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><path d="M49.997,0C22.38,0.004,0.005,22.383,0,50.002C0.005,77.614,22.38,99.995,49.997,100C77.613,99.995,99.996,77.614,100,50.002C99.996,22.383,77.613,0.004,49.997,0z M49.997,88.81c-21.429-0.04-38.772-17.378-38.809-38.807c0.037-21.437,17.381-38.775,38.809-38.812C71.43,11.227,88.769,28.567,88.81,50.002C88.769,71.432,71.43,88.77,49.997,88.81z"/><path d="M72.073,25.891L40.25,41.071l-0.003-0.004l-0.003,0.009L27.925,74.109l31.82-15.182l0.004,0.004l0.002-0.007l-0.002-0.004L72.073,25.891z M57.837,54.411L44.912,42.579l21.092-10.062L57.837,54.411z"/><!--Created by iconoci from the Noun Project--></svg>',r.ICONS["download.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><path d="M83.285,35.575H66.271L66.277,3H32.151v32.575H16.561l33.648,32.701L83.285,35.575z"/><path d="M83.316,64.199v16.32H16.592v-16.32H-0.094v32.639H100V64.199H83.316z"/><!--Created by Michael Zenaty from the Noun Project--></svg>',r.ICONS["fullscreen-in.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><polygon points="100,39.925 87.105,39.925 87.105,18.895 66.075,18.895 66.075,6 100,6"/><polygon points="100,93.221 66.075,93.221 66.075,80.326 87.105,80.326 87.105,59.295 100,59.295"/><polygon points="33.925,93.221 0,93.221 0,59.295 12.895,59.295 12.895,80.326 33.925,80.326"/><polygon points="12.895,39.925 0,39.925 0,6 33.925,6 33.925,18.895 12.895,18.895"/><!--Created by Garrett Knoll from the Noun Project--></svg>',r.ICONS["fullscreen-out.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><polygon points="66.075,7 78.969,7 78.969,28.031 100,28.031 100,40.925 66.075,40.925"/><polygon points="66.075,60.295 100,60.295 100,73.19 78.969,73.19 78.969,94.221 66.075,94.221"/><polygon points="0,60.295 33.925,60.295 33.925,94.221 21.031,94.221 21.031,73.19 0,73.19"/><polygon points="21.031,7 33.925,7 33.925,40.925 0,40.925 0,28.031 21.031,28.031"/><!--Created by Garrett Knoll from the Noun Project--></svg>',r.ICONS["pin.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve"><path d="M24,0C13.798,0,5.499,8.3,5.499,18.501c0,10.065,17.57,28.635,18.318,29.421C23.865,47.972,23.931,48,24,48s0.135-0.028,0.183-0.078c0.748-0.786,18.318-19.355,18.318-29.421C42.501,8.3,34.202,0,24,0z M24,7.139c5.703,0,10.342,4.64,10.342,10.343c0,5.702-4.639,10.342-10.342,10.342c-5.702,0-10.34-4.64-10.34-10.342C13.66,11.778,18.298,7.139,24,7.139z"/><!--Created by Daniele Marucci from the Noun Project--></svg>',r.ICONS["play-active.svg"]='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 41 41" enable-background="new 0 0 41 41" xml:space="preserve"><path d="M40.5,14.1c-0.1-0.1-1.2-0.5-2.898-1C37.5,13.1,37.4,13,37.4,12.9C34.5,6.5,28,2,20.5,2S6.6,6.5,3.7,12.9c0,0.1-0.1,0.1-0.2,0.2c-1.7,0.6-2.8,1-2.9,1L0,14.4v12.1l0.6,0.2c0.1,0,1.1,0.399,2.7,0.899c0.1,0,0.2,0.101,0.2,0.199C6.3,34.4,12.9,39,20.5,39c7.602,0,14.102-4.6,16.9-11.1c0-0.102,0.1-0.102,0.199-0.2c1.699-0.601,2.699-1,2.801-1l0.6-0.3V14.3L40.5,14.1z M6.701,11.5C9.7,7,14.8,4,20.5,4c5.8,0,10.9,3,13.8,7.5c0.2,0.3-0.1,0.6-0.399,0.5c-3.799-1-8.799-2-13.6-2c-4.7,0-9.5,1-13.2,2C6.801,12.1,6.601,11.8,6.701,11.5z M25.1,20.3L18.7,24c-0.3,0.2-0.7,0-0.7-0.5v-7.4c0-0.4,0.4-0.6,0.7-0.4 l6.399,3.8C25.4,19.6,25.4,20.1,25.1,20.3z M34.5,29.201C31.602,33.9,26.4,37,20.5,37c-5.9,0-11.1-3.1-14-7.898c-0.2-0.302,0.1-0.602,0.4-0.5c3.9,1,8.9,2.1,13.6,2.1c5,0,9.9-1,13.602-2C34.4,28.602,34.602,28.9,34.5,29.201z"/><!--Created by Nick Bluth from the Noun Project--></svg>',r.ICONS["play.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 41 41" enable-background="new 0 0 41 41" xml:space="preserve"><path d="M40.5,14.1c-0.1-0.1-1.2-0.5-2.899-1c-0.101,0-0.2-0.1-0.2-0.2C34.5,6.5,28,2,20.5,2S6.6,6.5,3.7,12.9c0,0.1-0.1,0.1-0.2,0.2c-1.7,0.6-2.8,1-2.9,1L0,14.4v12.1l0.6,0.2c0.1,0,1.1,0.4,2.7,0.9c0.1,0,0.2,0.1,0.2,0.199C6.3,34.4,12.9,39,20.5,39c7.601,0,14.101-4.6,16.9-11.1c0-0.101,0.1-0.101,0.2-0.2c1.699-0.6,2.699-1,2.8-1l0.6-0.3V14.3L40.5,14.1zM20.5,4c5.8,0,10.9,3,13.8,7.5c0.2,0.3-0.1,0.6-0.399,0.5c-3.8-1-8.8-2-13.6-2c-4.7,0-9.5,1-13.2,2c-0.3,0.1-0.5-0.2-0.4-0.5C9.7,7,14.8,4,20.5,4z M20.5,37c-5.9,0-11.1-3.1-14-7.899c-0.2-0.301,0.1-0.601,0.4-0.5c3.9,1,8.9,2.1,13.6,2.1c5,0,9.9-1,13.601-2c0.3-0.1,0.5,0.2,0.399,0.5C31.601,33.9,26.4,37,20.5,37z M39.101,24.9c0,0.1-0.101,0.3-0.2,0.3c-2.5,0.9-10.4,3.6-18.4,3.6c-7.1,0-15.6-2.699-18.3-3.6C2.1,25.2,2,25,2,24.9V16c0-0.1,0.1-0.3,0.2-0.3c2.6-0.9,10.6-3.6,18.2-3.6c7.5,0,15.899,2.7,18.5,3.6c0.1,0,0.2,0.2,0.2,0.3V24.9z"/><path d="M18.7,24l6.4-3.7c0.3-0.2,0.3-0.7,0-0.8l-6.4-3.8c-0.3-0.2-0.7,0-0.7,0.4v7.4C18,24,18.4,24.2,18.7,24z"/><!--Created by Nick Bluth from the Noun Project--></svg>',r.ICONS["zoom-in.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M14.043,12.22c2.476-3.483,1.659-8.313-1.823-10.789C8.736-1.044,3.907-0.228,1.431,3.255c-2.475,3.482-1.66,8.312,1.824,10.787c2.684,1.908,6.281,1.908,8.965,0l4.985,4.985c0.503,0.504,1.32,0.504,1.822,0c0.505-0.503,0.505-1.319,0-1.822L14.043,12.22z M7.738,13.263c-3.053,0-5.527-2.475-5.527-5.525c0-3.053,2.475-5.527,5.527-5.527c3.05,0,5.524,2.474,5.524,5.527C13.262,10.789,10.788,13.263,7.738,13.263z"/><polygon points="8.728,4.009 6.744,4.009 6.744,6.746 4.006,6.746 4.006,8.73 6.744,8.73 6.744,11.466 8.728,11.466 8.728,8.73 11.465,8.73 11.465,6.746 8.728,6.746"/><!--Created by Ryan Canning from the Noun Project--></svg>',r.ICONS["zoom-out.svg"]='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M14.043,12.22c2.476-3.483,1.659-8.313-1.823-10.789C8.736-1.044,3.907-0.228,1.431,3.255c-2.475,3.482-1.66,8.312,1.824,10.787c2.684,1.908,6.281,1.908,8.965,0l4.985,4.985c0.503,0.504,1.32,0.504,1.822,0c0.505-0.503,0.505-1.319,0-1.822L14.043,12.22z M7.738,13.263c-3.053,0-5.527-2.475-5.527-5.525c0-3.053,2.475-5.527,5.527-5.527c3.05,0,5.524,2.474,5.524,5.527C13.262,10.789,10.788,13.263,7.738,13.263z"/><rect x="4.006" y="6.746" width="7.459" height="1.984"/><!--Created by Ryan Canning from the Noun Project--></svg>',r.Error=b,r.Utils=M,r}),// Copyright (c) 2015 Edson Hilios
// The above copyright notice and this permission notice shall be included in all
// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";function e(t){if(t instanceof Date)return t;if(String(t).match(a))return String(t).match(/^[0-9]*$/)&&(t=Number(t)),String(t).match(/\-/)&&(t=String(t).replace(/\-/g,"/")),new Date(t);throw new Error("Couldn't cast `"+t+"` to a date object.")}function i(t){var e=t.toString().replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return new RegExp(e)}function n(t){return function(e){var n=e.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(n)for(var o=0,a=n.length;a>o;++o){var s=n[o].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),c=i(s[0]),h=s[1]||"",u=s[3]||"",d=null;s=s[2],l.hasOwnProperty(s)&&(d=l[s],d=Number(t[d])),null!==d&&("!"===h&&(d=r(u,d)),""===h&&10>d&&(d="0"+d.toString()),e=e.replace(c,d.toString()))}return e=e.replace(/%%/,"%")}}function r(t,e){var i="s",n="";return t&&(t=t.replace(/(:|;|\s)/gi,"").split(/\,/),1===t.length?i=t[0]:(n=t[0],i=t[1])),1===Math.abs(e)?n:i}var o=[],a=[],s={precision:100,elapse:!1};a.push(/^[0-9]*$/.source),a.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),a.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),a=new RegExp(a.join("|"));var l={Y:"years",m:"months",n:"daysToMonth",w:"weeks",d:"daysToWeek",D:"totalDays",H:"hours",M:"minutes",S:"seconds"},c=function(e,i,n){this.el=e,this.$el=t(e),this.interval=null,this.offset={},this.options=t.extend({},s),this.instanceNumber=o.length,o.push(this),this.$el.data("countdown-instance",this.instanceNumber),n&&("function"==typeof n?(this.$el.on("update.countdown",n),this.$el.on("stoped.countdown",n),this.$el.on("finish.countdown",n)):this.options=t.extend({},s,n)),this.setFinalDate(i),this.start()};t.extend(c.prototype,{start:function(){null!==this.interval&&clearInterval(this.interval);var t=this;this.update(),this.interval=setInterval(function(){t.update.call(t)},this.options.precision)},stop:function(){clearInterval(this.interval),this.interval=null,this.dispatchEvent("stoped")},toggle:function(){this.interval?this.stop():this.start()},pause:function(){this.stop()},resume:function(){this.start()},remove:function(){this.stop.call(this),o[this.instanceNumber]=null,delete this.$el.data().countdownInstance},setFinalDate:function(t){this.finalDate=e(t)},update:function(){if(0===this.$el.closest("html").length)return void this.remove();var e,i=void 0!==t._data(this.el,"events"),n=new Date;e=this.finalDate.getTime()-n.getTime(),e=Math.ceil(e/1e3),e=!this.options.elapse&&0>e?0:Math.abs(e),this.totalSecsLeft!==e&&i&&(this.totalSecsLeft=e,this.elapsed=n>=this.finalDate,this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToWeek:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToMonth:Math.floor(this.totalSecsLeft/60/60/24%30.4368),totalDays:Math.floor(this.totalSecsLeft/60/60/24),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),months:Math.floor(this.totalSecsLeft/60/60/24/30.4368),years:Math.abs(this.finalDate.getFullYear()-n.getFullYear())},this.options.elapse||0!==this.totalSecsLeft?this.dispatchEvent("update"):(this.stop(),this.dispatchEvent("finish")))},dispatchEvent:function(e){var i=t.Event(e+".countdown");i.finalDate=this.finalDate,i.elapsed=this.elapsed,i.offset=t.extend({},this.offset),i.strftime=n(this.offset),this.$el.trigger(i)}}),t.fn.countdown=function(){var e=Array.prototype.slice.call(arguments,0);return this.each(function(){var i=t(this).data("countdown-instance");if(void 0!==i){var n=o[i],r=e[0];c.prototype.hasOwnProperty(r)?n[r].apply(n,e.slice(1)):null===String(r).match(/^[$A-Z_][0-9A-Z_$]*$/i)?(n.setFinalDate.call(n,r),n.start()):t.error("Method %s does not exist on jQuery.countdown".replace(/\%s/gi,r))}else new c(this,e[0],e[1])})}}),/* jQuery.enllax.js - v1.1.0 | copyright 2015, MMK Jony | https://github.com/mmkjony/enllax.js | released under the MIT license */
!function(t){"use strict";t.fn.enllax=function(e){var i=t(window).height(),n=t(document).height(),r=t.extend({ratio:0,type:"background",direction:"vertical"},e),o=t("[data-enllax-ratio]");o.each(function(){var e,o,a,s=t(this),l=s.offset().top,c=s.outerHeight(),h=s.data("enllax-ratio"),u=s.data("enllax-type"),d=s.data("enllax-direction");e=h?h:r.ratio,o=u?u:r.type,a=d?d:r.direction;var p=Math.round(l*e),f=Math.round((l-i/2+c)*e);"background"==o?"vertical"==a?s.css({"background-position":"center "+-p+"px"}):"horizontal"==a&&s.css({"background-position":-p+"px center"}):"foreground"==o&&("vertical"==a?s.css({"-webkit-transform":"translateY("+f+"px)","-moz-transform":"translateY("+f+"px)",transform:"translateY("+f+"px)"}):"horizontal"==a&&s.css({"-webkit-transform":"translateX("+f+"px)","-moz-transform":"translateX("+f+"px)",transform:"translateX("+f+"px)"})),t(window).on("scroll",function(){var r=t(this).scrollTop();p=Math.round((l-r)*e),f=Math.round((l-i/2+c-r)*e),"background"==o?"vertical"==a?s.css({"background-position":"center "+-p+"px"}):"horizontal"==a&&s.css({"background-position":-p+"px center"}):"foreground"==o&&n>r&&("vertical"==a?s.css({"-webkit-transform":"translateY("+f+"px)","-moz-transform":"translateY("+f+"px)",transform:"translateY("+f+"px)"}):"horizontal"==a&&s.css({"-webkit-transform":"translateX("+f+"px)","-moz-transform":"translateX("+f+"px)",transform:"translateX("+f+"px)"}))})})}}(jQuery),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Parallax=t()}}(function(){return function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return r(i?i:t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("raf"),a=i(o),s={propertyCache:{},vendors:[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]],clamp:function(t,e,i){return i>e?e>t?e:t>i?i:t:i>t?i:t>e?e:t},data:function(t,e){return s.deserialize(t.getAttribute("data-"+e))},deserialize:function(t){return"true"===t?!0:"false"===t?!1:"null"===t?null:!isNaN(parseFloat(t))&&isFinite(t)?parseFloat(t):t},camelCase:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},accelerate:function(t){s.css(t,"transform","translate3d(0,0,0) rotate(0.0001deg)"),s.css(t,"transform-style","preserve-3d"),s.css(t,"backface-visibility","hidden")},transformSupport:function(t){for(var e=document.createElement("div"),i=!1,n=null,r=!1,o=null,a=null,l=0,c=s.vendors.length;c>l;l++)if(null!==s.vendors[l]?(o=s.vendors[l][0]+"transform",a=s.vendors[l][1]+"Transform"):(o="transform",a="transform"),void 0!==e.style[a]){i=!0;break}switch(t){case"2D":r=i;break;case"3D":if(i){var h=document.body||document.createElement("body"),u=document.documentElement,d=u.style.overflow,p=!1;document.body||(p=!0,u.style.overflow="hidden",u.appendChild(h),h.style.overflow="hidden",h.style.background=""),h.appendChild(e),e.style[a]="translate3d(1px,1px,1px)",n=window.getComputedStyle(e).getPropertyValue(o),r=void 0!==n&&n.length>0&&"none"!==n,u.style.overflow=d,h.removeChild(e),p&&(h.removeAttribute("style"),h.parentNode.removeChild(h))}}return r},css:function(t,e,i){var n=s.propertyCache[e];if(!n)for(var r=0,o=s.vendors.length;o>r;r++)if(n=null!==s.vendors[r]?s.camelCase(s.vendors[r][1]+"-"+e):e,void 0!==t.style[n]){s.propertyCache[e]=n;break}t.style[n]=i}},l=30,c={relativeInput:!1,clipRelativeInput:!1,calibrationThreshold:100,calibrationDelay:500,supportDelay:500,calibrateX:!1,calibrateY:!0,invertX:!0,invertY:!0,limitX:!1,limitY:!1,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,originX:.5,originY:.5,pointerEvents:!1,precision:1},h=function(){function t(e,i){n(this,t),this.element=e,this.layers=e.getElementsByClassName("layer");var r={calibrateX:s.data(this.element,"calibrate-x"),calibrateY:s.data(this.element,"calibrate-y"),invertX:s.data(this.element,"invert-x"),invertY:s.data(this.element,"invert-y"),limitX:s.data(this.element,"limit-x"),limitY:s.data(this.element,"limit-y"),scalarX:s.data(this.element,"scalar-x"),scalarY:s.data(this.element,"scalar-y"),frictionX:s.data(this.element,"friction-x"),frictionY:s.data(this.element,"friction-y"),originX:s.data(this.element,"origin-x"),originY:s.data(this.element,"origin-y"),pointerEvents:s.data(this.element,"pointer-events"),precision:s.data(this.element,"precision"),relativeInput:s.data(this.element,"relative-input"),clipRelativeInput:s.data(this.element,"clip-relative-input")};for(var o in r)null===r[o]&&delete r[o];Object.assign(this,c,r,i),this.calibrationTimer=null,this.calibrationFlag=!0,this.enabled=!1,this.depthsX=[],this.depthsY=[],this.raf=null,this.bounds=null,this.elementPositionX=0,this.elementPositionY=0,this.elementWidth=0,this.elementHeight=0,this.elementCenterX=0,this.elementCenterY=0,this.elementRangeX=0,this.elementRangeY=0,this.calibrationX=0,this.calibrationY=0,this.inputX=0,this.inputY=0,this.motionX=0,this.motionY=0,this.velocityX=0,this.velocityY=0,this.onMouseMove=this.onMouseMove.bind(this),this.onDeviceOrientation=this.onDeviceOrientation.bind(this),this.onOrientationTimer=this.onOrientationTimer.bind(this),this.onCalibrationTimer=this.onCalibrationTimer.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.windowWidth=null,this.windowHeight=null,this.windowCenterX=null,this.windowCenterY=null,this.windowRadiusX=null,this.windowRadiusY=null,this.portrait=null,this.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),this.motionSupport=!!window.DeviceMotionEvent&&!this.desktop,this.orientationSupport=!!window.DeviceOrientationEvent&&!this.desktop,this.orientationStatus=0,this.motionStatus=0,this.initialise()}return r(t,[{key:"initialise",value:function(){void 0===this.transform2DSupport&&(this.transform2DSupport=s.transformSupport("2D"),this.transform3DSupport=s.transformSupport("3D")),this.transform3DSupport&&s.accelerate(this.element);var t=window.getComputedStyle(this.element);"static"===t.getPropertyValue("position")&&(this.element.style.position="relative"),this.pointerEvents||(this.element.style.pointerEvents="none"),this.updateLayers(),this.updateDimensions(),this.enable(),this.queueCalibration(this.calibrationDelay)}},{key:"updateLayers",value:function(){this.layers=this.element.getElementsByClassName("layer"),this.depthsX=[],this.depthsY=[];for(var t=0;t<this.layers.length;t++){var e=this.layers[t];this.transform3DSupport&&s.accelerate(e),e.style.position=t?"absolute":"relative",e.style.display="block",e.style.left=0,e.style.top=0;var i=s.data(e,"depth")||0;this.depthsX.push(s.data(e,"depth-x")||i),this.depthsY.push(s.data(e,"depth-y")||i)}}},{key:"updateDimensions",value:function(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.windowCenterX=this.windowWidth*this.originX,this.windowCenterY=this.windowHeight*this.originY,this.windowRadiusX=Math.max(this.windowCenterX,this.windowWidth-this.windowCenterX),this.windowRadiusY=Math.max(this.windowCenterY,this.windowHeight-this.windowCenterY)}},{key:"updateBounds",value:function(){this.bounds=this.element.getBoundingClientRect(),this.elementPositionX=this.bounds.left,this.elementPositionY=this.bounds.top,this.elementWidth=this.bounds.width,this.elementHeight=this.bounds.height,this.elementCenterX=this.elementWidth*this.originX,this.elementCenterY=this.elementHeight*this.originY,this.elementRangeX=Math.max(this.elementCenterX,this.elementWidth-this.elementCenterX),this.elementRangeY=Math.max(this.elementCenterY,this.elementHeight-this.elementCenterY)}},{key:"queueCalibration",value:function(t){clearTimeout(this.calibrationTimer),this.calibrationTimer=setTimeout(this.onCalibrationTimer,t)}},{key:"enable",value:function(){this.enabled||(this.enabled=!0,this.orientationSupport?(this.portrait=null,window.addEventListener("deviceorientation",this.onDeviceOrientation),setTimeout(this.onOrientationTimer,this.supportDelay)):this.motionSupport?(this.portrait=null,window.addEventListener("devicemotion",this.onDeviceMotion),setTimeout(this.onMotionTimer,this.supportDelay)):(this.calibrationX=0,this.calibrationY=0,this.portrait=!1,window.addEventListener("mousemove",this.onMouseMove)),window.addEventListener("resize",this.onWindowResize),this.raf=a.default(this.onAnimationFrame))}},{key:"disable",value:function(){this.enabled&&(this.enabled=!1,this.orientationSupport?window.removeEventListener("deviceorientation",this.onDeviceOrientation):this.motionSupport?window.removeEventListener("devicemotion",this.onDeviceMotion):window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.onWindowResize),a.default.cancel(this.raf))}},{key:"calibrate",value:function(t,e){this.calibrateX=void 0===t?this.calibrateX:t,this.calibrateY=void 0===e?this.calibrateY:e}},{key:"invert",value:function(t,e){this.invertX=void 0===t?this.invertX:t,this.invertY=void 0===e?this.invertY:e}},{key:"friction",value:function(t,e){this.frictionX=void 0===t?this.frictionX:t,this.frictionY=void 0===e?this.frictionY:e}},{key:"scalar",value:function(t,e){this.scalarX=void 0===t?this.scalarX:t,this.scalarY=void 0===e?this.scalarY:e}},{key:"limit",value:function(t,e){this.limitX=void 0===t?this.limitX:t,this.limitY=void 0===e?this.limitY:e}},{key:"origin",value:function(t,e){this.originX=void 0===t?this.originX:t,this.originY=void 0===e?this.originY:e}},{key:"setPosition",value:function(t,e,i){e=e.toFixed(this.precision)+"px",i=i.toFixed(this.precision)+"px",this.transform3DSupport?s.css(t,"transform","translate3d("+e+","+i+",0)"):this.transform2DSupport?s.css(t,"transform","translate("+e+","+i+")"):(t.style.left=e,t.style.top=i)}},{key:"onOrientationTimer",value:function(){this.orientationSupport&&0===this.orientationStatus&&(this.disable(),this.orientationSupport=!1,this.enable())}},{key:"onMotionTimer",value:function(){this.motionSupport&&0===this.motionStatus&&(this.disable(),this.motionSupport=!1,this.enable())}},{key:"onCalibrationTimer",value:function(){this.calibrationFlag=!0}},{key:"onWindowResize",value:function(){this.updateDimensions()}},{key:"onAnimationFrame",value:function(){this.updateBounds();var t=this.inputX-this.calibrationX,e=this.inputY-this.calibrationY;(Math.abs(t)>this.calibrationThreshold||Math.abs(e)>this.calibrationThreshold)&&this.queueCalibration(0),this.portrait?(this.motionX=this.calibrateX?e:this.inputY,this.motionY=this.calibrateY?t:this.inputX):(this.motionX=this.calibrateX?t:this.inputX,this.motionY=this.calibrateY?e:this.inputY),this.motionX*=this.elementWidth*(this.scalarX/100),this.motionY*=this.elementHeight*(this.scalarY/100),isNaN(parseFloat(this.limitX))||(this.motionX=s.clamp(this.motionX,-this.limitX,this.limitX)),isNaN(parseFloat(this.limitY))||(this.motionY=s.clamp(this.motionY,-this.limitY,this.limitY)),this.velocityX+=(this.motionX-this.velocityX)*this.frictionX,this.velocityY+=(this.motionY-this.velocityY)*this.frictionY;for(var i=0;i<this.layers.length;i++){var n=this.layers[i],r=this.depthsX[i],o=this.depthsY[i],l=this.velocityX*r*(this.invertX?-1:1),c=this.velocityY*o*(this.invertY?-1:1);this.setPosition(n,l,c)}this.raf=a.default(this.onAnimationFrame)}},{key:"rotate",value:function(t,e){var i=(t||event.beta||0)/l,n=(e||event.gamma||0)/l,r=this.windowHeight>this.windowWidth;this.portrait!==r&&(this.portrait=r,this.calibrationFlag=!0),this.calibrationFlag&&(this.calibrationFlag=!1,this.calibrationX=i,this.calibrationY=n),this.inputX=i,this.inputY=n}},{key:"onDeviceOrientation",value:function(t){var e=t.beta,i=t.gamma;this.desktop||null===e||null===i||(this.orientationStatus=1,this.rotate(e,i))}},{key:"onDeviceMotion",value:function(t){var e=t.rotationRate.beta,i=t.rotationRate.gamma;this.desktop||null===e||null===i||(this.motionStatus=1,this.rotate(e,i))}},{key:"onMouseMove",value:function(t){var e=t.clientX,i=t.clientY;!this.orientationSupport&&this.relativeInput?(this.clipRelativeInput&&(e=Math.max(e,this.elementPositionX),e=Math.min(e,this.elementPositionX+this.elementWidth),i=Math.max(i,this.elementPositionY),i=Math.min(i,this.elementPositionY+this.elementHeight)),this.elementRangeX&&this.elementRangeY&&(this.inputX=(e-this.elementPositionX-this.elementCenterX)/this.elementRangeX,this.inputY=(i-this.elementPositionY-this.elementCenterY)/this.elementRangeY)):this.windowRadiusX&&this.windowRadiusY&&(this.inputX=(e-this.windowCenterX)/this.windowRadiusX,this.inputY=(i-this.windowCenterY)/this.windowRadiusY)}}]),t}();e.exports=h},{raf:4}],2:[function(t,e){(function(t){(function(){var i,n,r,o,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof t&&null!==t&&t.hrtime?(e.exports=function(){return(i()-a)/1e6},n=t.hrtime,i=function(){var t;return t=n(),1e9*t[0]+t[1]},o=i(),s=1e9*t.uptime(),a=o-s):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,t("_process"))},{_process:3}],3:[function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function a(){m&&p&&(m=!1,p.length?f=p.concat(f):g=-1,f.length&&s())}function s(){if(!m){var t=r(a);m=!0;for(var e=f.length;e;){for(p=f,f=[];++g<e;)p&&p[g].run();g=-1,e=f.length}p=null,m=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var h,u,d=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i}catch(t){h=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}}();var p,f=[],m=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];f.push(new l(t,e)),1!==f.length||m||r(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(){return[]},d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],4:[function(t,e){(function(i){for(var n=t("performance-now"),r="undefined"==typeof window?i:window,o=["moz","webkit"],a="AnimationFrame",s=r["request"+a],l=r["cancel"+a]||r["cancelRequest"+a],c=0;!s&&c<o.length;c++)s=r[o[c]+"Request"+a],l=r[o[c]+"Cancel"+a]||r[o[c]+"CancelRequest"+a];if(!s||!l){var h=0,u=0,d=[],p=1e3/60;s=function(t){if(0===d.length){var e=n(),i=Math.max(0,p-(e-h));h=i+e,setTimeout(function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(h)}catch(i){setTimeout(function(){throw i},0)}},Math.round(i))}return d.push({handle:++u,callback:t,cancelled:!1}),u},l=function(t){for(var e=0;e<d.length;e++)d[e].handle===t&&(d[e].cancelled=!0)}}e.exports=function(t){return s.call(r,t)},e.exports.cancel=function(){l.apply(r,arguments)},e.exports.polyfill=function(){r.requestAnimationFrame=s,r.cancelAnimationFrame=l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":2}]},{},[1])(1)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,i=Number(arguments[1])||0;for(i=0>i?Math.ceil(i):Math.floor(i),0>i&&(i+=e);e>i;i++)if(i in this&&this[i]===t)return i;return-1}),window.RM=function(){var RMApp=function(){_.bindAll(this,"_add_device_callback","_on_device_change"),this.sup(),this._callbacks.devices=[],$(window).on("device_change",this._on_device_change)};Prototype.extend(RMApp,App),_.extend(RMApp.prototype,{add_device_type:function(t){this._callbacks.devices[t]||(this._callbacks.devices[t]=null),this[t]||(this[t]=_.curry(this._add_device_callback,t))},_add_device_callback:function(t,e){var i=this._callbacks.devices[t];this._callbacks.devices[t]=i?_.compose(e,i):e},_execute_device_callback:function(t,e){var i=this._callbacks.devices[t];i&&i.call(this,e)},_on_device_change:function(t){this._execute_device_callback(t.device),this._execute_device_callback("device_change",t.device)},_ready_callback:function(){this.super_method("_ready_callback"),this._execute_device_callback(Device.device_type())}});var RM=new RMApp;return RM.add_device_type("device_change"),_(Device.ranges).each(function(t,e){RM.add_device_type(e)}),RM.ns("promoutils",function(promoutils){promoutils.activa_promos=function(){$(".j-promo_img").each(function(){RM.promoutils.isElementVisible($(this))&&RM.promoutils.activa_promo_img($(this))})},promoutils.activa_promo_img=function($enlace,reintentar){reintentar="undefined"!=typeof reintentar?reintentar:3,$enlace.each(function(){var dis=$(this),mimg=dis.find("img");if(!$(this).hasClass("j-promo_img")||!RM.promoutils.isElementVisible($(this)))return!1;if(RM.promoutils.imagen_cargada_ok(mimg[0])){$(this).removeClass("j-promo_img");var midatalayer=dis.attr("onclick"),tmpstr=midatalayer.replace("dataLayer.push(","").replace(");",""),miobj,miobjnuevo={eventCategory:"Impresiones banners",event:"impresiones"};try{miobj=eval("("+tmpstr+")"),miobjnuevo.eventAction="Imp_"+miobj.eventAction,miobjnuevo.eventLabel="",miobj.hasOwnProperty("eventLabel")&&""!=miobj.eventLabel&&(miobjnuevo.eventLabel="Imp_"+miobj.eventLabel),dataLayer.push(miobjnuevo)}catch(e){RM.utils.log(e)}}else reintentar>0&&setTimeout(function(){RM.promoutils.activa_promo_img(dis,reintentar-1)},1e3)})},promoutils.imagen_cargada_ok=function(t){var e=!0;return"undefined"==typeof t?!1:(t.complete||(e=!1),"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth&&(e=!1),e)},promoutils.isElementVisible=function(t){var e,i=!0;if(t.hasClass("header_info_sponsor"))if($("#side_nav_mobile_trigger").length>0)$("html").hasClass("menu_open")&&0!=t.closest("#mobile_devices_menu_holder").length||(i=!1);else{var n=t.closest(".swiper-slide");n.length&&(n.hasClass("swiper-slide-active")||(i=!1))}else if(t.parent(".navigation_sub_nav_advertisement").length)RM.utils.elemento_es_visible(t)||(i=!1);else if(t.parent(".m_slider_item").length){if(!t.parent(".m_slider_item").hasClass("swiper-slide-visible")){i=!1,e=t.closest(".m_slider").find("[data-viewport]");var r=t.closest(".m_slider").find("[data-viewport]").attr("id");RM.promoutils.add_swiper_callback(r,function(){setTimeout(function(){RM.promoutils.activa_promos()},500)})}}else RM.utils.elemento_es_visible(t)||(i=!1);return i},promoutils.actualiza_estado_visibilidad_banner=function(t){t.data("banner-mostrado",!0)},promoutils.setea_eventos=function(){$('body > [role="banner"]').find("[data-prev], [data-next]").on("click",function(){setTimeout(function(){RM.promoutils.activa_promos()},200)}),$('body > [role="banner"] [role="navigation"] .navlist_item').each(function(){var t=$(this).find(".navigation_sub_nav_advertisement"),e=t.find("a.j-promo_img");$(this).on("mouseenter",function(){setTimeout(function(){RM.promoutils.activa_promo_img(e)},1e3)})})},promoutils.ya_se_ha_visto_banner=function(t){return 1==t.data("banner-mostrado")},promoutils.swiper_callbacks={},promoutils.add_swiper_callback=function(t,e){promoutils.swiper_callbacks[t]=e},promoutils.swiper_callback=function(t){"function"==typeof promoutils.swiper_callbacks[t]&&promoutils.swiper_callbacks[t]()},promoutils.isElementInViewport=function(t){t instanceof jQuery&&(t=t[0]);var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}}),RM.ns("utils",function(t){t.pon_global_loading=function(){if(RM.dom.body.addClass("g-loading"),!$("#g-loading").length){var t=$('<div id="g-loading">');$("body").append(t)}},t.quita_global_loading=function(){RM.dom.body.removeClass("g-loading"),$("#g-loading").remove()},t.get_extension=function(t){if(null==t)return!1;var e=t.split(".").pop(),i="string"==typeof e?e:"mp4";return i},t.eliminarHasta=function(t,e){return t.substring(e+2,t.length)},t.eliminarDesde=function(t,e){return t.substring(0,e)},t.elemento_es_visible=function(t){return t.is(":visible")&&0==t.parents(":hidden").length},t.elemento_visible_en_pantalla=function(t){var e=$(window).scrollTop(),i=e+$(window).height(),n=t.offset().top,r=n+t.height();return r>=e&&i>=n&&i>=r&&n>=e},t.es_arabe=function(){var t=!1,e=$("html").attr("lang");return"undefined"!=typeof e&&e!==!1&&(t="ar"==e),t},t.get_max_height=function(t,e){var i={};"undefined"==typeof e&&(e=!1);var n=e?"min-height":"height",r=e?"0":"auto";t.css(n,r);var o=_.chain(t).map(function(t){return $(t).height()}).max().value();return i.prop=n,i.max_height=o,i},t._equalize_heights=function(e,i){var n=t.get_max_height(e,i);e.css(n.prop,n.max_height)},t.equalize_heights=function(e,i,n){"undefined"==typeof n&&(n=!1),t._equalize_heights(e,n),i&&$(window).on("resize",_.curry(_.debounce(t._equalize_heights,100),e,n))},t._equalize_heights_opts=function(e){var i=t.get_max_height(e.elements,e.min_height);e.elements.css(i.prop,i.max_height),e.line_height&&e.elements.css("line-height",i.max_height+"px")},t.equalize_heights_opts=function(e){"min_height"in e||(e.min_height=!1),"perpetual"in e||(e.perpetual=!1),"line_height"in e?e.line_height&&e.elements.css("line-height","normal"):e.line_height=!1,t._equalize_heights_opts(e),e.perpetual&&$(window).on("resize",_.curry(_.debounce(t._equalize_heights_opts,100),e))},t.transition_events=function(){var e,i=document.createElement("fakeelement"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",OTransition:"oTransitionEnd",transition:"transitionEnd"};for(e in n)if(void 0!==i.style[e])return t.transition_events=function(t){return function(){return t}}(n[e]),n[e]},t.get_url_param=function(t,e){void 0==e&&(e=window.location.href);try{t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+t+"=([^&#]*)",n=new RegExp(i),r=n.exec(e);return null==r?"":r[1]}catch(o){return""}},t.add_param=function(t,e,i){var n=-1==i.indexOf("?")?"?":"&";return i+n+t+"="+e},t.add_random_param=function(t,e){function i(t,e){return Math.floor(Math.random()*(e-t+1)+t)}return void 0===t||""===t||null===t?"":((void 0===e||""===e)&&(e="_"),t+=(-1!=t.indexOf("?")?"&":"?")+e+"="+i(0,1))},t.log=function(t){if(-1==location.host.indexOf("realmadrid.com"))try{console.log(t)}catch(e){}},t.logRM=function(t){if(-1==location.host.indexOf("realmadrid.com"))try{console.log("RM: "+t)}catch(e){}},t.is_firefox=function(){return $.browser.mozilla&&-1==navigator.userAgent.indexOf("Trident")},t.get_flash_status=function(t){var e=0;if(navigator.plugins["Shockwave Flash"])embed_length=$("embed").length,object_length=$("object").length,embed_length>0||object_length>0?$("object, embed").each(function(){"none"===$(this).css("display")&&(e=2)}):$("div[bginactive]").length>0&&(e=2);else if(navigator.userAgent.indexOf("MSIE")>-1)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(i){e=2}else e=1;return t&&"function"==typeof t?void t(e):e},t.hay_flash=function(t){return 0==RM.utils.get_flash_status(t)},t.ends_with=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},t.generic_morphs={init_functions:[],add_init_function:function(t){this.init_functions.push(t)},destroy_functions:[],add_destroy_function:function(t){this.destroy_functions.push(t)},init:function(){jQuery.each(RM.utils.generic_morphs.init_functions,function(t,e){e()})},destroy:function(){jQuery.each(RM.utils.generic_morphs.destroy_functions,function(t,e){e()})}},t.genera_id=function(t){return t+"_"+Math.random().toString().replace(".","")},t.pon_id_si_no_tiene=function(t,e){var i=t.is("[id]")?t.attr("id"):RM.utils.genera_id(e);return t.attr("id",i),i}}),RM.ns("fn",function(t){t.toggle_errors_of_form_for=function(t){_.delay(function(){var e=$(t).closest("form").find(".form_errors"),i=!0;e.find("label").each(function(){"none"!=$(this)[0].style.display&&(i=!1)}),i?e.removeClass("with_errors"):e.addClass("with_errors")},100)},t.init_advantages_table_headers=function(){RM.dom.m_advantages_table.each(function(){var t=$(this),e=$("<div class='m_advantages_table_headers show_on_mobile silent' aria-hidden='true'></div>"),i=t.prepend(e).find("tbody th"),n=t.find("thead th"),r=$('<div class="m_advantages_header_advantages"></div>');e.append(r),n.each(function(){var t=$("<div><span>"+$(this).text()+"</span></div>");r.children().length||t.addClass("first"),r.append(t)}),i.each(function(){e.append('<div class="m_advantages_headers">'+$(this).text()+"</div>")})})},t.resize_advantages_table_headers=function(){RM.dom.m_advantages_table&&RM.dom.m_advantages_table.each(function(){var t=$(this),e=t.find(".m_advantages_table_headers");e.length&&e.css("height",t.find("table").outerHeight()+1)})},t.config_underscore_templates=function(){_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g}},t.resize_highlighted=function(){RM.dom.highlighted&&(RM.utils.equalize_heights(RM.dom.highlighted.children().not(".m_highlighted_sponsor, .j_no_resize"),!0,!0),(Browser.not_msie()||Browser.is_msie("> 8"))&&RM.utils.equalize_heights(RM.dom.highlighted.find(".m_highlighted_aside_section"),!0,!0))}}),RM.ns("fn.validate",function(t){t.DNI_FORMAT="^[0-9]{7,8}[A-Z]{1}$",t.DNI_TEST=/^[0-9]{8}[A-Z]{1}$/,t.DNI_EXCEPTIONS=/^[KLM]{1}/,t.NIE_FORMAT="(^[X-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)",t.NIET_TEST=/^[T]{1}/,t.NIE_TEST=/^[X-Z]{1}[0-9]{7}[A-Z0-9]{1}$/,t.PASS_TEST=/^[<a-zA-Z0-9]{6,9}$/,t.PHOTO_CODE_TEST=/^[a-z0-9]+$/i,t.CP_CODIGO_POSTAL_TEST=/^([1-9]{2}|[0-9][1-9]|[1-9][0-9])[0-9]{3}$/,t.validate_dni=function(e){return e=e.replace("-","").toUpperCase(),8==e.length&&(e="0"+e),e.match(t.DNI_FORMAT)?t.DNI_TEST.test(e)?"TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.substring(8,0)%23)===e.charAt(8):t.DNI_EXCEPTIONS.test(e)?e[8]===String.fromCharCode(64):!1:!1},t.validate_nie=function(e){return e=e.replace("-","").toUpperCase(),e.match(t.NIE_FORMAT)?t.NIET_TEST.test(e)?e[8]===/^[T]{1}[A-Z0-9]{8}$/.test(e):t.NIE_TEST.test(e)?e[8]==="TRWAGMYFPDXBNJZSQVHLCKE".charAt(e.replace("X","0").replace("Y","1").replace("Z","2").substring(0,8)%23):!1:!1},t.validate_pass=function(e){return e=e.replace("-","").toUpperCase(),t.PASS_TEST.test(e)},t.id_format=function(e,i){return t["validate_"+i]?t["validate_"+i](e):!0},t.tipoTitular=function(t){"mad"==t?($(".tipoTitular #tipoTitularSoc .col_form_3.noexpand").css("display","none"),$(".tipoTitular #tipoTitularMad .col_form_3.noexpand").css("display","block")):($(".tipoTitular #tipoTitularMad .col_form_3.noexpand").css("display","none"),$(".tipoTitular #tipoTitularSoc .col_form_3.noexpand").css("display","block"))},t.tipoAcompa=function(t,e){"mad"==t?($(".tipoAcompa #tipoAcompaSoc_"+e+" .col_form_3.noexpand").css("display","none"),$(".tipoAcompa #tipoAcompaMad_"+e+" .col_form_3.noexpand").css("display","block"),$("#nombreAcompa_"+e).css("display","none"),$("#apellAcompa_"+e).css("display","none")):"soc"==t?($(".tipoAcompa #tipoAcompaMad_"+e+" .col_form_3.noexpand").css("display","none"),$(".tipoAcompa #tipoAcompaSoc_"+e+" .col_form_3.noexpand").css("display","block"),$("#nombreAcompa_"+e).css("display","none"),$("#apellAcompa_"+e).css("display","none")):($(".tipoAcompa #tipoAcompaSoc_"+e+" .col_form_3.noexpand").css("display","none"),$(".tipoAcompa #tipoAcompaMad_"+e+" .col_form_3.noexpand").css("display","none"),$("#nombreAcompa_"+e).css("display","block"),$("#apellAcompa_"+e).css("display","block"))},t.validate_photo_code=function(e){return 8!=e.length?!1:t.PHOTO_CODE_TEST.test(e)?!0:!1},t.validate_num_madridista=function(t){var e=/^\d+$/;return e.test(t)},t.ejecuta_scripts_inicio=function(){"undefined"!=typeof opciones_validacion&&$.each(opciones_validacion,function(t,e){var i=$("#"+e.id_formulario);i.validate().settings.messages=e.mensajes;for(var n in e.mensajes)$("#"+n).attr("data-custom-msg")||$("#"+n).attr("data-custom-msg","")})}}),RM}(),RM.ns("AddOther",function(t){t.AddOther=function(t,e){this.options=$.extend({},this.defaults,e),_.bindAll(this,"init","on_clone"),this.element=$(t),this.currentItem=this.options.starts_at,this.trigger=this.element.find(this.options.trigger),this.where=this.element.find(this.options.where),this.what=this.element.find(this.options.what),this.init()},$.extend(t.AddOther.prototype,{defaults:{what:"[data-add-what]",where:"[data-add-where]",trigger:"[data-add-trigger]",on_end:$.noop(),max:null,starts_at:0},init:function(){this.trigger.on("click",this.on_clone)},on_clone:function(t){if(t.preventDefault(),_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},!(this.currentItem>this.options.max)){var e=_.template(_.trim(this.what.html())),i=$(e({index:this.currentItem++}));this.where.append(i),this.options.on_end&&this.options.on_end.call(this,i)}}}),Plugin.define("add_other",t.AddOther)}),RM.ns("AddOtherNew",function(t){t.AddOtherNew=function(t,e){this.options=$.extend({},this.defaults,e),_.bindAll(this,"init","on_clone","on_remove"),this.element=$(t),this.currentItem=this.options.starts_at,this.trigger=this.element.find(this.options.trigger),this.untrigger=this.element.find(this.options.untrigger),this.where=this.element.find(this.options.where),this.what=this.element.find(this.options.what),this.init()},$.extend(t.AddOtherNew.prototype,{defaults:{what:"[data-add-what]",where:"[data-add-where]",trigger:"[data-add-trigger]",untrigger:"[data-remove-trigger]",on_end:$.noop(),max:null,starts_at:0},init:function(){this.trigger.on("click",this.on_clone),this.untrigger.on("click",this.on_remove)},on_clone:function(t){if(t.preventDefault(),_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},$(".add_member_limits").hide(),!(this.currentItem>this.options.max)){var e=_.template(_.trim(this.what.html())),i=$(e({index:this.currentItem++}));this.where.append(i),this.options.on_end&&this.options.on_end.call(this,i)}},on_remove:function(t){t.preventDefault(),quita_acomp(),controla_acomp_publ(),this.currentItem=this.currentItem-1}}),Plugin.define("add_other_new",t.AddOtherNew)}),RM.ns(function(t){t.Bindeable=function(t){_.bindAll(this,"on_click"),this.element=t,this.bindings=_(t.data()).chain().map(function(t,e){return/^bind[A-Z].+/.exec(e)?(e=e.replace(/([A-Z])/,function(t){return"-"+t.toLowerCase()}).replace(/^bind-/,""),[e,t]):null}).compact().value(),t.find(this.element.data("bindeable")).on("click",this.on_click)},$.extend(t.Bindeable.prototype,{on_click:function(t){t.preventDefault();var e=$(t.target);_(this.bindings).each(function(t){$(t[1]).text(e.data(t[0]))})}}),Plugin.define("bindeable",t.Bindeable,"bindeable-instance")}),RM.ns(function(t){t.Collapsable=function(e,i){this.options=$.extend({},t.Collapsable.DEFAULTS,i),_.bindAll(this,"on_toggle","expand","collapse"),this.element=e,this.$element=$(e),this.triggers=this.$element.find("[data-toggle]"),this.init()},$.extend(t.Collapsable.prototype,{init:function(){if(""==this.triggers.html()){var t=this.$element.find(".active").text();this.triggers.html(t)}this.notify(),this.triggers.on("click",this.on_toggle)},notify:function(){this.is_expanded()?(this.$element.trigger($.Event("expanded")),void 0!=this.triggers[0]&&this.triggers[0].setAttribute("data-status","expanded")):(this.$element.trigger($.Event("collapsed")),void 0!=this.triggers[0]&&this.triggers[0].setAttribute("data-status","collapsed"))
},collapse:function(){this.$element.removeClass("expanded"),this.notify()},expand:function(){this.$element.addClass("expanded"),this.notify()},is_expanded:function(){return this.$element.hasClass("expanded")},on_toggle:function(t){t.preventDefault(),this.is_expanded()?this.collapse():this.expand()}}),t.Collapsable.DEFAULTS={},$.fn.collapsable=function(e){return $(this).each(function(){var i=$(this);i.data("collapsable")||i.data("collapsable",new t.Collapsable(this,e))})}}),RM.ns("filters",function(t){t.ElementFilter=function(t){this.filtered_elements=this.elements=t,this.filtered_by="*"},Prototype.extend(t.ElementFilter,EventDispatcher),_.extend(t.ElementFilter.prototype,{iterator:function(){return new CollectionIterator(this.get_elements())},set_elements:function(t){this.elements=t},get_elements:function(){return this.filtered_elements},total_elements:function(){return this.get_elements().length},filter_by:function(t){this.filtered_elements=_(this.elements).filter(function(e){var i="*"==t||t==e.filter_category;return i?e.show():e.hide(),i}),this.trigger($.Event("filtered",{elements:this.filtered_elements,filter_type:t}))}}),t.ElementFilterGUI=function(t,e){_.bindAll(this,"on_filter_click"),this.sup(e),this.element=t,this.init()},Prototype.extend(t.ElementFilterGUI,t.ElementFilter),_.extend(t.ElementFilterGUI.prototype,{init:function(){this.element.on("click","[data-filter-type]",this.on_filter_click)},on_filter_click:function(t){t.preventDefault();var e=$(t.target).data("filter-type");this.filter_by(e)}}),t.FilterableElement=function(t){this.element=$(t),this.filter_category=this.element.data("filter-by"),this.hidden=!1},_.extend(t.FilterableElement.prototype,{show:function(){this.hidden&&(this.element.show(),this.hidden=!1)},hide:function(){this.hidden||(this.element.hide(),this.hidden=!0)}})}),RM.ns("filter_tags",function(t){t.FilterTags=function(t){this.element=t},_.extend(t.FilterTags,{classes:{},register_tag:function(t,e){var i=this.classes;_.each(e.split(","),function(e){i[_(e).trim()]=t})},get_class_by_element:function(t){var e,i=t.prop("tagName").toLowerCase();return"input"==i&&(i+=":"+t.attr("type")),new(e=this.classes[i]||this)(t)}}),_.extend(t.FilterTags.prototype,{show:function(){this.visibility(!0)},hide:function(){this.visibility(!1)},visibility:$.noop,active:function(){return this.element.is(":visible")}}),t.FilterCheckboxes=function(t){this.sup(t)},Prototype.extend(t.FilterCheckboxes,t.FilterTags),_.extend(t.FilterCheckboxes.prototype,{hide:function(){try{this.element.removeAttr("checked").custom_form("update")}catch(t){}finally{this.super_method("hide",!1)}},visibility:function(t){"string"!=typeof t&&(t=t?"inline-block":"none"),this.element.closest("span").css("display",t).siblings("label").css("display",t).end().end()},active:function(){return this.element.is(":checked")},visible:function(){return this.element.closest("span").is(":visible")}}),t.FilterCheckboxes.TAG_TYPE="input:checkbox, input:radio",t.FilterTags.register_tag(t.FilterCheckboxes,t.FilterCheckboxes.TAG_TYPE),t.FilterLinks=function(t){this.sup(t)},Prototype.extend(t.FilterLinks,t.FilterTags),_.extend(t.FilterLinks.prototype,{visibility:function(t){"string"!=typeof t&&(t=t?"block":"none"),this.element.css("display",t)},visible:function(){return this.element.is(":visible")}}),t.FilterLinks.TAG_TYPE="a",t.FilterTags.register_tag(t.FilterLinks,t.FilterLinks.TAG_TYPE)}),RM.ns(function(t){t.FilterVideosCategories=function(t){_.bindAll(this,"on_filters_change"),this.element=t,this.init()},$.extend(t.FilterVideosCategories.prototype,{init:function(){this.element.on("change","[data-filters]",this.on_filters_change)},on_filters_change:function(t){var e,i,n=$(t.target),r=n.closest("[data-filters]"),o=this.get_checked_filters_from(r);if(i=this.categories_for_filters(r),e=this.get_related_filters_for(o),o.length){this.each_filter(e,"show");var a=this,s=i.addClass("m_filters_visible").find("[data-filter-by]").not(e);this.hide_filters_recursively(s),this.hide_inactive_categories(i),i.each(function(t,e){a.some_visible($(e))||$(e).removeClass("m_filters_visible")}),window.__filters=this}else this.each_filter(i.find("[type=radio], [type=checkbox]"),"hide"),this.hide_categories(i);RM.utils.equalize_heights(this.element.find(".m_filter_videos_content fieldset")),this.element.trigger("resize")},each_filter:function(e,i){e instanceof jQuery&&(e=e.toArray());for(var n=e.length-1;n>=0;n--){var r=$(e[n]),o=t.filter_tags.FilterTags.get_class_by_element(r);"string"==typeof i?o[i].call(o):i.call(this,o,r)}},categories_for_filters:function(t){return $("[data-filter-category='"+t.data("filters").split(/,\s*/).join("'], [data-filter-category='")+"']")},get_checked_filters_from:function(t){return t.find("[data-filter-with]:checked").map(function(t,e){return e})},get_related_filters_for:function(t){return t=_(t).chain().map(function(t){var t=$(t);return $("[data-filter-by='"+t.data("filter-with")+"']").toArray()}).flatten().value(),$(t)},hide_categories:function(t){var e=this;t.each(function(){var t=$(this),i=e.all_inactive(t);i&&t.removeClass("m_filters_visible")})},hide_filters_recursively:function(t){this.each_filter(t,"hide");var e=this.get_related_filters_for(t);t.length&&this.hide_filters_recursively(e)},hide_inactive_categories:function(t){var e=_(t).chain().map(function(t){var e=$(t).data("filters");return e?"[data-filter-category='"+e+"']":null}).compact().value().join(",");this.hide_categories($(e))},show_filters_parents:function(t){return t.closest("[data-filter-category]").addClass("m_filters_visible")},all_inactive:function(e){return _(e.find("[data-filter-by]")).all(function(e){var i=t.filter_tags.FilterTags.get_class_by_element($(e));return!i.active()})},some_visible:function(e){return _(e.find("[data-filter-by]")).some(function(e){var i=t.filter_tags.FilterTags.get_class_by_element($(e));return i.visible()})}}),t.Filtervideos=function(e,i){this.options=$.extend({},t.Filtervideos.DEFAULTS,i),_.bindAll(this,"add_words","remove_words","press_enter","cleam_all","on_trending_click"),this.element=e,this.$element=$(e),this.content_words=this.$element.find(".m_filter_keywords_box"),this.input_words=this.$element.find(".m_filter_keywords_box_input"),this.action_words=this.$element.find(".m_filter_keywords_box_add"),this.hidden_words=this.$element.find(".m_filter_keywords_hidden"),this.cleam_filters=this.$element.find(".m_filter_keywords_actions_delete"),this.categories=new t.FilterVideosCategories(this.element),this.words=[],this.init()},$.extend(t.Filtervideos.prototype,{init:function(){this.action_words.on("click",this.add_words),this.content_words.on("click","span",this.remove_words),this.input_words.on("keypress",this.press_enter),this.cleam_filters.on("click",this.cleam_all),this.element.find('[data-filter-category="trending"]').on("click","[data-filter-by]",this.on_trending_click)},add_words:function(t){t.preventDefault();var e=this.input_words.val();e.match(/\S/)&&(this.register_word(e),this.cleam_input_words(),this.$element.trigger("resize"))},register_word:function(t){return this.words.push(_(t).trim()),this.hidden_val(),this.add_tag(t)},add_tag:function(t){var e=$("<span>"+t+"</span>");return this.content_words.append(e),e},remove_words:function(t){t.preventDefault();var e=$(t.target),i=this.words.indexOf(e.text());-1!=i&&(e.data("rel-trending")&&$(e.data("rel-trending")).removeClass("trending_hidden"),this.words.splice(i,1),this.hidden_val(),e.remove())},hidden_val:function(){this.hidden_words.val(this.words.join(","))},cleam_input_words:function(){this.input_words.val("")},press_enter:function(t){13==t.which&&(t.preventDefault(),this.action_words.trigger("click"))},cleam_all:function(t){t.preventDefault();var e=this.$element.find("input");e.prop("checked",!1);try{e.custom_form("update")}catch(t){window.console&&console.log(t)}finally{this.hidden_words.val(""),this.content_words.find("span").remove()}},on_trending_click:function(t){t.preventDefault();var e=$(t.target),i=this.register_word(e.text());i.data("rel-trending",t.target),e.addClass("trending_hidden"),this.$element.trigger("resize")}}),t.Filtervideos.DEFAULTS={},Plugin.define("filter_videos",t.Filtervideos,"filter_videos")}),RM.ns(function(t){t.FullWindow=function(t,e){_.bindAll(this,"center_element","on_resize"),this.on_resize=_.debounce(this.on_resize,200),this.options=$.extend({},this.defaults,e),this.element=t,this.init()},$.extend(t.FullWindow.prototype,{defaults:{ready_class:"full_window_ready",offset:!1,tipo:"default",img_class:""},init:function(){if("max-size"==this.options.tipo){var t=this;this.dimensiones_maximas={anchura:0,altura:0};var e=this.element.find(this.options.img_class);if(e.length){var i=e.attr("src"),n=new Image;n.onload=function(){t.dimensiones_maximas={anchura:this.width,altura:this.height},t.eval(),t.element.addClass(t.options.ready_class)},n.src=i}}else this.eval(),this.element.addClass(this.options.ready_class);$(window).on("resize",this.on_resize)},eval:function(){this.set_dimensions(),this.center_elements()},set_dimensions:function(){var t,e=this.element.parent(".m_destacados_home").length,i=!1;try{t=this.dimensiones_maximas.anchura/this.dimensiones_maximas.altura,i=t>=3.75}catch(n){}var r,o=this.element.find(".m_special_banner_link"),a=this.element.find(".m_dest_home_special_info"),s=$(window).width(),l=$(window).height();if(1==this.options.offset&&(l-=this.element.offset().top),"max-size"==this.options.tipo)if(l<this.dimensiones_maximas.altura&&(r=l-70),s>this.dimensiones_maximas.anchura&&(this.element.addClass("j_max"),s=this.dimensiones_maximas.anchura),0!=s&&(this.set_image_type(s,l),this.element.css({width:s})),e){var c=a.height(),h=this.dimensiones_maximas.altura,u=o.height(),d=h-c;if(h>c)if(h>c+u+60&&!i){o.css("display","block"),d-=u,resto_top=.4*d,a.css("top",resto_top+"px");var p=resto_top+c+60;r>p&&(p=r),o.css("top",p+"px")}else o.css("display","none"),resto_top=.4*d,a.css("top",resto_top+"px")}else o.css("top",r+"px");else this.set_image_type(s,l),this.element.css({width:s,height:l})},set_image_type:function(t,e){var i=t/e;this.element.find("[data-center]").each(function(){var t=$(this),e=t.width(),n=t.height(),r=e/n;i>r?t.addClass("m_special_properties"):t.removeClass("m_special_properties")})},center_elements:function(){this.element.find("[data-center]").each(this.center_element)},center_element:function(t,e){e=$(e);var i=e.width(),n=RM.utils.es_arabe()?"margin-right":"margin-left";e.css(n,-(i/2))},on_resize:function(){this.eval()}}),Plugin.define("full_window",t.FullWindow)}),RM.ns("HeaderSchedule",function(t){t.Model=function(){_.bindAll(this,"on_ajax_loaded"),this.sup(this),this.loaded=!1,this.matches=[],this.index=0},t.Model.LOADING="loading",t.Model.LOADED="loaded",t.Model.INDEXCHANGE="indexchange",Prototype.extend(t.Model,EventDispatcher),_.extend(t.Model.prototype,{load:function(e){this.trigger($.Event(t.Model.LOADING)),$.ajax({type:"post",url:e,dataType:"json"}).done(this.on_ajax_loaded)},on_ajax_loaded:function(e){this.data=e,this.data.matches.length>0&&(this.matches=this.matches.concat(this.data.matches)),this.loaded=!0,this.trigger($.Event(t.Model.LOADED))},add_match:function(t){this.matches.push(t)},has_next:function(){return this.matches[this.index+1]},next:function(){this.set_index(this.index+1)},has_prev:function(){return this.matches[this.index-1]},prev:function(){this.set_index(this.index-1)},set_index:function(e){this.index=e,this.trigger($.Event(t.Model.INDEXCHANGE,{index:this.index,items:this.matches.length}))},current:function(){return this.matches[this.index]}}),t.View=function(t,e,i){_.bindAll(this,"on_loading","index_change","on_loaded","on_time_select_change"),this.options=$.extend({},this.defaults,i),this.sup(t),this.model=e,this.element=t,this.content=t.find("[data-content]"),this.visible=!1,this.template=_.template(this.element.find("#header_template").html()),this.init()},t.View.SHOW="header_info_show",t.View.HIDE="header_info_hide",Prototype.extend(t.View,EventDispatcher),_.extend(t.View.prototype,{defaults:{next_btn:".ico_goto:not(.ico_goto_back)",prev_btn:".ico_goto_back",time_select:".header_basic_details select",time_select_content:".time_select_content",time_select_summary:".header_summary_description time em"},init:function(){this.model.on(t.Model.LOADING,this.on_loading),this.model.on(t.Model.LOADED,this.on_loaded),this.model.on(t.Model.INDEXCHANGE,this.index_change),this.init_time_select()},init_time_select:function(){this.element.find(this.options.time_select).off(".header_info_time_selection").on("change.header_info_time_selection",this.on_time_select_change)},on_time_select_change:function(){var t=this.element.find(this.options.time_select).find(":selected");this.element.find(this.options.time_select_content).text(t.data("time")+", "+t.data("tv")),this.element.find(this.options.time_select_summary).text(t.data("time"))},toggle:function(){this.visible?this.hide():this.show()},show:function(e,i){void 0==i&&(i=!0),this.visible=!0,MoveIt.slide_down(this.content,i),this.hide_tools(i),e||this.trigger($.Event(t.View.SHOW))},hide:function(){this.visible=!1,MoveIt.slide_up(this.content),this.show_tools(),this.trigger($.Event(t.View.HIDE))},show_tools:function(){MoveIt.fade_in($(".header_summary_description, .header_info_actions a:not(.header_info_sponsor)"))},hide_tools:function(t){void 0==t&&(t=!0),MoveIt.fade_out($(".header_summary_description, .header_info_actions a:not(.header_info_sponsor)"),t)},on_loading:function(){this.element.addClass(t.Model.LOADING)},on_loaded:function(){this.element.removeClass(t.Model.LOADING)},change_match:function(t){t instanceof HTMLElement||t instanceof jQuery?this.element.html(t):(_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},this.element.html(this.template(t))),this.content=this.element.find("[data-content]"),this.visible&&this.show(!0,!1),this.init_time_select()},index_change:function(t){t.index>=t.items-1?this.element.addClass("hide_arrow_next"):this.element.removeClass("hide_arrow_next"),0==t.index?this.element.addClass("hide_arrow_prev"):this.element.removeClass("hide_arrow_prev")}}),t.Controller=function(e,i){_.bindAll(this,"on_triggers","on_visibility_change","on_document_keydown","on_next_btn","on_model_loaded","on_prev_btn"),this.options=$.extend({},this.defaults,i),this.element=e,this.model=new t.Model,this.view=new t.View(e,this.model),this.url=this.element.data("url"),this.init()},_.extend(t.Controller.prototype,{defaults:{triggers:"[data-header-trigger]"},init:function(){this.element.on("click",this.options.triggers,this.on_triggers),this.view.on(t.View.SHOW+" "+t.View.HIDE,this.on_visibility_change),this.model.add_match(this.element.find("[data-content],[data-toolbar]")),this.element.on("click",".ico_goto:not(.ico_goto_back)",this.on_next_btn),this.element.on("click",".ico_goto_back",this.on_prev_btn)},on_triggers:function(t){t.preventDefault(),this.view.toggle()},on_visibility_change:function(e){switch(e.type){case t.View.SHOW:$(document).off(".header_info_key_event").on("keydown.header_info_key_event",this.on_document_keydown);break;case t.View.HIDE:$(document).off(".header_info_key_event")}},on_document_keydown:function(t){27==t.keyCode&&this.view.hide()},on_next_btn:function(t){t.preventDefault(),this.next()},on_prev_btn:function(t){t.preventDefault(),this.prev()},next:function(){this.model.loaded?this.model.has_next()&&(this.model.next(),this.view.change_match(this.model.current())):(this.model.on(t.Model.LOADED,this.on_model_loaded),this.model.load(this.url))},prev:function(){this.model.loaded&&this.model.has_prev()&&(this.model.prev(),this.view.change_match(this.model.current()))},on_model_loaded:function(){this.model.off(t.Model.LOADED),this.next()}})}),RM.ns(function(t){t.LatesTweets=function(t,e){_.bindAll(this,"on_loaded"),this.options=$.extend({},this.defaults,e),this.element=t,this.pirendo=new RM.Pirendo,this.max_tweets=this.element.data("tweets"),this.lounge=this.element.data("lounge"),this.element.find(this.options.template).length&&(this.template=_.template(this.element.find(this.options.template).html()),this.init())},$.extend(t.LatesTweets.prototype,{defaults:{template:"[data-template]"},init:function(){this.pirendo.get_tweets({rpp:this.max_tweets,lounge:this.lounge}),this.pirendo.on("loaded",this.on_loaded)},on_loaded:function(){_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},this.element.append(this.template({messages:this.pirendo.result.data}))}}),Plugin.define("lates_tweets",t.LatesTweets,"lates_tweets")}),RM.ns(function(t){t.PreloadableImage=function(t,e,i){_.bindAll(this,"on_image_load"),this.src=t,this.width=e,this.height=i,this.image_tag=null,this.ready=!1,this.render()},_.extend(t.PreloadableImage.prototype,{wrapper_class:"image_wrapper",render:function(){return this.element||(this.element=$("<div class='"+this.wrapper_class+"'></div>"),this.prevent_reflow()),this.element},prevent_reflow:function(){if(this.width&&this.height){var t=Math.round(100*this.height/this.width*1e3)/1e3;this.element.css("padding-bottom",t+"%")}},load:function(){this.ready||(this.image_tag=new Image,this.image_tag.onload=this.on_image_load,this.image_tag.src=this.src,this.ready=!0)},on_image_load:function(){$(this.image_tag).parent().length||this.element.append(this.image_tag)}}),t.PreloadableImageItem=function(t){this.element=t,this.init_image()},_.extend(t.PreloadableImageItem.prototype,{image_class:t.PreloadableImage,init_image:function(){var t=this.element.find("noscript"),e=this.element.find(".noscript_image");e.length&&t.length?(e.remove(),this.image=new this.image_class(e.attr("src"),e.attr("width"),e.attr("height")),t.after(this.image.render())):t.length&&(img=$(this.get_noscript_content(t)),this.image=new this.image_class(img.attr("src"),img.attr("width"),img.attr("height")),t.after(this.image.render()))},get_noscript_content:function(t){return _.trim(t.text())},load_image:function(){this.image&&!this.image.ready&&this.image.load()}})}),RM.ns(function(t){t.Advertisement=function(e){this.sup(e),t.Advertisement.register(this)},_.extend(t.Advertisement,{instances:[],ready:!1,register:function(t){var e=this.load(t);e||(this.set_listeners(),this.instances.push(t))},set_listeners:function(){this.ready||(_.bindAll(this,"on_device_change"),$(window).on("device_change.advertisement_device_change",this.on_device_change),this.ready=!0)},on_device_change:function(){_.delay(_.bind(function(){_(this.instances).each(function(t){this.load(t)},this),this.instances=_(this.instances).filter(function(t){return _.has(t,"image")?!t.image.ready:!1})},this),500)},load:function(t){var e=t.element;return e.is(":visible")?(t.load_image(),!0):!1}}),Prototype.extend(RM.Advertisement,t.PreloadableImageItem),_.extend(t.Advertisement.prototype,{get_noscript_content:function(t){var e=t.text().replace(/<!--.+?-->/g,"");return _.trim(e)}}),Plugin.define("m_ad",t.Advertisement,"m_ad")}),RM.ns(function(t){t.ArticlesFilter=function(t,e){this.sup(t,e)},Prototype.extend(t.ArticlesFilter,RM.filters.ElementFilterGUI),_.extend(t.ArticlesFilter.prototype,{super_filter_by:t.ArticlesFilter.prototype.filter_by,filter_by:function(t){_(this.elements).each(function(t){t.remove()}),this.super_filter_by(t)}}),t.ArticlesItem=function(t){this.sup(t),this.timestamp=parseInt(this.element.data("timestamp"),10)},Prototype.extend(t.ArticlesItem,RM.filters.FilterableElement),_.extend(t.ArticlesItem.prototype,{hide:function(){this.hidden=!0},show:function(){this.hidden=!1},remove:function(){this.element.parent().length&&this.element.detach().removeClass("m_highlight_banner")}}),t.ArticlesViewport=function(t){this.element=t},_.extend(t.ArticlesViewport.prototype,{articles:function(){return this.element.find("[data-filter-by]")},append:function(t){_.each(t,function(t,e){0==e?this.append_to_highlight(t):this.append_to_column(t,e%2)},this)},append_to_highlight:function(t){t.element.addClass("m_highlight_banner"),this.swap_image_of(t,"big"),$(".m_articles_banner",this.element).append(t.element)},append_to_column:function(t,e){this.swap_image_of(t,"small"),$(".m_articles_col:nth-child("+(1==e?1:2)+")",this.element).append(t.element)},swap_image_of:function(t,e){var i=t.element,n=i.data(e+"-image");if(n){var r=i.find(".m_highlight_header img");r.attr("src")!=n&&r.attr("src",n)}}}),t.Articles=function(e){_.bindAll(this,"on_filter"),this.element=e,this.viewport=new t.ArticlesViewport(this.element.find("[data-viewport]"));var i=_.chain(this.viewport.articles()).map(function(e){return new t.ArticlesItem($(e))}).value();this.filter=new t.ArticlesFilter(this.element.find("[data-filters]"),i),this.filter.on("filtered",this.on_filter)},_.extend(t.Articles.prototype,{on_filter:function(){this.viewport.append(_(this.filter.get_elements()).chain().sort(function(t,e){return t.timestamp>e.timestamp}).reverse().value())}}),Plugin.define("m_articles",t.Articles,"m_articles")}),RM.ns(function(t){t.MHightlight=function(t,e){this.highlight=$(t);var i=this.highlight.is(".m_share")?this.highlight[0]:this.highlight.find(".m_share")[0];this.sup(i,e)},Prototype.extend(t.MHightlight,t.Collapsable),$.extend(t.MHightlight.prototype,{init:function(){this.notify(),this.triggers.on("click",this.click_trap),this.triggers.on("tap",this.on_toggle),"desktop"==Device.current_device?this.$element.on("mouseenter",this.expand).on("mouseleave",this.collapse):this.$element.addClass("expanded")},click_trap:function(t){t.preventDefault()}}),$.fn.m_highlight=function(e){return $(this).each(function(){var i=$(this);i.data("m_hightlight")||i.data("m_hightlight",new t.MHightlight(this,e))})}}),RM.ns(function(t){t.Minnernav=function(e,i){this.options=$.extend({},t.Minnernav.DEFAULTS,i),_.bindAll(this,"insert_text"),this.element=e,this.$element=$(e),this.items=this.$element.find(".m_collapsable_content li"),this.element_text=this.$element.find(".m_inner_nav_content p"),this.init()},$.extend(t.Minnernav.prototype,{init:function(){var t=this.get_active();0==t.length&&this.add_active(this.items[0]),this.element_text.text(this.items.filter(".active").text()),this.items.on("click","a",this.insert_text)},get_active:function(){return this.items.filter(".active")},add_active:function(t){this.remove_active(),$(t).addClass("active")},remove_active:function(){this.items.removeClass("active")},insert_text:function(t){var e=$(t.target).text();this.add_active(t.delegateTarget),this.element_text.text(e);var i=this.$element.data("collapsable");i&&i.collapse()}}),t.Minnernav.DEFAULTS={},$.fn.m_inner_nav=function(e){return $(this).each(function(){var i=$(this);i.data("m_inner_nav")||i.data("m_inner_nav",new t.Minnernav(this,e))})}}),RM.ns(function(t){t.MShare=function(t,e){this.sup(t,e)},Prototype.extend(t.MShare,t.Collapsable),$.extend(t.MShare.prototype,{init:function(){this.notify(),this.triggers.on("click",this.click_trap),this.triggers.on("tap",this.on_toggle),this.$element.on("mouseenter",this.expand).on("mouseleave",this.collapse)},click_trap:function(t){t.preventDefault()},expand:function(){this.super_method("expand"),MoveIt.slide_down(this.$element.find(".m_collapsable_content"))},collapse:function(){this.super_method("collapse"),MoveIt.slide_up(this.$element.find(".m_collapsable_content"))}}),$.fn.m_share=function(e){return $(this).each(function(){var i=$(this);i.data("m_share")||i.data("m_share",new t.MShare(this,e))})}}),RM.ns(function(t){t.Pirendo=function(t){_.bindAll(this,"on_success"),this.element=t,this.result=null},Prototype.extend(t.Pirendo,EventDispatcher),$.extend(t.Pirendo.prototype,{load:function(t,e){void 0==t&&(t=""),e||(e={});var i=e.timestamp||0,n=e.rpp||2,r=e.lounge||1,o="https://rmapi.pirendo.com/api/rm_api/get_feed/"+r+"/"+t+"/"+i+"/"+n;$.ajax({type:"post",data:{api_key:"36d193b3jaae2n7cfe716cae4700bad0"},url:o,dataType:"json"}).done(this.on_success).fail(function(){window.console&&console.log(arguments,"fail")})},get_facebook:function(t){this.load("facebook",t)},get_tweets:function(t){this.load("twitter",t)},get_instagram:function(t){this.load("instagram",t)},get_all:function(t){this.load("all",t)},on_success:function(t){this.result=t,200==this.result.code&&this.trigger($.Event("loaded"))}})}),RM.ns(function(t){t.PlayerStats=function(t){_.bindAll(this,"on_change_season","load_big_stats","calc_stats_season","calc_stats_cols"),this.element=t,this.current_count=1,this.init()},_.extend(t.PlayerStats.prototype,{init:function(){this.change_season(),this.get_season_selector().change(this.on_change_season),this.load_big_stats()},get_season_selector:function(){return this.element.find("[data-seasons]")},change_season:function(){var t=this.get_season_selector(),e=t.find(":selected");e.length||(e=t.find("option").first()),this.element.find("[data-season].active_season").removeClass("active_season"),$(this.element.find("[data-season]")[e.index()]).addClass("active_season")},on_change_season:function(){this.change_season()},load_big_stats:function(){if(this.element.find(".m_teams_stats").each(this.calc_stats_season),RM.dom.player_basket_stats){var t=[];for(t=this.element.find(".active_season .m_teams_stats_list li p").slice(0,4).clone(),s=0;s<=t.length;s++)RM.dom.player_basket_stats.append(t[s])}},calc_stats_season:function(t,e){this.stats_season=$(e);var i=this.stats_season.data("stats-mode");void 0!=i&&"b"==i?(this.calc_stats_basket(),this.current_count=1):(this.stats_season.find("table tbody tr").each(this.calc_stats_cols),this.current_count=1)},calc_stats_basket:function(){var t=this.stats_season.data("lit1")?this.stats_season.data("lit1"):"Points",e=this.stats_season.data("lit2")?this.stats_season.data("lit2"):"Rebounds";for(this.rows=this.stats_season.find("table tbody tr"),i=1;6>=i;i++)switch(i){case 1:this.calc_stats_cols(i,this.rows[i-1]);break;case 2:this.calc_stats_multicols(i,t,1,3);break;case 3:this.calc_stats_multicols(i,e,9,10);break;case 4:this.calc_stats_cols(i,this.rows[i]);break;case 5:this.calc_stats_cols(i,this.rows[i]);break;case 6:this.calc_stats_cols(i,this.rows[i])}},calc_stats_cols:function(t,e){if(this.current_count<=6){for(this.stats_col=$(e),this.col_title=$(this.stats_col.find("td").get(0)).html(),this.col_value=0,l=1;6>=l;l++)current_value=$(this.stats_col.find("td").get(l)).html(),null!=current_value&&(this.col_value+=parseInt(current_value));this.col_title&&this.stats_season.find(".m_teams_stats_list").append("<li><p><dfn data-stat-title>"+this.col_title+"</dfn> <span data-stat-value>"+this.col_value+"</span></p></li>"),this.current_count++}},calc_stats_multicols:function(t,e,i,n){var r=i,o=n;for(this.multicol_value=0,k=r;o>=k;k++)for(this.current_row=$(this.rows[k]),j=1;6>=j;j++)current_value=$(this.current_row.find("td").get(j)).html(),null!=current_value&&(this.multicol_value+=parseInt(current_value));var a="<tr><td>"+e+"</td><td>"+this.multicol_value+"</td></tr>";this.calc_stats_cols(t,a)}}),Plugin.define("player_stats",t.PlayerStats,"player-stats")}),RM.ns(function(t){t.Promos=function(t){_.bindAll(this,"on_success","print"),this.group=t.group,this.url=$("[data-ads-remote="+this.group+"]").val(),this.numero_maximo=$("[data-ads-remote="+this.group+"]").attr("data-ads-numero-maximo")?$("[data-ads-remote="+this.group+"]").data("ads-numero-maximo"):0,this.template="default"==this.group||"promos_galeria"==this.group?_($("[data-ads-template="+this.group+"]").html()).template():_($('[data-ads-template="default"]').html()).template(),this.load(),$(window).on("device_change",this.print)},$.extend(t.Promos.prototype,{load:function(){this.get_all_containers().addClass("loading"),this.url&&$.ajax({type:"get",url:this.url,dataType:"json"}).done(this.on_success).fail(function(){window.console&&console.log(arguments,"fail")})},on_success:function(t){this.get_all_containers().removeClass("loading"),this.data=t,this.print()},print:function(){0!=this.numero_maximo&&(this.data.results=this.data.results.splice(0,this.numero_maximo));var t=this.get_current_container();if(this.data&&!t.hasClass("change")){_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g};var e=this.template({data:this.data,group:this.group,device:Device.device_type()});t.append(e),t.addClass("change"),t.find(".j-promo_img").each(function(){RM.promoutils.activa_promo_img($(this))})}},get_current_container:function(){return $("[data-ads="+this.group+"][data-ads-block="+Device.device_type()+"]")},get_all_containers:function(){return $("[data-ads="+this.group+"]")}})}),RM.ns(function(t){t.Promos_Noticias=function(t){_.bindAll(this,"on_success","print"),this.group=t.group,this.url=$("[data-ads-remote="+this.group+"]").val(),this.numero_maximo=$("[data-ads-remote="+this.group+"]").attr("data-ads-numero-maximo")?$("[data-ads-remote="+this.group+"]").data("ads-numero-maximo"):0,this.template="default"==this.group||"promos_galeria"==this.group?_($("[data-ads-template="+this.group+"]").html()).template():_($('[data-ads-template="default"]').html()).template(),this.load(),$(window).on("device_change",this.print)},$.extend(t.Promos_Noticias.prototype,{load:function(){this.get_all_containers().addClass("loading"),this.url&&$.ajax({type:"get",url:this.url,dataType:"json"}).done(this.on_success).fail(function(){window.console&&console.log(arguments,"fail")})},on_success:function(t){this.get_all_containers().removeClass("loading"),this.data=t,this.print()},print:function(){0!=this.numero_maximo&&(this.data.results=this.data.results.splice(0,this.numero_maximo));var t=this.get_current_container();if(this.data&&!t.hasClass("change")){_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g};var e=this.template({data:this.data,group:this.group,device:Device.device_type()});t.append(e),t.addClass("change")}},get_current_container:function(){return $("[data-ads="+this.group+"][data-ads-block="+Device.device_type()+"]")},get_all_containers:function(){return $("[data-ads="+this.group+"]")}})}),RM.ns(function(t){_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},t.ScheduleModel=function(){this.events=[]},$.extend(t.ScheduleModel.prototype,{date:null,events:null,date_str:null,formats:{current:"YYYY-MM",event:"YYYY-MM-DD HH:mm"},set_date:function(t){this.date=moment(t,this.formats.current)},add_event:function(t,e,i){this.events.push({title:t,date:moment(e,this.formats.event),href:i})}}),t.Schedule=function(e){this.element=e,this.model=new t.ScheduleModel,this.viewport=this.element.find("[data-viewport]"),this.init_model(),this.init_calendar()},$.extend(t.Schedule.prototype,{init_model:function(){var t=this.element.find("[data-current-date]");this.model.set_date(t.data("current-date")),this.model.date_str=t.text(),this.element.find("[data-event]").each(_.bind(function(t,e){e=$(e);var i=e.find("[data-event-title]").text(),n=e.find("[data-event-date]").attr("datetime"),r=e.find("a").attr("href");this.model.add_event(i,n,r)},this)),this.model.next_url=this.element.find("[data-next]").attr("href"),this.model.prev_url=this.element.find("[data-prev]").attr("href")},init_calendar:function(){var t=this.element.find("[data-template]").html(),e=document.documentElement.lang||"es";this.viewport.empty().clndr({template:t,startWithMonth:this.model.date,events:this.model.events,daysOfTheWeek:SCHEDULE_PARAMS.dow[e],weekOffset:SCHEDULE_PARAMS.start_week_at,extras:{date_str:this.model.date_str,next_url:this.model.next_url,prev_url:this.model.prev_url}}),this.viewport.addClass("ready")}}),Plugin.define("schedule",t.Schedule,"schedule")}),RM.SideMenu=function(t,e){_.bindAll(this,"on_trigger","on_back","on_transition_end"),this.on_back=_.throttle(this.on_back,2e3),this.change_panel=_.throttle(this.change_panel,500),this.options=$.extend(!0,{},this.defaults,e),this.element=t,this.templates={},this.element.children().on(RM.utils.transition_events(),this.on_transition_end),this.element.on("click",this.options.triggers,this.on_trigger),this.element.on("click",this.options.back_btn,this.on_back),this.options.initialize&&this.options.initialize.apply(this)},_.extend(RM.SideMenu.prototype,{defaults:{triggers:"[data-goto],[data-gosub]",panels:"[data-panel]",back_btn:"[data-back-btn]",current_class:"current_panel",visible_class:"visible_panel",select_panel:null,templates:{back_btn:"[data-back-btn-template]"},prepare_panel:null},get_panel_for:function(t){var e;return e=(e=this.options.select_panel)&&"function"==typeof e?e.call(this,t):t.siblings(this.options.panels)},get_template:function(t,e){var i;if(!(i=this.templates[t])){var n=$(this.options.templates.back_btn);n.length&&(i=_.template(_(n.html()).trim()))}return i(e)},prepare_panel:function(t){var e;
(e=t.find("[data-back-btn]")).length||(e=this.get_template("back_btn"),t.prepend(e)),this.options.prepare_panel&&this.options.prepare_panel.call(this,t),t.addClass(this.options.visible_class)},change_panel:function(t){this.prepare_panel(t),_.defer(_.bind(function(){t.addClass(this.options.current_class)},this))},on_trigger:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.target),i=this.get_panel_for(e);this.change_panel(i)},on_back:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.target),i=e.closest(this.options.panels);if(i.hasClass(this.options.current_class)){i.length&&(this.options.before_back&&this.options.before_back.call(this,i),i.removeClass(this.options.current_class));var n=i.closest(".current_panel");n.length&&(n.addClass("hidden_panel"),setTimeout(function(){n.removeClass("hidden_panel")},0))}},on_transition_end:function(t){var e=$(t.target);e.hasClass(this.options.visible_class)&&e.hasClass(this.options.current_class)&&e.removeClass(this.options.visible_class)}}),RM.ns(function(t){t.Total_tickets=function(e,i){this.options=$.extend({},t.Total_tickets.DEFAULTS,i),_.bindAll(this,"change_element"),this.element=e,this.$element=$(e),this.element_total_sum=$(".m_total_price_sum",this.$element),this.data_price=$("[data-price]",this.element),this.price=0,this.init()},$.extend(t.Total_tickets.prototype,{init:function(){this.$element.on("change","[data-price], .m_combined_ticket_table select",this.change_element),this.total_price(0)},change_element:function(t){this.price=this.calc_price($("[data-ticket]:checked"));var e=$(t.target);e.is(":checkbox")&&e.closest("tr").find(".m_combined_ticket_table_quantity")[e.is(":checked")?"addClass":"removeClass"]("m_combined_ticket_table_quantity_active"),this.total_price(this.price)},calc_price:function(t){var e=0;return t.each(function(){if($(this).data("quantity")){var t=$("select"+$(this).data("quantity")).val();e+=parseInt(t,10)*parseFloat($(this).data("price"))}else e+=parseFloat($(this).data("price"))}),e},total_price:function(t){var e=t.toFixed(2).replace(".",",");this.element_total_sum.text(e)}}),t.Total_tickets.DEFAULTS={},Plugin.define("total_tickets",t.Total_tickets,"total_tickets")}),RM.ns("autocomplete",function(t){t.YouAutoCompleteMeListItem=function(t){_.bindAll(this,"on_click"),this.text=t},$.extend(t.YouAutoCompleteMeListItem.prototype,{append_to:function(t){t.append(this.render())},render:function(){return this.element||(this.element=this.draw(),this.element.on("click",this.on_click)),this.element},draw:function(){return $("<li>"+this.text+"</li>")},destroy:function(){this.element&&this.element.parent()&&this.element.remove(),this.text=null,this.element.off("click"),this.element=null},highlight:function(t){this.element.html(this.highlighted_text(t))},highlighted_text:function(t){var e=new RegExp("("+t.split(/\s/).join("|")+")","ig");return this.text.match(e)||this.element.hide(),this.text.replace(e,"<strong>$1</strong>")},on_click:function(t){t.preventDefault(),this.element.trigger($.Event("list_item_click",{item:this}))},activate:function(){this.element.hasClass("active")||this.element.addClass("active")},deactivate:function(){this.element.hasClass("active")&&this.element.removeClass("active")}}),t.YouAutoCompleteMeList=function(t,e,i){_.bindAll(this,"on_collection_change","on_index_change"),this.element=i,this.parent=t,this.model=e,this.elements=null,this.init()},$.extend(t.YouAutoCompleteMeList.prototype,{item:t.YouAutoCompleteMeListItem,init:function(){this.model.on("collection_change",this.on_collection_change).on("index_change",this.on_index_change)},render:function(){if(!this.element){var t=this.draw();this.element=t.is("[data-items]")?t:t.find("[data-items]"),this.append(t)}this.fill()},fill:function(){var t=[],e=this.item,i=this.element,n=this.model;n.each(function(r){r=new e(r),t.push(r),r.append_to(i),r.highlight(n.query)}),this.elements=t},clear:function(){_(this.elements).each(function(t){t.destroy()}),this.elements=[]},append:function(t){this.parent.append(t)},draw:function(){return $("<div><ul data-items></ul></div>")},highlight_all:function(){var t=this.model.query;_(this.elements).each(function(e){e.highlight(t)})},on_collection_change:function(){this.clear(),this.fill()},on_index_change:function(t){void 0!=t.index&&_(this.elements).each(function(e,i){i!=t.index?e.deactivate():e.activate()})}}),t.YouAutocompleteMeRemote=function(t,e){_.bindAll(this,"on_done","on_fail","on_always"),_.extend(this,_.pick(e,"method")),this.endpoint=t,this.callbacks={done:[],fail:[],always:[]}},$.extend(t.YouAutocompleteMeRemote.prototype,{load:function(t){return this.last_options&&this.last_options==t?this:(this.last_options=t,$.ajax({url:this.endpoint,data:t,dataType:"json",type:this.method}).done(this.on_done).fail(this.on_fail).always(this.on_always),this)},on:function(t,e){return this.callbacks[t].push(e),this},on_done:function(t){this.execute_callbacks("done",t)},on_fail:function(t){this.execute_callbacks("fail",t)},on_always:function(){this.execute_callbacks("always")},execute_callbacks:function(t,e){var i,n=this.callbacks[t],r=n.length;for(r=0;r<n.length;r++)i=n[r],i.call(this,e)}}),t.YouAutocompleteMeModel=function(t,e){this.options=_.extend({},this.defaults,e),this.collection=t||[],this.current_index=-1},$.extend(t.YouAutocompleteMeModel.prototype,{defaults:{endpoint:null},set_query:function(t,e){this.query=t;var i=_.trim(this.query);this.last_query!=i&&(this.last_query=i,e||this.trigger($.Event("query_change",{query:this.query})),t.match(/\S/)||this.clear())},stage_current:function(t){this.set_query(this.current(),t)},set_collection:function(t){this.reset_index(),this.collection=t,this.trigger($.Event("collection_change"))},each:function(t){var e,i,n=this.collection.length;for(e=0;n>e;e++)i=this.collection[e],t.call(this,i)},clear:function(){this.reset_index(),this.collection=[],this.trigger($.Event("collection_change"))},next:function(){var t=this.collection.length;t&&(this.current_index>=t-1?this.reset_index():this.set_index(++this.current_index))},prev:function(){this.collection.length&&this.set_index(this.current_index<=-1?this.collection.length-1:--this.current_index)},reset_index:function(){this.set_index(-1)},set_index:function(t){var e=this.collection.length;t>=e?t=-1:-1>t&&(t=-1),this.current_index=t,this.trigger($.Event("index_change",{index:this.current_index,current:this.current()}))},current:function(){return-1==this.current_index?null:this.collection[this.current_index]}}),Prototype.mixin(t.YouAutocompleteMeModel,EventDispatcher),t.YouAutocompleteMe=function(t,e){_.bindAll(this,"on_key_up","on_remote_fail","on_remote_done","on_query_change","fetch","on_collection_change","on_index_change","on_key_down","on_list_item_click","on_click_trap"),this.options=_.extend({},this.defaults,e),this.fetch=_.debounce(this.fetch,this.options.delay),this.element=t,this.form=t.is("form")?t:t.find("form"),this.input=this.element.find("[data-searchable]"),this.model=new this.options.model,this.remote=new this.options.remote(this.form.data("autocomplete-url")||this.form.attr("action"),{method:(this.form.attr("method")||"get").toUpperCase()}),this.list=new this.options.list(this.element,this.model),this.init()},t.YouAutocompleteMe.UP=38,t.YouAutocompleteMe.DOWN=40,t.YouAutocompleteMe.ESC=27,t.YouAutocompleteMe.ENTER=13,$.extend(t.YouAutocompleteMe.prototype,{defaults:{delay:150,model:t.YouAutocompleteMeModel,remote:t.YouAutocompleteMeRemote,list:t.YouAutoCompleteMeList},init:function(){this.init_dom(),this.init_events()},init_dom:function(){this.list.render()},init_events:function(){this.element.on("list_item_click",this.on_list_item_click),this.remote.on("done",this.on_remote_done).on("fail",this.on_remote_fail),this.input.on("keyup",this.on_key_up).on("keydown",this.on_key_down),this.model.on("query_change",this.on_query_change).on("collection_change",this.on_collection_change).on("index_change",this.on_index_change)},fetch:function(){this.input.val().match(/\S/)&&this.remote.load(this.get_options_for_request())},get_options_for_request:function(){return this.options.serialize?this.options.serialize.call(this):this.form.serialize()},show:function(){this.element.addClass("autocomplete_visible"),this.init_click_trap()},hide:function(){this.element.removeClass("autocomplete_visible"),this.destroy_click_trap()},init_click_trap:function(){$("body").off(".autocomplete_click_trap"),$("body").on("click.autocomplete_click_trap tap.autocomplete_click_trap",this.on_click_trap)},on_click_trap:function(t){0==$(t.target).closest(this.element).length&&this.hide()},destroy_click_trap:function(){$("body").off(".autocomplete_click_trap")},on_list_item_click:function(t){this.input.val(t.item.text),this.form.submit()},on_collection_change:function(){0!=this.model.collection.length?this.show():this.hide()},on_query_change:function(t){t.query.match(/\S/)&&(this.list.highlight_all(),this.fetch())},on_key_down:function(e){var i=e.keyCode;switch(i){case t.YouAutocompleteMe.ENTER:this.model.current()&&(this.model.stage_current(!0),e.preventDefault()),this.model.clear()}},on_key_up:function(e){var i=e.keyCode;switch(i){case t.YouAutocompleteMe.UP:this.model.prev(),this.model.collection.length&&this.show();break;case t.YouAutocompleteMe.DOWN:this.model.next(),this.model.collection.length&&this.show();break;case t.YouAutocompleteMe.ESC:this.model.set_query("");break;default:var n=this.input.val();this.model.set_query(n)}},on_remote_done:function(t){t&&this.model.set_collection(t.results)},on_remote_fail:function(t){window.console&&console.log("fail",t)},on_index_change:function(t){t.current&&this.input.val(t.current)}}),t.YouRMCompleteMeListItem=function(t,e,i){this.sup(t,e,i)},Prototype.extend(t.YouRMCompleteMeListItem,t.YouAutoCompleteMeListItem),$.extend(t.YouRMCompleteMeListItem.prototype,{draw:function(){return $("<li><a href='#'><span>"+this.text+"</span></a></li>")},render:function(){return this.super_method("render"),!this.text_container&&this.element&&(this.text_container=this.element.find("span")),this.element},highlight:function(t){this.text_container&&this.text_container.html(this.highlighted_text(t))}}),t.YouRMCompleteMeList=function(t,e,i){_.bindAll(this,"on_query_change"),this.sup(t,e,i)},Prototype.extend(t.YouRMCompleteMeList,t.YouAutoCompleteMeList),$.extend(t.YouRMCompleteMeList.prototype,{item:t.YouRMCompleteMeListItem,init:function(){this.super_method("init"),this.model.on("query_change",this.on_query_change)},draw:function(){var t=$("<div class='search_bar_results_wrapper'><div class='search_bar_results'>                    <p data-query class='search_bar_results_query'><span></span></p>                    <ul class='search_bar_results_predictive' data-items></ul>                </div></div>");return this.query=t.find("[data-query] span"),t},on_query_change:function(){this.query&&this.query.text(this.model.query)}}),t.YouRMCompleteMe=function(e,i){this.defaults=_.extend({},this.defaults,{list:t.YouRMCompleteMeList}),this.sup(e,i)},Prototype.extend(t.YouRMCompleteMe,t.YouAutocompleteMe),$.extend(t.YouRMCompleteMe.prototype,{}),Plugin.define("autocomplete_me",t.YouRMCompleteMe,"autocomplete_me")}),RM.ns(function(t){t.HeaderScheduleCarousel=function(t,e){_.bindAll(this,"on_next","on_prev","slide_change","control_actions","on_details_change","on_parent_unsticked"),this.options=$.extend(!0,{},this.defaults,e),this.element=t,this.options.parent&&(this.parent=this.options.parent),this.total_items=this.element.find(".swiper-slide ").length,this.info_more=this.element.find(".header_info_more,[data-close]"),this.info_content=this.element.find(".header_info_content"),this.init()},_.extend(t.HeaderScheduleCarousel.prototype,{defaults:{swiper:{calculateHeight:!0},prev:"<a href='#' data-prev>anterior</a>",next:"<a href='#' data-next>siguiente</a>",parent:null},init:function(){var t=this.element;this.options.swiper.onSlideChangeEnd=this.slide_change,this.info_more.on("click",this.control_actions),t.swiper(this.options.swiper),this.element.addClass("header_schedule_ready"),this.swiper=t.data("swiper"),this.hide_corner(),this.add_corner(),this.element.find("[data-prev]").on("click",this.on_prev),this.element.find("[data-next]").on("click",this.on_next),this.element.find(".header_basic_details select").on("change",this.on_details_change),this.parent&&this.parent.length&&this.parent.on("unsticked",this.on_parent_unsticked),this.refresh_arrows()},hide_corner:function(){this.element.find(".ico_goto").hide()},add_corner:function(){this.element.append(this.options.prev,this.options.next)},refresh_arrows:function(){var t=this.swiper.activeIndex,e=this.element.find("[data-next]");t>=this.total_items-1?e.hide():e.is(":hidden")&&e.show(),e=this.element.find("[data-prev]"),0==t?e.hide():e.is(":hidden")&&e.show()},on_next:function(t){t.preventDefault(),this.swiper.slideNext()},on_prev:function(t){t.preventDefault(),this.swiper.slidePrev()},slide_change:function(){this.refresh_arrows()},control_actions:function(t){t.preventDefault(),this.element.toggleClass("header_schedule_expanded")},on_details_change:function(t){var e=$(t.target).closest(".swiper-slide"),i=$(t.target).find(":selected");e.find(".time_select_content").text(i.data("time")+", "+i.data("tv")),e.find(".header_summary_description time em").text(i.data("time"))},on_parent_unsticked:function(){this.swiper&&this.swiper.update()}}),Plugin.define("header_schedule_carousel",t.HeaderScheduleCarousel)});